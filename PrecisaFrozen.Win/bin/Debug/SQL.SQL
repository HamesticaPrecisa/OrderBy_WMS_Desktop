
GO

CREATE TABLE [dbo].[_personas](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[PRIMERNOMBRE] [varchar](50) NOT NULL,
	[SEGUNDONOMBRE] [varchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[AccionCamion](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Descripcion] [char](30) NOT NULL,
 CONSTRAINT [PK_AccionCamion] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Actualizaciones](
	[Act_Codi] [int] IDENTITY(1,1) NOT NULL,
	[Act_version] [nvarchar](8) NULL,
	[Act_Fecha] [date] NULL,
	[Act_Descripcion] [varchar](900) NULL,
 CONSTRAINT [PK_Actualizaciones] PRIMARY KEY CLUSTERED 
(
	[Act_Codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ACUSETE_LOG](
	[LOG_FECAVISO] [nvarchar](10) NULL,
	[LOG_HORAVISO] [nvarchar](5) NULL,
	[LOG_USUARIO] [nvarchar](5) NULL,
	[LOG_PALLET] [nvarchar](9) NULL,
	[LOG_FECMOV] [nvarchar](10) NULL,
	[LOG_HORMOV] [nvarchar](5) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[ACUSETE_PARAMETROS](
	[acu_horas] [nvarchar](2) NULL,
	[acu_fecha] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[AINVENTARIO](
	[PALLET] [varchar](50) NULL,
	[ESTADO] [varchar](50) NULL,
	[USUARIO] [varchar](50) NULL,
	[FECHA] [datetime] NULL,
	[TIPOLECT] [varchar](20) NULL,
	[VALPRODUCTO] [numeric](18, 0) NULL,
	[VALCLIENTE] [numeric](18, 0) NULL,
	[VALCANTIDAD] [numeric](18, 0) NULL,
	[CODPRODUCTO] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[AINVENTARIO1](
	[PALLET] [varchar](50) NULL,
	[ESTADO] [varchar](50) NULL,
	[USUARIO] [varchar](50) NULL,
	[FECHA] [datetime] NULL,
	[TIPOLECT] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[ajustetarifas](
	[id] [varchar](50) NULL,
	[contrato] [varchar](50) NULL,
	[servicio] [varchar](50) NULL,
	[valor] [float] NULL,
	[cambio] [float] NULL,
	[fecha] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Alumnos](
	[Rut] [nvarchar](10) NOT NULL,
	[Nombre] [nvarchar](100) NULL,
	[Mail] [nvarchar](100) NULL,
	[Clave] [nvarchar](8) NULL,
 CONSTRAINT [PK_Alumnos] PRIMARY KEY CLUSTERED 
(
	[Rut] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[AlumnosNotas](
	[Rut] [nvarchar](10) NOT NULL,
	[Nota1] [numeric](18, 0) NULL,
	[Nota2] [numeric](18, 0) NULL,
	[Nota3] [numeric](18, 0) NULL,
 CONSTRAINT [PK_AlumnosNotas] PRIMARY KEY CLUSTERED 
(
	[Rut] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[AndenesReg](
	[Folio] [nchar](10) NULL,
	[Anden] [nvarchar](50) NULL,
	[cliente] [nvarchar](50) NULL,
	[tip_mov] [nvarchar](50) NULL,
	[fec_reg] [datetime] NULL,
	[usr_reg] [nvarchar](20) NULL,
	[usr_reg2] [nvarchar](20) NULL,
	[Obs] [nvarchar](80) NULL,
	[cod_bod] [nchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[anuladoc](
	[anul_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_anuladoc_anul_unica]  DEFAULT (newid()),
	[anul_codi] [nvarchar](10) NULL,
	[anul_fecha] [nvarchar](10) NULL,
	[anul_hora] [nvarchar](8) NULL,
	[anul_usuario] [nvarchar](10) NULL,
	[anul_personal] [int] NULL,
	[anul_glosa] [nvarchar](50) NULL,
 CONSTRAINT [PK_anuladoc] PRIMARY KEY NONCLUSTERED 
(
	[anul_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[ApeCieAndenes](
	[Folio] [nchar](10) NULL,
	[Anden] [nvarchar](50) NULL,
	[cliente] [nvarchar](50) NULL,
	[aper] [datetime] NULL,
	[cierrre] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[CAJAS_DANADAS](
	[CDAN_PALLET] [nvarchar](9) NULL,
	[CDAN_FECHA] [nvarchar](10) NULL,
	[CDAN_OBSERVACION] [nvarchar](255) NULL,
	[CDAN_ESTADO] [nvarchar](50) NULL,
	[CDAN_HORA] [nvarchar](5) NULL,
	[CDAN_LINK] [nvarchar](255) NULL,
	[CDAN_CAJAS] [nvarchar](5) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[CAJAS_DANADAS_LOG](
	[id] [nvarchar](14) NULL,
	[fecha] [nvarchar](10) NULL,
	[pallet] [nvarchar](9) NULL,
	[cajas] [numeric](18, 0) NULL,
	[usuario] [nvarchar](50) NULL,
	[equipo] [nvarchar](50) NULL,
	[tipo] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[CamaraConf](
	[Camara] [nchar](10) NULL,
	[NCamara] [nvarchar](max) NULL,
	[Columnas] [nchar](10) NULL,
	[Bandas] [nchar](10) NULL,
	[AlturaP] [nchar](10) NULL,
	[PisosP] [nchar](10) NULL,
	[apiso] [nchar](20) NULL,
	[rack_sel] [nchar](20) NULL,
	[push_back] [nchar](20) NULL,
	[drivein] [nchar](20) NULL,
	[libre] [nchar](20) NULL,
	[cod_bod] [nchar](10) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[CamaraMantenedor](
	[NombreCamara] [nvarchar](50) NULL,
	[Camara] [nchar](10) NULL,
	[Banda] [nchar](10) NULL,
	[Columna] [nchar](10) NULL,
	[Piso] [nchar](10) NULL,
	[Nivel] [nchar](10) NULL,
	[Altura] [nchar](10) NULL,
	[Cordenada] [nchar](10) NULL,
	[TipoPos] [nvarchar](50) NULL,
	[Bloqueo] [nchar](10) NULL,
	[TipoBloqueo] [nchar](10) NULL,
	[cod_bod] [nchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[camaras](
	[cam_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_camaras_cam_unica]  DEFAULT (newid()),
	[cam_codi] [varchar](3) NULL,
	[cam_descr] [varchar](30) NULL,
	[cam_tipo] [tinyint] NULL,
	[cam_tipocon] [tinyint] NULL,
	[cam_temper] [float] NULL,
	[cam_humed] [float] NULL,
	[cam_baninic] [float] NULL,
	[cam_banfin] [float] NULL,
	[cam_numcol] [float] NULL,
	[cam_numpiso] [float] NULL,
	[cam_numnive] [float] NULL,
	[cam_capm3] [float] NULL,
	[cam_captone] [float] NULL,
	[cam_numplan] [nvarchar](2) NULL,
	[cam_unidadini] [int] NULL,
	[cam_unidadfin] [int] NULL,
	[cam_capa] [numeric](18, 0) NULL,
	[cam_tmp] [numeric](18, 0) NULL,
 CONSTRAINT [PK_camaras] PRIMARY KEY NONCLUSTERED 
(
	[cam_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Camaras_Altura](
	[camara] [nvarchar](5) NULL,
	[columna] [nvarchar](5) NULL,
	[piso] [nvarchar](5) NULL,
	[altura] [nvarchar](5) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[CambioFechaDocumento](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Fecha] [smalldatetime] NULL,
	[NumeroDocumento] [char](10) NULL,
	[TipoDocumento] [char](10) NULL,
	[Reproceso] [bit] NOT NULL,
	[Usuario] [char](10) NULL,
	[FechaAnterior] [smalldatetime] NULL,
	[FechaNueva] [smalldatetime] NULL,
 CONSTRAINT [PK_CambioFechaDocumento] PRIMARY KEY NONCLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[CARGA_DESCARGA](
	[Codigo] [nvarchar](1) NULL,
	[Desc] [char](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[categorias_cliente](
	[CODIGO_CATEGORIA] [int] IDENTITY(1,1) NOT NULL,
	[NOMBRE_CATEGORIA] [varchar](2) NOT NULL,
	[ESTADO_CATEGORIA] [varchar](15) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[CODIGO_CATEGORIA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[chk_images](
	[id_chk] [int] NULL,
	[nombre] [nchar](1) NULL,
	[id_pallets] [bigint] NULL CONSTRAINT [DF_chk_images_id_pallets]  DEFAULT ((0)),
	[cl_imgtem] [image] NULL,
	[cl_imgsel] [image] NULL,
	[cl_imgpat] [image] NULL,
	[cl_fecha] [datetime] NULL,
	[fechamod] [datetime] NULL,
	[cl_imgtemS] [image] NULL,
	[cl_imgselS] [image] NULL,
	[cl_imgpatS] [image] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[chk_imagesopo](
	[id_pallets] [varchar](9) NULL,
	[cl_imgtem] [image] NULL,
	[cl_imgsel] [image] NULL,
	[cl_imgpat] [image] NULL,
	[cl_fecha] [datetime] NULL CONSTRAINT [DF_chk_imagesopo_fecha]  DEFAULT (getdate())
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[chk_imagestmp](
	[id_chk] [int] NULL,
	[nombre] [nchar](1) NULL,
	[codtpmrece] [int] NULL,
	[cl_imgpat] [image] NULL,
	[cl_imgsel] [image] NULL,
	[cl_imgtem] [image] NULL,
	[cl_fecha] [datetime] NULL CONSTRAINT [DF_chk_imagestmp_fecha]  DEFAULT (getdate()),
	[id_pallets] [nvarchar](9) NULL,
	[fechamod] [datetime] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[choferes](
	[cho_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_choferes_cho_unica]  DEFAULT (newid()),
	[cho_rut] [nvarchar](9) NULL,
	[cho_rutclie] [nvarchar](9) NULL,
	[cho_nombre] [nvarchar](40) NULL,
	[cho_patente] [nvarchar](10) NULL,
	[cho_empresa] [nvarchar](50) NULL,
	[cho_rutempresa] [nvarchar](13) NULL,
	[cho_patente2] [nvarchar](20) NULL,
	[cho_fecreg] [datetime] NULL CONSTRAINT [DF_choferes_cho_fecreg]  DEFAULT (getdate()),
 CONSTRAINT [PK_choferes] PRIMARY KEY NONCLUSTERED 
(
	[cho_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[cincuenta](
	[folio] [char](10) NULL,
	[despacho] [char](10) NULL,
	[cliente] [char](10) NULL,
	[carga] [char](10) NULL,
	[cincuenta] [bit] NOT NULL,
	[fecha] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ciudad](
	[ciu_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_ciudad_ciu_unica]  DEFAULT (newid()),
	[ciu_codi] [nvarchar](3) NULL,
	[ciu_descr] [nvarchar](30) NULL,
 CONSTRAINT [PK_ciudad] PRIMARY KEY NONCLUSTERED 
(
	[ciu_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ClasificacionMovimiento](
	[Cmov_codi] [varchar](50) NOT NULL,
	[Cmov_Descrip] [varchar](50) NULL,
 CONSTRAINT [PK_ClasificacionMovimiento] PRIMARY KEY CLUSTERED 
(
	[Cmov_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[clientes](
	[cli_unica] [uniqueidentifier] ROWGUIDCOL  NULL CONSTRAINT [DF_clientes_cli_unica]  DEFAULT (newid()),
	[cli_rut] [varchar](9) NOT NULL,
	[cli_nomb] [varchar](50) NULL,
	[cli_direcc] [varchar](50) NULL,
	[cli_comuna] [varchar](50) NULL,
	[cli_ciudad] [varchar](50) NULL,
	[cli_fono] [varchar](50) NULL,
	[cli_fax] [varchar](50) NULL,
	[cli_feccre] [varchar](50) NULL,
	[cli_estado] [varchar](50) NULL,
	[cli_rubro] [varchar](50) NULL,
	[cli_mail] [varchar](max) NULL,
	[Mail2] [varchar](max) NULL,
	[CLI_CRYD] [varchar](max) NULL,
	[CLI_VENC] [nvarchar](1) NULL,
	[CLI_PVENC] [nvarchar](300) NULL,
	[cli_envio] [nvarchar](1) NULL,
	[cli_diaenv] [nvarchar](1) NULL,
	[cli_validarfecvenc] [char](1) NULL CONSTRAINT [DF_clientes_cli_validarfecvenc]  DEFAULT ((0)),
	[cli_picking] [numeric](18, 0) NULL CONSTRAINT [DF_clientes_cli_picking]  DEFAULT ((0)),
	[cli_ItemGuia] [numeric](18, 0) NULL CONSTRAINT [DF_clientes_cli_ItemGuia]  DEFAULT ((0)),
	[cli_recepciones] [numeric](18, 0) NULL CONSTRAINT [DF_clientes_cli_recepciones]  DEFAULT ((0)),
	[cli_despachos] [numeric](18, 0) NULL CONSTRAINT [DF_clientes_cli_despachos]  DEFAULT ((0)),
	[cli_facturabloqueo] [numeric](18, 0) NULL CONSTRAINT [DF_clientes_cli_facturabloqueo]  DEFAULT ((0)),
	[cli_dia] [numeric](18, 0) NULL CONSTRAINT [DF_clientes_cli_dia]  DEFAULT ((1)),
	[cli_codvig] [numeric](18, 0) NULL,
	[cli_estadopedcaja] [int] NULL CONSTRAINT [DF_clientes_cli_estadopedcaja]  DEFAULT ((3)),
	[cli_length] [numeric](18, 0) NULL,
	[cli_pwdbloqueo] [nvarchar](15) NULL,
	[cli_tipoclie] [varchar](15) NULL,
	[cli_contactos] [varchar](max) NULL,
	[cli_inftraq] [numeric](18, 0) NULL,
	[cli_tramorece] [int] NULL CONSTRAINT [DF_clientes_cli_tramorece]  DEFAULT ((2)),
	[cli_tramodespa] [int] NULL CONSTRAINT [DF_clientes_cli_tramodespa]  DEFAULT ((2)),
	[cli_procrece] [int] NULL CONSTRAINT [DF_clientes_cli_procrece]  DEFAULT ((1)),
	[cli_procdespa] [int] NULL CONSTRAINT [DF_clientes_cli_procdespa]  DEFAULT ((1)),
	[cli_blockweb] [int] NULL,
	[cli_blockGes] [int] NULL,
	[cli_hrs_homog] [int] NULL,
	[cli_stock0] [int] NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_clientes] PRIMARY KEY NONCLUSTERED 
(
	[cli_rut] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Clientes_CodigoPequeno](
	[cli_rut] [char](10) NULL,
	[cli_cod] [char](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[CLIENTES_LOG_BLOQUEOS](
	[ID] [nvarchar](14) NULL,
	[USUARIO] [nvarchar](50) NULL,
	[PC] [nvarchar](50) NULL,
	[RECEPCION] [nvarchar](50) NULL,
	[DESPACHO] [nvarchar](50) NULL,
	[USUARIOGESTION] [nvarchar](3) NULL,
	[CLIENTE] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[ConexionDatos](
	[ip_servidor] [nvarchar](50) NULL,
	[nombre_serv] [nvarchar](50) NULL,
	[user_adm] [nvarchar](50) NULL,
	[pass] [nvarchar](50) NULL,
	[Tipo] [nchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Conf_Impresora](
	[Imp_Id] [uniqueidentifier] NULL CONSTRAINT [DF_Conf_Impresora_Imp_Id]  DEFAULT (newid()),
	[Imp_Comp] [nvarchar](70) NULL,
	[Imp_Etiq] [nvarchar](70) NULL,
	[Imp_Inf] [nvarchar](70) NULL,
	[Imp_FecConf] [datetime] NULL,
	[Imp_Com1] [nvarchar](4) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[CONFIGURACION_DATAMAX](
	[PC] [nvarchar](50) NULL,
	[CALOR] [nvarchar](2) NULL,
	[DATAMAX] [bit] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[confirma](
	[con_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_confirma_con_unica]  DEFAULT (newid()),
	[con_tipope] [nvarchar](1) NULL,
	[con_folio] [nvarchar](9) NULL,
	[con_nper] [nvarchar](3) NULL,
	[con_fecha] [nvarchar](10) NULL,
	[con_dhora] [nvarchar](6) NULL,
	[con_hhora] [nvarchar](50) NULL,
 CONSTRAINT [PK_confirma] PRIMARY KEY NONCLUSTERED 
(
	[con_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[contrato](
	[cont_codi] [varchar](7) NOT NULL,
	[cont_rutclie] [varchar](9) NULL,
	[cont_descr] [varchar](50) NULL,
	[cont_feccont] [date] NULL,
	[cont_fecexpi] [date] NULL,
	[cont_TipAlmc] [numeric](18, 0) NULL,
	[cont_manual] [numeric](18, 0) NULL,
	[cont_tempcon] [real] NULL,
	[cont_tempgra] [real] NULL,
	[cont_diagracia] [smallint] NULL,
	[cont_cc] [int] NULL,
	[cont_tunelG] [int] NULL,
	[cont_estado] [numeric](18, 0) NULL,
	[cont_Tunelescala] [nvarchar](1) NULL CONSTRAINT [DF_contrato_cont_Tunelescala]  DEFAULT ((0)),
	[cont_palletpromedio] [int] NULL,
	[cont_mespromedio] [nvarchar](12) NULL,
	[cont_producto] [numeric](18, 0) NULL CONSTRAINT [DF_contrato_cont_producto]  DEFAULT ((0)),
	[CONT_RECEPCIONES] [numeric](18, 0) NULL CONSTRAINT [DF_contrato_CONT_RECEPCIONES]  DEFAULT (N'0'),
	[CONT_DESPACHOS] [numeric](18, 0) NULL CONSTRAINT [DF_contrato_CONT_DESPACHOS]  DEFAULT (N'0'),
	[cont_BloqImp] [numeric](18, 0) NULL CONSTRAINT [DF_contrato_cont_BloqImp]  DEFAULT ((0)),
	[cont_bloqfac] [numeric](18, 0) NULL,
	[cont_rutpro] [varchar](15) NULL,
	[cont_fecproc] [nvarchar](10) NULL,
	[cont_diafact] [int] NULL,
	[cont_contrel] [nvarchar](7) NULL,
	[cont_diacont] [smallint] NULL,
	[cont_tipo] [int] NULL CONSTRAINT [DF_contrato_cont_tipo]  DEFAULT ((0)),
	[cont_pallet] [int] NULL,
	[cont_lectura] [numeric](18, 0) NULL CONSTRAINT [DF_contrato_cont_lectura]  DEFAULT ((0)),
	[cont_tipseg] [numeric](18, 0) NULL,
 CONSTRAINT [PK_contrato] PRIMARY KEY NONCLUSTERED 
(
	[cont_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[contrato_hist](
	[cont_unica_hist] [char](16) NULL,
	[cont_rutclie_hist] [nvarchar](9) NULL,
	[cont_rutpro_hist] [varchar](15) NULL,
	[cont_codi_hist] [nvarchar](7) NULL,
	[cont_descr_hist] [nvarchar](40) NULL,
	[cont_feccont_hist] [nvarchar](10) NULL,
	[cont_fecexpi_hist] [nvarchar](10) NULL,
	[cont_fecproc_hist] [nvarchar](10) NULL,
	[cont_diafact_hist] [int] NULL,
	[cont_tempcon_hist] [real] NULL,
	[cont_tempgra_hist] [real] NULL,
	[cont_contrel_hist] [nvarchar](7) NULL,
	[cont_diacont_hist] [smallint] NULL,
	[cont_diagracia_hist] [smallint] NULL,
	[cont_tipo_hist] [int] NULL,
	[cont_pallet_hist] [int] NULL,
	[cont_fecha_hist] [datetime] NULL,
	[cont_CodWeb] [decimal](18, 0) NULL,
	[cont_GrupFec] [decimal](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Contratos_Procesos](
	[cont_unica] [varchar](255) NULL,
	[cont_rutclie] [varchar](255) NULL,
	[cont_rutPro] [varchar](50) NULL,
	[cont_codi] [varchar](255) NULL,
	[cont_descr] [varchar](255) NULL,
	[cont_feccont] [varchar](255) NULL,
	[cont_fecexpi] [varchar](255) NULL,
	[cont_fecproc] [varchar](255) NULL,
	[cont_diafact] [int] NULL,
	[cont_tempcon] [real] NULL,
	[cont_tempgra] [real] NULL,
	[cont_contrel] [varchar](255) NULL,
	[cont_diacont] [smallint] NULL,
	[cont_diagracia] [smallint] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[contratos_web](
	[con_unica] [uniqueidentifier] NULL,
	[con_rut] [varchar](9) NULL,
	[con_pdf] [varchar](200) NULL,
	[con_excel] [varchar](200) NULL,
	[con_imagen] [varchar](200) NULL,
	[con_estado] [varchar](9) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[ContratosDetalle](
	[Dcon_Codigo] [varchar](7) NOT NULL,
	[Dcon_ServCod] [varchar](3) NOT NULL,
	[Dcon_activo] [numeric](18, 0) NULL,
	[Dcon_Valor] [float] NULL,
	[Dcon_Moneda] [varchar](2) NULL,
	[Dcon_Medida] [varchar](3) NULL,
	[Dcon_codvig] [numeric](18, 0) NULL,
	[Dcon_cero] [numeric](18, 0) NULL,
 CONSTRAINT [PK_ContratosDetalle] PRIMARY KEY CLUSTERED 
(
	[Dcon_Codigo] ASC,
	[Dcon_ServCod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[ContratosHorarios](
	[Hor_ContCod] [varchar](7) NOT NULL,
	[Hor_SRI] [varchar](5) NULL,
	[Hor_SRT] [varchar](5) NULL,
	[Hor_SDI] [varchar](5) NULL,
	[Hor_SDT] [varchar](5) NULL,
	[Hor_FRI] [varchar](5) NULL,
	[Hor_FRT] [varchar](5) NULL,
	[Hor_FDI] [varchar](5) NULL,
	[Hor_FDT] [varchar](5) NULL,
 CONSTRAINT [PK_ContratosHorarios_1] PRIMARY KEY CLUSTERED 
(
	[Hor_ContCod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ControlVersion](
	[numero] [nvarchar](2) NULL,
	[programa] [nvarchar](15) NULL,
	[version] [nvarchar](10) NULL,
	[sitioweb] [nvarchar](255) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[contrpara](
	[cpar_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_contrpara_cpar_unica]  DEFAULT (newid()),
	[cpar_contr] [nvarchar](7) NULL,
	[cpar_servi] [nvarchar](2) NULL,
	[cpar_marca] [nvarchar](1) NULL,
	[cpar_valor] [float] NULL,
	[cpar_moneda] [nvarchar](2) NULL,
	[cpar_medida] [nvarchar](7) NULL,
	[cpar_codvig] [tinyint] NULL CONSTRAINT [DF_contrpara_cpar_codvig]  DEFAULT (0),
	[cpar_meses] [nvarchar](12) NULL CONSTRAINT [DF_contrpara_cpar_meses]  DEFAULT (111111111111),
	[cpar_fechahabilita] [nvarchar](10) NULL,
 CONSTRAINT [PK_contrpara] PRIMARY KEY NONCLUSTERED 
(
	[cpar_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[contrpara_hist](
	[cpar_unica_hist] [uniqueidentifier] NULL,
	[cpar_contr_hist] [nvarchar](7) NULL,
	[cpar_servi_hist] [nvarchar](2) NULL,
	[cpar_marca_hist] [nvarchar](1) NULL,
	[cpar_valor_hist] [real] NULL,
	[cpar_moneda_hist] [nvarchar](2) NULL,
	[cpar_medida_hist] [nvarchar](7) NULL,
	[cpar_codvig_hist] [tinyint] NULL,
	[cpar_fecha_hist] [datetime] NULL,
	[cpar_rutcli_hist] [nvarchar](50) NULL,
	[cpar_CodWeb] [decimal](18, 0) NULL,
	[cpar_GrupFec] [decimal](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[correlat](
	[cor_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_correlat_cor_unica]  DEFAULT (newid()),
	[cor_codi] [nvarchar](3) NULL,
	[cor_descr] [nvarchar](50) NULL,
	[cor_correini] [int] NULL,
	[cor_correfin] [int] NULL,
	[cor_correact] [int] NULL,
	[cor_codact] [tinyint] NULL,
 CONSTRAINT [PK_correlat] PRIMARY KEY NONCLUSTERED 
(
	[cor_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Correlat_salto](
	[tmps_unica] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_Correlat_salto_tmps_unica]  DEFAULT (newid()),
	[tmps_codi] [nvarchar](10) NOT NULL,
	[tmps_correl] [int] NOT NULL,
	[tmps_usuario] [nvarchar](10) NULL,
	[tmps_personal] [smallint] NULL,
	[tmps_fecha] [nvarchar](10) NULL,
	[tmps_gestion] [numeric](18, 0) NULL,
 CONSTRAINT [PK_Correlat_salto] PRIMARY KEY CLUSTERED 
(
	[tmps_codi] ASC,
	[tmps_correl] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[correlat_saltoTMP](
	[tmps_unica] [uniqueidentifier] NOT NULL,
	[tmps_codi] [nvarchar](10) NULL,
	[tmps_correl] [int] NULL,
	[tmps_usuario] [nvarchar](10) NULL,
	[tmps_personal] [smallint] NULL,
	[tmps_fecha] [nvarchar](10) NULL,
 CONSTRAINT [PK_correlat_saltoTMP] PRIMARY KEY CLUSTERED 
(
	[tmps_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[CORRELATIVO](
	[TIPO] [int] NULL,
	[ACTUAL] [varchar](50) NULL,
	[UTILIZADO] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[correlatTMP](
	[cor_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_correlat_TMP_cor_unica]  DEFAULT (newid()),
	[cor_codi] [nvarchar](3) NULL,
	[cor_descr] [nvarchar](30) NULL,
	[cor_correini] [int] NULL,
	[cor_correfin] [int] NULL,
	[cor_correact] [int] NULL,
	[cor_codact] [tinyint] NULL,
 CONSTRAINT [PK_correlat_TMP] PRIMARY KEY CLUSTERED 
(
	[cor_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Correos](
	[corr_codi] [numeric](18, 0) NOT NULL,
	[corr_desc] [varchar](50) NULL,
	[corr_TO] [varchar](100) NULL,
	[corr_CCO] [varchar](500) NULL,
	[corr_BCC] [varchar](500) NULL,
 CONSTRAINT [PK_Correos] PRIMARY KEY CLUSTERED 
(
	[corr_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[CORRTABLAS](
	[TABLA] [varchar](50) NOT NULL,
	[CODIGO] [numeric](18, 0) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Cotizaciones](
	[coti_codi] [varchar](7) NOT NULL,
	[coti_rutclie] [varchar](9) NULL,
	[coti_descr] [varchar](50) NULL,
	[coti_descrsopo] [varchar](50) NULL,
	[coti_feccont] [date] NULL,
	[coti_fecexpi] [date] NULL,
	[coti_TipAlmc] [numeric](18, 0) NULL,
	[coti_manual] [numeric](18, 0) NULL,
	[coti_tempcon] [real] NULL,
	[coti_tempgra] [real] NULL,
	[coti_diagracia] [smallint] NULL,
	[coti_cc] [int] NULL,
	[coti_tunelG] [int] NULL,
	[coti_estado] [numeric](18, 0) NULL,
	[coti_Tunelescala] [nvarchar](1) NULL CONSTRAINT [DF_Table_1_cont_Tunelescala]  DEFAULT ((0)),
	[coti_producto] [numeric](18, 0) NULL CONSTRAINT [DF_Table_1_cont_producto]  DEFAULT ((0)),
	[coti_RECEPCIONES] [numeric](18, 0) NULL CONSTRAINT [DF_Table_1_CONT_RECEPCIONES]  DEFAULT (N'0'),
	[coti_DESPACHOS] [numeric](18, 0) NULL CONSTRAINT [DF_Table_1_CONT_DESPACHOS]  DEFAULT (N'0'),
	[coti_BloqImp] [numeric](18, 0) NULL CONSTRAINT [DF_Table_1_cont_BloqImp]  DEFAULT ((0)),
	[coti_bloqfac] [numeric](18, 0) NULL,
	[coti_tipo] [int] NULL CONSTRAINT [DF_Table_1_cont_tipo]  DEFAULT ((0)),
	[coti_pallet] [int] NULL,
	[coti_lectura] [numeric](18, 0) NULL CONSTRAINT [DF_Table_1_cont_lectura]  DEFAULT ((0)),
	[coti_tipseg] [numeric](18, 0) NULL,
 CONSTRAINT [PK_Cotizaciones] PRIMARY KEY CLUSTERED 
(
	[coti_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[CotizacionesDetalle](
	[Dcot_Codigo] [varchar](7) NOT NULL,
	[Dcot_ServCod] [varchar](3) NOT NULL,
	[Dcot_activo] [numeric](18, 0) NULL,
	[Dcot_Valor] [float] NULL,
	[Dcot_Moneda] [varchar](2) NULL,
	[Dcot_Medida] [varchar](3) NULL,
	[Dcot_codvig] [numeric](18, 0) NULL,
	[Dcot_cero] [numeric](18, 0) NULL,
 CONSTRAINT [PK_CotizacionesDetalle] PRIMARY KEY CLUSTERED 
(
	[Dcot_Codigo] ASC,
	[Dcot_ServCod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[CotizacionesDetalleEscalas](
	[esc_coti] [varchar](7) NOT NULL,
	[esc_serser] [varchar](3) NOT NULL,
	[esc_ntramos] [numeric](18, 0) NULL,
	[esc_dtramo1] [float] NULL,
	[esc_htramo1] [float] NULL,
	[esc_valor1] [float] NULL,
	[esc_dtramo2] [float] NULL,
	[esc_htramo2] [float] NULL,
	[esc_valor2] [float] NULL,
	[esc_dtramo3] [float] NULL,
	[esc_htramo3] [float] NULL,
	[esc_valor3] [float] NULL,
	[esc_dtramo4] [float] NULL,
	[esc_htramo4] [float] NULL,
	[esc_valor4] [float] NULL,
	[esc_dtramo5] [float] NULL,
	[esc_htramo5] [float] NULL,
	[esc_valor5] [float] NULL,
	[esc_dtramo6] [float] NULL,
	[esc_htramo6] [float] NULL,
	[esc_valor6] [float] NULL,
	[esc_dtramo7] [float] NULL,
	[esc_htramo7] [float] NULL,
	[esc_valor7] [float] NULL,
	[esc_dtramo8] [float] NULL,
	[esc_htramo8] [float] NULL,
	[esc_valor8] [float] NULL,
	[esc_dtramo9] [float] NULL,
	[esc_htramo9] [float] NULL,
	[esc_valor9] [float] NULL,
	[esc_dtramo10] [float] NULL,
	[esc_htramo10] [float] NULL,
	[esc_valor10] [float] NULL,
 CONSTRAINT [PK_CotizacionesDetalleEscalas] PRIMARY KEY CLUSTERED 
(
	[esc_coti] ASC,
	[esc_serser] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[CotizacionesHorarios](
	[Hor_CotiCod] [varchar](7) NOT NULL,
	[Hor_SRI] [varchar](5) NULL,
	[Hor_SRT] [varchar](5) NULL,
	[Hor_SDI] [varchar](5) NULL,
	[Hor_SDT] [varchar](5) NULL,
	[Hor_FRI] [varchar](5) NULL,
	[Hor_FRT] [varchar](5) NULL,
	[Hor_FDI] [varchar](5) NULL,
	[Hor_FDT] [varchar](5) NULL,
 CONSTRAINT [PK_CotizacionesHorarios] PRIMARY KEY CLUSTERED 
(
	[Hor_CotiCod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[DefaultHorarios](
	[Hor_ContCod] [varchar](7) NOT NULL,
	[Hor_SRI] [varchar](5) NULL,
	[Hor_SRT] [varchar](5) NULL,
	[Hor_SDI] [varchar](5) NULL,
	[Hor_SDT] [varchar](5) NULL,
	[Hor_FRI] [varchar](5) NULL,
	[Hor_FRT] [varchar](5) NULL,
	[Hor_FDI] [varchar](5) NULL,
	[Hor_FDT] [varchar](5) NULL,
 CONSTRAINT [PK_DefaultHorarios] PRIMARY KEY CLUSTERED 
(
	[Hor_ContCod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[despaimagen](
	[dimg_imagen] [image] NULL,
	[dimg_num] [int] NULL,
	[dimg_despcodi] [nvarchar](7) NULL,
	[fecha] [datetime] NULL CONSTRAINT [DF_despaimagen_fecha]  DEFAULT (getdate()),
	[dimg_imagen2] [image] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[DestinoPallet](
	[DPal_codi] [int] NULL,
	[DPal_desc] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[detacont](
	[dcon_cont] [varchar](20) NOT NULL,
	[dcon_folio] [varchar](9) NOT NULL,
	[dcon_usue] [nvarchar](3) NULL,
	[dcon_este] [int] NULL,
	[dcon_fet] [datetime] NULL,
	[dcon_usur] [nvarchar](3) NULL,
	[dcon_estr] [int] NULL,
	[dcon_fre] [datetime] NULL,
	[dcon_dr] [nvarchar](50) NULL,
 CONSTRAINT [PK_detacont_1] PRIMARY KEY CLUSTERED 
(
	[dcon_cont] ASC,
	[dcon_folio] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detadespa](
	[ddes_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_detadespa_ddes_unica]  DEFAULT (newid()),
	[ddes_codi] [nvarchar](9) NULL,
	[ddes_codpro] [nvarchar](7) NULL,
	[ddes_codsopo] [nvarchar](2) NULL,
	[ddes_sopocli] [nvarchar](17) NULL,
	[ddes_unidades] [int] NULL,
	[ddes_peso] [float] NULL,
	[ddes_fecprod] [nvarchar](10) NULL,
	[ddes_fecha] [nvarchar](10) NULL,
	[ddes_rutcli] [nvarchar](9) NULL,
	[ddes_contcli] [nvarchar](7) NULL,
	[ddes_camara] [nvarchar](2) NULL,
	[ddes_almacen] [tinyint] NULL,
	[ddes_codpred] [nvarchar](9) NULL,
	[ddes_codrece] [nvarchar](9) NULL,
	[ddes_codvig] [nvarchar](1) NULL,
	[ddes_pallet] [tinyint] NULL,
	[ddes_pedido] [nvarchar](25) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_detadespa] PRIMARY KEY NONCLUSTERED 
(
	[ddes_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO
CREATE TABLE [dbo].[Detadespabasura](
	[ddes_unica] [uniqueidentifier] NOT NULL,
	[ddes_codi] [nvarchar](9) NULL,
	[ddes_codpro] [nvarchar](7) NULL,
	[ddes_codsopo] [nvarchar](2) NULL,
	[ddes_sopocli] [nvarchar](11) NULL,
	[ddes_unidades] [int] NULL,
	[ddes_peso] [float] NULL,
	[ddes_fecprod] [nvarchar](10) NULL,
	[ddes_fecha] [nvarchar](10) NULL,
	[ddes_rutcli] [nvarchar](9) NULL,
	[ddes_contcli] [nvarchar](7) NULL,
	[ddes_camara] [nvarchar](2) NULL,
	[ddes_almacen] [tinyint] NULL,
	[ddes_codpred] [nvarchar](9) NULL,
	[ddes_codrece] [nvarchar](9) NULL,
	[ddes_codvig] [nvarchar](1) NULL,
	[ddes_pallet] [tinyint] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[DETAETIQ](
	[ETIQ_CODI] [varchar](5) NOT NULL,
	[ETIQ_DCOD] [nvarchar](2) NOT NULL,
	[ETIQ_SOPOPRE] [nvarchar](9) NULL,
	[ETIQ_SOPOCLIANT] [nvarchar](11) NULL,
	[ETIQ_SOPOCLI] [nvarchar](11) NULL,
	[ETIQ_CODPRO] [nvarchar](7) NULL,
	[ETIQ_FECPROD] [date] NULL,
	[ETIQ_FECVENC] [date] NULL,
	[ETIQ_CAJAS] [numeric](18, 0) NULL,
	[ETIQ_KILOS] [float] NULL,
	[ETIQ_NFECPROD] [date] NULL,
	[ETIQ_NFECVENC] [date] NULL,
	[ETIQ_NSOPOCLI] [nvarchar](11) NULL,
	[ETIQ_EST] [nvarchar](5) NULL,
 CONSTRAINT [PK_DETAETIQ] PRIMARY KEY CLUSTERED 
(
	[ETIQ_CODI] ASC,
	[ETIQ_DCOD] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detafact](
	[dfac_codi] [numeric](18, 0) NOT NULL,
	[dfac_codserv] [numeric](18, 0) NULL,
	[dfac_unid] [float] NULL,
	[dfac_caj] [numeric](18, 0) NULL,
	[dfac_kil] [float] NULL,
	[dfac_usd] [float] NULL,
	[dfac_vuni] [numeric](18, 0) NULL,
	[dfac_tot] [numeric](18, 0) NULL,
 CONSTRAINT [PK_detafact] PRIMARY KEY CLUSTERED 
(
	[dfac_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[DETAGRUPOS](
	[dgru_Codi] [nvarchar](7) NULL,
	[dgru_RutCli] [nvarchar](10) NULL,
	[dgru_MetaPallet] [numeric](18, 0) NULL,
	[dgru_TarifaNormal] [numeric](10, 0) NULL,
	[dgru_TarifaMeta] [numeric](10, 0) NULL,
	[dgru_Fecha] [nvarchar](10) NULL,
	[dgru_Hora] [nvarchar](5) NULL,
	[dgru_Usuario] [nvarchar](3) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[DETALLE_CARGA](
	[IDPROCESO] [nvarchar](50) NULL,
	[RUT] [nvarchar](9) NULL,
	[CLIENTE] [nvarchar](50) NULL,
	[CODIGO] [nvarchar](15) NULL,
	[PRODUCTO] [nvarchar](50) NULL,
	[TUNEL] [nvarchar](15) NULL,
	[PALLET] [numeric](18, 0) NULL,
	[KILOS] [float] NULL,
	[UNIDADES] [numeric](18, 0) NULL,
	[FECHA_INI] [nvarchar](10) NULL,
	[HORA_INI] [nvarchar](8) NULL,
	[FECHA_TER] [nvarchar](10) NULL,
	[HORA_TER] [nvarchar](8) NULL,
	[OPERADOR] [nvarchar](50) NULL,
	[ESTADO] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[detapedcaja](
	[pc_codi] [numeric](18, 0) NULL,
	[dpc_numpal] [nvarchar](9) NULL,
	[dpc_estado] [int] NULL,
	[dpc_codcaja] [nvarchar](200) NULL,
	[dpc_codped] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[DETAPNC](
	[dpnc_codigo] [nvarchar](12) NULL,
	[dpnc_foto] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detapred](
	[dpre_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_detapred_dpre_unica]  DEFAULT (newid()),
	[dpre_codi] [nvarchar](9) NULL,
	[dpre_codpro] [nvarchar](7) NULL,
	[dpre_codsopo] [nvarchar](2) NULL,
	[dpre_sopocli] [nvarchar](17) NULL,
	[dpre_unidades] [int] NULL,
	[dpre_peso] [float] NULL,
	[dpre_fecdes] [nvarchar](10) NULL,
	[dpre_rutcli] [nvarchar](9) NULL,
	[dpre_contcli] [nvarchar](7) NULL,
	[dpre_fecprod] [nvarchar](10) NULL,
	[dpre_camara] [nvarchar](2) NULL,
	[dpre_banda] [nvarchar](2) NULL,
	[dpre_colum] [nvarchar](2) NULL,
	[dpre_piso] [nvarchar](2) NULL,
	[dpre_nivel] [nvarchar](1) NULL,
	[dpre_almacen] [tinyint] NULL,
	[dpre_dcaja] [tinyint] NULL,
	[dpre_folio] [nvarchar](9) NULL,
	[dpre_activa] [tinyint] NULL,
	[dpre_radio] [tinyint] NULL,
	[dpre_track] [tinyint] NULL,
	[dpre_codvig] [nvarchar](1) NULL,
	[dpre_pallet] [tinyint] NULL,
	[dpre_slot] [nvarchar](3) NULL,
	[dpre_TS] [real] NULL,
	[dpre_TM] [real] NULL,
	[dpre_TI] [real] NULL,
	[dpre_CodPer] [char](3) NULL,
	[dpre_Hora] [varchar](10) NULL,
	[dpre_fecn] [nvarchar](10) NULL,
	[DPRE_FOLIO_PALLET] [nvarchar](18) NULL,
	[dpre_temperatura] [varchar](1) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_detapred] PRIMARY KEY NONCLUSTERED 
(
	[dpre_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[DetaPredCajas](
	[dpre_npallet] [nvarchar](9) NULL,
	[dpre_caja] [nvarchar](200) NULL,
	[dpre_nped] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Detapredcajas1](
	[dpre_codi] [nvarchar](21) NULL,
	[dpre_codpro] [nvarchar](7) NULL,
	[dpre_codsopo] [nvarchar](2) NULL,
	[dpre_sopocli] [nvarchar](9) NULL,
	[dpre_unidades] [int] NULL,
	[dpre_peso] [float] NULL,
	[dpre_fecdes] [nvarchar](10) NULL,
	[dpre_rutcli] [nvarchar](9) NULL,
	[dpre_contcli] [nvarchar](7) NULL,
	[dpre_fecprod] [nvarchar](10) NULL,
	[dpre_camara] [nvarchar](2) NULL,
	[dpre_banda] [nvarchar](2) NULL,
	[dpre_colum] [nvarchar](2) NULL,
	[dpre_piso] [nvarchar](2) NULL,
	[dpre_nivel] [nvarchar](1) NULL,
	[dpre_almacen] [tinyint] NULL,
	[dpre_dcaja] [tinyint] NULL,
	[dpre_folio] [nvarchar](9) NULL,
	[dpre_activa] [tinyint] NULL,
	[dpre_radio] [tinyint] NULL,
	[dpre_track] [tinyint] NULL,
	[dpre_codvig] [nvarchar](1) NULL,
	[dpre_pallet] [tinyint] NULL,
	[dpre_slot] [nvarchar](3) NULL,
	[dpre_TS] [real] NULL,
	[dpre_TM] [real] NULL,
	[dpre_TI] [real] NULL,
	[dpre_CodPer] [char](3) NULL,
	[dpre_Hora] [varchar](10) NULL,
	[dpre_fecn] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detapreslo](
	[pres_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_detapreslo_pres_unica]  DEFAULT (newid()),
	[pres_codi] [nvarchar](11) NULL,
	[pres_caslo] [nvarchar](5) NULL,
	[pres_codpro] [nvarchar](7) NULL,
	[pres_unidades] [int] NULL,
	[pres_peso] [float] NULL,
	[pres_fecprod] [nvarchar](10) NULL,
	[pres_folio] [nvarchar](11) NULL,
	[pres_activa] [tinyint] NULL,
	[pres_radio] [tinyint] NULL,
	[pres_codvig] [tinyint] NULL,
 CONSTRAINT [PK_detapreslo] PRIMARY KEY NONCLUSTERED 
(
	[pres_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[detarecbolsa](
	[codrece] [nvarchar](15) NULL,
	[lote] [nvarchar](15) NULL,
	[pallet] [nvarchar](15) NULL,
	[bandejas] [nvarchar](15) NULL,
	[kilos] [nvarchar](15) NULL,
	[producto] [nvarchar](50) NULL,
	[fecha_ela] [datetime] NULL,
	[fecha_ven] [datetime] NULL,
	[kilosbol] [numeric](18, 0) NULL,
	[codbolsa] [numeric](18, 0) NOT NULL,
	[estado] [nchar](10) NULL,
 CONSTRAINT [PK_detarecbolsa] PRIMARY KEY CLUSTERED 
(
	[codbolsa] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detarece](
	[drec_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_detarece_drec_unica]  DEFAULT (newid()),
	[drec_codi] [nvarchar](9) NULL,
	[drec_codcaja] [nvarchar](50) NULL,
	[drec_codpro] [nvarchar](7) NULL,
	[drec_origen] [nvarchar](2) NULL,
	[drec_codsopo] [nvarchar](2) NULL,
	[drec_sopocli] [nvarchar](17) NULL,
	[drec_unidades] [int] NULL,
	[drec_peso] [float] NULL,
	[drec_fecrec] [nvarchar](10) NULL,
	[drec_rutcli] [nvarchar](9) NULL,
	[drec_rutproductor] [varchar](12) NULL CONSTRAINT [DF_detarece_drec_rutproductor]  DEFAULT (''),
	[drec_contcli] [nvarchar](7) NULL,
	[drec_fecprod] [nvarchar](10) NULL,
	[drec_camara] [nvarchar](2) NULL,
	[drec_banda] [nvarchar](2) NULL,
	[drec_colum] [nvarchar](2) NULL,
	[drec_piso] [nvarchar](2) NULL,
	[drec_nivel] [nvarchar](1) NULL,
	[drec_almacen] [tinyint] NULL,
	[drec_dcaja] [tinyint] NULL,
	[drec_tunel] [tinyint] NULL,
	[drec_codvig] [nvarchar](1) NULL,
	[drec_pallet] [tinyint] NULL,
	[drec_codrel] [nvarchar](7) NULL,
	[drec_nrosopo] [int] NULL,
	[drec_slot] [nvarchar](3) NULL,
	[drec_dtgracia] [nvarchar](3) NULL,
	[drec_codsag] [nvarchar](20) NULL,
	[drec_tipo] [int] NULL CONSTRAINT [DF_detarece_drec_tipo]  DEFAULT ((0)),
	[FechaVencimiento] [char](10) NULL,
	[LoteCliente] [char](20) NULL,
	[drec_temp] [float] NULL,
	[drec_TS] [real] NULL,
	[drec_TM] [real] NULL,
	[drec_TI] [real] NULL,
	[drec_RecepTunel] [int] NULL,
	[drec_ProcTunel] [int] NULL,
	[drec_TS_Tunel] [real] NULL,
	[drec_TM_Tunel] [real] NULL,
	[drec_TI_Tunel] [real] NULL,
	[drec_codper] [char](3) NULL,
	[drec_hora] [varchar](10) NULL,
	[drec_FecHomo] [varchar](10) NULL,
	[drec_HorHomo] [varchar](10) NULL,
	[drec_AutHomo] [nvarchar](4) NULL,
	[drec_estado] [varchar](50) NULL,
	[drec_etiqueta] [varchar](20) NULL,
	[drec_valor] [real] NULL,
	[drec_moncodi] [nvarchar](2) NULL,
	[drec_medcodi] [nvarchar](3) NULL,
	[drec_proceso] [nvarchar](50) NULL,
	[drec_palletCC] [nvarchar](9) NULL,
	[frec_codi] [nvarchar](7) NULL,
	[drec_desc] [nvarchar](50) NULL,
	[frec_codi1] [nvarchar](7) NULL,
	[drec_arriendo] [varchar](1) NULL,
	[drec_rev] [int] NULL CONSTRAINT [DF_detarece_drec_rev]  DEFAULT ((0)),
	[Estpallet] [nchar](5) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_detarece] PRIMARY KEY CLUSTERED 
(
	[drec_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[Detarecebasura](
	[drec_unica] [uniqueidentifier] NOT NULL,
	[drec_codi] [nvarchar](9) NULL,
	[drec_codcaja] [nvarchar](50) NULL,
	[drec_codpro] [nvarchar](7) NULL,
	[drec_origen] [nvarchar](2) NULL,
	[drec_codsopo] [nvarchar](2) NULL,
	[drec_sopocli] [nvarchar](11) NULL,
	[drec_unidades] [int] NULL,
	[drec_peso] [float] NULL,
	[drec_fecrec] [nvarchar](10) NULL,
	[drec_rutcli] [nvarchar](9) NULL,
	[drec_rutproductor] [varchar](12) NULL,
	[drec_contcli] [nvarchar](7) NULL,
	[drec_fecprod] [nvarchar](10) NULL,
	[drec_camara] [nvarchar](2) NULL,
	[drec_banda] [nvarchar](2) NULL,
	[drec_colum] [nvarchar](2) NULL,
	[drec_piso] [nvarchar](2) NULL,
	[drec_nivel] [nvarchar](1) NULL,
	[drec_almacen] [tinyint] NULL,
	[drec_dcaja] [tinyint] NULL,
	[drec_tunel] [tinyint] NULL,
	[drec_codvig] [nvarchar](1) NULL,
	[drec_pallet] [tinyint] NULL,
	[drec_codrel] [nvarchar](7) NULL,
	[drec_nrosopo] [int] NULL,
	[drec_slot] [nvarchar](3) NULL,
	[drec_dtgracia] [nvarchar](3) NULL,
	[drec_codsag] [nvarchar](10) NULL,
	[drec_tipo] [int] NULL,
	[FechaVencimiento] [char](10) NULL,
	[LoteCliente] [char](10) NULL,
	[drec_TS] [real] NULL,
	[drec_TM] [real] NULL,
	[drec_TI] [real] NULL,
	[drec_RecepTunel] [int] NULL,
	[drec_ProcTunel] [int] NULL,
	[drec_TS_Tunel] [real] NULL,
	[drec_TM_Tunel] [real] NULL,
	[drec_TI_Tunel] [real] NULL,
	[drec_codper] [char](3) NULL,
	[drec_hora] [varchar](10) NULL,
	[drec_FecHomo] [varchar](10) NULL,
	[drec_HorHomo] [varchar](10) NULL,
	[drec_AutHomo] [int] NULL,
	[drec_estado] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[DetaReceCajas](
	[caj_Pcod] [varchar](9) NOT NULL,
	[caj_cod] [nvarchar](200) NOT NULL,
	[caj_codenca] [varchar](3) NULL,
	[caj_Est] [numeric](1, 0) NULL,
	[caj_TipError] [nvarchar](1) NULL,
	[caj_ped] [int] NULL CONSTRAINT [DF_DetaReceCajas_caj_ped]  DEFAULT ((0)),
	[caj_fecha] [datetime] NULL CONSTRAINT [DF_DetaReceCajas_Caj_fecha]  DEFAULT (getdate()),
	[caj_Calidad] [varchar](30) NULL,
	[caj_Calibre] [varchar](50) NULL,
	[caj_felab] [date] NULL,
	[caj_fvenc] [date] NULL,
	[caj_unid] [int] NULL,
	[caj_Kg] [float] NULL,
	[caj_libras] [varchar](20) NULL,
	[caj_producto] [varchar](100) NULL,
	[caj_Id] [varchar](20) NULL,
	[caj_lote] [varchar](20) NULL,
	[caj_maquilador] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[DetareceCajas11](
	[drec_unica] [uniqueidentifier] NULL,
	[drec_codi] [nvarchar](12) NULL,
	[drec_codcaja] [nvarchar](50) NULL,
	[drec_codpro] [nvarchar](10) NULL,
	[drec_origen] [nvarchar](2) NULL,
	[drec_codsopo] [nvarchar](2) NULL,
	[drec_sopocli] [nvarchar](10) NULL,
	[drec_unidades] [int] NULL,
	[drec_peso] [float] NULL,
	[drec_fecrec] [nvarchar](10) NULL,
	[drec_rutcli] [nvarchar](9) NULL,
	[drec_rutproductor] [varchar](12) NULL,
	[drec_contcli] [nvarchar](7) NULL,
	[drec_fecprod] [nvarchar](10) NULL,
	[drec_camara] [nvarchar](2) NULL,
	[drec_banda] [nvarchar](2) NULL,
	[drec_colum] [nvarchar](2) NULL,
	[drec_piso] [nvarchar](2) NULL,
	[drec_nivel] [nvarchar](1) NULL,
	[drec_almacen] [tinyint] NULL,
	[drec_dcaja] [tinyint] NULL,
	[drec_tunel] [tinyint] NULL,
	[drec_codvig] [nvarchar](1) NULL CONSTRAINT [DF_DetareceCajas_drec_codvig]  DEFAULT ('0'),
	[drec_pallet] [tinyint] NULL,
	[drec_codrel] [nvarchar](7) NULL,
	[drec_nrosopo] [int] NULL,
	[drec_slot] [nvarchar](3) NULL,
	[drec_dtgracia] [nvarchar](3) NULL,
	[drec_codsag] [nvarchar](10) NULL,
	[drec_tipo] [int] NULL,
	[FechaVencimiento] [char](10) NULL,
	[LoteCliente] [char](10) NULL,
	[drec_TS] [real] NULL,
	[drec_TM] [real] NULL,
	[drec_TI] [real] NULL,
	[drec_RecepTunel] [int] NULL,
	[drec_ProcTunel] [int] NULL,
	[drec_TS_Tunel] [real] NULL,
	[drec_TM_Tunel] [real] NULL,
	[drec_TI_Tunel] [real] NULL,
	[drec_codper] [char](3) NULL,
	[drec_hora] [varchar](10) NULL,
	[drec_FecHomo] [varchar](10) NULL,
	[drec_HorHomo] [varchar](10) NULL,
	[drec_AutHomo] [int] NULL,
	[drec_estado] [varchar](50) NULL,
	[Batch] [nvarchar](50) NULL,
	[Caja] [nvarchar](50) NULL,
	[Producto] [nvarchar](50) NULL,
	[FechaDespacho] [nvarchar](10) NULL,
	[HoraDespacho] [nvarchar](5) NULL,
	[drec_CajaCliente] [nvarchar](50) NULL,
	[drec_fechahora] [nvarchar](19) NULL,
	[TRACK_CODI] [nvarchar](12) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[DetarececajasHistorial](
	[Caj_Pcod] [varchar](9) NOT NULL,
	[Caj_cod] [nvarchar](200) NOT NULL,
	[caj_codenca] [varchar](3) NULL,
	[Caj_Est] [numeric](1, 0) NULL,
	[Caj_TipError] [nvarchar](1) NULL,
	[caj_ped] [int] NULL CONSTRAINT [DF_DetarececajasHistorial_caj_ped]  DEFAULT ((0)),
	[Caj_fecha] [datetime] NULL CONSTRAINT [DF_DetarececajasHistorial_Caj_fecha]  DEFAULT (getdate()),
	[Caj_Calidad] [varchar](30) NULL,
	[Caj_Calibre] [varchar](50) NULL,
	[Caj_felab] [date] NULL,
	[Caj_fvenc] [date] NULL,
	[Caj_unid] [int] NULL,
	[Caj_Kg] [float] NULL,
	[Caj_libras] [varchar](20) NULL,
	[Caj_producto] [varchar](100) NULL,
	[Caj_Id] [varchar](20) NULL,
	[caj_lote] [varchar](20) NULL,
	[caj_maquilador] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[detarececajasrespaldo](
	[caj_Pcod] [varchar](9) NOT NULL,
	[caj_cod] [nvarchar](200) NOT NULL,
	[caj_codenca] [varchar](3) NULL,
	[caj_Est] [numeric](1, 0) NULL,
	[caj_TipError] [nvarchar](1) NULL,
	[caj_ped] [int] NULL,
	[caj_fecha] [datetime] NULL,
	[caj_Calidad] [varchar](30) NULL,
	[caj_Calibre] [varchar](50) NULL,
	[caj_felab] [date] NULL,
	[caj_fvenc] [date] NULL,
	[caj_unid] [int] NULL,
	[caj_Kg] [float] NULL,
	[caj_libras] [varchar](20) NULL,
	[caj_producto] [varchar](100) NULL,
	[caj_Id] [varchar](20) NULL,
	[caj_lote] [varchar](20) NULL,
	[caj_maquilador] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[detareceestado](
	[rtraq_codi] [varchar](7) NOT NULL,
	[rtraq_est] [numeric](18, 0) NULL,
	[rtraq_largo] [numeric](18, 0) NULL,
	[rtraq_l2] [numeric](18, 0) NULL,
	[rtraq_l3] [numeric](18, 0) NULL,
	[rtraq_l4] [numeric](18, 0) NULL,
	[rtraq_l5] [numeric](18, 0) NULL,
 CONSTRAINT [PK_detareceestado] PRIMARY KEY CLUSTERED 
(
	[rtraq_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Detaservicios](
	[RECEPCION] [nchar](10) NULL,
	[PALLET] [nchar](10) NULL,
	[FILM] [nchar](2) NULL,
	[REPA] [nchar](2) NULL,
	[RETIRO] [nchar](2) NULL,
	[ETIQUETADO] [nchar](2) NULL,
	[CARGAAPISO] [nchar](2) NULL,
	[DESCARGA] [nchar](2) NULL,
	[OBS] [nvarchar](350) NULL,
	[EST_FIN] [nchar](2) NULL,
	[RESPONSABLE] [nvarchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detatunel](
	[dtun_codiPallet] [nvarchar](9) NULL,
	[dtun_fecTunel] [char](10) NULL,
	[dtun_ProcTunel] [char](10) NULL,
	[dtun_TS] [real] NULL,
	[dtun_TM] [real] NULL,
	[dtun_TI] [real] NULL,
	[dtun_CodPer] [varchar](3) NULL,
	[dtun_Fecha] [datetime] NULL,
	[dtun_hora] [varchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[detcaja](
	[detc_unica] [uniqueidentifier] NOT NULL,
	[detc_codi] [nvarchar](12) NULL,
	[detc_peso] [float] NULL,
	[detc_ncaja] [smallint] NULL,
	[detc_pieza] [smallint] NULL,
	[detc_fecprod] [nvarchar](10) NULL,
	[detc_codprod] [nvarchar](7) NULL,
	[detc_estado] [tinyint] NULL,
	[detc_salida] [tinyint] NULL,
	[detc_track] [tinyint] NULL,
	[detc_pfolio] [nvarchar](9) NULL,
	[detc_codvig] [tinyint] NULL,
 CONSTRAINT [PK_detcaja] PRIMARY KEY NONCLUSTERED 
(
	[detc_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[DetCajas](
	[detc_pallet] [nvarchar](12) NULL,
	[detc_fprod] [nvarchar](10) NULL,
	[detc_fvenc] [nvarchar](10) NULL,
	[detc_cantidad] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[detslot](
	[dets_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_detslot_dets_unica]  DEFAULT (newid()),
	[dets_codi] [nvarchar](11) NULL,
	[dets_codpro] [nvarchar](7) NULL,
	[dets_caslot] [nvarchar](5) NULL,
	[dets_niveles] [int] NULL,
	[dets_altura] [int] NULL,
	[dets_envniv] [int] NULL,
	[dets_altenv] [int] NULL,
	[dets_unidades] [int] NULL,
	[dets_peso] [float] NULL,
	[dets_fecprod] [nvarchar](10) NULL,
	[dets_tunel] [tinyint] NULL,
	[dets_codvig] [tinyint] NULL,
 CONSTRAINT [PK_detslot] PRIMARY KEY NONCLUSTERED 
(
	[dets_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[documento](
	[doc_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_documento_doc_unica]  DEFAULT (newid()),
	[doc_codi] [nvarchar](2) NULL,
	[doc_descr] [nvarchar](30) NULL,
 CONSTRAINT [PK_documento] PRIMARY KEY NONCLUSTERED 
(
	[doc_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[DocumentosEnviados](
	[Denv_codi] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[Denv_seccion] [varchar](50) NULL,
	[Denv_fecha] [date] NULL,
	[Denv_hora] [nchar](10) NULL,
	[Denv_Dcto] [varchar](80) NULL,
 CONSTRAINT [PK_DocumentosEnviados] PRIMARY KEY CLUSTERED 
(
	[Denv_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[EQUIPOS](
	[host] [nvarchar](50) NULL,
	[puerto] [nvarchar](3) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[escala](
	[esc_contr] [varchar](7) NOT NULL,
	[esc_servi] [varchar](3) NOT NULL,
	[esc_tramos] [int] NULL,
	[esc_dtramo1] [int] NULL,
	[esc_htramo1] [int] NULL,
	[esc_valor1] [float] NULL,
	[esc_dtramo2] [int] NULL,
	[esc_htramo2] [int] NULL,
	[esc_valor2] [float] NULL,
	[esc_dtramo3] [int] NULL,
	[esc_htramo3] [int] NULL,
	[esc_valor3] [float] NULL,
	[esc_dtramo4] [int] NULL,
	[esc_htramo4] [int] NULL,
	[esc_valor4] [float] NULL,
	[esc_dtramo5] [int] NULL,
	[esc_htramo5] [int] NULL,
	[esc_valor5] [float] NULL,
	[esc_dtramo6] [int] NULL,
	[esc_htramo6] [int] NULL,
	[esc_valor6] [float] NULL,
	[esc_dtramo7] [int] NULL,
	[esc_htramo7] [int] NULL,
	[esc_valor7] [float] NULL,
	[esc_dtramo8] [int] NULL,
	[esc_htramo8] [int] NULL,
	[esc_valor8] [float] NULL,
	[esc_dtramo9] [int] NULL,
	[esc_htramo9] [int] NULL,
	[esc_valor9] [float] NULL,
	[esc_dtramo10] [int] NULL,
	[esc_htramo10] [int] NULL,
	[esc_valor10] [float] NULL,
 CONSTRAINT [PK_escala] PRIMARY KEY NONCLUSTERED 
(
	[esc_contr] ASC,
	[esc_servi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[escala_hist](
	[esc_unica] [uniqueidentifier] NULL,
	[esc_contr_hist] [nvarchar](7) NULL,
	[esc_servi_hist] [nvarchar](2) NULL,
	[esc_dtramo1_hist] [int] NULL,
	[esc_htramo1_hist] [int] NULL,
	[esc_valor1_hist] [real] NULL,
	[esc_dtramo2_hist] [int] NULL,
	[esc_htramo2_hist] [int] NULL,
	[esc_valor2_hist] [real] NULL,
	[esc_dtramo3_hist] [int] NULL,
	[esc_htramo3_hist] [int] NULL,
	[esc_valor3_hist] [real] NULL,
	[esc_dtramo4_hist] [int] NULL,
	[esc_htramo4_hist] [int] NULL,
	[esc_valor4_hist] [real] NULL,
	[esc_fecha_hist] [datetime] NULL,
	[esc_rutcli_hist] [nvarchar](9) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[escalaNueva](
	[escn_servi] [nvarchar](2) NULL,
	[escn_rutcli] [nvarchar](10) NULL,
	[escn_pallet] [int] NULL,
	[escn_tunel] [int] NULL,
	[escn_dtramo1] [int] NULL,
	[escn_htramo1] [int] NULL,
	[escn_valor1] [int] NULL,
	[escn_dtramo2] [int] NULL,
	[escn_htramo2] [int] NULL,
	[escn_valor2] [int] NULL,
	[escn_dtramo3] [int] NULL,
	[escn_htramo3] [int] NULL,
	[escn_valor3] [int] NULL,
	[escn_dtramo4] [int] NULL,
	[escn_htramo4] [int] NULL,
	[escn_valor4] [int] NULL
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[ESCALASERV](
	[ESCCOD] [int] NOT NULL,
	[ESCCONTR] [varchar](7) NOT NULL,
	[ESCSERV] [varchar](2) NOT NULL,
	[TOTTRAMAS] [int] NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[estado_cliente](
	[CODIGO_ESTADO] [int] IDENTITY(1,1) NOT NULL,
	[NOMBRE_ESTADO] [varchar](50) NOT NULL,
	[ESTADO_ESTADO] [varchar](15) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[CODIGO_ESTADO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[ESTADOGUIAS](
	[ESTCODIGO] [int] NOT NULL,
	[ESTNOMBRE] [varchar](20) NOT NULL,
	[ESTDESCRIP] [varchar](60) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ETIQUETA](
	[CODIGO] [nvarchar](450) NULL,
	[LARGO] [numeric](18, 0) NULL,
	[RUTCLIE] [nvarchar](9) NULL,
	[id] [uniqueidentifier] ROWGUIDCOL  NULL CONSTRAINT [DF_ETIQUETA_id]  DEFAULT (newid())
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[FacEscalas](
	[esc_contr] [nvarchar](7) NOT NULL,
	[esc_servi] [nvarchar](3) NOT NULL,
	[esc_ntramos] [numeric](18, 0) NULL,
	[esc_dtramo1] [float] NULL,
	[esc_htramo1] [float] NULL,
	[esc_valor1] [float] NULL,
	[esc_dtramo2] [float] NULL,
	[esc_htramo2] [float] NULL,
	[esc_valor2] [float] NULL,
	[esc_dtramo3] [float] NULL,
	[esc_htramo3] [float] NULL,
	[esc_valor3] [float] NULL,
	[esc_dtramo4] [float] NULL,
	[esc_htramo4] [float] NULL,
	[esc_valor4] [float] NULL,
	[esc_dtramo5] [float] NULL,
	[esc_htramo5] [float] NULL,
	[esc_valor5] [float] NULL,
	[esc_dtramo6] [float] NULL,
	[esc_htramo6] [float] NULL,
	[esc_valor6] [float] NULL,
	[esc_dtramo7] [float] NULL,
	[esc_htramo7] [float] NULL,
	[esc_valor7] [float] NULL,
	[esc_dtramo8] [float] NULL,
	[esc_htramo8] [float] NULL,
	[esc_valor8] [float] NULL,
	[esc_dtramo9] [float] NULL,
	[esc_htramo9] [float] NULL,
	[esc_valor9] [float] NULL,
	[esc_dtramo10] [float] NULL,
	[esc_htramo10] [float] NULL,
	[esc_valor10] [float] NULL,
 CONSTRAINT [PK_FacEscalas] PRIMARY KEY CLUSTERED 
(
	[esc_contr] ASC,
	[esc_servi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FacEstadoVas](
	[evas_codi] [numeric](18, 0) NOT NULL,
	[evas_desc] [varchar](10) NULL,
 CONSTRAINT [PK_Fac_EstadoVas] PRIMARY KEY CLUSTERED 
(
	[evas_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FacLugar](
	[Tdoc_codi] [numeric](18, 0) NOT NULL,
	[Tdoc_desc] [nvarchar](50) NULL,
 CONSTRAINT [PK_FacAdmFrigo] PRIMARY KEY CLUSTERED 
(
	[Tdoc_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[FacSeccion](
	[Sec_codi] [numeric](18, 0) NOT NULL,
	[Sec_Desc] [nvarchar](20) NOT NULL,
 CONSTRAINT [PK_FacSeccion] PRIMARY KEY CLUSTERED 
(
	[Sec_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FacServicios](
	[Serv_Cod] [varchar](3) NOT NULL,
	[Serv_Nom] [varchar](50) NULL,
	[Serv_MedPred] [varchar](3) NULL,
	[Serv_MonPred] [varchar](2) NULL,
	[Serv_descr] [varchar](max) NULL,
	[Serv_Incluir] [numeric](18, 0) NULL,
	[Serv_OrdR] [numeric](18, 0) NULL,
	[Serv_OrdD] [numeric](18, 0) NULL,
	[Serv_OrdE] [numeric](18, 0) NULL,
	[Serv_Esc] [numeric](18, 0) NULL,
	[Serv_Sec] [numeric](18, 0) NULL,
	[Serv_entsal] [numeric](18, 0) NULL CONSTRAINT [DF_FacServicios_Serv_entsal]  DEFAULT ((0)),
 CONSTRAINT [PK_FacServicios] PRIMARY KEY CLUSTERED 
(
	[Serv_Cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[FacTipoDcto](
	[TDOC_CODI] [numeric](18, 0) NOT NULL,
	[TDOC_DESC] [varchar](50) NULL,
 CONSTRAINT [PK_FacTipoDcto] PRIMARY KEY CLUSTERED 
(
	[TDOC_CODI] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[facturacion](
	[fac_unica] [uniqueidentifier] NOT NULL,
	[fac_fecha] [nvarchar](10) NULL,
	[fac_rutcli] [nvarchar](9) NULL,
	[fac_contr] [nvarchar](7) NULL,
	[fac_servi] [nvarchar](2) NULL,
	[fac_moneda] [nvarchar](2) NULL,
	[fac_unifac] [nvarchar](3) NULL,
	[fac_tarifa] [real] NULL,
	[fac_tarifamnac] [real] NULL,
	[fac_dolar] [real] NULL,
	[fac_uf] [real] NULL,
	[fac_unidad] [real] NULL,
	[fac_valorneto] [float] NULL,
	[fac_dfecha] [nvarchar](10) NULL,
 CONSTRAINT [PK_facturacion] PRIMARY KEY NONCLUSTERED 
(
	[fac_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[FACTURASWEB](
	[FACT_ID] [nvarchar](14) NULL,
	[FACT_NUMERO] [nvarchar](50) NULL,
	[FACT_RUTCLI] [nvarchar](10) NULL,
	[FACT_NOMARCHIVO] [nvarchar](255) NULL,
	[FACT_FECHA] [nvarchar](10) NULL,
	[FACT_GLOSA] [nvarchar](255) NULL,
	[FACT_TIPODOCUMENTO] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FacVas](
	[Vas_cod] [varchar](50) NOT NULL,
	[Vas_Clirut] [varchar](50) NULL,
	[Vas_Cont] [varchar](50) NULL,
	[Vas_Dcto] [varchar](50) NOT NULL,
	[Vas_fecha] [date] NOT NULL,
	[Vas_guia] [varchar](50) NOT NULL,
	[Vas_Estado] [numeric](18, 0) NOT NULL,
	[Vas_Seccion] [varchar](50) NOT NULL,
	[Vas_TipDoc] [numeric](18, 0) NOT NULL,
	[Vas_Obs] [nvarchar](150) NULL,
	[Vas_TipAsoc] [numeric](18, 0) NULL,
	[Vas_Emis] [datetime] NULL CONSTRAINT [DF_FacVas_Vas_Emis]  DEFAULT (getdate()),
	[Vas_usucod] [varchar](3) NULL,
 CONSTRAINT [PK_FacVas] PRIMARY KEY CLUSTERED 
(
	[Vas_cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[FacVasDeta](
	[Dvas_VasCod] [varchar](7) NOT NULL,
	[Dvas_ServCod] [varchar](50) NOT NULL,
	[Dvas_Est] [varchar](50) NULL,
	[Dvas_Unid] [float] NULL,
	[Dvas_Cajas] [numeric](18, 0) NULL,
	[Dvas_Kilos] [float] NULL,
	[Dvas_Cobrar] [numeric](18, 0) NULL,
	[Dvas_Obs] [varchar](100) NULL,
	[Dvas_ValUni] [numeric](18, 0) NULL,
	[Dvas_ValTot] [numeric](18, 0) NULL,
	[Dvas_entsal] [numeric](18, 0) NULL CONSTRAINT [DF_FacVasDeta_Dvas_entsal]  DEFAULT ((0)),
 CONSTRAINT [PK_FacVasDeta] PRIMARY KEY CLUSTERED 
(
	[Dvas_VasCod] ASC,
	[Dvas_ServCod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[famprod](
	[fam_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_famprod_fam_unica]  DEFAULT (newid()),
	[fam_codi] [nvarchar](7) NULL,
	[fam_descr] [nvarchar](40) NULL,
	[fam_correl] [float] NULL,
	[fam_imp] [float] NULL CONSTRAINT [DF_famprod_fam_imp]  DEFAULT (0),
	[fam_exp] [float] NULL CONSTRAINT [DF_famprod_fam_exp]  DEFAULT (0),
	[fam_nac] [float] NULL CONSTRAINT [DF_famprod_fam_nac]  DEFAULT (0),
	[FamiliaTunel1] [float] NULL,
	[FamiliaTunel2] [float] NULL,
	[FamiliaTunel3] [float] NULL,
	[FamiliaTunel4] [float] NULL,
 CONSTRAINT [PK_famprod] PRIMARY KEY NONCLUSTERED 
(
	[fam_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ficha_clientes](
	[CODIGO] [int] IDENTITY(1,1) NOT NULL,
	[RUBRO] [varchar](50) NULL,
	[PRODUCTOS] [varchar](100) NULL,
	[FUENTE] [varchar](100) NULL,
	[FECHA_CREACION] [varchar](100) NULL,
	[RUT] [varchar](12) NULL,
	[RAZON_SOCIAL] [varchar](100) NULL,
	[NOMBRE_CLIENTE] [varchar](100) NULL,
	[DIRECCION] [varchar](100) NULL,
	[FONO] [varchar](100) NULL,
	[PAGINA] [varchar](100) NULL,
	[MERCANTIL] [varchar](200) NULL,
	[NOMBRECONTACTO1] [varchar](100) NULL,
	[FONOCONTACTO1] [varchar](100) NULL,
	[EMAILCONTACTO1] [varchar](100) NULL,
	[CARGOCONTACTO1] [varchar](100) NULL,
	[MOVILCONTACTO1] [varchar](100) NULL,
	[NOMBRECONTACTO2] [varchar](100) NULL,
	[FONOCONTACTO2] [varchar](100) NULL,
	[EMAILCONTACTO2] [varchar](100) NULL,
	[CARGOCONTACTO2] [varchar](100) NULL,
	[MOVILCONTACTO2] [varchar](100) NULL,
	[NOMBRECONTACTO3] [varchar](100) NULL,
	[FONOCONTACTO3] [varchar](100) NULL,
	[EMAILCONTACTO3] [varchar](100) NULL,
	[CARGOCONTACTO3] [varchar](100) NULL,
	[MOVILCONTACTO3] [varchar](100) NULL,
	[NOMBRECONTACTO4] [varchar](100) NULL,
	[FONOCONTACTO4] [varchar](100) NULL,
	[EMAILCONTACTO4] [varchar](100) NULL,
	[CARGOCONTACTO4] [varchar](100) NULL,
	[MOVILCONTACTO4] [varchar](100) NULL,
	[FECHA_CATE_A] [varchar](10) NULL,
	[FECHA_CATE_B] [varchar](10) NULL,
	[FECHA_CATE_C] [varchar](10) NULL,
	[FECHA_CATE_D] [varchar](10) NULL,
	[FECHA_CATE_E] [varchar](10) NULL,
	[FECHA_CATE_F] [varchar](10) NULL,
	[FECHA_CATE_G] [varchar](10) NULL,
	[FECHA_CATE_H] [varchar](10) NULL,
	[FECHA_CATE_I] [varchar](10) NULL,
	[FECHA_CATE_J] [varchar](10) NULL,
	[CBOESTADO] [varchar](5) NULL,
	[CHKCONGELADO] [varchar](1) NULL,
	[CHKREFRIGERADO] [varchar](1) NULL,
	[CHKSECO] [varchar](1) NULL,
	[CHKPROCESO] [varchar](1) NULL,
	[CHKEXPORTACION] [varchar](1) NULL,
	[CHKIMPORTACION] [varchar](1) NULL,
	[CHKNACIONAL] [varchar](1) NULL,
	[COTIZACION] [varchar](50) NULL,
	[CATEGORIA_CLIENTE] [varchar](2) NULL,
	[COMENTARIOS] [varchar](1000) NULL,
	[NECESIDADES_CLIENTE] [varchar](1000) NULL,
	[USUARIO_INGRESO] [varchar](5) NULL,
	[FECHA_INGRESO] [varchar](12) NULL,
	[USUARIO_MODIFICO] [varchar](5) NULL,
	[FECHA_MODIFICACION] [varchar](12) NULL,
	[ESTADO] [varchar](15) NULL,
	[USUARIO_ELIMINACION] [varchar](5) NULL,
 CONSTRAINT [PK__ficha_cl__CC87E1270D5104F8] PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[ficha_clientes_categorias](
	[CODIGO_CATEGORIA] [int] IDENTITY(1,1) NOT NULL,
	[LETRA_CATEGORIA] [varchar](2) NULL,
	[DESCRIPCION_CATEGORIA] [varchar](100) NULL,
	[ESTADO_CATEGORIA] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[fichcont](
	[fcon_codi] [int] NULL,
	[fcon_cont] [nvarchar](50) NOT NULL,
	[fcon_rutcli] [varchar](9) NULL,
	[fcon_contcli] [varchar](7) NULL,
	[fcon_fec] [datetime] NULL,
	[fcon_enca] [varchar](3) NULL,
	[fcon_est] [int] NULL,
	[fcon_petiq] [numeric](18, 0) NULL,
	[fcon_petiqfec] [datetime] NULL,
	[fcon_prev] [int] NULL,
	[fcon_prevfec] [datetime] NULL,
	[fcon_prevdoc] [varchar](80) NULL,
 CONSTRAINT [PK_fichcont] PRIMARY KEY CLUSTERED 
(
	[fcon_cont] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[fichdespa](
	[fdes_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_fichdespa_fdes_unica]  DEFAULT (newid()),
	[fdes_codi] [nvarchar](7) NULL,
	[fdes_rutcli] [nvarchar](9) NULL,
	[fdes_horalleg] [varchar](15) NULL,
	[fdes_hora] [nvarchar](5) NULL,
	[fdes_fecha] [nvarchar](10) NULL,
	[fdes_codpred] [nvarchar](7) NULL,
	[fdes_totsopo] [int] NULL,
	[fdes_totunidad] [int] NULL,
	[fdes_totpeso] [float] NULL,
	[fdes_rutcond] [nvarchar](9) NULL,
	[fdes_patente] [nvarchar](10) NULL,
	[fdes_transporte] [nvarchar](50) NULL,
	[fdes_contenedor] [nvarchar](30) NULL,
	[fdes_carro] [nvarchar](30) NULL,
	[fdes_sello] [nvarchar](50) NULL,
	[fdes_horometro] [nvarchar](30) NULL,
	[fdes_observ] [nvarchar](200) NULL,
	[fdes_tipcarga] [nvarchar](1) NULL,
	[fdes_codienca] [nvarchar](3) NULL,
	[fdes_codvig] [nvarchar](1) NULL,
	[fdes_origen] [nvarchar](2) NULL,
	[fdes_arte] [nvarchar](7) NULL,
	[fdes_tipo] [int] NULL CONSTRAINT [DF_fichdespa_fdes_tipo]  DEFAULT ((0)),
	[fdes_GuiaCliente] [varchar](25) NULL CONSTRAINT [DF_fichdespa_fdes_GuiaCliente]  DEFAULT ((0)),
	[fdes_tempdespacho] [varchar](60) NULL,
	[fdes_ordenembarque] [nvarchar](15) NULL,
	[fdes_destino] [nvarchar](50) NULL,
	[fdes_clfol] [nvarchar](7) NULL,
	[fdes_enviada] [nvarchar](1) NULL,
	[fdes_emis] [datetime] NULL CONSTRAINT [DF_fichdespa_fdes_emis]  DEFAULT (getdate()),
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_fichdespa] PRIMARY KEY NONCLUSTERED 
(
	[fdes_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[Fichdespabasura](
	[fdes_unica] [uniqueidentifier] NOT NULL,
	[fdes_codi] [nvarchar](7) NULL,
	[fdes_rutcli] [nvarchar](9) NULL,
	[fdes_hora] [nvarchar](5) NULL,
	[fdes_fecha] [nvarchar](10) NULL,
	[fdes_codpred] [nvarchar](7) NULL,
	[fdes_totsopo] [int] NULL,
	[fdes_totunidad] [int] NULL,
	[fdes_totpeso] [float] NULL,
	[fdes_rutcond] [nvarchar](9) NULL,
	[fdes_patente] [nvarchar](10) NULL,
	[fdes_transporte] [nvarchar](30) NULL,
	[fdes_contenedor] [nvarchar](30) NULL,
	[fdes_carro] [nvarchar](30) NULL,
	[fdes_sello] [nvarchar](30) NULL,
	[fdes_horometro] [nvarchar](30) NULL,
	[fdes_observ] [nvarchar](50) NULL,
	[fdes_tipcarga] [nvarchar](1) NULL,
	[fdes_codienca] [nvarchar](3) NULL,
	[fdes_codvig] [nvarchar](1) NULL,
	[fdes_origen] [nvarchar](2) NULL,
	[fdes_arte] [nvarchar](7) NULL,
	[fdes_tipo] [int] NULL,
	[fdes_GuiaCliente] [varchar](25) NULL,
	[fdes_tempdespacho] [varchar](60) NULL,
	[fdes_ordenembarque] [nvarchar](15) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FICHETIQ](
	[ETIQ_CODI] [nvarchar](5) NOT NULL,
	[ETIQ_CLIRUT] [nvarchar](9) NULL,
	[ETIQ_CODCONT] [nvarchar](7) NULL,
	[ETIQ_FECHA] [date] NULL,
	[ETIQ_HORINI] [time](7) NULL,
	[ETIQ_CODENCA] [nvarchar](3) NULL,
	[ETIQ_EST] [nvarchar](1) NULL,
	[ETIQ_HORTER] [time](7) NULL,
	[ETIQ_TOTSOPO] [numeric](18, 0) NULL,
	[ETIQ_TOTUNIDAD] [numeric](18, 0) NULL,
	[ETIQ_TOTPESO] [float] NULL,
 CONSTRAINT [PK_FICHETIQ] PRIMARY KEY CLUSTERED 
(
	[ETIQ_CODI] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[fichfact](
	[fac_codi] [numeric](18, 0) NOT NULL,
	[fac_clirut] [varchar](9) NULL,
	[fac_contcli] [varchar](9) NULL,
	[fact_feci] [date] NULL,
	[fact_fect] [date] NULL,
	[fac_neto] [numeric](18, 0) NULL,
	[fac_iva] [numeric](18, 0) NULL,
	[fac_total] [numeric](18, 0) NULL,
	[fac_enca] [varchar](3) NULL,
 CONSTRAINT [PK_fichfact] PRIMARY KEY CLUSTERED 
(
	[fac_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FICHGRUPOS](
	[fgru_Codi] [nvarchar](5) NULL,
	[fgru_Descr] [nvarchar](50) NULL,
	[fgru_Meta] [numeric](18, 0) NULL,
	[fgru_Tarifa] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[FICHPNC](
	[fpnc_codigo] [nvarchar](10) NULL,
	[fpnc_fecha] [nvarchar](10) NULL,
	[fpnc_fechacierre] [nvarchar](10) NULL,
	[fpnc_rutcli] [nvarchar](10) NULL,
	[fpnc_persona] [nvarchar](50) NULL,
	[fpnc_supervisor] [nvarchar](50) NULL,
	[fpnc_producto] [nvarchar](50) NULL,
	[fpnc_cantidad] [nvarchar](10) NULL,
	[fpnc_lugar] [nvarchar](50) NULL,
	[fpnc_pallet] [nvarchar](9) NULL,
	[fpnc_observacion] [nvarchar](1000) NULL,
	[fpnc_accion] [nvarchar](1000) NULL,
	[fpnc_encargado] [nvarchar](1000) NULL,
	[fpnc_responsable] [nvarchar](50) NULL,
	[fpnc_EncAseg] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[fichpred](
	[fpre_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_fichpred_fpre_unica]  DEFAULT (newid()),
	[fpre_codi] [nvarchar](7) NULL,
	[fpre_rutcli] [nvarchar](9) NULL,
	[fpre_horades] [nvarchar](5) NULL,
	[fpre_horater] [nvarchar](5) NULL,
	[fpre_fecdes] [nvarchar](10) NULL,
	[fpre_totsopo] [int] NULL,
	[fpre_totunidad] [int] NULL,
	[fpre_totpeso] [float] NULL,
	[fpre_rutcond] [nvarchar](9) NULL,
	[fpre_codienca] [nvarchar](3) NULL,
	[fpre_activa] [nvarchar](1) NULL,
	[fpre_fechact] [nvarchar](10) NULL,
	[fpre_codvig] [nvarchar](1) NULL,
	[fpre_gdespa] [nvarchar](7) NULL,
	[fpre_radio] [nvarchar](1) NULL,
	[fpre_tipo] [int] NULL CONSTRAINT [DF_fichpred_fpre_tipo]  DEFAULT (0),
	[fpre_proceso] [int] NULL CONSTRAINT [DF_fichpred_fpre_proceso]  DEFAULT (0),
	[fpre_sello] [varchar](50) NULL,
	[fpre_tem] [real] NULL,
	[fpre_anden] [nvarchar](10) NULL,
	[FPRE_USUCRE] [nvarchar](6) NULL,
	[est_codi] [int] NULL,
	[fpre_contenedor] [nvarchar](50) NULL,
	[fpre_rampla] [nvarchar](15) NULL,
	[fpre_destino] [nvarchar](20) NULL,
	[fpre_Observacion] [varchar](255) NULL,
	[fpre_nped] [numeric](18, 0) NULL CONSTRAINT [DF_fichpred_fpre_nped]  DEFAULT ((0)),
	[fpre_etiq] [nvarchar](1) NULL,
	[estc_olor] [nchar](10) NULL,
	[estc_hig] [nchar](10) NULL,
	[estc_cond] [nchar](10) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_fichpred] PRIMARY KEY NONCLUSTERED 
(
	[fpre_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FICHPRED_TEMPERATURA](
	[FPRE_CODI] [nvarchar](7) NULL,
	[FPRE_TIPOTEMPERATURA] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[fichrece](
	[frec_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_fichrece_frec_unica]  DEFAULT (newid()),
	[frec_codi] [nvarchar](7) NULL,
	[frec_rutcli] [nvarchar](9) NULL,
	[frec_rutproductor] [varchar](12) NULL,
	[frec_contcli] [nvarchar](7) NULL,
	[frec_horalleg] [nvarchar](5) NULL,
	[frec_horarec] [nvarchar](5) NULL,
	[frec_horater] [nvarchar](5) NULL,
	[frec_turnrec] [nvarchar](1) NULL,
	[frec_fecproc] [nvarchar](10) NULL,
	[frec_fecrec] [nvarchar](10) NULL,
	[frec_fecter] [nvarchar](10) NULL,
	[frec_guiades] [nvarchar](8) NULL,
	[frec_tipentr] [nvarchar](2) NULL,
	[frec_totsopo] [int] NULL,
	[frec_totunidad] [int] NULL,
	[frec_totpeso] [float] NULL,
	[frec_temppro] [real] NULL,
	[frec_rutcond] [nvarchar](9) NULL,
	[frec_observ] [nvarchar](320) NULL,
	[frec_tipdesc] [nvarchar](1) NULL,
	[frec_codienca] [nvarchar](3) NULL,
	[frec_origen] [nvarchar](2) NULL,
	[frec_codvig] [nvarchar](1) NULL,
	[frec_radio] [nvarchar](1) NULL,
	[frec_tipo] [int] NULL CONSTRAINT [DF_fichrece_frec_tipo]  DEFAULT ((0)),
	[frec_RecepTunel] [int] NULL,
	[frec_AspectoSanitario] [nvarchar](15) NULL,
	[frec_CondGeneral] [int] NULL,
	[frec_procedencia] [char](10) NULL,
	[frec_paso] [nvarchar](1) NULL,
	[frec_antecamara] [nvarchar](2) NULL,
	[frec_numSello] [nvarchar](25) NULL,
	[frec_termografo] [nvarchar](1) NULL,
	[frec_tiporecepcion] [nvarchar](1) NULL,
	[frec_observ2] [nvarchar](50) NULL,
	[frec_tipoalmacenamiento] [varchar](50) NULL,
	[frec_contenedor] [nvarchar](20) NULL,
	[frec_patente] [nvarchar](20) NULL,
	[frec_almac] [nvarchar](15) NULL,
	[frec_empresa] [nvarchar](50) NULL,
	[frec_olores] [nvarchar](2) NULL,
	[frec_higiene] [nvarchar](2) NULL,
	[frec_estiba] [nvarchar](2) NULL,
	[frec_daado] [nvarchar](2) NULL,
	[frec_TS] [real] NULL,
	[frec_TM] [real] NULL,
	[frec_TI] [real] NULL,
	[frec_clfol] [nvarchar](7) NULL,
	[frec_Enviada] [nvarchar](1) NULL,
	[frec_tablet] [int] NOT NULL CONSTRAINT [DF_fichrece_frec_tablet]  DEFAULT ((0)),
	[frec_traq] [nvarchar](1) NULL,
	[frec_emis] [datetime] NULL CONSTRAINT [DF_fichrece_frec_emis]  DEFAULT (getdate()),
	[frec_packinglist] [nvarchar](30) NULL,
	[frec_ntunel] [nvarchar](50) NULL,
	[frec_modificado] [nchar](10) NULL,
	[cod_bod] [nchar](10) NULL,
	[val_guia] [nchar](10) NULL,
	[uni_guia] [nchar](10) NULL,
	[kilos_guia] [nchar](10) NULL,
 CONSTRAINT [PK_fichrece] PRIMARY KEY NONCLUSTERED 
(
	[frec_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[FICHRECE_TEMPERATURA](
	[frec_codi] [nvarchar](7) NULL,
	[frec_tipotemperatura] [nvarchar](1) NULL,
	[frec_t1] [nvarchar](2) NULL,
	[frec_t2] [nvarchar](2) NULL,
	[frec_t3] [nvarchar](2) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Fichrecebasura](
	[frec_unica] [uniqueidentifier] NOT NULL,
	[frec_codi] [nvarchar](7) NULL,
	[frec_rutcli] [nvarchar](9) NULL,
	[frec_rutproductor] [varchar](12) NULL,
	[frec_contcli] [nvarchar](7) NULL,
	[frec_horalleg] [nvarchar](5) NULL,
	[frec_horarec] [nvarchar](5) NULL,
	[frec_horater] [nvarchar](5) NULL,
	[frec_turnrec] [nvarchar](1) NULL,
	[frec_fecproc] [nvarchar](10) NULL,
	[frec_fecrec] [nvarchar](10) NULL,
	[frec_fecter] [nvarchar](10) NULL,
	[frec_guiades] [nvarchar](8) NULL,
	[frec_tipentr] [nvarchar](2) NULL,
	[frec_totsopo] [int] NULL,
	[frec_totunidad] [int] NULL,
	[frec_totpeso] [float] NULL,
	[frec_temppro] [real] NULL,
	[frec_rutcond] [nvarchar](9) NULL,
	[frec_observ] [nvarchar](50) NULL,
	[frec_tipdesc] [nvarchar](1) NULL,
	[frec_codienca] [nvarchar](3) NULL,
	[frec_origen] [nvarchar](2) NULL,
	[frec_codvig] [nvarchar](1) NULL,
	[frec_radio] [nvarchar](1) NULL,
	[frec_tipo] [int] NULL,
	[frec_RecepTunel] [int] NULL,
	[frec_AspectoSanitario] [nvarchar](15) NULL,
	[frec_CondGeneral] [int] NULL,
	[frec_procedencia] [char](10) NULL,
	[frec_paso] [nvarchar](1) NULL,
	[frec_antecamara] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[fichtunel](
	[ftun_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_fichtunel_ftun_unica]  DEFAULT (newid()),
	[ftun_codi] [nvarchar](7) NULL,
	[ftun_rutcli] [nvarchar](9) NULL,
	[ftun_contcli] [nvarchar](7) NULL,
	[ftun_horalleg] [nvarchar](5) NULL,
	[ftun_horarec] [nvarchar](5) NULL,
	[ftun_horater] [nvarchar](5) NULL,
	[ftun_turnrec] [nvarchar](1) NULL,
	[ftun_fecproc] [nvarchar](10) NULL,
	[ftun_fecrec] [nvarchar](10) NULL,
	[ftun_guiades] [nvarchar](8) NULL,
	[ftun_tipentr] [nvarchar](2) NULL,
	[ftun_totsopo] [int] NULL,
	[ftun_totunidad] [int] NULL,
	[ftun_totpeso] [float] NULL,
	[ftun_ctotsopo] [int] NULL,
	[ftun_ctotunidad] [int] NULL,
	[ftun_ctotpeso] [float] NULL,
	[ftun_etotsopo] [int] NULL,
	[ftun_etotunidad] [int] NULL,
	[ftun_etotpeso] [float] NULL,
	[ftun_temppro] [real] NULL,
	[ftun_tempsal] [real] NULL,
	[ftun_rutcond] [nvarchar](9) NULL,
	[ftun_observ] [nvarchar](50) NULL,
	[ftun_tipdesc] [nvarchar](1) NULL,
	[ftun_codienca] [nvarchar](3) NULL,
	[ftun_codvig] [nvarchar](1) NULL,
 CONSTRAINT [PK_fichtunel] PRIMARY KEY NONCLUSTERED 
(
	[ftun_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[FICHTUNEL_TEMPERATURA](
	[ftun_codi] [nvarchar](7) NULL,
	[ftun_tipotemperatura] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[formato](
	[for_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_formato_for_unica]  DEFAULT (newid()),
	[for_codi] [nvarchar](5) NULL,
	[for_rutcli] [nvarchar](9) NULL,
	[for_cbarra] [nvarchar](51) NULL,
	[for_desde] [smallint] NULL,
	[for_nrodig] [smallint] NULL,
	[for_sopocli] [smallint] NULL,
	[for_sopnro] [smallint] NULL,
	[for_fecha] [smallint] NULL,
	[for_fecnro] [smallint] NULL,
	[for_unidad] [smallint] NULL,
	[for_uninro] [smallint] NULL,
	[for_peso] [smallint] NULL,
	[for_pesnro] [smallint] NULL,
 CONSTRAINT [PK_formato] PRIMARY KEY NONCLUSTERED 
(
	[for_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Formato128](
	[RUTCLI] [nvarchar](12) NULL,
	[LARGO] [numeric](18, 0) NULL,
	[CodEjemplo] [nvarchar](70) NULL,
	[BatchD] [numeric](18, 0) NULL,
	[BatchC] [numeric](18, 0) NULL,
	[CajaD] [numeric](18, 0) NULL,
	[CajaC] [numeric](18, 0) NULL,
	[ProdD] [numeric](18, 0) NULL,
	[ProdC] [numeric](18, 0) NULL,
	[UnidadD] [numeric](18, 0) NULL,
	[UnidadC] [numeric](18, 0) NULL,
	[KilosD] [numeric](18, 0) NULL,
	[KilosC] [numeric](18, 0) NULL,
	[GramosD] [numeric](18, 0) NULL,
	[GramosC] [numeric](18, 0) NULL,
	[KilosOPD] [numeric](18, 0) NULL,
	[KilosOPC] [numeric](18, 0) NULL,
	[GramosOPD] [numeric](18, 0) NULL,
	[GramosOPC] [numeric](18, 0) NULL,
	[FechaPD] [numeric](18, 0) NULL,
	[FechaPC] [numeric](18, 0) NULL,
	[FechaVD] [numeric](18, 0) NULL,
	[FechaVC] [numeric](18, 0) NULL,
	[Codigo] [nvarchar](10) NULL,
	[Descripcion] [nvarchar](50) NULL,
	[BuscarDatos] [nvarchar](100) NULL,
	[KilosCaja] [float] NULL,
	[KilosDecimales] [numeric](18, 0) NULL CONSTRAINT [DF_Formato128_KilosDecimales]  DEFAULT (0),
	[KilosOPDecimales] [numeric](18, 0) NULL CONSTRAINT [DF_Formato128_KilosOPDecimales]  DEFAULT (0)
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[FORMATOETIQUETA](
	[CODIGO] [nvarchar](4) NULL,
	[CLIENTE] [nvarchar](10) NULL,
	[CONTRATO] [nvarchar](7) NULL,
	[LARGOETIQUETA] [nvarchar](255) NULL,
	[CODIGOEJEMPLO] [nvarchar](255) NULL,
	[BATCHD] [nvarchar](10) NULL,
	[BATCHC] [nvarchar](10) NULL,
	[CAJAD] [nvarchar](10) NULL,
	[CAJAC] [nvarchar](10) NULL,
	[PRODUCTOD] [nvarchar](10) NULL,
	[PRODUCTOC] [nvarchar](10) NULL,
	[UNIDADD] [nvarchar](10) NULL,
	[UNIDADC] [nvarchar](10) NULL,
	[KILOSD] [nvarchar](10) NULL,
	[KILOSC] [nvarchar](10) NULL,
	[KILOSOPD] [nvarchar](10) NULL,
	[KILOSOPC] [nvarchar](10) NULL,
	[FECHAPD] [nvarchar](10) NULL,
	[FECHAPC] [nvarchar](10) NULL,
	[FECHAVD] [nvarchar](10) NULL,
	[FECHAVC] [nvarchar](10) NULL,
	[FECHAED] [nvarchar](10) NULL,
	[FECHAEC] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[habhora](
	[hor_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_habhora_hor_unica]  DEFAULT (newid()),
	[hor_rutcli] [nvarchar](9) NULL,
	[hor_cont] [nvarchar](7) NULL,
	[hor_nrodoc] [nvarchar](7) NULL,
	[hor_fecha] [nvarchar](10) NULL,
	[hor_horas] [int] NULL,
	[hor_autoriza] [nvarchar](40) NULL,
	[hor_patente] [nvarchar](10) NULL,
	[hor_cfecha] [nvarchar](10) NULL,
 CONSTRAINT [PK_habhora] PRIMARY KEY NONCLUSTERED 
(
	[hor_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[HistoricoFactura](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Cliente] [char](9) NULL,
	[Contrato] [char](9) NULL,
	[Item] [char](10) NULL,
	[FechaInicio] [smalldatetime] NULL,
	[FechaFin] [smalldatetime] NULL,
	[Moneda] [char](10) NULL,
	[ValorDolar] [float] NOT NULL,
	[ValorUF] [float] NULL,
	[Medida] [char](10) NULL,
	[PrecioUnitario] [float] NULL,
	[Cantidad] [float] NULL,
	[Total] [float] NULL,
	[Vigencia] [bit] NULL,
	[Fecha] [smalldatetime] NULL,
 CONSTRAINT [PK_HistoricoFactura] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ID_Servicio](
	[ID_codi] [decimal](18, 0) NULL,
	[ID_Contra_Hist] [decimal](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[INF_CALIDAD](
	[calidad_id] [nvarchar](20) NULL,
	[calidad_numero] [nvarchar](10) NULL,
	[calidad_RUTCLI] [nvarchar](10) NULL,
	[calidad_nomarchivo] [nvarchar](255) NULL,
	[calidad_fecha] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[INF_PNC](
	[pnc_id] [nvarchar](20) NULL,
	[pnc_numero] [nvarchar](10) NULL,
	[pnc_rutcli] [nvarchar](10) NULL,
	[pnc_nomarchivo] [nvarchar](255) NULL,
	[pnc_fecha] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[infocama](
	[inf_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_infocama_inf_unica]  DEFAULT (newid()),
	[inf_codi] [nvarchar](10) NULL,
	[inf_rack] [real] NULL,
	[inf_realf] [real] NULL,
	[inf_slot] [real] NULL,
	[inf_sinpos] [real] NULL,
 CONSTRAINT [PK_infocama] PRIMARY KEY NONCLUSTERED 
(
	[inf_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[informes](
	[inf_cod] [int] IDENTITY(1,1) NOT NULL,
	[inf_nom] [varchar](100) NOT NULL,
	[inf_emp] [varchar](12) NOT NULL,
	[inf_est] [varchar](15) NOT NULL,
	[inf_copia] [varchar](max) NULL,
 CONSTRAINT [PK__informes__D9F1ADBB693B9ABD] PRIMARY KEY CLUSTERED 
(
	[inf_cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[informes_programa](
	[inf_pro_cod] [int] IDENTITY(1,1) NOT NULL,
	[prg_rut_cli] [varchar](9) NOT NULL,
	[prg_inf_cod] [int] NOT NULL,
	[prg_emp] [varchar](1) NOT NULL,
	[prg_hora] [varchar](5) NULL,
	[prg_mail] [varchar](max) NULL,
	[prg_lunes] [varchar](12) NOT NULL,
	[prg_martes] [varchar](12) NOT NULL,
	[prg_miercoles] [varchar](12) NOT NULL,
	[prg_jueves] [varchar](12) NOT NULL,
	[prg_viernes] [varchar](12) NOT NULL,
	[prg_sabado] [varchar](12) NOT NULL,
	[prg_domingo] [varchar](12) NOT NULL,
	[prg_estado] [varchar](20) NOT NULL,
	[prg_min] [varchar](2) NULL,
 CONSTRAINT [PK__informes__1E6405AAEFDDC1EF] PRIMARY KEY CLUSTERED 
(
	[inf_pro_cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[informes_siniestro](
	[CODIGO_INFORME] [int] IDENTITY(1,1) NOT NULL,
	[FOLIO] [varchar](10) NULL,
	[RUT_CLIENTE] [varchar](20) NULL,
	[CODIGO_USUARIO] [varchar](5) NULL,
	[CLIENTE] [varchar](60) NULL,
	[FECHA_SINIESTRO] [varchar](20) NULL,
	[PERSONA_DETECTA] [varchar](100) NULL,
	[ENCARGADO_INFORME] [varchar](100) NULL,
	[LUGAR_DETECCION] [varchar](50) NULL,
	[PALLET_PRECISA] [varchar](20) NULL,
	[DESCRIPCION] [varchar](1000) NULL,
	[PALLET_CLIENTE] [varchar](20) NULL,
	[NOMBRE_PRODUCTO] [varchar](100) NULL,
	[UNIDADES] [varchar](9) NULL,
	[KILOS_UNIDAD] [varchar](9) NULL,
	[TOTAL_KILOS] [varchar](9) NULL,
	[FECHA_RECEPCION] [varchar](20) NULL,
	[GUIA_RECEPCION] [varchar](20) NULL,
	[UNIDADES_SINIESTRO] [varchar](9) NULL,
	[KILOS_UNIDAD_SINIESTRO] [varchar](9) NULL,
	[TOTAL_KILOS_SINIESTRO] [varchar](9) NULL,
	[UNIDADES_DETERIORO] [varchar](9) NULL,
	[KILOS_UNIDAD_DETERIORO] [varchar](9) NULL,
	[TOTAL_KILOS_DETERIORO] [varchar](9) NULL,
	[UNIDADES_INFECTADO] [varchar](9) NULL,
	[KILOS_UNIDAD_INFECTADO] [varchar](9) NULL,
	[TOTAL_KILOS_INFECTADO] [varchar](9) NULL,
	[IMAGEN1] [varchar](500) NULL,
	[IMAGEN2] [varchar](500) NULL,
	[IMAGEN3] [varchar](500) NULL,
	[IMAGEN4] [varchar](500) NULL,
	[IMAGEN5] [varchar](500) NULL,
	[IMAGEN6] [varchar](500) NULL,
	[ACCION_CORRECTIVA_1] [varchar](100) NULL,
	[ACCION_CORRECTIVA_2] [varchar](100) NULL,
	[ACCION_CORRECTIVA_3] [varchar](100) NULL,
	[ACCION_CORRECTIVA_4] [varchar](100) NULL,
	[ACCION_CORRECTIVA_5] [varchar](100) NULL,
	[ACCION_CORRECTIVA_6] [varchar](100) NULL,
	[USUARIO_MODIFICO] [varchar](5) NULL,
	[FECHA_MODIFICACION] [varchar](12) NULL,
	[FECHA_INGRESO] [varchar](12) NULL,
	[ESTADO] [varchar](15) NULL,
	[USUARIO_CAMBIO_ESTADO] [varchar](5) NULL,
 CONSTRAINT [PK__informes__BB24868BE16C3473] PRIMARY KEY CLUSTERED 
(
	[CODIGO_INFORME] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[ipc](
	[ipc_unica] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_ipc_ipc_unica]  DEFAULT (newid()),
	[ipc_fecha] [nvarchar](10) NULL,
	[ipc_valor] [real] NULL,
 CONSTRAINT [PK_ipc] PRIMARY KEY NONCLUSTERED 
(
	[ipc_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[juanjabre](
	[cola] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[cola] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[llamados_diarios](
	[CODIGO_LLAMADAS] [int] IDENTITY(1,1) NOT NULL,
	[FECHA] [date] NULL,
	[CODIGO_FICHA] [int] NULL,
	[CONTACTO] [varchar](100) NULL,
	[CARGO] [varchar](100) NULL,
	[TELEFONO] [varchar](15) NULL,
	[OBSERVACION] [varchar](300) NULL,
	[USUARIO_INGRESO] [varchar](5) NULL,
	[FECHA_INGRESO] [varchar](12) NULL,
	[USUARIO_MODIFICO] [varchar](5) NULL,
	[FECHA_MODIFICACION] [varchar](12) NULL,
	[ESTADO] [varchar](15) NULL,
 CONSTRAINT [PK_llamados_diarios] PRIMARY KEY CLUSTERED 
(
	[CODIGO_LLAMADAS] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_BLOQ_WEB](
	[LT_CLI] [nvarchar](20) NULL,
	[LT_MOV] [nvarchar](15) NULL,
	[LT_FECHA] [date] NULL,
	[LT_HORA] [time](5) NULL,
	[LT_USUARIO] [nvarchar](20) NULL,
	[LT_PC] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_BLOQUEOPALLETS](
	[LBP_ID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_LOG_BLOQUEOPALLETS_LFR_ID]  DEFAULT (newid()),
	[LBP_CODI] [varchar](50) NULL,
	[LBP_FECHA] [date] NULL,
	[LBP_HORA] [time](5) NULL,
	[LBP_USUARIO] [varchar](3) NULL,
	[LBP_PC] [varchar](50) NULL,
	[LBP_ESTADO] [numeric](18, 0) NULL,
 CONSTRAINT [PK_LOG_BLOQUEOPALLETS] PRIMARY KEY CLUSTERED 
(
	[LBP_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_CONTENEDORES](
	[LCON_CONT] [varchar](50) NULL,
	[LCON_FECHA] [datetime] NULL,
	[LCON_USUCOD] [varchar](3) NULL,
	[LCON_TIPO] [nvarchar](10) NULL,
	[LCON_PC] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_FICHDESPA](
	[LFR_ID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_LOG_FICHDESPA_LFR_ID]  DEFAULT (newid()),
	[LFR_CODI] [nvarchar](7) NULL,
	[LFR_FECHA] [date] NULL,
	[LFR_HORA] [time](5) NULL,
	[LFR_USUARIO] [nvarchar](20) NULL,
	[LFR_PC] [nvarchar](50) NULL,
 CONSTRAINT [PK_LOG_FICHDESPA] PRIMARY KEY CLUSTERED 
(
	[LFR_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[LOG_FICHRECE](
	[LFR_ID] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_LOG_FICHRECE_LFR_ID]  DEFAULT (newid()),
	[LFR_CODI] [nvarchar](7) NULL,
	[LFR_FECHA] [date] NULL,
	[LFR_HORA] [time](5) NULL,
	[LFR_USUARIO] [nvarchar](20) NULL,
	[LFR_PC] [nvarchar](50) NULL,
 CONSTRAINT [PK_LOG_FICHRECE] PRIMARY KEY CLUSTERED 
(
	[LFR_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Log_Liberacion_Tunel](
	[Pallet] [nvarchar](9) NULL,
	[Cliente] [nvarchar](60) NULL,
	[fechaLib] [nvarchar](10) NULL,
	[HoraLib] [nvarchar](8) NULL,
	[fechaTra] [nvarchar](10) NULL,
	[HoraTra] [nvarchar](8) NULL,
	[COD_VIG] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[LOG_MAEPROD](
	[LMP_ID] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_LOG_MAEPROD_LMP_ID]  DEFAULT (newid()),
	[LMP_CODI] [nvarchar](7) NULL,
	[LMP_FECHA] [date] NULL,
	[LMP_HORA] [time](5) NULL,
	[LMP_USUARIO] [nvarchar](20) NULL,
	[LMP_PC] [nvarchar](50) NULL,
	[LMP_OPERACION] [nvarchar](50) NULL,
 CONSTRAINT [PK_LOG_MAEPROD] PRIMARY KEY CLUSTERED 
(
	[LMP_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[LOG_PALLET_BLOQUEADOS](
	[id] [nvarchar](50) NULL,
	[pallet] [nvarchar](50) NULL,
	[tipo] [nvarchar](50) NULL,
	[equipo] [nvarchar](50) NULL,
	[USUARIOEQUIPO] [nvarchar](50) NULL,
	[usuario] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[LOG_PALLETVENCIDOS](
	[RUT] [nvarchar](10) NULL,
	[FECHA] [nvarchar](10) NULL,
	[HORA] [nvarchar](8) NULL,
	[TIPO] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[LOG_PEDIDOSELIMINADOS](
	[LEM_ID] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_LOG_PEDIDOSELIMINADOS_LEM_ID]  DEFAULT (newid()),
	[LEM_CODI] [nvarchar](7) NULL,
	[LEM_FECHA] [date] NULL,
	[LEM_HORA] [time](7) NULL,
	[LEM_USU] [nvarchar](3) NULL,
	[LEM_PC] [nvarchar](50) NULL,
	[LEM_TIPO] [nvarchar](2) NULL,
 CONSTRAINT [PK_LOG_PEDIDOSELIMINADOS] PRIMARY KEY CLUSTERED 
(
	[LEM_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[LOG_RCP](
	[LRCP_ID] [uniqueidentifier] NOT NULL CONSTRAINT [DF_Table_1_LFR_ID]  DEFAULT (newid()),
	[LRCP_CODI] [nvarchar](7) NULL,
	[LRCP_FECHA] [date] NULL,
	[LRCP_HORA] [time](5) NULL,
	[LRCP_USUARIO] [nvarchar](20) NULL,
	[LRCP_PC] [nvarchar](50) NULL,
	[LRCP_CODSAG] [nvarchar](50) NULL,
 CONSTRAINT [PK_LOG_RCP] PRIMARY KEY CLUSTERED 
(
	[LRCP_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[log_recepcion](
	[log_id] [nvarchar](30) NOT NULL,
	[log_Nrecepcion] [nvarchar](7) NULL,
	[log_fecha_hora] [nvarchar](20) NULL,
	[log_usuario] [nvarchar](30) NULL,
	[log_tipo] [nvarchar](1) NULL,
	[log_usergestion] [nvarchar](3) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_RevisionPallets](
	[rev_codi] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_LOG_RevisionPallets_rev_codi]  DEFAULT (newid()),
	[rev_codpallet] [varchar](9) NULL,
	[rev_fecha] [datetime] NULL,
	[rev_codenca] [varchar](3) NULL,
	[rev_est] [int] NULL,
	[rev_tipo] [int] NULL,
 CONSTRAINT [PK_LOG_RevisionPallets] PRIMARY KEY CLUSTERED 
(
	[rev_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_SALTOCORR](
	[tmps_unica] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_LOG_SALTOCORR_tmps_unica]  DEFAULT (newid()),
	[tmps_codi] [nvarchar](10) NULL,
	[tmps_correl] [int] NULL,
	[tmps_usuario] [nvarchar](10) NULL,
	[tmps_personal] [smallint] NULL,
	[tmps_fecha] [datetime] NULL,
	[tmps_gestion] [varchar](50) NULL,
 CONSTRAINT [PK_LOG_SALTOCORR] PRIMARY KEY CLUSTERED 
(
	[tmps_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_VAS](
	[LVAS_ID] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_LOG_VAS_LVAS_ID]  DEFAULT (newid()),
	[LVAS_CODI] [nvarchar](7) NULL,
	[LVAS_FECHA] [date] NULL,
	[LVAS_HORA] [time](5) NULL,
	[LVAS_USUARIO] [nvarchar](20) NULL,
	[LVAS_PC] [nvarchar](50) NULL,
	[LVAS_OP] [varchar](50) NULL,
 CONSTRAINT [PK_LOG_VAS] PRIMARY KEY CLUSTERED 
(
	[LVAS_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[LOG_WEBUSUARIOS](
	[LWU_ID] [uniqueidentifier] NOT NULL,
	[LWU_CODI] [varchar](50) NULL,
	[LWU_FECHA] [date] NULL,
	[LWU_HORA] [time](7) NULL,
	[LWU_USUARIO] [varchar](10) NULL,
	[LWU_PC] [varchar](50) NULL,
	[LWU_IP] [varchar](50) NULL,
	[LWU_TABLA] [varchar](100) NULL,
	[LWU_ESTADO] [varchar](10) NULL,
 CONSTRAINT [PK_LOG_WEBUSUARIOS] PRIMARY KEY CLUSTERED 
(
	[LWU_ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Mae_Bodega](
	[Cod_Bodega] [nvarchar](50) NULL,
	[Des_Bodega] [nvarchar](max) NULL,
	[Tipo] [nvarchar](50) NULL,
	[Dir_Bodega] [nvarchar](max) NULL,
	[Rut_Bodega] [numeric](18, 0) NOT NULL,
	[Razon_Social] [nvarchar](max) NULL,
	[contacto] [nvarchar](50) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[maeprod](
	[mae_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_maeprod_mae_unica]  DEFAULT (newid()),
	[mae_codi] [nvarchar](7) NULL,
	[mae_descr] [nvarchar](50) NULL,
	[mae_tipenv] [nvarchar](5) NULL,
	[mae_clirut] [nvarchar](10) NULL,
	[mae_productor] [varchar](15) NULL,
	[mae_feccre] [nvarchar](10) NULL,
	[mae_alto] [float] NULL,
	[mae_ancho] [float] NULL,
	[mae_fondo] [float] NULL,
	[mae_base] [int] NULL,
	[mae_altura] [int] NULL,
	[mae_codcli] [nvarchar](15) NULL,
	[mae_codvig] [tinyint] NULL,
	[mae_codirel] [nvarchar](6) NULL,
	[mae_tipo] [int] NULL CONSTRAINT [DF_maeprod_mae_tipo]  DEFAULT ((0)),
	[mae_pt] [int] NULL CONSTRAINT [DF_maeprod_mae_pt]  DEFAULT ((0)),
	[mae_producto_tipo] [int] NULL CONSTRAINT [DF_maeprod_mae_producto_tipo]  DEFAULT ((0)),
	[mae_diasv] [int] NULL,
	[mae_estado] [nvarchar](1) NULL,
	[mae_valor] [real] NOT NULL CONSTRAINT [DF_maeprod_mae_valor]  DEFAULT ((0)),
	[mae_dun14] [nvarchar](60) NULL,
	[MAE_CODI2] [nvarchar](7) NULL,
	[mae_tipenvdesc] [nvarchar](30) NULL,
	[mae_clirutdesc] [nvarchar](30) NULL,
	[mae_pcaja] [nchar](10) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_maeprod] PRIMARY KEY NONCLUSTERED 
(
	[mae_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[maeprod_detalle](
	[id] [varchar](10) NULL,
	[codigo] [varchar](10) NULL,
	[numero] [varchar](10) NULL,
	[descripcion] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[MAEPROD_SOLICITUD](
	[IDAUTOMATICO] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[ID] [nvarchar](50) NULL,
	[FECHA] [nvarchar](10) NULL,
	[HORA] [nvarchar](8) NULL,
	[CLIENTE] [nvarchar](50) NULL,
	[FAMILIA] [nvarchar](3) NULL,
	[CODENVASE] [nvarchar](5) NULL,
	[ENVASE] [nvarchar](40) NULL,
	[CODPROD] [nvarchar](7) NULL,
	[PRODUCTO] [nvarchar](50) NULL,
	[CODCLIENTE] [nvarchar](20) NULL,
	[ALTO] [real] NULL,
	[ANCHO] [real] NULL,
	[FONDO] [real] NULL,
	[BASE] [real] NULL,
	[ALTURA] [real] NULL,
	[DUN14] [nvarchar](14) NULL,
	[ESTADO] [bit] NULL,
	[USUARIO] [nvarchar](3) NULL,
	[MAIL] [nvarchar](50) NULL,
	[MAIL1] [nvarchar](50) NULL,
	[BLOQUEO] [nvarchar](3) NULL,
	[FECHABLOQUEO] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[maerela](
	[mar_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_maerela_mar_unica]  DEFAULT (newid()),
	[mar_rutcli] [nvarchar](9) NULL,
	[mar_codigo] [nvarchar](51) NULL,
	[mar_maecod] [nvarchar](7) NULL,
 CONSTRAINT [PK_maerela] PRIMARY KEY NONCLUSTERED 
(
	[mar_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Mail_Ped_Local](
	[mpl_correos] [nvarchar](254) NULL,
	[mpl_vigencia] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[medidas](
	[med_codi] [varchar](3) NOT NULL,
	[med_descr] [nvarchar](30) NULL,
 CONSTRAINT [PK_medidas] PRIMARY KEY NONCLUSTERED 
(
	[med_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Medidas2](
	[med_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_Medidas2_med_unica]  DEFAULT (newid()),
	[med_codi] [nvarchar](3) NULL,
	[med_descr] [nvarchar](30) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Menu_Gestion](
	[NombreNodo] [nvarchar](50) NULL,
	[IdentificadorNodo] [int] NULL,
	[IdentificadorPadre] [int] NULL,
	[Estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[MenuFactura](
	[Menu1] [char](40) NULL,
	[Menu2] [char](40) NULL,
	[Menu3] [char](40) NULL,
	[Acceso1] [bit] NULL,
	[Acceso2] [bit] NULL,
	[Acceso3] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[MenuGestion](
	[Menu1] [char](40) NULL,
	[Menu2] [char](40) NULL,
	[Menu3] [char](40) NULL,
	[Menu4] [char](40) NULL,
	[Acceso1] [bit] NULL,
	[Acceso2] [bit] NULL,
	[Acceso3] [bit] NULL,
	[Acceso4] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Menus](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[Aplicacion] [char](10) NULL,
	[Personal] [char](3) NULL,
	[Menu1] [char](40) NULL,
	[Menu2] [char](40) NULL,
	[Menu3] [char](40) NULL,
	[Menu4] [char](40) NULL,
	[Acceso1] [bit] NULL,
	[Acceso2] [bit] NULL,
	[Acceso3] [bit] NULL,
	[Acceso4] [bit] NULL,
 CONSTRAINT [PK_Menus] PRIMARY KEY NONCLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[MENUS_gestion](
	[NOMBRE] [varchar](80) NULL,
	[FORMULARIO] [varchar](80) NULL,
	[PADRE] [varchar](80) NULL,
	[NUMERO] [int] NULL,
	[HOJA] [bit] NULL,
	[GRABAR] [bit] NULL,
	[PANTALLA] [bit] NULL,
	[ARCHIVO] [bit] NULL,
	[IMPRIMIR] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[MENUS_OPERACIONES](
	[NOMBRE] [varchar](80) NULL,
	[FORMULARIO] [varchar](80) NULL,
	[PADRE] [varchar](80) NULL,
	[NUMERO] [int] NULL,
	[HOJA] [bit] NULL,
	[GRABAR] [bit] NULL,
	[PANTALLA] [bit] NULL,
	[ARCHIVO] [bit] NULL,
	[IMPRIMIR] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[MENUS_OPERACIONES1](
	[NOMBRE] [varchar](80) NULL,
	[FORMULARIO] [varchar](80) NULL,
	[PADRE] [varchar](80) NULL,
	[NUMERO] [int] NULL,
	[HOJA] [bit] NULL,
	[GRABAR] [bit] NULL,
	[PANTALLA] [bit] NULL,
	[ARCHIVO] [bit] NULL,
	[IMPRIMIR] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[MENUS_PROCESOS](
	[NOMBRE] [varchar](80) NULL,
	[FORMULARIO] [varchar](80) NULL,
	[PADRE] [varchar](80) NULL,
	[NUMERO] [int] NULL,
	[HOJA] [bit] NULL,
	[GRABAR] [bit] NULL,
	[PANTALLA] [bit] NULL,
	[ARCHIVO] [bit] NULL,
	[IMPRIMIR] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[metas_tunel](
	[met_cod] [int] NOT NULL,
	[met_mes_num] [varchar](2) NULL,
	[met_mes] [varchar](12) NULL,
	[met_year] [varchar](4) NULL,
	[met_toneladas] [float] NULL,
 CONSTRAINT [PK_metas_tunel] PRIMARY KEY CLUSTERED 
(
	[met_cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[monedas](
	[mon_codi] [varchar](2) NOT NULL,
	[mon_descr] [varchar](50) NULL,
	[mon_valor] [real] NULL,
	[mon_fecval] [varchar](50) NULL,
	[mon_est] [int] NULL,
	[mon_sigla] [varchar](5) NULL,
 CONSTRAINT [PK_monedas_1] PRIMARY KEY CLUSTERED 
(
	[mon_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[monedas_hist](
	[Vmon_ID] [decimal](18, 0) NULL,
	[Vmon_Fec] [datetime] NULL,
	[Vmon_codUF] [decimal](18, 0) NULL,
	[Vmon_ValorUF] [float] NULL,
	[Vmon_CodDolar] [decimal](18, 0) NULL,
	[Vmon_ValorDolar] [float] NULL,
	[Vnom_CodPesos] [decimal](18, 0) NULL,
	[Vnom_ValorPesos] [float] NULL,
	[Vmon_GrupFec] [decimal](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[MONITOREO_TRAZABILIDAD](
	[LINEA] [nvarchar](3) NULL,
	[PALLET] [nvarchar](9) NULL,
	[POSRACK] [nvarchar](50) NULL,
	[POSTRAZ] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[movcajas](
	[movc_codi] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_movcajas_movc_codi]  DEFAULT (newid()),
	[movc_fecha] [datetime] NULL,
	[movc_codcaja] [varchar](200) NULL,
	[movc_codrece] [varchar](9) NULL,
	[movc_tipo] [varchar](3) NULL,
	[movc_ndoc] [numeric](18, 0) NULL,
 CONSTRAINT [PK_movcajas] PRIMARY KEY CLUSTERED 
(
	[movc_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[MOVIMIENTOCAMARAS](
	[MOVC_ID] [nvarchar](14) NULL,
	[MOVC_TIPO] [nvarchar](2) NULL,
	[MOVC_FOLIO] [nvarchar](9) NULL,
	[MOVC_FECHA] [nvarchar](10) NULL,
	[MOVC_HORA] [nvarchar](10) NULL,
	[MOVC_CA] [nvarchar](2) NULL,
	[MOVC_BA] [nvarchar](2) NULL,
	[MOVC_CO] [nvarchar](2) NULL,
	[MOVC_PI] [nvarchar](2) NULL,
	[MOVC_NI] [nvarchar](2) NULL,
	[MOVC_TS] [real] NULL,
	[MOVC_TM] [real] NULL,
	[MOVC_TI] [real] NULL,
	[MOVC_PESO] [float] NULL CONSTRAINT [DF_MOVIMIENTOCAMARAS_MOVC_PESO]  DEFAULT (0)
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[MovimientoCamion](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NumeroIngreso] [numeric](10, 0) NULL,
	[Chofer] [nvarchar](9) NOT NULL,
	[EmpresaTransporte] [nvarchar](50) NULL,
	[Patente] [char](10) NULL,
	[Cliente] [nvarchar](9) NULL,
	[Accion] [int] NULL,
	[Fecha1] [smalldatetime] NULL,
	[Hora1] [char](5) NULL,
	[Fecha2] [smalldatetime] NULL,
	[Hora2] [char](5) NULL,
	[Fecha3] [smalldatetime] NULL,
	[Hora3] [char](5) NULL,
	[Atiende] [nvarchar](9) NULL,
	[TipoMovimiento] [int] NOT NULL,
	[DocumentoEntrada] [char](10) NULL,
	[DocumentoSalida] [char](10) NULL,
	[Observacion] [char](75) NULL,
	[ruttransporte] [nvarchar](13) NULL,
	[RCP] [nvarchar](15) NULL,
	[DocumentoEntrada2] [nvarchar](10) NULL,
	[DocumentoEntrada3] [nvarchar](10) NULL,
	[DocumentoSalida2] [nvarchar](10) NULL,
	[DocumentoSalida3] [nvarchar](10) NULL,
	[Encargado] [nvarchar](5) NULL,
	[Patente2] [nvarchar](20) NULL,
	[Producto] [nvarchar](15) NULL,
	[TIPOCAMION] [nvarchar](15) NULL,
	[ANDEN] [nvarchar](10) NULL,
	[beepers] [nvarchar](2) NULL,
	[beepers_fh] [nvarchar](19) NULL,
 CONSTRAINT [PK_MovimientoCamion] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[movpallet](
	[mov_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_movpallet_mov_unica]  DEFAULT (newid()),
	[mov_folio] [nvarchar](9) NULL,
	[mov_codper] [nvarchar](3) NULL,
	[mov_ca] [nvarchar](2) NULL,
	[mov_ba] [nvarchar](3) NULL,
	[mov_co] [nvarchar](2) NULL,
	[mov_pi] [nvarchar](2) NULL,
	[mov_ni] [nvarchar](1) NULL,
	[mov_fecha] [nvarchar](10) NULL,
	[mov_tipo] [nvarchar](2) NULL,
	[mov_hora] [nvarchar](10) NULL,
	[mov_TS] [real] NULL,
	[mov_TM] [real] NULL,
	[mov_TI] [real] NULL,
	[mov_Doc] [nvarchar](10) NULL,
	[mov_RecepTunel] [int] NULL,
	[Mov_Despacho] [int] NULL,
	[Mov_Saldo] [int] NULL,
	[mov_docdespa] [nvarchar](9) NULL,
	[mov_chorut] [nvarchar](10) NULL,
	[mov_chonom] [nvarchar](50) NULL,
	[mov_chopat] [nvarchar](10) NULL,
	[mov_chotra] [nvarchar](50) NULL,
	[mov_anden] [nvarchar](10) NULL,
	[mov_unidped] [int] NULL CONSTRAINT [DF_movpallet_mov_unidped]  DEFAULT ((0)),
 CONSTRAINT [PK_movpallet] PRIMARY KEY NONCLUSTERED 
(
	[mov_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[NewInventario](
	[inv_pcod] [nvarchar](50) NULL,
	[inv_caj] [nvarchar](50) NOT NULL,
	[Cliente] [nvarchar](100) NULL,
	[fecha_reg] [datetime] NULL,
	[usr_reg] [nchar](10) NULL,
	[obs_com] [nvarchar](100) NULL,
 CONSTRAINT [PK_NewInventario] PRIMARY KEY CLUSTERED 
(
	[inv_caj] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[NewRack](
	[rack_ca] [varchar](2) NULL,
	[rack_ba] [varchar](2) NULL,
	[rack_co] [varchar](2) NULL,
	[rack_pi] [varchar](2) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[nomiper](
	[nper_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_nomiper_nper_unica]  DEFAULT (newid()),
	[nper_codi] [nvarchar](3) NULL,
	[nper_rut] [nvarchar](9) NULL,
	[nper_nomb] [nvarchar](40) NULL,
	[nper_cargo] [nvarchar](30) NULL,
	[nper_feccre] [nvarchar](10) NULL,
 CONSTRAINT [PK_nomiper] PRIMARY KEY NONCLUSTERED 
(
	[nper_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[NotificacionCliente](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Cliente] [char](10) NOT NULL,
	[Notificacion] [int] NOT NULL,
 CONSTRAINT [PK_NotificacionCliente] PRIMARY KEY NONCLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[numerdia](
	[num_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_numerdia_num_unica]  DEFAULT (newid()),
	[num_fecha] [nvarchar](10) NULL,
	[num_rutclie] [nvarchar](9) NULL,
	[num_contclie] [nvarchar](7) NULL,
	[num_totsopo] [int] NULL,
	[num_totunidad] [int] NULL,
	[num_totpeso] [real] NULL,
 CONSTRAINT [PK_numerdia] PRIMARY KEY NONCLUSTERED 
(
	[num_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[orden_trabajo](
	[idOT] [int] IDENTITY(1,1) NOT NULL,
	[fecha_hora] [datetime] NULL,
	[descripcion] [varchar](200) NULL,
	[solucionado] [bit] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[origen](
	[ori_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_origen_ori_unica]  DEFAULT (newid()),
	[ori_codi] [nvarchar](2) NULL,
	[ori_descr] [nvarchar](40) NULL,
 CONSTRAINT [PK_origen] PRIMARY KEY NONCLUSTERED 
(
	[ori_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[osaka](
	[CODIGO] [varchar](12) NOT NULL,
	[FECHA] [date] NULL,
	[HORA] [time](7) NULL,
	[TUNEL1_TEMPERATURA] [varchar](5) NULL,
	[TUNEL2_TEMPERATURA] [varchar](5) NULL,
	[ODAT_TEMP_CA1] [varchar](5) NULL,
	[ODAT_TEMP_CA2] [varchar](5) NULL,
	[ODAT_TEMP_CA3] [varchar](5) NULL,
	[ODAT_TEMP_CA4] [varchar](5) NULL,
	[ODAT_TEMP_CA5] [varchar](5) NULL,
	[ODAT_TEMP_CA6] [varchar](5) NULL,
	[ODAT_TEMP_PULM1] [varchar](5) NULL,
	[ODAT_TEMP_PULM2] [varchar](5) NULL,
	[TUNEL1_ESTADO] [varchar](5) NULL,
	[TUNEL2_ESTADO] [varchar](5) NULL,
	[SALA_SERVICIOS] [varchar](5) NULL,
 CONSTRAINT [PK__osaka__CC87E127E14E4A17] PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_Ciudades](
	[CiudadCodigo] [nvarchar](3) NOT NULL,
	[CiudadDescripcion] [nvarchar](70) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_Comunas](
	[CodInterno] [int] NULL,
	[Nombre] [varchar](255) NULL,
	[Padre] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_ConChecklist](
	[Con_codi] [numeric](18, 0) NOT NULL,
	[Con_desc] [nvarchar](50) NULL,
 CONSTRAINT [PK_P_ConChecklist] PRIMARY KEY CLUSTERED 
(
	[Con_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_DescripcionCamaras](
	[IdCamara] [nchar](10) NULL,
	[Camara] [nvarchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoCajasDaadas](
	[Id] [int] NULL,
	[Estado] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoContrato](
	[econt_codi] [numeric](18, 0) NOT NULL,
	[econt_desc] [varchar](50) NULL,
 CONSTRAINT [PK_P_EstadoContrato] PRIMARY KEY CLUSTERED 
(
	[econt_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoDocumento](
	[ED_CODI] [numeric](18, 0) NOT NULL,
	[ED_DESC] [nvarchar](50) NULL,
 CONSTRAINT [PK_P_EstadoDocumento] PRIMARY KEY CLUSTERED 
(
	[ED_CODI] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoFacturacion](
	[tfac_codi] [numeric](18, 0) NOT NULL,
	[tfac_desc] [varchar](50) NULL,
 CONSTRAINT [PK_P_EstadoFacturacion] PRIMARY KEY CLUSTERED 
(
	[tfac_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoIngreso](
	[eing_codi] [numeric](18, 0) NOT NULL,
	[eing_desc] [varchar](50) NULL,
 CONSTRAINT [PK_P_EstadoIngreso] PRIMARY KEY CLUSTERED 
(
	[eing_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoPallet](
	[IdEstadoPallet] [nvarchar](50) NULL,
	[EstadoPallet] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoProducto](
	[IdEstado] [int] NULL,
	[TipoEstado] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Estados](
	[EstadoId] [int] NULL,
	[EstadoNombre] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_EstadoUsuPed](
	[estped_glosa] [nvarchar](50) NULL,
	[estped_codi] [int] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Filtros](
	[IdFiltro] [nvarchar](2) NULL,
	[FiltroDescripcion] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Incluir](
	[Inc_codi] [numeric](18, 0) NOT NULL,
	[Inc_Descr] [nvarchar](20) NULL,
 CONSTRAINT [PK_P_Incluir] PRIMARY KEY CLUSTERED 
(
	[Inc_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfCargaDescarga](
	[Id] [int] NULL,
	[Tipo] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_InfCPendientesMov](
	[id] [varchar](1) NULL,
	[TipoMov] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_InfEstadoPedido](
	[Id] [int] NULL,
	[Estado] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfMovPallet](
	[Id] [int] NULL,
	[Datos] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfOrdenar](
	[id] [int] NULL,
	[Ordenar] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfPalletVencidos](
	[Id] [int] NULL,
	[Mostrar] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfPosicionCamaras](
	[Id] [int] NULL,
	[Mostrar] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfProductividad](
	[Id] [int] NULL,
	[Datos] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_InfTunel](
	[id] [int] NULL,
	[Tunel] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_MenuADMINISTRADOROPERACIONES](
	[NombreNodo] [nvarchar](50) NULL,
	[IdentificadorNodo] [int] NULL,
	[IdentificadorPadre] [int] NULL,
	[Estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_MenuOPERACION](
	[NombreNodo] [nvarchar](50) NULL,
	[IdentificadorNodo] [int] NULL,
	[IdentificadorPadre] [int] NULL,
	[Estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_MenuOPERACIONES](
	[NombreNodo] [nvarchar](50) NULL,
	[IdentificadorNodo] [int] NULL,
	[IdentificadorPadre] [int] NULL,
	[Estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_MenuSUPERVISOR](
	[NombreNodo] [nvarchar](50) NULL,
	[IdentificadorNodo] [int] NULL,
	[IdentificadorPadre] [int] NULL,
	[Estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_MovChecklist](
	[mov_codi] [numeric](18, 0) NOT NULL,
	[Mov_desc] [nvarchar](30) NULL,
 CONSTRAINT [PK_P_MovChecklist] PRIMARY KEY CLUSTERED 
(
	[mov_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_NotificacioneCliente](
	[RutCliente] [nvarchar](10) NOT NULL,
	[IdNotificacion1] [int] NOT NULL,
	[IdNotificacion2] [int] NOT NULL,
	[IdNotificacion3] [int] NOT NULL,
	[IdNotificacion4] [int] NOT NULL,
	[IdNotificacion5] [int] NOT NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_PalletHACCP](
	[id] [int] NULL,
	[descripcion] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_ProcTunel](
	[id] [nchar](10) NULL,
	[estado] [nchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_RadioFrecuencia](
	[Id] [int] NOT NULL,
	[RadioNombre] [nvarchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_ROLES](
	[IdRol] [int] NOT NULL,
	[NombreRol] [varchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_SeccionVas](
	[sec_codi] [numeric](18, 0) NOT NULL,
	[sec_descr] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Sensor](
	[IdSensor] [int] NULL,
	[Sensor] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoAlmacenamiento](
	[id] [int] NULL,
	[almacenamiento] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoCamaras](
	[IdTipoCamara] [nchar](10) NULL,
	[TipoCamara] [nvarchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoCargaDescarga](
	[tcar_codi] [numeric](18, 0) NULL,
	[tcar_descr] [nvarchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoClientes](
	[tcli_codi] [varchar](15) NOT NULL,
	[tcli_desc] [varchar](20) NULL,
	[tcli_traqueo] [numeric](18, 0) NULL,
 CONSTRAINT [PK_P_TipoClientes] PRIMARY KEY CLUSTERED 
(
	[tcli_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoDao](
	[IdDao] [nvarchar](50) NULL,
	[DescripcionDao] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoDescripcion](
	[IdTipoDescripcion] [nvarchar](50) NULL,
	[TipoDescripcion] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoEstiba](
	[IdEstiba] [nvarchar](50) NULL,
	[DescripcionEstiba] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoHigiene](
	[IdHigiene] [nvarchar](50) NULL,
	[DescripcionHigiene] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoLectura](
	[tlec_codi] [numeric](18, 0) NOT NULL,
	[tlec_desc] [varchar](50) NULL,
 CONSTRAINT [PK_P_TipoLectura] PRIMARY KEY CLUSTERED 
(
	[tlec_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoMenu](
	[Menu] [nvarchar](50) NULL,
	[TipoPerfil] [nvarchar](50) NULL,
	[Rol] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoMovCajas](
	[tmov_sigla] [varchar](2) NOT NULL,
	[tmov_desc] [varchar](50) NULL,
 CONSTRAINT [PK_OP_TipoMovCajas] PRIMARY KEY CLUSTERED 
(
	[tmov_sigla] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoMovTraza](
	[tmov_sigla] [varchar](2) NOT NULL,
	[tmov_desc] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoMovVas](
	[tmov_codi] [numeric](18, 0) NOT NULL,
	[tmov_desc] [varchar](20) NULL,
 CONSTRAINT [PK_Op_TipoMovVas] PRIMARY KEY CLUSTERED 
(
	[tmov_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoNumerales](
	[tnum_codi] [numeric](18, 0) NOT NULL,
	[tnum_desc] [varchar](20) NULL,
	[tnum_act] [numeric](18, 0) NULL,
 CONSTRAINT [PK_P_TipoNumerales] PRIMARY KEY CLUSTERED 
(
	[tnum_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoOlores](
	[IdOlor] [nvarchar](50) NULL,
	[DescripcionOlor] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoPerfil](
	[Id] [int] NULL,
	[TipoPerfil] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_TipoRecepcion](
	[IdRecepcion] [nvarchar](50) NULL,
	[DescripcionRecepcion] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoSeguros](
	[tseg_codi] [numeric](18, 0) NOT NULL,
	[tseg_desc] [varchar](50) NULL,
 CONSTRAINT [PK_P_TipoSeguros] PRIMARY KEY CLUSTERED 
(
	[tseg_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[P_TipoTunel](
	[IdTunel] [int] NULL,
	[Tunel] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Tunel](
	[IdTunel] [int] NULL,
	[Tunel] [nvarchar](3) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_turnos](
	[tur_codi] [numeric](18, 0) NOT NULL,
	[tur_desc] [nvarchar](10) NULL,
 CONSTRAINT [PK_P_turnos] PRIMARY KEY CLUSTERED 
(
	[tur_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Usuario](
	[UsuarioNumero] [nvarchar](50) NOT NULL,
	[UsuarioRut] [nvarchar](50) NOT NULL,
	[UsuarioNombre] [nvarchar](100) NOT NULL,
	[UsuarioModulo] [int] NOT NULL,
	[UsuarioClave] [nvarchar](50) NOT NULL,
	[UsuarioAlias] [nvarchar](50) NOT NULL,
	[IdRol] [int] NOT NULL,
	[UsuarioCargo] [nvarchar](50) NULL,
	[UsuarioRadio] [int] NULL,
	[UsuarioTipoRadio] [int] NULL,
	[UsuarioMenu] [nvarchar](50) NULL,
	[UsuarioTipoMenu] [nvarchar](50) NULL,
	[UsuarioTemperatura] [int] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[P_Vigencia](
	[IdVigencia] [int] NULL,
	[Nombre] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Packing_List](
	[Pack_rutcli] [nvarchar](50) NULL,
	[Pack_Numero] [nvarchar](50) NULL,
	[Pack_Fecha] [nvarchar](50) NULL,
	[Pack_CodPer] [nvarchar](50) NULL,
	[PacK_CodBarra] [nvarchar](50) NULL,
	[Pack_Batch] [nvarchar](50) NULL,
	[Pack_Caja] [nvarchar](50) NULL,
	[Pack_Prod] [nvarchar](15) NULL,
	[Pack_unidad] [numeric](18, 0) NULL,
	[Pack_kilos] [real] NULL,
	[Pack_kilosop] [real] NULL,
	[Pack_obs] [nvarchar](255) NULL,
	[Pack_FechaP] [nvarchar](10) NULL,
	[Pack_FechaV] [nvarchar](10) NULL,
	[Pack_Estado] [nvarchar](1) NULL,
	[pack_primar] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Packing_listCliente](
	[correlativo] [nvarchar](50) NULL,
	[rutcli] [nvarchar](12) NULL,
	[batch] [nvarchar](50) NULL,
	[codpro] [nvarchar](50) NULL,
	[caja] [nvarchar](50) NULL,
	[pieza] [nvarchar](50) NULL,
	[calidad] [nvarchar](50) NULL,
	[kilosop] [numeric](18, 0) NULL,
	[kilos] [numeric](18, 0) NULL,
	[fechadesp] [nvarchar](50) NULL,
	[packing] [nvarchar](50) NULL,
	[contenedor] [nvarchar](50) NULL,
	[cliente] [nvarchar](50) NULL,
	[orden] [nvarchar](50) NULL,
	[fechaelab] [nvarchar](50) NULL,
	[f10] [nvarchar](50) NULL,
	[NumCajaCliente] [nvarchar](15) NULL,
	[Propietario] [nvarchar](50) NULL,
	[LotePrimar] [nvarchar](15) NULL,
	[LoteCliente] [nvarchar](15) NULL,
	[TipoLote] [nvarchar](15) NULL,
	[Productor] [nvarchar](50) NULL,
	[CentroCultivo] [nvarchar](20) NULL,
	[Especie] [nvarchar](30) NULL,
	[ProductoDescr] [nvarchar](50) NULL,
	[Conservacion] [nvarchar](20) NULL,
	[CalibreINF] [nvarchar](10) NULL,
	[CalibreSUP] [nvarchar](10) NULL,
	[UMCal] [nvarchar](15) NULL,
	[EnvasePRIM] [nvarchar](20) NULL,
	[EnvaseSECU] [nvarchar](20) NULL,
	[UMPeso] [nvarchar](15) NULL,
	[FechaProduccion] [nvarchar](10) NULL,
	[Sello] [nvarchar](40) NULL,
	[GuiaDespacho] [nvarchar](15) NULL,
	[Destino] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Packing_pass](
	[pack_pass] [nvarchar](10) NULL,
	[pack_pass2] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Passwords](
	[porteria] [nvarchar](15) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[PasswordsTemperatura](
	[Usuario] [nvarchar](50) NULL,
	[Password] [char](10) NULL,
	[MAIL] [nvarchar](50) NULL,
	[NOMBRE] [nvarchar](50) NULL,
	[CODVIG] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[PCC2](
	[PCC2_ID] [nvarchar](9) NULL,
	[PCC2_RECEPCION] [nvarchar](7) NULL,
	[PCC2_TUNEL] [nvarchar](2) NULL,
	[PCC2_FECHA] [nvarchar](10) NULL,
	[PCC2_HORA] [nvarchar](30) NULL,
	[PCC2_SUPERVISOR] [nvarchar](50) NULL,
	[PCC2_EXTENCION] [nvarchar](1) NULL CONSTRAINT [DF_PCC2_PCC2_EXTENCION]  DEFAULT (0)
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[pedcaja](
	[pc_fecha] [date] NULL,
	[pc_hora] [time](7) NULL,
	[pc_estado] [int] NULL,
	[pc_codped] [numeric](18, 0) NULL,
	[pc_ncaja] [int] NULL,
	[pc_numpal] [nchar](9) NULL,
	[pc_tpoped] [int] NULL,
	[pc_saldo] [int] NULL,
	[pc_rutclie] [nchar](10) NULL,
	[pc_horaenvio] [time](7) NULL,
	[pc_kilos] [float] NULL CONSTRAINT [DF_pedcaja_pc_kilos]  DEFAULT ((0))
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Pedido_Est](
	[pallet] [varchar](9) NULL,
	[fecha_reg] [datetime] NULL,
	[pedido] [numeric](18, 0) NULL,
	[encargado] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[pedidoguias](
	[pguia_nguia] [nchar](8) NULL,
	[pguia_fecha] [date] NULL,
	[pguia_ncajas] [int] NULL CONSTRAINT [DF_pedidoguias_pguia_ncajas]  DEFAULT ((0)),
	[pguia_nsopo] [int] NULL CONSTRAINT [DF_pedidoguias_pguia_nsopo]  DEFAULT ((0)),
	[pguia_hora] [time](7) NULL,
	[pguia_rutclie] [nchar](9) NULL,
	[pguia_estado] [int] NULL CONSTRAINT [DF_pedidoguias_pguia_estado]  DEFAULT ((0)),
	[pguia_codped] [numeric](18, 0) NULL CONSTRAINT [DF_pedidoguias_pguia_codped]  DEFAULT ((0))
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Pedidos_detalle](
	[pedido] [varchar](25) NULL,
	[linea] [numeric](18, 0) NULL,
	[pallet] [varchar](9) NULL,
	[cajas] [numeric](18, 0) NULL,
	[kilos] [real] NULL,
	[posicion] [varchar](50) NULL,
	[est] [nvarchar](1) NULL,
	[parcial] [int] NULL CONSTRAINT [DF_Pedidos_detalle_parcial]  DEFAULT ((0)),
	[revisado] [int] NULL CONSTRAINT [DF_Pedidos_detalle_revisado]  DEFAULT ((0)),
	[cajas_siniestradas] [int] NULL,
	[cod_bod] [nchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[pedidos_enviados](
	[orden] [numeric](18, 0) NULL,
	[pedido] [nvarchar](50) NULL,
	[fecha] [varchar](50) NULL,
	[hora] [varchar](7) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Pedidos_ficha](
	[Orden] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[pedido] [varchar](25) NULL,
	[cliente] [varchar](10) NULL,
	[transporte] [varchar](100) NULL,
	[fecha] [varchar](10) NULL,
	[hora] [varchar](5) NULL,
	[destino] [varchar](250) NULL,
	[observacion] [varchar](1000) NULL,
	[mail] [varchar](max) NULL,
	[codvig] [varchar](1) NULL,
	[terminado] [nvarchar](1) NULL,
	[Encargado] [nvarchar](50) NULL,
	[fechapedido] [datetime] NULL,
	[fechaTermino] [datetime] NULL,
	[ped_estpred] [numeric](18, 0) NULL CONSTRAINT [DF_Pedidos_ficha_ped_estpred]  DEFAULT ((0)),
	[ped_revision] [numeric](18, 0) NULL CONSTRAINT [DF_Pedidos_ficha_ped_revision]  DEFAULT ((0)),
	[packinglist] [nvarchar](30) NULL,
	[ordenconjunta] [nvarchar](max) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_Pedidos_ficha_1] PRIMARY KEY CLUSTERED 
(
	[Orden] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[pedidos_prg](
	[prg_orden] [numeric](18, 0) NULL,
	[prg_hora] [time](7) NULL,
	[prg_fecha] [date] NULL,
	[prg_rutclie] [nvarchar](20) NULL,
	[prg_modo] [nvarchar](25) NULL,
	[prg_2daHr] [int] NULL CONSTRAINT [DF_pedidos_prg_prg_2daHr]  DEFAULT ((0)),
	[prg_tipo] [int] NULL CONSTRAINT [DF_pedidos_prg_prg_tipo]  DEFAULT ((0))
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[PedidosWebok](
	[Ped_Numero] [nvarchar](50) NULL,
	[ped_fechahora] [nvarchar](16) NULL,
	[Ped_RutCliente] [nvarchar](10) NULL,
	[Ped_Folio_Icestar] [nvarchar](9) NULL,
	[Ped_Folio_Cliente] [nvarchar](15) NULL,
	[Ped_Cantidad] [int] NULL,
	[Ped_Kilos] [float] NULL,
	[Ped_Descripcion] [nvarchar](50) NULL,
	[Ped_RCP] [nvarchar](15) NULL,
	[Ped_FecRec] [nvarchar](10) NULL,
	[Ped_FecProd] [nvarchar](10) NULL,
	[Ped_FecVenc] [nvarchar](10) NULL,
	[Ped_Sopocli] [nvarchar](20) NULL,
	[Ped_Tipo] [numeric](18, 0) NULL,
	[Ped_destino] [nvarchar](100) NULL,
	[Ped_transporte] [nvarchar](100) NULL,
	[Ped_FechaHoraCarga] [nvarchar](50) NULL,
	[Ped_Picking] [nvarchar](15) NULL,
	[Ped_Pallet] [nvarchar](9) NULL,
	[Ped_ok] [nvarchar](1) NULL,
	[Ped_GDespacho] [nvarchar](9) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[PEDIDOSWEBOK_ANULACION](
	[ped_numero] [nvarchar](30) NULL,
	[ped_fecha] [nvarchar](10) NULL,
	[ped_hora] [nvarchar](8) NULL,
	[ped_estado] [nvarchar](1) NULL,
	[ped_usuario] [nvarchar](3) NULL,
	[ped_pc] [nvarchar](20) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[PedidosWebOKTMP](
	[pedido] [nvarchar](23) NULL,
	[ped_ok] [nvarchar](1) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[pedidowebrelacionrut](
	[ID] [int] NOT NULL,
	[Rut] [nvarchar](255) NULL,
	[Rutcorto] [nvarchar](255) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[PedWebTmp](
	[pwt_codcaja] [nvarchar](200) NULL,
	[pwt_producto] [nvarchar](50) NULL,
	[pwt_calidad] [nvarchar](20) NULL,
	[pwt_calibre] [nvarchar](10) NULL,
	[pwt_piezas] [int] NULL,
	[pwt_kilos] [float] NULL,
	[pwt_misc1] [nvarchar](50) NULL,
	[pwt_misc2] [nvarchar](50) NULL,
	[pwt_pallet] [nvarchar](9) NULL,
	[pwt_estado] [int] NULL,
	[pwt_fecelab] [nchar](10) NULL,
	[pwt_fecvenc] [nchar](10) NULL,
	[pwt_lote] [nvarchar](30) NULL,
	[pwt_coding] [nvarchar](30) NULL,
	[pwt_codped] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[PERFIL_USUARIO](
	[ID] [decimal](18, 0) IDENTITY(1,1) NOT NULL,
	[NOMBRE] [varchar](250) NULL,
	[FORMULARIO] [varchar](250) NULL,
	[PADRE] [varchar](250) NULL,
	[NUMERO] [varchar](250) NULL,
	[HOJA] [varchar](250) NULL,
	[GRABAR] [varchar](252) NULL,
	[PANTALLA] [varchar](250) NULL,
	[ARCHIVO] [varchar](250) NULL,
	[IMPRIMIR] [varchar](250) NULL,
	[TIPO_ROL] [varchar](250) NULL,
	[TIPO_PERFIL] [varchar](250) NULL,
	[NOMBRE_PERFIL] [varchar](250) NULL,
	[NOMBRE_TABLA] [varchar](250) NULL,
	[ESTADO] [decimal](18, 0) NULL,
	[ATRIBUTO] [varchar](250) NULL,
	[FECHA] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[PERFIL_USUARIO1](
	[ID] [decimal](18, 0) IDENTITY(1,1) NOT NULL,
	[NOMBRE] [varchar](250) NULL,
	[FORMULARIO] [varchar](250) NULL,
	[PADRE] [varchar](250) NULL,
	[NUMERO] [varchar](250) NULL,
	[HOJA] [varchar](250) NULL,
	[GRABAR] [varchar](252) NULL,
	[PANTALLA] [varchar](250) NULL,
	[ARCHIVO] [varchar](250) NULL,
	[IMPRIMIR] [varchar](250) NULL,
	[TIPO_ROL] [varchar](250) NULL,
	[TIPO_PERFIL] [varchar](250) NULL,
	[NOMBRE_PERFIL] [varchar](250) NULL,
	[NOMBRE_TABLA] [varchar](250) NULL,
	[ESTADO] [decimal](18, 0) NULL,
	[ATRIBUTO] [varchar](250) NULL,
	[FECHA] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[picking](
	[FOLIO] [char](10) NULL,
	[DESPACHO] [char](10) NULL,
	[CLIENTE] [char](10) NULL,
	[CANTIDAD] [float] NULL,
	[PESO] [float] NULL,
	[PALLET] [float] NULL,
	[FECHA] [datetime] NULL,
	[CONTRATO] [char](10) NULL,
	[CODIGO_RECEP] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[pickingCorrupto](
	[FOLIO] [char](10) NULL,
	[DESPACHO] [char](10) NULL,
	[CLIENTE] [char](10) NULL,
	[CANTIDAD] [float] NULL,
	[PESO] [float] NULL,
	[PALLET] [float] NULL,
	[FECHA] [datetime] NULL,
	[CONTRATO] [char](10) NULL,
	[CODIGO_RECEP] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[pisoband](
	[pisb_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_pisoband_pisb_unica]  DEFAULT (newid()),
	[pisb_codi] [nvarchar](9) NULL,
	[pisb_ca] [nvarchar](2) NULL,
	[pisb_banda] [nvarchar](2) NULL,
 CONSTRAINT [PK_pisoband] PRIMARY KEY NONCLUSTERED 
(
	[pisb_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[pisodeta](
	[pisd_unica] [uniqueidentifier] NOT NULL,
	[pisd_codi] [nvarchar](11) NULL,
	[pisd_ca] [nvarchar](2) NULL,
	[pisd_folio] [nvarchar](9) NULL,
	[pisd_codprod] [nvarchar](7) NULL,
	[pisd_unidades] [int] NULL,
	[pisd_peso] [int] NULL,
	[pisd_fecprod] [nvarchar](10) NULL,
	[pisd_core] [tinyint] NULL,
	[pisd_code] [tinyint] NULL,
 CONSTRAINT [PK_pisodeta] PRIMARY KEY NONCLUSTERED 
(
	[pisd_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[POLITICAS](
	[id] [nvarchar](14) NULL,
	[nombre] [nvarchar](100) NULL,
	[archivo] [nvarchar](500) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[predimagen](
	[pimg_imagen] [image] NULL,
	[pimg_num] [int] NULL,
	[pimg_precodi] [nvarchar](7) NULL,
	[fecha] [datetime] NULL CONSTRAINT [DF_predimagen_fecha]  DEFAULT (getdate())
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[preferen](
	[pref_unica] [uniqueidentifier] NOT NULL,
	[pref_rutclie] [nvarchar](9) NULL,
	[pref_prefer] [tinyint] NULL,
	[pref_camara] [nvarchar](2) NULL,
	[pref_almacen] [tinyint] NULL,
	[pref_estado] [tinyint] NULL,
 CONSTRAINT [PK_preferen] PRIMARY KEY NONCLUSTERED 
(
	[pref_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO
CREATE TABLE [dbo].[PRIVILEGIOS](
	[COD_PRIVILEGIO] [int] NOT NULL,
	[COD_ROL] [int] NOT NULL,
	[PRIVILEGIO] [nvarchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[PrivilegiosSeccion](
	[Priv_Id] [nvarchar](3) NOT NULL,
	[Priv_Nombre] [nvarchar](50) NULL,
 CONSTRAINT [PK_PrivilegiosSeccion] PRIMARY KEY CLUSTERED 
(
	[Priv_Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[PrivilegiosSubSeccion](
	[Spriv_Id] [nvarchar](3) NOT NULL,
	[Spriv_nombre] [nvarchar](50) NOT NULL,
	[Spriv_PrivId] [nvarchar](3) NOT NULL,
	[spriv_habil] [int] NULL CONSTRAINT [DF_PrivilegiosSubSeccion_spriv_habil]  DEFAULT ((0)),
 CONSTRAINT [PK_PrivilegiosSubSeccion] PRIMARY KEY CLUSTERED 
(
	[Spriv_Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Proc_Importaciones](
	[pimp_codi] [nvarchar](4) NOT NULL,
	[pimp_rutcli] [nvarchar](9) NULL,
	[pimp_contcli] [nvarchar](7) NULL,
	[pimp_ncont] [nvarchar](30) NULL,
	[pimp_codrece] [nvarchar](7) NULL,
	[pimp_reso] [nvarchar](40) NULL,
	[pimp_totsopo] [numeric](18, 0) NULL,
	[pimp_totunid] [numeric](18, 0) NULL,
	[pimp_totpeso] [float] NULL,
	[pimp_obs] [nvarchar](150) NULL,
	[pimp_fecha] [date] NULL,
	[pimp_hora] [time](7) NULL,
	[Pimp_usucod] [nvarchar](3) NULL,
 CONSTRAINT [PK_Proc_Importaciones_1] PRIMARY KEY CLUSTERED 
(
	[pimp_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[procedencia](
	[proc_rutcli] [nvarchar](10) NULL,
	[proc_origen] [nvarchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_despa](
	[ID] [varchar](80) NULL,
	[NUMERO] [varchar](20) NULL,
	[RECEPCION] [varchar](20) NULL,
	[CLIENTE] [varchar](15) NULL,
	[PRODUCTOR] [varchar](15) NULL,
	[FECHA] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_despa_dett](
	[ID] [varchar](20) NULL,
	[NUMERO] [varchar](20) NULL,
	[PRODUCTO] [varchar](20) NULL,
	[PALLET] [varchar](20) NULL,
	[LOTEP] [varchar](10) NULL,
	[TIPO] [varchar](20) NULL,
	[SOPO] [varchar](20) NULL,
	[TIPO_CARGA] [varchar](20) NULL,
	[ORIGEN] [varchar](20) NULL,
	[OBSERVACION] [varchar](80) NULL,
	[UNIDADES] [float] NULL,
	[PESO] [float] NULL,
	[FECHA] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_despa_dett2](
	[ID] [varchar](20) NULL,
	[NUMERO] [varchar](20) NULL,
	[PRODUCTO] [varchar](20) NULL,
	[PALLET] [varchar](20) NULL,
	[LOTEP] [varchar](10) NULL,
	[TIPO] [varchar](20) NULL,
	[SOPO] [varchar](20) NULL,
	[TIPO_CARGA] [varchar](20) NULL,
	[ORIGEN] [varchar](20) NULL,
	[OBSERVACION] [varchar](80) NULL,
	[UNIDADES] [float] NULL,
	[PESO] [float] NULL,
	[FECHA] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_despa2](
	[ID] [varchar](80) NULL,
	[NUMERO] [varchar](20) NULL,
	[RECEPCION] [varchar](20) NULL,
	[CLIENTE] [varchar](15) NULL,
	[PRODUCTOR] [varchar](15) NULL,
	[FECHA] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_estaticos](
	[id] [uniqueidentifier] NULL,
	[codigo] [char](10) NULL,
	[ngp] [char](10) NULL,
	[producto] [char](10) NULL,
	[fecha] [float] NULL,
	[unidades] [float] NULL,
	[peso] [float] NULL,
	[pallet] [char](10) NULL,
	[sopor] [char](10) NULL,
	[estado] [int] NULL,
	[lugar] [char](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_ingreso_Camaras](
	[Id] [varchar](255) NULL,
	[NGP] [varchar](10) NULL,
	[codigo] [varchar](10) NULL,
	[numero] [varchar](10) NULL,
	[producto] [varchar](10) NULL,
	[pallet] [varchar](8) NULL,
	[fecha] [datetime] NULL,
	[unidades] [float] NULL,
	[peso] [float] NULL,
	[tipo] [varchar](10) NULL,
	[camara] [varchar](10) NULL,
	[sopo] [varchar](10) NULL,
	[estado] [int] NULL,
	[final] [int] NULL CONSTRAINT [DF_procesos_ingreso_Camaras_final]  DEFAULT (0),
	[CLIENTE] [char](15) NULL CONSTRAINT [DF_procesos_ingreso_Camaras_CLIENTE]  DEFAULT (0),
	[PRODUCTOR] [char](15) NULL CONSTRAINT [DF_procesos_ingreso_Camaras_PRODUCTOR]  DEFAULT (0),
	[pucho] [char](10) NULL,
	[reproceso] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_ingreso_camaras2](
	[Id] [varchar](255) NULL,
	[NGP] [varchar](10) NULL,
	[codigo] [varchar](10) NULL,
	[numero] [varchar](10) NULL,
	[producto] [varchar](10) NULL,
	[pallet] [varchar](8) NULL,
	[fecha] [datetime] NULL,
	[unidades] [float] NULL,
	[peso] [float] NULL,
	[tipo] [varchar](10) NULL,
	[camara] [varchar](10) NULL,
	[sopo] [varchar](10) NULL,
	[estado] [int] NULL,
	[final] [int] NULL,
	[CLIENTE] [varchar](15) NULL,
	[PRODUCTOR] [varchar](15) NULL,
	[pucho] [varchar](10) NULL,
	[reproceso] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_ingreso_temporal](
	[id] [char](10) NULL,
	[pallet] [float] NULL,
	[npallet] [char](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_ingreso_tunel](
	[id] [varchar](255) NULL,
	[NGP] [varchar](10) NULL,
	[codigo] [varchar](50) NULL,
	[numero] [varchar](10) NULL,
	[producto] [varchar](20) NULL,
	[fecha] [datetime] NULL,
	[unidades] [float] NULL,
	[peso] [float] NULL,
	[tipo] [varchar](10) NULL,
	[tunel] [varchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_medidas](
	[id] [int] NULL,
	[tipo] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_moneda](
	[id] [char](10) NULL,
	[dolar] [float] NULL,
	[UF] [float] NULL,
	[fecha] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_puchos](
	[id] [char](10) NULL,
	[codigo] [char](10) NULL,
	[ngp] [char](10) NULL,
	[peso] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_puchos_temporal](
	[ID] [char](10) NULL,
	[codigo] [char](10) NULL,
	[ngp] [char](10) NULL,
	[peso] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_recep](
	[id] [varchar](255) NULL,
	[NGP] [varchar](50) NULL,
	[GUIA_OPER] [varchar](50) NULL,
	[RUTCLIENTE] [varchar](50) NULL,
	[RUTPRODUCTOR] [varchar](50) NULL,
	[CONTRATO] [varchar](50) NULL,
	[FECHA] [datetime] NULL,
	[TURNO] [int] NULL,
	[TEMPERATURA] [int] NULL,
	[TIPO_DESC] [int] NULL,
	[ORIGEN] [int] NULL,
	[OBSERVACION] [varchar](10) NULL,
	[ESTADO] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_recep_dett](
	[id] [varchar](50) NULL,
	[NGP] [varchar](50) NULL,
	[CODIGO] [varchar](50) NULL,
	[PRODUCTO] [char](50) NULL,
	[PALLET] [varchar](50) NULL,
	[SOPORTANTE] [varchar](50) NULL,
	[FECHA] [datetime] NULL,
	[UNIDADES] [float] NULL,
	[PESO] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_recep_dett2](
	[id] [varchar](50) NULL,
	[NGP] [varchar](50) NULL,
	[CODIGO] [varchar](50) NULL,
	[PRODUCTO] [char](50) NULL,
	[PALLET] [varchar](50) NULL,
	[SOPORTANTE] [varchar](50) NULL,
	[FECHA] [datetime] NULL,
	[UNIDADES] [float] NULL,
	[PESO] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_recep2](
	[id] [varchar](255) NULL,
	[NGP] [varchar](50) NULL,
	[GUIA_OPER] [varchar](50) NULL,
	[RUTCLIENTE] [varchar](50) NULL,
	[RUTPRODUCTOR] [varchar](50) NULL,
	[CONTRATO] [varchar](50) NULL,
	[FECHA] [datetime] NULL,
	[TURNO] [int] NULL,
	[TEMPERATURA] [int] NULL,
	[TIPO_DESC] [int] NULL,
	[ORIGEN] [int] NULL,
	[OBSERVACION] [varchar](10) NULL,
	[ESTADO] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_RelacionFactura](
	[producto] [varchar](20) NULL,
	[factura] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_reprocesos](
	[codigo] [char](10) NULL,
	[tipo] [char](10) NULL,
	[fecha] [char](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_tipo_producto](
	[id] [varchar](10) NULL,
	[producto] [varchar](10) NULL,
	[tipo] [varchar](10) NULL,
	[descripcion] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_Tipofactura](
	[cliente] [varchar](20) NULL,
	[codigo] [float] NULL,
	[descripcion] [varchar](80) NULL,
	[precio] [float] NULL CONSTRAINT [DF_procesos_Tipofactura_precio]  DEFAULT (0),
	[medida] [int] NULL CONSTRAINT [DF_procesos_Tipofactura_medida]  DEFAULT (0),
	[valor] [int] NULL CONSTRAINT [DF_procesos_Tipofactura_valor]  DEFAULT (0),
	[fecha] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_Tunel](
	[id] [varchar](10) NULL,
	[NGP] [varchar](10) NULL,
	[producto] [varchar](50) NULL,
	[total] [float] NULL CONSTRAINT [DF_procesos_Tunel_total]  DEFAULT (0),
	[IQF] [float] NULL CONSTRAINT [DF_procesos_Tunel_IQF]  DEFAULT (0),
	[E1] [float] NULL CONSTRAINT [DF_procesos_Tunel_E1]  DEFAULT (0),
	[E2] [float] NULL CONSTRAINT [DF_procesos_Tunel_E2]  DEFAULT (0),
	[E3] [float] NULL CONSTRAINT [DF_procesos_Tunel_E3]  DEFAULT (0),
	[JUGO] [float] NULL CONSTRAINT [DF_procesos_Tunel_JUGO]  DEFAULT (0),
	[fecha] [datetime] NULL,
	[usuario] [varchar](10) NULL,
	[estado] [int] NULL,
	[final] [char](10) NULL CONSTRAINT [DF_procesos_Tunel_final]  DEFAULT (0),
	[REPROCESO] [int] NULL CONSTRAINT [DF_procesos_Tunel_REPROCESO]  DEFAULT (0)
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_Tunel_dett](
	[Id] [varchar](50) NULL,
	[numero] [varchar](50) NULL,
	[iqf] [float] NULL CONSTRAINT [DF_procesos_Tunel_dett_iqf]  DEFAULT (0),
	[e1] [float] NULL CONSTRAINT [DF_procesos_Tunel_dett_e1]  DEFAULT (0),
	[e2] [float] NULL CONSTRAINT [DF_procesos_Tunel_dett_e2]  DEFAULT (0),
	[e3] [float] NULL CONSTRAINT [DF_procesos_Tunel_dett_e3]  DEFAULT (0),
	[JUGO] [float] NULL CONSTRAINT [DF_procesos_Tunel_dett_JUGO]  DEFAULT (0),
	[fecha] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[procesos_valores](
	[id] [int] NULL,
	[tipo] [varchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[PRODUCCION_PROCESOS](
	[Especie] [char](50) NULL,
	[Fecha] [datetime] NULL,
	[Turno] [char](10) NULL,
	[Hora_ini] [char](10) NULL,
	[Hora_Fin] [char](10) NULL,
	[Calidad] [char](20) NULL,
	[Valor] [float] NULL,
	[Numero] [char](13) NULL,
	[Productor] [char](13) NULL,
	[Produccion] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Productores](
	[cli_unica] [varchar](255) NULL,
	[cli_rut] [varchar](255) NULL,
	[cli_nomb] [varchar](255) NULL,
	[cli_direcc] [varchar](255) NULL,
	[cli_comuna] [varchar](255) NULL,
	[cli_ciudad] [varchar](255) NULL,
	[cli_fono] [varchar](255) NULL,
	[cli_fax] [varchar](255) NULL,
	[cli_feccre] [varchar](255) NULL,
	[cli_estado] [varchar](255) NULL,
	[cli_rubro] [varchar](255) NULL,
	[cli_mail] [varchar](255) NULL,
	[cli_envio] [varchar](255) NULL,
	[cli_diaenv] [varchar](255) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[PRODUCTOS_PROCESOS](
	[mae_unica] [varchar](255) NULL,
	[mae_codi] [varchar](50) NULL,
	[mae_descr] [varchar](50) NULL,
	[mae_tipenv] [varchar](50) NULL,
	[mae_clirut] [varchar](50) NULL,
	[mae_productor] [varchar](50) NULL,
	[mae_feccre] [varchar](50) NULL,
	[mae_alto] [float] NULL,
	[mae_ancho] [float] NULL,
	[mae_fondo] [float] NULL,
	[mae_base] [int] NULL,
	[mae_altura] [int] NULL,
	[mae_codcli] [varchar](255) NULL,
	[mae_codvig] [tinyint] NULL,
	[mae_codirel] [varchar](255) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[rack](
	[rack_codi] [varchar](8) NOT NULL,
	[rack_ca] [varchar](2) NULL,
	[rack_ba] [varchar](2) NULL,
	[rack_co] [varchar](2) NULL,
	[rack_pi] [varchar](2) NULL,
 CONSTRAINT [PK_rack_1] PRIMARY KEY CLUSTERED 
(
	[rack_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[rack_](
	[rac_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_rack_rac_unica]  DEFAULT (newid()),
	[rac_codi] [nvarchar](8) NULL,
	[rac_camara] [nvarchar](2) NULL,
	[rac_banda] [nvarchar](2) NULL,
	[rac_columna] [nvarchar](2) NULL,
	[rac_piso] [nvarchar](2) NULL,
	[rac_nivel1] [nvarchar](1) NULL CONSTRAINT [DF_rack_rac_nivel1]  DEFAULT ('0'),
	[rac_nivel2] [nvarchar](1) NULL CONSTRAINT [DF_rack_rac_nivel2]  DEFAULT ('0'),
	[rac_dispon] [nvarchar](1) NULL CONSTRAINT [DF_rack_rac_dispon]  DEFAULT ('0'),
	[rac_tiempo] [nvarchar](4) NULL CONSTRAINT [DF_rack_rac_tiempo]  DEFAULT ('0'),
	[rac_ocupado] [nvarchar](1) NULL CONSTRAINT [DF_rack_rac_ocupado]  DEFAULT ('0'),
	[rac_coren1] [tinyint] NULL CONSTRAINT [DF_rack_rac_coren1]  DEFAULT (0),
	[rac_coren2] [tinyint] NULL CONSTRAINT [DF_rack_rac_coren2]  DEFAULT (0),
 CONSTRAINT [PK_rack] PRIMARY KEY NONCLUSTERED 
(
	[rac_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[Rack_Altura](
	[rack_ca] [varchar](2) NULL,
	[rack_ba] [varchar](2) NULL,
	[rack_co] [varchar](2) NULL,
	[rack_pi] [varchar](2) NULL,
	[rack_altura] [nchar](10) NULL,
	[Bloqueo] [nchar](10) NULL,
	[Imp_nac] [nvarchar](50) NULL,
	[Reserva_cliente] [nvarchar](50) NULL,
	[Reserva_Producto] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Rack_Descuentos](
	[rack_ca] [varchar](2) NULL,
	[rack_ba] [varchar](2) NULL,
	[rack_co] [varchar](2) NULL,
	[rack_pi] [varchar](2) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[rackdeta](
	[racd_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_rackdeta_racd_unica]  DEFAULT (newid()),
	[racd_codi] [nvarchar](9) NULL,
	[racd_ca] [nvarchar](2) NULL,
	[racd_ba] [nvarchar](2) NULL,
	[racd_co] [nvarchar](2) NULL,
	[racd_pi] [nvarchar](2) NULL,
	[racd_ni] [nvarchar](1) NULL,
	[racd_codpro] [nvarchar](7) NULL,
	[racd_unidades] [int] NULL,
	[racd_peso] [float] NULL,
	[racd_fecpro] [nvarchar](10) NULL,
	[racd_core] [tinyint] NULL,
	[racd_code] [tinyint] NULL,
	[FechaVencimiento] [char](10) NULL,
	[LoteCliente] [char](20) NULL,
	[racd_pedido] [nvarchar](2) NULL CONSTRAINT [DF_rackdeta_racd_pedido]  DEFAULT ((0)),
	[racd_pedido_fec] [nvarchar](10) NULL,
	[racd_pedido_hor] [nvarchar](5) NULL,
	[racd_fechamov] [nvarchar](10) NULL,
	[racd_horamov] [nvarchar](5) NULL,
	[racd_estadopallet] [nvarchar](1) NULL CONSTRAINT [DF_rackdeta_racd_estadopallet]  DEFAULT ('0'),
	[racd_solicitado] [int] NULL CONSTRAINT [DF_rackdeta_racd_solicitado]  DEFAULT ((0)),
	[racd_correo] [nvarchar](1) NULL CONSTRAINT [DF_rackdeta_racd_correo]  DEFAULT ('0'),
	[racd_picking] [nvarchar](1) NULL CONSTRAINT [DF_rackdeta_racd_picking]  DEFAULT ('0'),
	[racd_estado] [nvarchar](1) NULL CONSTRAINT [DF_rackdeta_racd_estado]  DEFAULT ('0'),
	[racd_pred] [varchar](7) NULL,
	[racd_pedi] [varchar](10) NULL,
	[racd_sini] [varchar](10) NULL,
	[cod_bod] [nchar](10) NULL,
	[racd_webusu] [int] NULL,
 CONSTRAINT [PK_rackdeta] PRIMARY KEY NONCLUSTERED 
(
	[racd_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[rackdeta_20080512](
	[racd_unica] [uniqueidentifier] NOT NULL,
	[racd_codi] [nvarchar](9) NULL,
	[racd_ca] [nvarchar](2) NULL,
	[racd_ba] [nvarchar](2) NULL,
	[racd_co] [nvarchar](2) NULL,
	[racd_pi] [nvarchar](2) NULL,
	[racd_ni] [nvarchar](1) NULL,
	[racd_codpro] [nvarchar](7) NULL,
	[racd_unidades] [int] NULL,
	[racd_peso] [float] NULL,
	[racd_fecpro] [nvarchar](10) NULL,
	[racd_core] [tinyint] NULL,
	[racd_code] [tinyint] NULL,
	[FechaVencimiento] [char](10) NULL,
	[LoteCliente] [char](10) NULL,
	[racd_pedido] [nvarchar](2) NULL,
	[racd_pedido_fec] [nvarchar](10) NULL,
	[racd_pedido_hor] [nvarchar](5) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[RACKDETA_ESTADO](
	[CODIGO] [varchar](1) NULL,
	[DESCRIPCION] [varchar](30) NULL,
	[BLOQUEAR] [varchar](1) NULL,
	[VISIBLE] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[RackdetaBasura](
	[fecbasura] [datetime] NULL CONSTRAINT [DF_RackdetaBasura_fecbasura]  DEFAULT (getdate()),
	[racd_unica] [uniqueidentifier] NOT NULL,
	[racd_codi] [nvarchar](9) NULL,
	[racd_ca] [nvarchar](2) NULL,
	[racd_ba] [nvarchar](2) NULL,
	[racd_co] [nvarchar](2) NULL,
	[racd_pi] [nvarchar](2) NULL,
	[racd_ni] [nvarchar](1) NULL,
	[racd_codpro] [nvarchar](7) NULL,
	[racd_unidades] [int] NULL,
	[racd_peso] [float] NULL,
	[racd_fecpro] [nvarchar](10) NULL,
	[racd_core] [tinyint] NULL,
	[racd_code] [tinyint] NULL,
	[FechaVencimiento] [char](10) NULL,
	[LoteCliente] [char](10) NULL,
	[racd_pedido] [nvarchar](2) NULL,
	[racd_pedido_fec] [nvarchar](10) NULL,
	[racd_pedido_hor] [nvarchar](5) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[receimagen](
	[rimg_imagen] [image] NULL,
	[rimg_num] [int] NULL,
	[rimg_rececodi] [nvarchar](7) NULL,
	[fecha] [datetime] NULL CONSTRAINT [DF_receimagen_fecha]  DEFAULT (getdate()),
	[rimg_temp] [int] NULL CONSTRAINT [DF_receimagen_riimg_temp]  DEFAULT ((0)),
	[rimg_imagen2] [image] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[recepcion_prg](
	[rprg_codrece] [nvarchar](7) NULL,
	[rprg_hora] [time](7) NULL,
	[rprg_fecha] [date] NULL,
	[rprg_rutclie] [nvarchar](20) NULL,
	[rprg_modo] [nvarchar](25) NULL,
	[rprg_pl] [nvarchar](30) NULL,
	[rprg_observacion] [nvarchar](150) NULL,
	[rprg_guiatrans] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Reclamo_Clientes](
	[Numero] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Reclamo_Clientes_Detalle](
	[rec_numero] [nvarchar](5) NULL,
	[rec_rutcli] [nvarchar](10) NULL,
	[rec_fecha] [nvarchar](10) NULL,
	[rec_genrec] [nvarchar](50) NULL,
	[rec_reclamo] [nvarchar](2048) NULL,
	[rec_direccion] [nvarchar](80) NULL,
	[rec_ciudad] [nvarchar](50) NULL,
	[rec_telefono] [nvarchar](50) NULL,
	[rec_email] [nvarchar](60) NULL,
	[rec_producto] [nvarchar](80) NULL,
	[rec_elaboracion] [nvarchar](15) NULL,
	[REC_ESTADO] [nvarchar](1) NULL CONSTRAINT [DF_Reclamo_Clientes_Detalle_REC_ESTADO]  DEFAULT (0)
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[reclamos](
	[CODIGO] [int] IDENTITY(1,1) NOT NULL,
	[RUTCLIENTE] [varchar](20) NULL,
	[NOMBRE] [varchar](100) NULL,
	[EMAIL] [varchar](100) NULL,
	[COMENTARIO] [varchar](1000) NULL,
	[FECHA_INGRESO] [datetime] NULL,
	[FECHA_APERTURA] [datetime] NULL,
	[FECHA_CIERRE] [datetime] NULL,
	[ARCHIVO] [varchar](200) NULL,
	[ESTADO_PROCESO] [varchar](20) NULL,
	[ESTADO_ACTUALIZACION] [varchar](20) NULL,
	[ESTADO] [varchar](20) NULL,
	[USUARIO] [varchar](10) NULL,
 CONSTRAINT [PK__reclamos__CC87E1278B70086B] PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[reclamos_mensajes](
	[CODIGO] [int] IDENTITY(1,1) NOT NULL,
	[CODIGO_RECLAMO] [int] NULL,
	[USUARIO] [varchar](100) NULL,
	[TIPO] [varchar](11) NULL,
	[MENSAJE] [varchar](1000) NULL,
	[FECHA_INGRESO] [datetime] NULL,
	[ESTADO] [varchar](1) NULL,
 CONSTRAINT [PK__reclamos__CC87E127ABF513FB] PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[recordatorios](
	[CODIGO_RECORDATORIO] [int] IDENTITY(1,1) NOT NULL,
	[TITULO_REC] [varchar](100) NULL,
	[FECHA_REC] [date] NULL,
	[HORA_REC] [time](7) NULL,
	[DESCRIPCION_REC] [varchar](1000) NULL,
	[USUARIO_INGRESO] [varchar](5) NULL,
	[FECHA_INGRESO] [varchar](12) NULL,
	[USUARIO_MODIFICO] [varchar](5) NULL,
	[FECHA_MODIFICACION] [varchar](12) NULL,
	[CODIGO_FICHA] [int] NULL,
	[ESTADO_REC] [varchar](15) NULL,
 CONSTRAINT [PK_recordatorios] PRIMARY KEY CLUSTERED 
(
	[CODIGO_RECORDATORIO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO
CREATE TABLE [dbo].[REL_USUARIOS_ROLES](
	[COD_USUARIO] [nvarchar](8) NOT NULL,
	[COD_ROL] [int] NOT NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[relrack](
	[rel_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_relrack_rel_unica]  DEFAULT (newid()),
	[rel_ca] [nvarchar](2) NULL,
	[rel_ba] [nvarchar](2) NULL,
	[rel_co] [nvarchar](2) NULL,
	[rel_pi] [nvarchar](2) NULL,
	[rel_pa] [nvarchar](1) NULL,
 CONSTRAINT [PK_relrack] PRIMARY KEY NONCLUSTERED 
(
	[rel_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Rendiciondinero](
	[correlativo] [nvarchar](10) NULL,
	[fecha] [nvarchar](50) NULL,
	[cliente] [nvarchar](50) NULL,
	[cheque] [nvarchar](50) NULL,
	[efectivo] [numeric](18, 0) NULL,
	[pagado] [numeric](18, 0) NULL,
	[vuelto] [numeric](18, 0) NULL
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO
CREATE TABLE [dbo].[ROLES](
	[CODIGO_ROL] [int] NOT NULL,
	[DESCRIPCION_ROL] [nvarchar](50) NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[RPTlote](
	[Pallet] [varchar](50) NULL,
	[fecharece] [varchar](50) NULL,
	[guiacliente] [varchar](50) NULL,
	[posicion] [varchar](50) NULL,
	[guiadesp] [varchar](50) NULL,
	[fechadesp] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[rubro](
	[CODIGO_RUBRO] [int] IDENTITY(1,1) NOT NULL,
	[NOMBRE_RUBRO] [varchar](50) NOT NULL,
	[ESTADO_RUBRO] [varchar](15) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[CODIGO_RUBRO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[rutacama](
	[rutca_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_rutacama_rutca_unica]  DEFAULT (newid()),
	[rutca_rutclie] [nvarchar](9) NULL,
	[rutca_secuen] [nvarchar](2) NULL,
	[rutca_cama] [nvarchar](2) NULL,
 CONSTRAINT [PK_rutacama] PRIMARY KEY NONCLUSTERED 
(
	[rutca_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[rutaclie](
	[rutc_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_rutaclie_rutc_unica]  DEFAULT (newid()),
	[rutc_rutclie] [nvarchar](9) NULL,
	[rutc_secuen] [nvarchar](2) NULL,
	[rutc_almacena] [nvarchar](1) NULL,
 CONSTRAINT [PK_rutaclie] PRIMARY KEY NONCLUSTERED 
(
	[rutc_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[rutaprod](
	[rutp_unica] [uniqueidentifier] NOT NULL,
	[rutp_rutclie] [nvarchar](9) NULL,
	[rutp_codpro] [nvarchar](7) NULL,
	[rutp_secuen] [nvarchar](3) NULL,
	[rutp_camara] [nvarchar](2) NULL,
	[rutp_npos] [nvarchar](6) NULL,
 CONSTRAINT [PK_rutaprod] PRIMARY KEY NONCLUSTERED 
(
	[rutp_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[SADEMA_GRAFICAS](
	[nombre] [nvarchar](50) NULL,
	[base] [nvarchar](50) NULL,
	[sectores] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Secciones](
	[Sec_Id] [numeric](18, 0) NOT NULL,
	[Sec_Descr] [nvarchar](20) NULL,
 CONSTRAINT [PK_Secciones] PRIMARY KEY CLUSTERED 
(
	[Sec_Id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[serimagen](
	[rimg_imagen] [image] NULL,
	[rimg_num] [int] NULL,
	[rimg_rececodi] [nvarchar](7) NULL,
	[fecha] [datetime] NULL CONSTRAINT [DF_serimagen_fecha]  DEFAULT (getdate()),
	[rimg_temp] [int] NULL CONSTRAINT [DF_serimagen_rimg_temp]  DEFAULT ((0)),
	[rimg_imagen2] [image] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Servicio_Nuevos](
	[ServN_servicio] [nvarchar](4) NULL,
	[servn_rutcli] [nvarchar](10) NULL,
	[servn_pallet] [int] NULL,
	[servn_tunel] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios](
	[ser_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_servicios_ser_unica]  DEFAULT (newid()),
	[ser_codi] [nvarchar](3) NULL,
	[ser_descr] [varchar](1000) NULL,
	[ser_tdato] [tinyint] NULL,
	[ser_tmeca] [tinyint] NULL,
	[ser_codvig] [tinyint] NULL,
	[ser_escala] [tinyint] NULL,
 CONSTRAINT [PK_servicios] PRIMARY KEY NONCLUSTERED 
(
	[ser_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_asociar](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[pallet] [varchar](50) NULL,
	[servicio] [varchar](50) NULL,
	[estado] [int] NULL,
	[fecha] [datetime] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_detalledespacho](
	[codigo] [int] IDENTITY(1,1) NOT NULL,
	[barra] [varchar](50) NULL,
	[numero] [varchar](50) NULL,
	[ficha] [varchar](50) NULL,
	[fecha] [datetime] NULL,
	[producto] [varchar](50) NULL,
	[soportante] [varchar](50) NULL,
	[unidades] [float] NULL,
	[peso] [float] NULL,
	[estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_detallerecepcion](
	[codigo] [int] IDENTITY(1,1) NOT NULL,
	[barra] [varchar](50) NULL,
	[numero] [varchar](50) NULL,
	[ficha] [varchar](50) NULL,
	[fecha] [datetime] NULL,
	[producto] [varchar](50) NULL,
	[soportante] [varchar](50) NULL,
	[unidades] [float] NULL,
	[peso] [float] NULL,
	[estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_fichaDespacho](
	[codigo] [int] IDENTITY(1,1) NOT NULL,
	[ficha] [varchar](50) NULL,
	[cliente] [varchar](50) NULL,
	[productor] [varchar](50) NULL,
	[cotrato] [varchar](50) NULL,
	[fecha] [datetime] NULL,
	[carga] [varchar](50) NULL,
	[observacion] [varchar](50) NULL,
	[estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_ficharecepcion](
	[codigo] [int] IDENTITY(1,1) NOT NULL,
	[ficha] [varchar](50) NULL,
	[cliente] [varchar](50) NULL,
	[productor] [varchar](50) NULL,
	[contrato] [varchar](50) NULL,
	[fecha] [datetime] NULL,
	[carga] [varchar](50) NULL,
	[observacion] [varchar](50) NULL,
	[estado] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_monedas](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[codigo] [varchar](50) NULL,
	[nombre] [varchar](50) NULL,
	[sigla] [varchar](50) NULL,
	[valor] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_numeros](
	[codigo] [int] IDENTITY(1,1) NOT NULL,
	[tipo] [varchar](50) NULL,
	[actual] [float] NULL,
	[utilizado] [float] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_servicios](
	[id] [int] IDENTITY(10,1) NOT NULL,
	[codigo] [int] NULL,
	[nombre] [varchar](50) NULL,
	[descripcion] [varchar](50) NULL,
	[valor] [float] NULL,
	[unidad] [int] NULL,
	[moneda] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_unidades](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[codigo] [varchar](50) NULL,
	[nombre] [varchar](50) NULL,
	[tipo] [int] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_web](
	[CODIGO] [int] IDENTITY(1,1) NOT NULL,
	[DESCRIPCION] [varchar](100) NULL,
	[ESTADO] [varchar](1) NULL,
PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[servicios_web_solicitud](
	[CODIGO] [int] IDENTITY(1,1) NOT NULL,
	[RUTCLIENTE] [varchar](20) NULL,
	[NOMBRE] [varchar](100) NULL,
	[EMAIL] [varchar](100) NULL,
	[CODIGO_SERVICIO] [varchar](5) NULL,
	[OTRO] [varchar](100) NULL,
	[COMENTARIO] [varchar](1000) NULL,
	[FECHA_INGRESO] [datetime] NULL,
	[ESTADO] [varchar](1) NULL,
 CONSTRAINT [PK__servicio__CC87E127BC94A5A1] PRIMARY KEY CLUSTERED 
(
	[CODIGO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[ServWeb](
	[Sweb_codi] [float] NULL,
	[Sweb_Serv] [int] NULL,
	[Sweb_Cliente] [char](10) NULL,
	[Sweb_Fecha] [datetime] NULL,
	[Sweb_Cam1] [float] NULL,
	[Sweb_Cam2] [float] NULL,
	[Sweb_Cam3] [float] NOT NULL,
	[Sweb_Cam4] [char](15) NULL,
	[Sweb_Cam5] [char](15) NULL,
	[Sweb_Cam6] [char](15) NULL,
	[Sweb_Cam7] [char](15) NULL,
	[Sweb_Cam8] [char](15) NULL,
	[Sweb_GrupFec] [decimal](24, 0) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[slot](
	[slo_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_slot_slo_unica]  DEFAULT (newid()),
	[slo_codi] [nvarchar](5) NULL,
	[slo_camara] [nvarchar](2) NULL,
	[slo_slot] [nvarchar](3) NULL,
	[slo_banda] [nvarchar](2) NULL,
	[slo_piso] [nvarchar](2) NULL,
	[slo_alto] [int] NULL,
	[slo_ancho] [int] NULL,
	[slo_fondo] [int] NULL,
	[slo_saltura] [nvarchar](5) NULL,
	[slo_tslot] [nvarchar](1) NULL,
 CONSTRAINT [PK_slot] PRIMARY KEY NONCLUSTERED 
(
	[slo_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[slot_historial](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[fecha] [datetime] NULL,
	[cliente] [varchar](50) NULL,
	[cod_Rece] [varchar](50) NULL,
	[camara] [varchar](50) NULL,
	[slot] [varchar](50) NULL,
	[contrato] [varchar](50) NULL,
	[producto] [varchar](50) NULL,
	[unidades] [float] NULL CONSTRAINT [DF_slot_historial_unidades]  DEFAULT (0),
	[peso] [float] NULL CONSTRAINT [DF_slot_historial_peso]  DEFAULT (0)
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[slotdeta](
	[slod_unica] [uniqueidentifier] NOT NULL,
	[slod_codi] [nvarchar](16) NULL,
	[slod_caslo] [nvarchar](5) NULL,
	[slod_folio] [nvarchar](11) NULL,
	[slod_codpro] [nvarchar](7) NULL,
	[slod_unidades] [int] NULL,
	[slod_peso] [float] NULL,
	[slod_fecpro] [nvarchar](10) NULL,
	[slod_nivel] [int] NULL,
	[slod_altura] [int] NULL,
	[slod_envniv] [int] NULL,
	[slod_altenv] [int] NULL,
	[slod_core] [tinyint] NULL,
	[slod_code] [tinyint] NULL,
 CONSTRAINT [PK_slotdeta] PRIMARY KEY NONCLUSTERED 
(
	[slod_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Stock_Pallet_Cliente](
	[fecha] [nvarchar](10) NULL,
	[nombre] [nvarchar](50) NULL,
	[pallet] [numeric](18, 0) NULL,
	[bins] [numeric](18, 0) NULL,
	[envases] [numeric](18, 0) NULL,
	[kilos] [float] NULL,
	[grupo] [nvarchar](6) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[Stockini](
	[sto_unica] [uniqueidentifier] NOT NULL,
	[sto_fecha] [nvarchar](4) NULL,
	[sto_codprod] [nvarchar](7) NULL,
	[sto_pallet] [int] NULL,
	[sto_unidad] [int] NULL,
	[sto_peso] [float] NULL,
 CONSTRAINT [PK_Stockini] PRIMARY KEY NONCLUSTERED 
(
	[sto_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[T_ANDREW_TEMP](
	[PALET] [nvarchar](50) NULL,
	[CAJA] [nvarchar](50) NULL,
	[ESTADO] [nvarchar](50) NULL,
	[CALIDAD] [nvarchar](50) NULL,
	[CALIBRE] [nvarchar](50) NULL,
	[FECHAELAB] [nvarchar](50) NULL,
	[FECHAVEN] [nvarchar](50) NULL,
	[UNIDAD] [nvarchar](50) NULL,
	[KILO] [nvarchar](50) NULL,
	[ID] [nvarchar](50) NULL,
	[LOTE] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TipoDocumento](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Descripcion] [char](30) NOT NULL,
	[Tabla] [char](30) NULL,
 CONSTRAINT [PK_Notificacion] PRIMARY KEY NONCLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[tipoenv](
	[tenv_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_tipoenv_tenv_unica]  DEFAULT (newid()),
	[tenv_codi] [nvarchar](5) NULL,
	[tenv_descr] [nvarchar](40) NULL,
	[tenv_mater] [nvarchar](15) NULL,
	[tenv_alto] [float] NULL,
	[tenv_ancho] [float] NULL,
	[tenv_fondo] [float] NULL,
	[tenv_fecproc] [nvarchar](10) NULL,
 CONSTRAINT [PK_tipoenv] PRIMARY KEY NONCLUSTERED 
(
	[tenv_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[tiposopo](
	[tsop_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_tiposopo_tsop_unica]  DEFAULT (newid()),
	[tsop_codi] [nvarchar](3) NULL,
	[tsop_descr] [nvarchar](40) NULL,
	[tsop_materi] [nvarchar](30) NULL,
	[tsop_alto] [float] NULL,
	[tsop_ancho] [float] NULL,
	[tsop_fondo] [float] NULL,
	[tsop_fecproc] [nvarchar](10) NULL,
	[codcorto] [nchar](3) NULL,
	[pesoPallet] [numeric](18, 0) NULL,
 CONSTRAINT [PK_tiposopo] PRIMARY KEY NONCLUSTERED 
(
	[tsop_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[TMP_DETAPREDCAJAS](
	[Folio] [nchar](10) NULL,
	[Pallet] [nvarchar](50) NULL,
	[Caja] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[TMP_MOVIMIENTOSCAMARA](
	[MOVC_ID] [nvarchar](14) NULL,
	[MOVC_FOLIO] [nvarchar](9) NULL,
	[MOVC_FECHA] [nvarchar](10) NULL,
	[MOVC_HORA] [nvarchar](5) NULL,
	[MOVC_CA] [nvarchar](2) NULL,
	[MOVC_BA] [nvarchar](2) NULL,
	[MOVC_CO] [nvarchar](2) NULL,
	[MOVC_PI] [nvarchar](2) NULL,
	[MOVC_NI] [nvarchar](1) NULL,
	[MOVC_TS] [real] NULL,
	[MOVC_TM] [real] NULL,
	[MOVC_TI] [real] NULL,
	[MOVC_RUTCLI] [nvarchar](10) NULL,
	[MOVC_NOMCLI] [nvarchar](50) NULL,
	[MOVC_MOVIM] [nvarchar](50) NULL,
	[MOVC_CODPRO] [nvarchar](10) NULL,
	[MOVC_PRODESC] [nvarchar](50) NULL,
	[MOVC_FECREC] [nvarchar](10) NULL,
	[MOVC_PESO] [float] NULL,
	[MOVC_UNIDAD] [int] NULL CONSTRAINT [DF_TMP_MOVIMIENTOSCAMARA_MOVC_UNIDAD]  DEFAULT (1)
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TMP_PackingList](
	[tmpc_codrece] [varchar](9) NULL,
	[tmpc_codcaja] [varchar](200) NULL,
	[tmpc_id] [numeric](18, 0) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TMP_POS](
	[pallet] [nvarchar](50) NULL,
	[fechareg] [datetime] NULL,
	[encargado] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[TMP_PRN_ETQ](
	[etiqueta] [nvarchar](20) NULL,
	[prn] [int] NULL,
	[temp] [int] NULL,
	[numpallet] [nvarchar](9) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TMP_SELECCIONCAJAS](
	[scaj_codcaja] [varchar](200) NOT NULL,
	[scaj_codped] [numeric](18, 0) NOT NULL,
	[scaj_fecha] [datetime] NULL,
	[scaj_enca] [varchar](3) NULL
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[TMPCABSERVICIOS](
	[IDENT] [numeric](18, 0) NOT NULL,
	[CONTRATO] [varchar](7) NOT NULL,
	[CONTRVAL] [decimal](12, 2) NOT NULL CONSTRAINT [DF__TMPCABSER__CONTR__0307610B]  DEFAULT (0),
	[MONDESC] [varchar](30) NOT NULL CONSTRAINT [DF__TMPCABSER__MONDE__03FB8544]  DEFAULT (''),
	[MONVAL] [decimal](12, 2) NOT NULL CONSTRAINT [DF__TMPCABSER__MONVA__04EFA97D]  DEFAULT (0),
	[MEDDESC] [varchar](30) NOT NULL CONSTRAINT [DF__TMPCABSER__MEDDE__05E3CDB6]  DEFAULT (''),
	[TOTSOP] [int] NOT NULL CONSTRAINT [DF__TMPCABSER__TOTSO__06D7F1EF]  DEFAULT (0),
	[VALNETO] [decimal](12, 2) NOT NULL CONSTRAINT [DF__TMPCABSER__VALNE__07CC1628]  DEFAULT (0),
	[VALUF] [decimal](12, 2) NOT NULL CONSTRAINT [DF__TMPCABSER__VALUF__08C03A61]  DEFAULT (0),
	[FECUF] [varchar](10) NOT NULL CONSTRAINT [DF__TMPCABSER__FECUF__09B45E9A]  DEFAULT (''),
	[VALDOLAR] [decimal](12, 2) NOT NULL CONSTRAINT [DF__TMPCABSER__VALDO__0AA882D3]  DEFAULT (0),
	[FECDOLAR] [varchar](10) NOT NULL CONSTRAINT [DF__TMPCABSER__FECDO__0B9CA70C]  DEFAULT (''),
	[TOTCT] [int] NOT NULL CONSTRAINT [DF__TMPCABSER__TOTCT__0C90CB45]  DEFAULT (0),
	[TOTST] [int] NOT NULL CONSTRAINT [DF__TMPCABSER__TOTST__0D84EF7E]  DEFAULT (0),
	[TOTDP] [int] NOT NULL CONSTRAINT [DF__TMPCABSER__TOTDP__0E7913B7]  DEFAULT (0),
	[TOTSTOCK] [int] NOT NULL CONSTRAINT [DF__TMPCABSER__TOTST__0F6D37F0]  DEFAULT (0),
	[TOTUNI] [int] NOT NULL CONSTRAINT [DF__TMPCABSER__TOTUN__10615C29]  DEFAULT (0),
	[TOTTONE] [decimal](12, 2) NOT NULL CONSTRAINT [DF__TMPCABSER__TOTTO__11558062]  DEFAULT (0),
	[CONTRDERENTR] [int] NOT NULL CONSTRAINT [DF_TMPCABSERVICIOS_CONTRDERENTR]  DEFAULT (0),
 CONSTRAINT [PK_TMPCABSERV_MINTUNEL] PRIMARY KEY CLUSTERED 
(
	[IDENT] ASC,
	[CONTRATO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO
CREATE TABLE [dbo].[TMPCHOFERES](
	[frec_codi] [nvarchar](7) NOT NULL,
	[cho_rut] [nvarchar](9) NOT NULL CONSTRAINT [DF_TMPCHOFERES_cho_rut]  DEFAULT (''),
	[cho_rutclie] [nvarchar](9) NOT NULL CONSTRAINT [DF_TMPCHOFERES_cho_rutclie]  DEFAULT (''),
	[cho_nombre] [nvarchar](40) NOT NULL CONSTRAINT [DF_TMPCHOFERES_cho_nombre]  DEFAULT (''),
	[cho_patente] [nvarchar](10) NOT NULL CONSTRAINT [DF_TMPCHOFERES_cho_patente]  DEFAULT (''),
	[cho_empresa] [nvarchar](35) NOT NULL CONSTRAINT [DF_TMPCHOFERES_cho_empresa]  DEFAULT (''),
 CONSTRAINT [PK_TMPCHOFERES] PRIMARY KEY CLUSTERED 
(
	[frec_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[tmpcorrel](
	[tmpc_unica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_tmpcorrel_tmpc_unica]  DEFAULT (newid()),
	[tmpc_codi] [nvarchar](10) NULL,
	[tmpc_usuario] [nvarchar](10) NULL,
	[tmpc_personal] [smallint] NULL,
	[tmpc_fechaini] [nvarchar](10) NULL,
	[tmpc_horaini] [nvarchar](8) NULL,
	[tmpc_fechater] [nvarchar](10) NULL,
	[tmpc_horater] [nvarchar](8) NULL,
	[tmpc_proceso] [tinyint] NULL,
 CONSTRAINT [PK_tmpcorrel] PRIMARY KEY NONCLUSTERED 
(
	[tmpc_unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPDETAETIQ](
	[ETIQ_CODI] [varchar](5) NOT NULL,
	[ETIQ_DCOD] [nvarchar](2) NOT NULL,
	[ETIQ_SOPOPRE] [nvarchar](9) NULL,
	[ETIQ_SOPOCLI] [nvarchar](11) NULL,
	[ETIQ_CODPRO] [nvarchar](7) NULL,
	[ETIQ_FECPROD] [date] NULL,
	[ETIQ_FECVENC] [date] NULL,
	[ETIQ_CAJAS] [numeric](18, 0) NULL,
	[ETIQ_KILOS] [float] NULL,
	[ETIQ_NFECPROD] [date] NULL,
	[ETIQ_NFECVENC] [date] NULL,
	[ETIQ_NSOPOCLI] [nvarchar](11) NULL,
	[ETIQ_EST] [nvarchar](5) NULL,
 CONSTRAINT [PK_TMPDETAETIQ] PRIMARY KEY CLUSTERED 
(
	[ETIQ_CODI] ASC,
	[ETIQ_DCOD] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPDETAPRED](
	[fpre_codi] [nvarchar](7) NOT NULL,
	[dpre_codi] [nvarchar](2) NOT NULL,
	[dpre_codpro] [nvarchar](7) NULL,
	[dpre_codsopo] [nvarchar](2) NULL,
	[dpre_sopocli] [nvarchar](17) NULL,
	[dpre_unidades] [int] NULL,
	[dpre_peso] [float] NULL,
	[dpre_fecdes] [nvarchar](10) NULL,
	[dpre_rutcli] [nvarchar](9) NULL,
	[dpre_contcli] [nvarchar](7) NULL,
	[dpre_fecprod] [nvarchar](10) NULL,
	[dpre_camara] [nvarchar](2) NULL,
	[dpre_banda] [nvarchar](2) NULL,
	[dpre_colum] [nvarchar](2) NULL,
	[dpre_piso] [nvarchar](2) NULL,
	[dpre_nivel] [nvarchar](1) NULL,
	[dpre_almacen] [tinyint] NULL,
	[dpre_dcaja] [tinyint] NULL,
	[dpre_folio] [nvarchar](9) NULL,
	[dpre_activa] [tinyint] NULL,
	[dpre_radio] [tinyint] NULL,
	[dpre_track] [tinyint] NULL,
	[dpre_codvig] [nvarchar](1) NULL,
	[dpre_pallet] [tinyint] NULL,
	[dpre_slot] [nvarchar](3) NULL,
	[dpre_TS] [real] NULL,
	[dpre_TM] [real] NULL,
	[dpre_TI] [real] NULL,
	[dpre_Ptr] [int] NOT NULL,
	[dpre_Pick] [int] NOT NULL,
	[dpre_CodPer] [char](3) NULL,
	[dpre_Hora] [varchar](10) NULL,
	[dpre_fecn] [nvarchar](10) NULL,
	[dpre_ActUni] [int] NOT NULL,
	[dpre_TotUni] [int] NOT NULL,
	[DPRE_CORRELATIVO] [int] NULL,
	[DPRE_FOLIO_PALLET] [nvarchar](18) NULL,
 CONSTRAINT [PK_TMPDETAPRED] PRIMARY KEY CLUSTERED 
(
	[fpre_codi] ASC,
	[dpre_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPDETARECE](
	[frec_codi] [nvarchar](7) NOT NULL,
	[drec_codi] [nvarchar](2) NOT NULL,
	[drec_codcaja] [varchar](1) NULL,
	[drec_codpro] [nvarchar](7) NOT NULL,
	[drec_origen] [nvarchar](2) NOT NULL,
	[drec_codsopo] [nvarchar](2) NOT NULL,
	[drec_sopocli] [nvarchar](17) NOT NULL,
	[drec_unidades] [int] NOT NULL,
	[drec_peso] [float] NOT NULL,
	[drec_fecrec] [nvarchar](10) NOT NULL,
	[drec_rutcli] [nvarchar](9) NOT NULL,
	[drec_rutproductor] [varchar](12) NOT NULL,
	[drec_contcli] [nvarchar](7) NOT NULL,
	[drec_fecprod] [nvarchar](10) NOT NULL,
	[drec_camara] [nvarchar](2) NOT NULL,
	[drec_banda] [nvarchar](2) NOT NULL,
	[drec_colum] [nvarchar](2) NOT NULL,
	[drec_piso] [nvarchar](2) NOT NULL,
	[drec_nivel] [nvarchar](1) NOT NULL,
	[drec_almacen] [tinyint] NOT NULL,
	[drec_dcaja] [tinyint] NOT NULL,
	[drec_tunel] [tinyint] NOT NULL,
	[drec_codvig] [nvarchar](1) NOT NULL,
	[drec_pallet] [tinyint] NULL,
	[drec_codrel] [nvarchar](7) NOT NULL,
	[drec_nrosopo] [int] NOT NULL,
	[drec_slot] [nvarchar](3) NOT NULL,
	[drec_dtgracia] [nvarchar](3) NOT NULL,
	[drec_codsag] [nvarchar](15) NOT NULL,
	[drec_tipo] [int] NULL,
	[FechaVencimiento] [char](10) NOT NULL,
	[LoteCliente] [char](15) NOT NULL,
	[drec_TS] [real] NULL,
	[drec_TM] [real] NULL,
	[drec_TI] [real] NULL,
	[drec_RecepTunel] [int] NULL,
	[drec_ProcTunel] [int] NULL,
	[drec_TS_Tunel] [real] NULL,
	[drec_TM_Tunel] [real] NULL,
	[drec_TI_Tunel] [real] NULL,
	[drec_codper] [char](3) NOT NULL,
	[drec_hora] [varchar](10) NOT NULL,
	[drec_FecHomo] [varchar](10) NOT NULL,
	[drec_HorHomo] [varchar](10) NOT NULL,
	[drec_AutHomo] [int] NULL,
	[drec_estado] [varchar](50) NOT NULL,
	[drec_ocup] [int] NOT NULL,
	[drec_valor] [real] NULL,
	[drec_moncodi] [nvarchar](2) NULL,
	[drec_medcodi] [nvarchar](3) NULL,
	[drec_temp] [float] NULL,
	[drec_arriendo] [varchar](1) NULL,
	[bloqueado] [nchar](1) NULL,
	[drec_etiqueta] [nvarchar](20) NULL,
	[codtmprece] [int] NULL,
	[estpallet] [nchar](5) NULL,
 CONSTRAINT [PK_TMPDETARECE] PRIMARY KEY CLUSTERED 
(
	[frec_codi] ASC,
	[drec_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPDETARECECASO](
	[frec_codi] [nvarchar](7) NOT NULL,
	[drec_codi] [nvarchar](2) NOT NULL,
	[drec_codpro] [nvarchar](7) NOT NULL,
	[drec_origen] [nvarchar](2) NOT NULL,
	[drec_codsopo] [nvarchar](2) NOT NULL,
	[drec_sopocli] [nvarchar](11) NOT NULL,
	[drec_unidades] [int] NOT NULL,
	[drec_peso] [float] NOT NULL,
	[drec_fecrec] [nvarchar](10) NOT NULL,
	[drec_rutcli] [nvarchar](9) NOT NULL,
	[drec_rutproductor] [varchar](12) NOT NULL,
	[drec_contcli] [nvarchar](7) NOT NULL,
	[drec_fecprod] [nvarchar](10) NOT NULL,
	[drec_camara] [nvarchar](2) NOT NULL,
	[drec_banda] [nvarchar](2) NOT NULL,
	[drec_colum] [nvarchar](2) NOT NULL,
	[drec_piso] [nvarchar](2) NOT NULL,
	[drec_nivel] [nvarchar](1) NOT NULL,
	[drec_almacen] [tinyint] NOT NULL,
	[drec_dcaja] [tinyint] NOT NULL,
	[drec_tunel] [tinyint] NOT NULL,
	[drec_codvig] [nvarchar](1) NOT NULL,
	[drec_pallet] [tinyint] NULL,
	[drec_codrel] [nvarchar](7) NOT NULL,
	[drec_nrosopo] [int] NOT NULL,
	[drec_slot] [nvarchar](3) NOT NULL,
	[drec_dtgracia] [nvarchar](3) NOT NULL,
	[drec_codsag] [nvarchar](10) NOT NULL,
	[drec_tipo] [int] NULL,
	[FechaVencimiento] [char](10) NOT NULL,
	[LoteCliente] [char](10) NOT NULL,
	[drec_TS] [real] NULL,
	[drec_TM] [real] NULL,
	[drec_TI] [real] NULL,
	[drec_RecepTunel] [int] NULL,
	[drec_ProcTunel] [int] NULL,
	[drec_TS_Tunel] [real] NULL,
	[drec_TM_Tunel] [real] NULL,
	[drec_TI_Tunel] [real] NULL,
	[drec_codper] [char](3) NOT NULL,
	[drec_hora] [varchar](10) NOT NULL,
	[drec_FecHomo] [varchar](10) NOT NULL,
	[drec_HorHomo] [varchar](10) NOT NULL,
	[drec_AutHomo] [int] NULL,
	[drec_estado] [varchar](50) NOT NULL,
	[drec_ocup] [int] NOT NULL
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO
CREATE TABLE [dbo].[TMPDETCAJAS](
	[frec_codi] [nvarchar](7) NOT NULL,
	[drec_codi] [nvarchar](2) NOT NULL,
	[detc_codi] [nvarchar](12) NOT NULL,
	[detc_fprod] [nvarchar](10) NOT NULL,
	[detc_fvenc] [nvarchar](10) NOT NULL,
	[detc_cantidad] [nvarchar](10) NOT NULL,
 CONSTRAINT [PK_TMPDETCAJAS] PRIMARY KEY CLUSTERED 
(
	[frec_codi] ASC,
	[drec_codi] ASC,
	[detc_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[TMPDETSERVICIOS](
	[IDENT] [numeric](18, 0) NOT NULL,
	[CONTRATO] [varchar](7) NOT NULL,
	[LINEA] [int] NOT NULL,
	[FECHA] [varchar](10) NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_FECHA]  DEFAULT (''),
	[CT] [int] NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_CT]  DEFAULT (0),
	[ST] [int] NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_ST]  DEFAULT (0),
	[DP] [int] NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_DP]  DEFAULT (0),
	[STOCK] [int] NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_STOCK]  DEFAULT (0),
	[FACTURAR] [int] NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_FACTURAR]  DEFAULT (0),
	[UNIDADES] [int] NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_UNIDADES]  DEFAULT (0),
	[TONELADAS] [decimal](12, 2) NOT NULL CONSTRAINT [DF_TMPSERV_MINTUNEL_TONELADAS]  DEFAULT (0),
 CONSTRAINT [PK_TMPSERV_MINTUNEL] PRIMARY KEY CLUSTERED 
(
	[IDENT] ASC,
	[CONTRATO] ASC,
	[LINEA] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[TMPESTADOS](
	[Est_Codi] [int] NOT NULL,
	[Est_Glosa] [varchar](10) NOT NULL CONSTRAINT [DF_TMPESTADOS_Est_Glosa]  DEFAULT (''),
 CONSTRAINT [PK_TMPESTADOS] PRIMARY KEY CLUSTERED 
(
	[Est_Codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPFICHETIQ](
	[ETIQ_CODI] [nvarchar](5) NOT NULL,
	[ETIQ_CLIRUT] [nvarchar](9) NULL,
	[ETIQ_CODCONT] [nvarchar](7) NULL,
	[ETIQ_FECHA] [date] NULL,
	[ETIQ_HORINI] [time](7) NULL,
	[ETIQ_CODENCA] [nvarchar](3) NULL,
	[ETIQ_EST] [nvarchar](1) NULL,
	[ETIQ_HORTER] [time](7) NULL,
 CONSTRAINT [PK_TMPFICHETIQ] PRIMARY KEY CLUSTERED 
(
	[ETIQ_CODI] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[TMPFICHPRED](
	[fpre_codi] [nvarchar](7) NOT NULL,
	[fpre_rutcli] [nvarchar](9) NULL,
	[fpre_horades] [nvarchar](5) NULL,
	[fpre_horater] [nvarchar](5) NULL,
	[fpre_fecdes] [nvarchar](10) NULL,
	[fpre_totsopo] [int] NULL,
	[fpre_totunidad] [int] NULL,
	[fpre_totpeso] [float] NULL,
	[fpre_rutcond] [nvarchar](9) NULL,
	[fpre_codienca] [nvarchar](3) NULL,
	[fpre_activa] [nvarchar](1) NULL,
	[fpre_fechact] [nvarchar](10) NULL,
	[fpre_codvig] [nvarchar](1) NULL,
	[fpre_gdespa] [nvarchar](7) NULL,
	[fpre_radio] [nvarchar](1) NULL,
	[fpre_tipo] [int] NULL,
	[fpre_proceso] [int] NULL,
	[fpre_sello] [varchar](50) NULL,
	[fpre_tem] [real] NULL,
	[fpre_anden] [nvarchar](10) NULL,
	[FPRE_USUCRE] [nvarchar](6) NULL,
	[EST_CODI] [int] NULL,
	[FPRE_PALLET] [nvarchar](18) NULL,
	[fpre_TS] [real] NULL,
	[fpre_TM] [real] NULL,
	[fpre_TI] [real] NULL,
	[fpre_nped] [numeric](18, 0) NULL,
	[FPRE_ETIQ] [nvarchar](1) NULL,
	[estc_olor] [nchar](10) NULL,
	[estc_hig] [nchar](10) NULL,
	[estc_cond] [nchar](10) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPFICHRECE](
	[frec_codi] [nvarchar](7) NOT NULL,
	[frec_rutcli] [nvarchar](9) NOT NULL,
	[frec_rutproductor] [varchar](12) NOT NULL,
	[frec_contcli] [nvarchar](7) NOT NULL,
	[frec_horalleg] [nvarchar](5) NOT NULL,
	[frec_horarec] [nvarchar](5) NOT NULL,
	[frec_horater] [nvarchar](5) NOT NULL,
	[frec_turnrec] [nvarchar](1) NOT NULL,
	[frec_fecproc] [nvarchar](10) NOT NULL,
	[frec_fecrec] [nvarchar](10) NOT NULL,
	[frec_guiades] [nvarchar](8) NOT NULL,
	[frec_tipentr] [nvarchar](2) NOT NULL,
	[frec_totsopo] [int] NOT NULL,
	[frec_totunidad] [int] NOT NULL,
	[frec_totpeso] [float] NOT NULL,
	[frec_temppro] [real] NULL,
	[frec_rutcond] [nvarchar](9) NOT NULL,
	[frec_observ] [nvarchar](250) NOT NULL,
	[frec_tipdesc] [nvarchar](1) NOT NULL,
	[frec_codienca] [nvarchar](3) NOT NULL,
	[frec_origen] [nvarchar](2) NOT NULL,
	[frec_codvig] [nvarchar](1) NOT NULL,
	[frec_radio] [nvarchar](1) NOT NULL,
	[frec_tipo] [int] NULL,
	[frec_RecepTunel] [int] NULL,
	[frec_AspectoSanitario] [nvarchar](15) NOT NULL,
	[frec_CondGeneral] [int] NULL,
	[frec_procedencia] [char](10) NULL,
	[frec_TS] [real] NULL,
	[frec_TM] [real] NULL,
	[frec_TI] [real] NULL,
	[Est_Codi] [int] NOT NULL,
	[frec_FecCre] [datetime] NOT NULL,
	[frec_UsuCre] [nvarchar](3) NOT NULL,
	[frec_FecMod] [datetime] NOT NULL,
	[FREC_NUMSELLO] [nvarchar](25) NULL,
	[frec_tipoalmacenamiento] [varchar](50) NULL,
	[frec_clfol] [nvarchar](7) NULL,
	[frec_contenedor] [nvarchar](20) NULL,
	[frec_antecamara] [nvarchar](2) NULL,
	[frec_olores] [nvarchar](2) NULL,
	[frec_higiene] [nvarchar](2) NULL,
	[frec_estiba] [nvarchar](2) NULL,
	[frec_daado] [nvarchar](2) NULL,
	[frec_codigo] [nvarchar](7) NULL,
	[frec_abierto] [int] NULL,
	[frec_tablet] [int] NULL,
 CONSTRAINT [PK_TMPFICHRECE] PRIMARY KEY CLUSTERED 
(
	[frec_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPFICHRECECASO](
	[frec_codi] [nvarchar](7) NOT NULL,
	[frec_rutcli] [nvarchar](9) NOT NULL,
	[frec_rutproductor] [varchar](12) NOT NULL,
	[frec_contcli] [nvarchar](7) NOT NULL,
	[frec_horalleg] [nvarchar](5) NOT NULL,
	[frec_horarec] [nvarchar](5) NOT NULL,
	[frec_horater] [nvarchar](5) NOT NULL,
	[frec_turnrec] [nvarchar](1) NOT NULL,
	[frec_fecproc] [nvarchar](10) NOT NULL,
	[frec_fecrec] [nvarchar](10) NOT NULL,
	[frec_guiades] [nvarchar](8) NOT NULL,
	[frec_tipentr] [nvarchar](2) NOT NULL,
	[frec_totsopo] [int] NOT NULL,
	[frec_totunidad] [int] NOT NULL,
	[frec_totpeso] [float] NOT NULL,
	[frec_temppro] [real] NULL,
	[frec_rutcond] [nvarchar](9) NOT NULL,
	[frec_observ] [nvarchar](50) NOT NULL,
	[frec_tipdesc] [nvarchar](1) NOT NULL,
	[frec_codienca] [nvarchar](3) NOT NULL,
	[frec_origen] [nvarchar](2) NOT NULL,
	[frec_codvig] [nvarchar](1) NOT NULL,
	[frec_radio] [nvarchar](1) NOT NULL,
	[frec_tipo] [int] NULL,
	[frec_RecepTunel] [int] NULL,
	[frec_AspectoSanitario] [nvarchar](15) NOT NULL,
	[frec_CondGeneral] [int] NOT NULL,
	[frec_procedencia] [char](10) NULL,
	[frec_TS] [real] NULL,
	[frec_TM] [real] NULL,
	[frec_TI] [real] NULL,
	[Est_Codi] [int] NOT NULL,
	[frec_FecCre] [datetime] NOT NULL,
	[frec_UsuCre] [nvarchar](3) NOT NULL,
	[frec_FecMod] [datetime] NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TMPTARIFASCLIENTES](
	[TAR_RUTCLI] [nvarchar](10) NULL,
	[TAR_NOMCLI] [nvarchar](50) NULL,
	[TAR_CODCONT] [nvarchar](50) NULL,
	[TAR_CONTRATO] [nvarchar](50) NULL,
	[TAR_CODSERV] [nvarchar](50) NULL,
	[TAR_SERVICIO] [nvarchar](50) NULL,
	[TAR_VALOR] [float] NULL,
	[TAR_MONEDA] [nvarchar](15) NULL,
	[TAR_TOTAL] [float] NULL,
	[TAR_TRAMNOMB] [nvarchar](10) NULL,
	[TAR_TRAMDESDE] [int] NULL,
	[TAR_TRAMHASTA] [int] NULL,
	[TAR_TRAMVAL] [real] NULL,
	[TAR_MEDIDA] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[TRACKEOCAJAS](
	[TRACK_CODI] [nvarchar](12) NULL,
	[TRACK_CODCAJA] [nvarchar](65) NULL,
	[TRACK_FECHAHORA] [nvarchar](19) NULL,
	[TRACK_USUARIO] [nvarchar](3) NULL,
	[TRACK_CODVIG] [nvarchar](1) NULL,
	[TRACK_PREDESPACHO] [nvarchar](24) NULL,
	[TRACK_CAJA] [numeric](18, 0) NULL,
	[TRACK_LECTURA] [nvarchar](200) NULL,
	[TRACK_CAJACLIENTE] [nvarchar](20) NULL,
	[TRACK_DUN14] [nvarchar](14) NULL,
	[track_drec_codi] [nvarchar](12) NULL
) ON [PRIMARY]

GO
SET ANSI_NULLS OFF
GO

GO

GO
CREATE TABLE [dbo].[TRAMO](
	[TRAMCOD] [int] NOT NULL,
	[ESCCOD] [int] NOT NULL,
	[TRAMNOMB] [varchar](30) NOT NULL,
	[TRAMDESDE] [int] NOT NULL,
	[TRAMHASTA] [int] NOT NULL,
	[TRAMVAL] [real] NOT NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Transportes](
	[tra_codigo] [varchar](9) NULL,
	[tra_rut] [varchar](13) NULL,
	[tra_razon] [varchar](50) NULL,
	[tra_representante] [varchar](50) NULL,
	[tra_direccion] [varchar](50) NULL,
	[tra_fonofax] [varchar](50) NULL,
	[tra_mail] [varchar](50) NULL,
	[tra_rutrepresentante] [varchar](50) NULL,
	[tra_fantasia] [varchar](50) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[TraspasoContratos](
	[tra_numero] [int] NOT NULL,
	[tra_recepcion] [varchar](7) NULL,
	[tra_despacho] [varchar](7) NULL,
	[tra_fecha] [datetime] NULL,
	[tra_hora] [nvarchar](8) NULL,
	[tra_pc] [varchar](50) NULL,
	[tra_pcusuario] [varchar](50) NULL,
	[tra_usuario] [varchar](3) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[TUNEL_AVISOS_SADEMA](
	[PROCESO] [nvarchar](10) NULL,
	[TUNEL] [numeric](18, 0) NULL,
	[FECHA] [nvarchar](10) NULL,
	[HORA] [nvarchar](5) NULL,
	[OBSERVACION] [ntext] NULL,
	[FECHAAVISO] [nvarchar](16) NULL,
	[FECHAINICIO] [nvarchar](16) NULL,
	[FECHATERMINO] [nvarchar](16) NULL,
	[MINUTOSANTES] [numeric](18, 0) NULL CONSTRAINT [DF_TUNEL_AVISOS_SADEMA_MINUTOSANTES]  DEFAULT (20),
	[TEMPORIZADOR] [numeric](18, 0) NULL CONSTRAINT [DF_TUNEL_AVISOS_SADEMA_TEMPORIZADOR]  DEFAULT (5),
	[ESTADO] [bit] NULL CONSTRAINT [DF_TUNEL_AVISOS_SADEMA_ESTADO]  DEFAULT (0)
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[TUNEL_HORAS_CONGELADO](
	[FAMILIA] [nvarchar](3) NULL,
	[T1] [float] NULL,
	[T2] [float] NULL,
	[T3] [float] NULL,
	[T4] [float] NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[TUNEL_MAIL_PROCESOS](
	[PROCESO] [nvarchar](10) NULL,
	[MAIL] [numeric](18, 0) NULL,
	[TUNEL] [nvarchar](2) NULL,
	[USUARIO] [nvarchar](3) NULL,
	[PC] [nvarchar](20) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[tuneles](
	[idTunel] [bigint] IDENTITY(1,1) NOT NULL,
	[frec_guia] [nvarchar](7) NOT NULL,
	[frec_codi] [varchar](20) NOT NULL,
	[fechora_ingreso] [datetime] NOT NULL,
	[temp_ingreso] [real] NULL,
	[fechora_salida] [datetime] NULL,
	[temp_salida] [real] NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[usuario](
	[unica] [uniqueidentifier] ROWGUIDCOL  NOT NULL CONSTRAINT [DF_usuario_unica]  DEFAULT (newid()),
	[codigo] [nvarchar](8) NOT NULL,
	[passwd] [nvarchar](20) NULL,
	[descri] [nvarchar](35) NULL,
	[personal] [nvarchar](3) NULL,
	[acceso] [tinyint] NULL,
	[accesof] [tinyint] NULL,
	[radio] [int] NULL CONSTRAINT [DF_usuario_radio]  DEFAULT ((-1)),
	[CodVig] [nvarchar](1) NULL CONSTRAINT [DF_usuario_CodVig]  DEFAULT (0),
	[modificacionPass] [varchar](50) NULL,
 CONSTRAINT [PK_usuario] PRIMARY KEY NONCLUSTERED 
(
	[unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[Usuarios](
	[usu_codigo] [nvarchar](3) NOT NULL,
	[usu_rut] [nvarchar](9) NULL,
	[usu_nombre] [nvarchar](40) NULL,
	[usu_ap] [varchar](25) NULL,
	[usu_am] [nvarchar](25) NULL,
	[usu_email] [nvarchar](150) NULL,
	[usu_anexo] [nvarchar](4) NULL,
	[usu_teleme] [numeric](18, 0) NULL,
	[usu_usuario] [nvarchar](20) NULL,
	[usu_pass] [nvarchar](100) NULL,
	[usu_pass2] [varchar](50) NULL,
	[usu_passweb] [varchar](80) NULL,
	[radio] [nvarchar](1) NULL,
	[personal] [nvarchar](3) NULL,
	[descri] [nvarchar](150) NOT NULL,
	[usu_codvig] [nvarchar](1) NOT NULL,
	[Usu_SecCod] [numeric](18, 0) NULL,
	[cl_imgtemS] [image] NULL,
	[des_bodega] [nvarchar](max) NULL,
 CONSTRAINT [PK_Usuarios] PRIMARY KEY CLUSTERED 
(
	[usu_codigo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[USUARIOS_GLOBAL](
	[RUT] [varchar](255) NULL,
	[NOMBRE] [varchar](255) NULL,
	[EMAIL] [varchar](255) NULL,
	[CARGO] [varchar](255) NULL,
	[ANEXO] [varchar](255) NULL,
	[TELEFONO] [varchar](255) NULL,
	[LOGIN] [varchar](255) NULL,
	[PASSWORD] [varchar](255) NULL,
	[ACCESO] [varchar](255) NULL,
	[personal] [varchar](10) NULL,
	[radio] [int] NULL CONSTRAINT [DF_USUARIOS_GLOBAL_radio]  DEFAULT ((-1)),
	[CodVig] [nvarchar](1) NULL CONSTRAINT [DF_USUARIOS_GLOBAL_CodVig]  DEFAULT (0),
	[NOMBRE_PERFIL] [varchar](250) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[USUARIOS_GLOBAL1](
	[RUT] [varchar](255) NULL,
	[NOMBRE] [varchar](255) NULL,
	[EMAIL] [varchar](255) NULL,
	[CARGO] [varchar](255) NULL,
	[ANEXO] [varchar](255) NULL,
	[TELEFONO] [varchar](255) NULL,
	[LOGIN] [varchar](255) NULL,
	[PASSWORD] [varchar](255) NULL,
	[ACCESO] [varchar](255) NULL,
	[personal] [varchar](10) NULL,
	[radio] [int] NULL,
	[CodVig] [nvarchar](1) NULL,
	[NOMBRE_PERFIL] [varchar](250) NULL,
	[ModificacionPass] [varchar](8) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[USUARIOS_MENU_GLOBAL](
	[IDUSUARIO] [varchar](255) NULL,
	[FORMULARIO] [varchar](255) NULL,
	[ESTADO] [bit] NULL,
	[ATRIBUTOS] [varchar](255) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[USUARIOS_MENU_GLOBAL1](
	[IDUSUARIO] [varchar](255) NULL,
	[FORMULARIO] [varchar](255) NULL,
	[ESTADO] [bit] NULL,
	[ATRIBUTOS] [varchar](255) NULL
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[UsuariosFunciones](
	[Usu_Rut] [nvarchar](9) NOT NULL,
	[Usu_SprivId] [nvarchar](3) NOT NULL,
	[Usu_Fnc] [nvarchar](100) NULL,
 CONSTRAINT [PK_UsuariosFunciones] PRIMARY KEY CLUSTERED 
(
	[Usu_Rut] ASC,
	[Usu_SprivId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[usuimg](
	[ID] [nchar](10) NULL,
	[FOTO] [image] NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[WEBpruebaserie](
	[serie] [bigint] NOT NULL CONSTRAINT [DF_WEBpruebaserie_serie]  DEFAULT ((0))
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[webtmpdetarece](
	[drec_codi] [nvarchar](9) NULL,
	[drec_codpro] [nvarchar](7) NULL,
	[drec_codsag] [nvarchar](15) NULL,
	[drec_codsopo] [nvarchar](2) NULL,
	[drec_fecprod] [nvarchar](10) NULL,
	[drec_unidades] [int] NULL,
	[drec_peso] [float] NULL,
	[drec_sopocli] [nvarchar](11) NULL,
	[fechavencimiento] [char](10) NULL,
	[lotecliente] [nvarchar](10) NULL,
	[drec_estado] [nvarchar](50) NULL,
	[codpal] [nvarchar](9) NULL,
	[drec_temp] [float] NULL,
	[bloqueado] [nvarchar](1) NULL,
	[codtpmrece] [int] NULL,
	[drec_etiqueta] [nvarchar](20) NULL,
	[drec_arriendo] [nvarchar](1) NULL CONSTRAINT [DF_webtmpdetarece_drec_arriendo]  DEFAULT ((0))
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[webtmpfichrece](
	[frec_tipoalmacenamiento] [varchar](50) NULL,
	[frec_rutcli] [nvarchar](19) NULL,
	[frec_contcli] [nvarchar](7) NULL,
	[frec_horarec] [nvarchar](5) NULL,
	[frec_horater] [nvarchar](5) NULL,
	[frec_fecrec] [nvarchar](10) NULL,
	[frec_tiporecepcion] [nvarchar](1) NULL,
	[frec_guiades] [nvarchar](8) NULL,
	[frec_clfol] [nvarchar](7) NULL,
	[frec_turnrec] [nvarchar](1) NULL,
	[frec_tipdesc] [nvarchar](1) NULL,
	[frec_origen] [nvarchar](2) NULL,
	[frec_numSello] [nvarchar](25) NULL,
	[frec_observ] [nvarchar](50) NULL,
	[frec_antecamara] [nvarchar](2) NULL,
	[frec_olores] [nvarchar](2) NULL,
	[frec_higiene] [nvarchar](2) NULL,
	[frec_estiba] [nvarchar](2) NULL,
	[frec_daado] [nvarchar](2) NULL,
	[frec_RecepTunel] [int] NULL,
	[frec_abierto] [int] NULL DEFAULT ((0)),
	[frec_contenedor] [nvarchar](20) NULL,
	[frec_codigo] [nvarchar](7) NULL
) ON [PRIMARY]

GO

GO

GO

GO

GO
CREATE TABLE [dbo].[webusuarios](
	[estado] [int] NULL CONSTRAINT [DF_webusuarios_estado]  DEFAULT ((0)),
	[rutclie] [varchar](50) NOT NULL,
	[pass] [nchar](10) NULL,
	[horasbloqueo] [int] NULL CONSTRAINT [DF_webusuarios_horasbloqueo]  DEFAULT ((48)),
	[pedidoe] [int] NULL CONSTRAINT [DF_webusuarios_pedidoe]  DEFAULT ((0)),
	[fechahora] [varchar](50) NULL,
	[tipo] [nchar](10) NULL CONSTRAINT [DF_webusuarios_tipo]  DEFAULT ((0)),
	[pedido] [nchar](10) NULL CONSTRAINT [DF_webusuarios_pedido]  DEFAULT ((0)),
	[nivel] [int] NULL CONSTRAINT [DF_webusuarios_nivel]  DEFAULT ((0)),
	[permisos] [nchar](20) NOT NULL CONSTRAINT [DF_webusuarios_permisos]  DEFAULT ('0000000000'),
	[nomusu] [varchar](50) NULL,
	[codfor] [varchar](18) NULL,
	[rutusu] [nchar](9) NULL,
 CONSTRAINT [PK_webusuarios] PRIMARY KEY CLUSTERED 
(
	[rutclie] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

GO
CREATE TABLE [dbo].[webusuclie](
	[webclie_horabloqueo] [int] NULL,
	[webclie_permisos] [int] NULL,
	[webclie_nivel] [int] NULL,
	[webclie_rut] [nchar](10) NULL,
	[webclie_pass] [nchar](10) NULL,
	[webclie_usu] [nchar](10) NULL,
	[webclie_id] [int] IDENTITY(1,1) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[webclie_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[xrelacion](
	[unica] [uniqueidentifier] NOT NULL,
	[codigo] [nvarchar](7) NULL,
	[rut] [nvarchar](9) NULL,
 CONSTRAINT [PK_xrelacion] PRIMARY KEY NONCLUSTERED 
(
	[unica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[ycubica](
	[cunica] [uniqueidentifier] NOT NULL CONSTRAINT [DF_ycubica_cunica]  DEFAULT (newid()),
	[crutcli] [nvarchar](9) NULL,
	[cnclie] [nvarchar](40) NULL,
	[ccodi] [nvarchar](7) NULL,
	[cenva] [nvarchar](5) NULL,
	[cdescri] [nvarchar](50) NULL,
	[calto] [float] NULL,
	[cancho] [float] NULL,
	[cfondo] [float] NULL,
	[cbase] [int] NULL,
	[caltura] [int] NULL,
 CONSTRAINT [PK_ycubica] PRIMARY KEY NONCLUSTERED 
(
	[cunica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[yrelacion](
	[yunica] [uniqueidentifier] NOT NULL,
	[yrutcli] [nvarchar](9) NULL,
	[ycodi] [nvarchar](7) NULL,
	[yenva] [nvarchar](5) NULL,
	[ydescri] [nvarchar](50) NULL,
	[yalto] [float] NULL,
	[yancho] [float] NULL,
	[yfondo] [float] NULL,
	[ybase] [int] NULL,
	[yaltura] [int] NULL,
 CONSTRAINT [PK_yrelacion] PRIMARY KEY NONCLUSTERED 
(
	[yunica] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[zCheckList](
	[Cl_fol] [nvarchar](7) NOT NULL,
	[Cl_RutCli] [nvarchar](9) NULL,
	[Cl_chorut] [nvarchar](9) NULL,
	[Cl_ChoEmp] [nvarchar](40) NULL,
	[Cl_Tur] [numeric](18, 0) NULL,
	[Cl_Ting] [nvarchar](10) NULL,
	[Cl_Sellocli] [nvarchar](20) NULL,
	[Cl_Cont] [numeric](18, 0) NULL,
	[Cl_Ori] [nvarchar](30) NULL,
	[Cl_Gs] [nvarchar](3) NULL,
	[Cl_Mov] [numeric](18, 0) NULL,
	[Cl_fec] [date] NULL,
	[Cl_ingGuia] [nvarchar](20) NULL,
	[Cl_IngSopo] [nvarchar](50) NULL,
	[Cl_DesSopo] [nvarchar](50) NULL,
	[Cl_DesTemp] [nvarchar](10) NULL,
	[Cl_DesSello] [nvarchar](50) NULL,
	[Cl_pate] [nvarchar](10) NULL,
	[Cl_Ram] [nvarchar](20) NULL,
	[Cl_EstPor] [numeric](18, 0) NULL,
	[Cl_Estfrigo] [numeric](18, 0) NULL,
	[Cl_Lleg] [datetime] NULL,
	[Cl_CargContenedor] [datetime] NULL,
	[Cl_ing] [datetime] NULL,
	[Cl_Des] [datetime] NULL,
	[Cl_Obs] [nvarchar](500) NULL,
	[Cl_salGuia] [nvarchar](20) NULL,
	[Cl_ModUsu] [numeric](18, 0) NULL,
	[Cl_ModFecha] [date] NULL,
	[Cl_Anden] [nvarchar](30) NULL,
	[Cl_Conectado] [numeric](18, 0) NULL,
	[Cl_Tablet] [numeric](18, 0) NULL,
	[Cl_Enviada] [numeric](18, 0) NULL,
	[cod_bod] [nchar](10) NULL,
 CONSTRAINT [PK_zCheckList] PRIMARY KEY CLUSTERED 
(
	[Cl_fol] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[zcontenedores](
	[Con_codi] [numeric](18, 0) NULL,
	[Con_desc] [nvarchar](50) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[zMovimientos](
	[mov_codi] [numeric](18, 0) NOT NULL,
	[Mov_desc] [nvarchar](30) NULL,
 CONSTRAINT [PK_zMovimientos] PRIMARY KEY CLUSTERED 
(
	[mov_codi] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[zOpcionCb](
	[op_cod] [nchar](10) NOT NULL,
	[op_desc] [nchar](10) NULL,
 CONSTRAINT [PK_zOpcionCb] PRIMARY KEY CLUSTERED 
(
	[op_cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[zTurno](
	[Tur_id] [numeric](18, 0) NULL,
	[Tur_desc] [nvarchar](20) NULL
) ON [PRIMARY]

GO

GO

GO
CREATE TABLE [dbo].[zusuario](
	[usu_cod] [numeric](18, 0) NOT NULL,
	[usu_nom] [nvarchar](20) NULL,
	[usu_usu] [nvarchar](15) NOT NULL,
	[usu_pass] [nvarchar](10) NULL,
	[usu_priv] [numeric](18, 0) NULL,
 CONSTRAINT [PK_zusuario] PRIMARY KEY CLUSTERED 
(
	[usu_cod] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

GO

GO

CREATE PROCEDURE [dbo].[APA_LISTARPEDIDOS] 
	(
	@terminado int
	) 
AS
	SELECT pedido, Orden, cliente+ '  '+ cli_nomb AS cliente, fecha, hora, destino, 
	(SELECT COUNT(*) FROM Pedidos_Detalle AS pd WHERE pf.pedido=pd.pedido AND pd.est='1') AS de,
	(SELECT COUNT(*) FROM Pedidos_Detalle AS pd WHERE pf.pedido=pd.pedido) AS to2, destino, encargado 
	FROM pedidos_ficha AS pf, clientes 
	WHERE cli_rut=cliente AND terminado=@terminado ORDER BY orden DESC

 RETURN

GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[BORRAR]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0

    DECLARE @TOTTRAMO AS INT
    DECLARE @ESCCOD AS INT
    DECLARE @TOTDIAS AS INT


 IF @IDENT = 0
 BEGIN

    DECLARE @TABLA VARCHAR(30)
    SET @TABLA = 'TMPSERV_MINTUNEL'

    BEGIN TRAN
        DECLARE @CODI AS INT
        SET @CODI = 0

        SELECT @CODI = CODIGO + 1 FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))
        IF @CODI > 0
        BEGIN

            UPDATE CORRTABLAS
            SET CODIGO = @CODI
            WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))

        END
        ELSE
            BEGIN
                ROLLBACK TRAN
                SET @CODI = -1
            END
    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
	SET @CODI = 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
	SET @IDENT = @CODI
    END
 END 

    SELECT @TOTTRAMO = ESCALASERV.TOTTRAMAS
        , @ESCCOD = ESCALASERV.ESCCOD
    FROM ESCALASERV
    WHERE ESCALASERV.ESCCONTR = @CONTR
        AND ESCALASERV.ESCSERV = '15'

    DECLARE CURPALLET CURSOR FOR
	    SELECT CONTRATO.CONT_CODI
	    FROM CONTRATO INNER JOIN CONTRPARA
	        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
	        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
	         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
	         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
	    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
	        AND CONTRPARA.CPAR_SERVI = '15'
	        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
	        AND ESCALASERV.ESCSERV = '15'
	     --   AND CONTRPARA.CPAR_MARCA = '1'
    OPEN CURPALLET
    FETCH NEXT FROM CURPALLET INTO @CONTR
    WHILE @@FETCH_STATUS = 0
    BEGIN

	EXEC PA_NUMERALES @FECINI, @FECFIN, @RUTCLI, @CONTR, @IDENT

        FETCH NEXT FROM CURPALLET INTO @CONTR
    END
    CLOSE CURPALLET
    DEALLOCATE CURPALLET

    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)


    --DROP TABLE #CONTRATOS
    SELECT CONTRPARA.CPAR_CONTR, ESCALASERV.ESCCOD, 0 AS CONT  --CONTRATO.CONT_CODI,
        , CONTRATO.CONT_DIAGRACIA
        , (CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG-1 END) AS CONT_TUNELG
        , CONTRATO.CONT_DESCR
            , CONTRATO.CONT_DIACONT, CONTRATO.CONT_PALLET
            , 0 AS CPAR_VALOR
         , MONEDAS.MON_DESCR, MONEDAS.MON_VALOR
         , MEDIDAS.MED_DESCR
        , 0 AS STOCK
        , 0 AS UNIDADES
        , 0 AS TONELADAS
    INTO #CONTRATOS
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND CONTRPARA.CPAR_SERVI = '15'
        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
        AND ESCALASERV.ESCSERV = '15'
 --       AND CONTRPARA.CPAR_MARCA = '1'

    DECLARE @COD VARCHAR(7)
    DECLARE @DESDE VARCHAR(7)
    DECLARE @HASTA VARCHAR(10)
    DECLARE @VAL VARCHAR(7)

    DECLARE CURTRAMA CURSOR FOR SELECT TRAMCOD, TRAMDESDE, TRAMHASTA, TRAMVAL FROM TRAMO WHERE ESCCOD = @ESCCOD
    OPEN CURTRAMA
    FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    WHILE @@FETCH_STATUS = 0
    BEGIN

        UPDATE #CONTRATOS
        SET CONT = CONT+1
--        SELECT *
        FROM #CONTRATOS INNER JOIN TRAMO
            ON #CONTRATOS.ESCCOD = TRAMO.ESCCOD
        --WHERE TRAMO.TRAMCOD = TRAMCOD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL
        WHERE TRAMO.TRAMCOD = @COD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL

        FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    END
    CLOSE CURTRAMA
    DEALLOCATE CURTRAMA

    --DROP TABLE #CONTR
    SELECT * INTO #CONTR FROM #CONTRATOS WHERE CONT = @TOTTRAMO

    --DROP TABLE #RESUMEN
    SELECT distinct TMPDETSERVICIOS.CONTRATO AS CONTR
        , (SUM(FACTURAR) * #CONTR.CPAR_VALOR) AS VALNETO
              , SUM(CT) AS TOTCT
        , SUM(ST) AS TOTST
              , SUM(DP) AS TOTDP
        , SUM(TMPDETSERVICIOS.STOCK) AS TOTSTOCK
        , SUM(TMPDETSERVICIOS.FACTURAR) AS TOTSOP
              , SUM(TMPDETSERVICIOS.UNIDADES) AS TOTUNI
        , SUM(TMPDETSERVICIOS.TONELADAS) AS TOTTONE
        , #CONTR.MON_DESCR AS MONDESC
        , #CONTR.MON_VALOR as MONVAL
             , #CONTR.MED_DESCR AS MEDDESC
        , #CONTR.CONT_DESCR AS CONTRDESC
    INTO #RESUMEN
    FROM TMPDETSERVICIOS
        INNER JOIN #CONTR
            ON TMPDETSERVICIOS.CONTRATO = #CONTR.CPAR_CONTR COLLATE SQL_Latin1_General_CP1_CI_AS
        INNER JOIN ESCALASERV
            ON #CONTR.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS
            AND '15' = ESCALASERV.ESCSERV
    WHERE IDENT = @IDENT
    GROUP BY TMPDETSERVICIOS.CONTRATO, #CONTR.CPAR_VALOR, #CONTR.MON_DESCR, #CONTR.MON_VALOR, #CONTR.MED_DESCR, #CONTR.CONT_DESCR

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)

    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
    SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

    DECLARE @TOTALFAC  AS DEC(12,2)
    DECLARE @PROMEDIO  AS DEC(12,2)
    DECLARE @TARIFUNI AS DEC(12,2)
    SET @TOTALFAC = 0
    SET @PROMEDIO = 0
    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

    SELECT @TOTALFAC = SUM(FACTURAR) FROM TMPDETSERVICIOS WHERE IDENT = @IDENT
    SET @PROMEDIO = @TOTALFAC / @TOTDIAS


    SELECT DISTINCT @TARIFUNI = TRAMVAL
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND ESCALASERV.ESCSERV = '15'
        AND @PROMEDIO BETWEEN TRAMDESDE AND TRAMHASTA


    SELECT DISTINCT TMPDETSERVICIOS.CONTRATO AS CONTR
        , CONTRDESC
        , TOTSOP
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 1,2

    SELECT ISNULL(@TOTALFAC, 0) AS TOTALFAC, ISNULL(@PROMEDIO, 0) AS PROMEDIO, ISNULL(@TARIFUNI, 0) AS TARIFUNI, ISNULL((@TOTALFAC*@TARIFUNI), 0) AS TOTAL

    SELECT LINEA, TMPDETSERVICIOS.CONTRATO AS CONTR, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
        , MONDESC
        , MEDDESC
        , CONTRDESC
         , TOTCT, TOTST, TOTDP
         , TOTSTOCK, TOTSOP, TOTUNI, TOTTONE
         , ISNULL(@VALUF, 0) AS VALUF, ISNULL(@VALDOLAR, 0) AS VALDOLAR
         , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
         , @TOTDIAS AS DIASFACT
         , ISNULL(@TOTALFAC, 0) AS TOTALFAC
         , ISNULL(@PROMEDIO, 0) AS PROMEDIO
         , ISNULL(@TARIFUNI, 0) AS TARIFUNI
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 2,1,3
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_ACT_DETAPRED]
  @DPRE_CODI        NVARCHAR(18),
  @DPRE_CODPRO      NVARCHAR(14),
  @DPRE_CODSOPO     NVARCHAR(04),
  @DPRE_SOPOCLI     NVARCHAR(18),
  @DPRE_UNIDADES    INT,
  @DPRE_PESO        FLOAT,
  @DPRE_FECDES      NVARCHAR(20),
  @DPRE_RUTCLI      NVARCHAR(18),
  @DPRE_CONTCLI     NVARCHAR(14),
  @DPRE_FECPROD     NVARCHAR(20),
  @DPRE_CAMARA      NVARCHAR(04),
  @DPRE_BANDA       NVARCHAR(04),
  @DPRE_COLUM       NVARCHAR(04),
  @DPRE_PISO        NVARCHAR(04),
  @DPRE_NIVEL       NVARCHAR(02),
  @DPRE_ALMACEN     TINYINT,
  @DPRE_DCAJA       TINYINT,
  @DPRE_FOLIO       NVARCHAR(18),
  @DPRE_ACTIVA      TINYINT,
  @DPRE_RADIO       TINYINT,
  @DPRE_TRACK       TINYINT,
  @DPRE_CODVIG      NVARCHAR(02),
  @DPRE_PALLET      TINYINT,
  @DPRE_SLOT        NVARCHAR(06),
  @DPRE_TS          REAL,
  @DPRE_TM          REAL,
  @DPRE_TI          REAL,
  @DPRE_CODPER      CHAR(03),
  @DPRE_HORA        VARCHAR(10),
  @DPRE_FECN        NVARCHAR(20)
--  @FOLIO_PALLET     NVARCHAR(18)
AS
  BEGIN

  IF NOT EXISTS ( SELECT   DPRE_CODI
                    FROM   DETAPRED
            WHERE  DPRE_CODI = @DPRE_CODI)

           INSERT INTO DETAPRED
         (DPRE_UNICA,
          DPRE_CODI,
          DPRE_CODPRO,
          DPRE_CODSOPO,
          DPRE_SOPOCLI,
          DPRE_UNIDADES,
          DPRE_PESO,
          DPRE_FECDES,
          DPRE_RUTCLI,
          DPRE_CONTCLI,
          DPRE_FECPROD,
          DPRE_CAMARA,
          DPRE_BANDA,
          DPRE_COLUM,
          DPRE_PISO,
          DPRE_NIVEL,
          DPRE_ALMACEN,
          DPRE_DCAJA,
          DPRE_FOLIO,
          DPRE_ACTIVA,
          DPRE_RADIO,
          DPRE_TRACK,
          DPRE_CODVIG,
          DPRE_PALLET,
          DPRE_SLOT,
          DPRE_TS,
          DPRE_TM,
          DPRE_TI,
          DPRE_CODPER,
          DPRE_HORA,
          DPRE_FECN)
        --  dpre_FOLIO_PALLET)
         VALUES
        ( NEWID(),
              @DPRE_CODI,
          @DPRE_CODPRO,
          @DPRE_CODSOPO,
          @DPRE_SOPOCLI,
          @DPRE_UNIDADES,
          @DPRE_PESO,
          @DPRE_FECDES,
          @DPRE_RUTCLI,
          @DPRE_CONTCLI,
          @DPRE_FECPROD,
          @DPRE_CAMARA,
          @DPRE_BANDA,
          @DPRE_COLUM,
          @DPRE_PISO,
          @DPRE_NIVEL,
          @DPRE_ALMACEN,
          @DPRE_DCAJA,
          @DPRE_FOLIO,
          @DPRE_ACTIVA,
          @DPRE_RADIO,
          @DPRE_TRACK,
          @DPRE_CODVIG,
          @DPRE_PALLET,
          @DPRE_SLOT,
          @DPRE_TS,
          @DPRE_TM,
          @DPRE_TI,
          @DPRE_CODPER,
          @DPRE_HORA,
          @DPRE_FECN)
        --  @FOLIO_PALLET)
END


GO

GO
SET QUOTED_IDENTIFIER OFF
GO
-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA DETARECE
-- Fecha de Creacin: 26-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_DETARECE

*/
CREATE PROCEDURE [dbo].[PA_ACT_DETARECE]
  @DREC_CODI NVARCHAR(9)
, @DREC_CODPRO NVARCHAR(7)
, @DREC_ORIGEN NVARCHAR(2)
, @DREC_CODSOPO NVARCHAR(2)
, @DREC_SOPOCLI NVARCHAR(11)
, @DREC_UNIDADES INT
, @DREC_PESO FLOAT
, @DREC_FECREC NVARCHAR(10)
, @DREC_RUTCLI NVARCHAR(9)
, @DREC_RUTPRODUCTOR VARCHAR(12)
, @DREC_CONTCLI NVARCHAR(7)
, @DREC_FECPROD NVARCHAR(10)
, @DREC_CAMARA NVARCHAR(2)
, @DREC_BANDA NVARCHAR(2)
, @DREC_COLUM NVARCHAR(2)
, @DREC_PISO NVARCHAR(2)
, @DREC_NIVEL NVARCHAR(1)
, @DREC_ALMACEN TINYINT
, @DREC_DCAJA TINYINT
, @DREC_TUNEL TINYINT
, @DREC_CODVIG NVARCHAR(1)
, @DREC_PALLET TINYINT
, @DREC_CODREL NVARCHAR(7)
, @DREC_NROSOPO INT
, @DREC_SLOT NVARCHAR(3)
, @DREC_DTGRACIA NVARCHAR(3)
, @DREC_CODSAG NVARCHAR(15)
, @DREC_TIPO INT
, @FECHAVENCIMIENTO CHAR(10)
, @LOTECLIENTE CHAR(10)
, @DREC_TS REAL
, @DREC_TM REAL
, @DREC_TI REAL
, @DREC_RECEPTUNEL INT
, @DREC_PROCTUNEL INT
, @DREC_TS_TUNEL REAL
, @DREC_TM_TUNEL REAL
, @DREC_TI_TUNEL REAL
, @DREC_CODPER CHAR(3)
, @DREC_HORA VARCHAR(10)
, @DREC_FECHOMO VARCHAR(10)
, @DREC_HORHOMO VARCHAR(10)
, @DREC_AUTHOMO INT
, @DREC_ESTADO VARCHAR(50)
, @DREC_VALOR REAL
, @DREC_MONCODI NVARCHAR(2)
, @DREC_MEDCODI NVARCHAR(3)
AS

        UPDATE DETARECE
        SET DREC_CODPRO = @DREC_CODPRO
          , DREC_ORIGEN = @DREC_ORIGEN
          , DREC_CODSOPO = @DREC_CODSOPO
          , DREC_SOPOCLI = @DREC_SOPOCLI
          , DREC_UNIDADES = @DREC_UNIDADES
          , DREC_PESO = @DREC_PESO
  --        , DREC_FECREC = @DREC_FECREC
 --         , DREC_RUTCLI = @DREC_RUTCLI
  --        , DREC_RUTPRODUCTOR = @DREC_RUTPRODUCTOR
          , DREC_CONTCLI = @DREC_CONTCLI
          , DREC_FECPROD = @DREC_FECPROD
          , DREC_CAMARA = @DREC_CAMARA
          , DREC_BANDA = @DREC_BANDA
          , DREC_COLUM = @DREC_COLUM
          , DREC_PISO = @DREC_PISO
          , DREC_NIVEL = @DREC_NIVEL
          , DREC_ALMACEN = @DREC_ALMACEN
          , DREC_DCAJA = @DREC_DCAJA
          , DREC_TUNEL = @DREC_TUNEL
          , DREC_CODVIG = @DREC_CODVIG
          , DREC_PALLET = @DREC_PALLET
          , DREC_CODREL = @DREC_CODREL
          , DREC_NROSOPO = @DREC_NROSOPO
          , DREC_SLOT = @DREC_SLOT
          , DREC_DTGRACIA = @DREC_DTGRACIA
          , DREC_CODSAG = @DREC_CODSAG
          , DREC_TIPO = @DREC_TIPO
          , FECHAVENCIMIENTO = @FECHAVENCIMIENTO
          , LOTECLIENTE = @LOTECLIENTE
          , DREC_TS = @DREC_TS
          , DREC_TM = @DREC_TM
          , DREC_TI = @DREC_TI
          , DREC_RECEPTUNEL = @DREC_RECEPTUNEL
         -- , DREC_PROCTUNEL = @DREC_PROCTUNEL--
          , DREC_TS_TUNEL = @DREC_TS_TUNEL
          , DREC_TM_TUNEL = @DREC_TM_TUNEL
          , DREC_TI_TUNEL = @DREC_TI_TUNEL
        --  , DREC_CODPER = @DREC_CODPER
       --   , DREC_HORA = @DREC_HORA
      --    , DREC_FECHOMO = @DREC_FECHOMO
      --    , DREC_HORHOMO = @DREC_HORHOMO
          , DREC_AUTHOMO = @DREC_AUTHOMO
          , DREC_ESTADO = @DREC_ESTADO
          , DREC_VALOR = @DREC_VALOR
          , DREC_MONCODI = @DREC_MONCODI 
          , DREC_MEDCODI = @DREC_MEDCODI
        WHERE DREC_CODI =  @DREC_CODI

	Update detadespa
	Set ddes_contcli = @DREC_CONTCLI
	 WHERE DDES_CODRECE =  @DREC_CODI


	Update detapred
	Set dpre_contcli = @DREC_CONTCLI
	 WHERE Dpre_folio =  @DREC_CODI
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA DETCAJAS
-- Fecha de Creacin: 26-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_DETCAJAS
*/
CREATE PROCEDURE [dbo].[PA_ACT_DETCAJAS]
  @DETC_PALLET NVARCHAR(11)
, @DETC_FPROD NVARCHAR(10)
, @DETC_FVENC NVARCHAR(10)
, @DETC_CANTIDAD NVARCHAR(10)
AS

    IF NOT EXISTS (SELECT DETC_PALLET FROM DETCAJAS WHERE DETC_PALLET= DETC_PALLET)

        INSERT INTO DETCAJAS(
          DETC_PALLET, DETC_FPROD, DETC_FVENC, DETC_CANTIDAD)
        VALUES(
          @DETC_PALLET, @DETC_FPROD, @DETC_FVENC, @DETC_CANTIDAD)

    ELSE

        UPDATE DETCAJAS
        SET DETC_FPROD = @DETC_FPROD
              , DETC_FVENC = @DETC_FVENC
              , DETC_CANTIDAD = @DETC_CANTIDAD
        WHERE DETC_PALLET = @DETC_PALLET


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:    ACTUALIZA TABLA CONTRPARA, AL INGRESAR ESCALAS Y TRAMOS

-- Fecha de Creacin:    20-07-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_UPD_ESCALASERV '0002900', '15', 2

*/


CREATE PROCEDURE [dbo].[PA_ACT_ESCALASERV]
  @ESCCONTR VARCHAR(7)
, @ESCSERV VARCHAR(2)
, @TOTTRAMAS INT
AS

    SET NOCOUNT ON

    IF NOT EXISTS (SELECT * FROM CONTRPARA WHERE CPAR_CONTR = @ESCCONTR AND CPAR_SERVI = @ESCSERV)
        INSERT INTO CONTRPARA
            ( CPAR_CONTR, CPAR_SERVI, CPAR_MARCA, CPAR_VALOR, CPAR_MONEDA, CPAR_MEDIDA, CPAR_CODVIG)
        VALUES
            (@ESCCONTR, @ESCSERV, '1', 0, '00', '',0 )
    ELSE
        UPDATE CONTRPARA
        SET CPAR_MARCA = CASE WHEN @TOTTRAMAS > 0 THEN 1 ELSE 0 END
        WHERE CPAR_CONTR = @ESCCONTR
            AND CPAR_SERVI = @ESCSERV

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_ACT_FICHPRED]
@FPRE_CODI    NVARCHAR(14),
@FPRE_CODVIG  NVARCHAR(02)
AS
    UPDATE FICHPRED
    SET    FPRE_CODVIG  = @FPRE_CODVIG
    WHERE  FPRE_CODI    = @FPRE_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA FICHRECE
-- Fecha de Creacin: 26-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_TMPFICHRECE
*/
CREATE PROCEDURE [dbo].[PA_ACT_FICHRECE]
  @FREC_CODI NVARCHAR(7)
, @FREC_RUTCLI NVARCHAR(9)
, @FREC_RUTPRODUCTOR VARCHAR(12)
, @FREC_CONTCLI NVARCHAR(7)
, @FREC_HORALLEG NVARCHAR(5)
, @FREC_HORAREC NVARCHAR(5)
, @FREC_HORATER NVARCHAR(5)
, @FREC_TURNREC NVARCHAR(1)
, @FREC_FECPROC NVARCHAR(10)
, @FREC_FECREC NVARCHAR(10)
, @FREC_GUIADES NVARCHAR(8)
, @FREC_TIPENTR NVARCHAR(2)
, @FREC_TOTSOPO INT
, @FREC_TOTUNIDAD INT
, @FREC_TOTPESO FLOAT
, @FREC_TEMPPRO REAL
, @FREC_RUTCOND NVARCHAR(9)
, @FREC_OBSERV NVARCHAR(50)
, @FREC_TIPDESC NVARCHAR(1)
, @FREC_CODIENCA NVARCHAR(3)
, @FREC_ORIGEN NVARCHAR(2)
, @FREC_CODVIG NVARCHAR(1)
, @FREC_RADIO NVARCHAR(1)
, @FREC_TIPO INT
, @FREC_RECEPTUNEL INT
, @FREC_ASPECTOSANITARIO NVARCHAR(15)
, @FREC_CONDGENERAL INT
, @FREC_PROCEDENCIA CHAR(10)
AS


        UPDATE FICHRECE
        SET --FREC_RUTCLI = @FREC_RUTCLI
 --         , FREC_RUTPRODUCTOR = @FREC_RUTPRODUCTOR
            FREC_CONTCLI = @FREC_CONTCLI
--          , FREC_HORALLEG = @FREC_HORALLEG
--          , FREC_HORAREC = @FREC_HORAREC
--          , FREC_HORATER = @FREC_HORATER
           , FREC_TURNREC = @FREC_TURNREC
--          , FREC_FECPROC = @FREC_FECPROC
--          , FREC_FECREC = @FREC_FECREC
          , FREC_GUIADES = @FREC_GUIADES
          , FREC_TIPENTR = @FREC_TIPENTR
          , FREC_TOTSOPO = @FREC_TOTSOPO
          , FREC_TOTUNIDAD = @FREC_TOTUNIDAD
          , FREC_TOTPESO = @FREC_TOTPESO
          , FREC_TEMPPRO = @FREC_TEMPPRO
          , FREC_RUTCOND = @FREC_RUTCOND
          , FREC_OBSERV = @FREC_OBSERV
          , FREC_TIPDESC = @FREC_TIPDESC
      --    , FREC_CODIENCA = @FREC_CODIENCA
          , FREC_ORIGEN = @FREC_ORIGEN
          , FREC_CODVIG = @FREC_CODVIG
          , FREC_RADIO = @FREC_RADIO
          , FREC_TIPO = @FREC_TIPO
          , FREC_RECEPTUNEL = @FREC_RECEPTUNEL
          , FREC_ASPECTOSANITARIO = @FREC_ASPECTOSANITARIO
          , FREC_CONDGENERAL = @FREC_CONDGENERAL
          , FREC_PROCEDENCIA = @FREC_PROCEDENCIA
        --  , EST_CODI = @EST_CODI
        WHERE FREC_CODI = @FREC_CODI

             UPDATE detaRECE SET drec_CONTCLI = @FREC_CONTCLI 
	WHERE substring(DREC_CODI,1,7) =   @fREC_CODI

	Update detadespa
	Set ddes_contcli =  @FREC_CONTCLI 
	 WHERE substring(DDES_CODRECE,1,7) =  @fREC_CODI

	Update detapred
	Set dpre_contcli = @FREC_CONTCLI 
	 WHERE substring(Dpre_folio,1,7) =  @fREC_CODI
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA FICHTUNEL
-- Fecha de Creacin: 13-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_FICHTUNEL

*/
CREATE PROCEDURE [dbo].[PA_ACT_FICHTUNEL]
  @FTUN_CODI NVARCHAR(7)
, @FTUN_RUTCLI NVARCHAR(9)
, @FTUN_CONTCLI NVARCHAR(7)
, @FTUN_HORALLEG NVARCHAR(5)
, @FTUN_HORAREC NVARCHAR(5)
, @FTUN_HORATER NVARCHAR(5)
, @FTUN_TURNREC NVARCHAR(1)
, @FTUN_FECPROC NVARCHAR(10)
, @FTUN_FECREC NVARCHAR(10)
, @FTUN_GUIADES NVARCHAR(8)
, @FTUN_TIPENTR NVARCHAR(2)
, @FTUN_TOTSOPO INT
, @FTUN_TOTUNIDAD INT
, @FTUN_TOTPESO FLOAT
, @FTUN_CTOTSOPO INT
, @FTUN_CTOTUNIDAD INT
, @FTUN_CTOTPESO FLOAT
, @FTUN_ETOTSOPO INT
, @FTUN_ETOTUNIDAD INT
, @FTUN_ETOTPESO FLOAT
, @FTUN_TEMPPRO REAL
, @FTUN_TEMPSAL REAL
, @FTUN_RUTCOND NVARCHAR(9)
, @FTUN_OBSERV NVARCHAR(50)
, @FTUN_TIPDESC NVARCHAR(1)
, @FTUN_CODIENCA NVARCHAR(3)
, @FTUN_CODVIG NVARCHAR(1)
AS

    IF NOT EXISTS (SELECT FTUN_CODI FROM FICHTUNEL WHERE FTUN_CODI = @FTUN_CODI)

        INSERT INTO FICHTUNEL(
            FTUN_CODI, FTUN_RUTCLI, FTUN_CONTCLI, FTUN_HORALLEG, FTUN_HORAREC, FTUN_HORATER, FTUN_TURNREC
           , FTUN_FECPROC, FTUN_FECREC, FTUN_GUIADES, FTUN_TIPENTR, FTUN_TOTSOPO, FTUN_TOTUNIDAD, FTUN_TOTPESO
           , FTUN_CTOTSOPO, FTUN_CTOTUNIDAD, FTUN_CTOTPESO, FTUN_ETOTSOPO, FTUN_ETOTUNIDAD, FTUN_ETOTPESO
           , FTUN_TEMPPRO, FTUN_TEMPSAL, FTUN_RUTCOND, FTUN_OBSERV, FTUN_TIPDESC, FTUN_CODIENCA, FTUN_CODVIG)
        VALUES(
            @FTUN_CODI, @FTUN_RUTCLI, @FTUN_CONTCLI, @FTUN_HORALLEG, @FTUN_HORAREC, @FTUN_HORATER,
@FTUN_TURNREC
           , @FTUN_FECPROC, @FTUN_FECREC, @FTUN_GUIADES, @FTUN_TIPENTR, @FTUN_TOTSOPO, @FTUN_TOTUNIDAD,
@FTUN_TOTPESO
           , @FTUN_CTOTSOPO, @FTUN_CTOTUNIDAD, @FTUN_CTOTPESO, @FTUN_ETOTSOPO, @FTUN_ETOTUNIDAD, @FTUN_ETOTPESO
           , @FTUN_TEMPPRO, @FTUN_TEMPSAL, @FTUN_RUTCOND, @FTUN_OBSERV, @FTUN_TIPDESC, @FTUN_CODIENCA,
@FTUN_CODVIG)

    ELSE

        UPDATE FICHTUNEL
        SET FTUN_RUTCLI = @FTUN_RUTCLI
          , FTUN_CONTCLI = @FTUN_CONTCLI
--          , FTUN_HORALLEG = @FTUN_HORALLEG
--          , FTUN_HORAREC = @FTUN_HORAREC
--          , FTUN_HORATER = @FTUN_HORATER
          , FTUN_TURNREC = @FTUN_TURNREC
--          , FTUN_FECPROC = @FTUN_FECPROC
          , FTUN_FECREC = @FTUN_FECREC
          , FTUN_GUIADES = @FTUN_GUIADES
          , FTUN_TIPENTR = @FTUN_TIPENTR
          , FTUN_TOTSOPO = @FTUN_TOTSOPO
          , FTUN_TOTUNIDAD = @FTUN_TOTUNIDAD
          , FTUN_TOTPESO = @FTUN_TOTPESO
          , FTUN_CTOTSOPO = @FTUN_CTOTSOPO
          , FTUN_CTOTUNIDAD = @FTUN_CTOTUNIDAD
          , FTUN_CTOTPESO = @FTUN_CTOTPESO
          , FTUN_ETOTSOPO = @FTUN_ETOTSOPO
          , FTUN_ETOTUNIDAD = @FTUN_ETOTUNIDAD
          , FTUN_ETOTPESO = @FTUN_ETOTPESO
          , FTUN_TEMPPRO = @FTUN_TEMPPRO
          , FTUN_TEMPSAL = @FTUN_TEMPSAL
          , FTUN_RUTCOND = @FTUN_RUTCOND
          , FTUN_OBSERV = @FTUN_OBSERV
          , FTUN_TIPDESC = @FTUN_TIPDESC
          , FTUN_CODIENCA = @FTUN_CODIENCA
           , FTUN_CODVIG = @FTUN_CODVIG
        WHERE FTUN_CODI = @FTUN_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA MOVPALLET
-- Fecha de Creacin: 13-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_MOVPALLET
*/
CREATE PROCEDURE [dbo].[PA_ACT_MOVPALLET]
  @MOV_FOLIO NVARCHAR(9)
, @MOV_CODPER NVARCHAR(3)
, @MOV_CA NVARCHAR(2)
, @MOV_BA NVARCHAR(3)
, @MOV_CO NVARCHAR(2)
, @MOV_PI NVARCHAR(2)
, @MOV_NI NVARCHAR(1)
, @MOV_FECHA NVARCHAR(10)
, @MOV_TIPO NVARCHAR(2)
, @MOV_HORA NVARCHAR(10)
, @MOV_TS REAL
, @MOV_TM REAL
, @MOV_TI REAL
, @MOV_DOC NVARCHAR(10)
, @MOV_RECEPTUNEL INT
, @MOV_DESPACHO INT
, @MOV_SALDO INT
, @MOV_DOCDESPA NVARCHAR(9)
, @MOV_CHORUT NVARCHAR(10)
, @MOV_CHONOM NVARCHAR(50)
, @MOV_CHOPAT NVARCHAR(10)
, @MOV_CHOTRA NVARCHAR(50)
, @MOV_ANDEN NVARCHAR(10)
AS

    IF NOT EXISTS (SELECT MOV_FOLIO FROM MOVPALLET WHERE MOV_FOLIO = @MOV_FOLIO AND  MOV_TIPO='EN'  --MOV_FECHA=@MOV_FECHA AND
)

        INSERT INTO MOVPALLET(
             MOV_FOLIO, MOV_CODPER, MOV_CA, MOV_BA, MOV_CO, MOV_PI, MOV_NI, MOV_FECHA, MOV_TIPO
           , MOV_HORA, MOV_TS, MOV_TM, MOV_TI, MOV_DOC, MOV_RECEPTUNEL, MOV_DESPACHO, MOV_SALDO
           , MOV_DOCDESPA, MOV_CHORUT , MOV_CHONOM, MOV_CHOPAT, MOV_CHOTRA, MOV_ANDEN)
        VALUES(
             @MOV_FOLIO, @MOV_CODPER, @MOV_CA, @MOV_BA, @MOV_CO, @MOV_PI, @MOV_NI, RIGHT(@MOV_FECHA,4)+'/'+SUBSTRING(@MOV_FECHA,4,2) +'/'+LEFT(@MOV_FECHA,2), @MOV_TIPO
           , @MOV_HORA, @MOV_TS, @MOV_TM, @MOV_TI, @MOV_DOC, @MOV_RECEPTUNEL, NULL, NULL
           , NULL, @MOV_CHORUT , @MOV_CHONOM, @MOV_CHOPAT, @MOV_CHOTRA, @MOV_ANDEN)

    ELSE

        UPDATE MOVPALLET
        SET MOV_CODPER = @MOV_CODPER
          --, MOV_CA = @MOV_CA
          --, MOV_BA = @MOV_BA
          --, MOV_CO = @MOV_CO
         -- , MOV_PI = @MOV_PI
         -- , MOV_NI = @MOV_NI
          , MOV_TIPO = @MOV_TIPO
          , MOV_TS = @MOV_TS
          , MOV_TM = @MOV_TM
          , MOV_TI = @MOV_TI
          , MOV_DOC = @MOV_DOC
          , MOV_RECEPTUNEL = @MOV_RECEPTUNEL
          , MOV_DESPACHO = @MOV_DESPACHO
          , MOV_SALDO = @MOV_SALDO
          , MOV_DOCDESPA = @MOV_DOCDESPA
          , MOV_CHORUT = @MOV_CHORUT
          , MOV_CHONOM = @MOV_CHONOM
          , MOV_CHOPAT = @MOV_CHOPAT
          , MOV_CHOTRA = @MOV_CHOTRA
          , MOV_ANDEN = @MOV_ANDEN
        WHERE MOV_FOLIO = @MOV_FOLIO
  --  AND MOV_FECHA=@MOV_FECHA
    AND MOV_TIPO='EN'
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_ACT_RACKDETA]
@RACD_CODI           NVARCHAR(18),
@RACD_CA         NVARCHAR(04),
@RACD_BA          NVARCHAR(04),
@RACD_CO         NVARCHAR(04),
@RACD_PI         NVARCHAR(04),
@RACD_NI         NVARCHAR(02),
@RACD_CODPRO         NVARCHAR(14),
@RACD_UNIDADES         INT,
@RACD_PESO         FLOAT,
@RACD_FECPRO         NVARCHAR(20),
@RACD_CORE         TINYINT,
@RACD_CODE         TINYINT,
@FECHAVENCIMIENTO    CHAR(10),
@LOTECLIENTE         CHAR(10),
@RACD_PEDIDO         NVARCHAR(04),
@RACD_PEDIDO_FEC     NVARCHAR(20),
@RACD_PEDIDO_HOR     NVARCHAR(10)
AS
UPDATE RACKDETA
SET   RACD_CA              =    @RACD_CA,
      RACD_BA               =    @RACD_BA,
      RACD_CO              =    @RACD_CO,
      RACD_PI              =    @RACD_PI,
      RACD_NI              =    @RACD_NI,
      RACD_CODPRO      =    @RACD_CODPRO,
      RACD_UNIDADES       =    @RACD_UNIDADES,
      RACD_PESO              =    @RACD_PESO,
      RACD_FECPRO      =    @RACD_FECPRO,
      RACD_CORE              =    @RACD_CORE,
      RACD_CODE              =    @RACD_CODE,
      FECHAVENCIMIENTO    =    @FECHAVENCIMIENTO,
      LOTECLIENTE      =    @LOTECLIENTE,
      RACD_PEDIDO      =    @RACD_PEDIDO,
      RACD_PEDIDO_FEC     =    @RACD_PEDIDO_FEC,
      RACD_PEDIDO_HOR     =    @RACD_PEDIDO_HOR
WHERE RACD_CODI  = @RACD_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_ACT_SLOTDETA]
@SLOD_CODI    NVARCHAR(32),
@SLOD_CODE    TINYINT
AS
   UPDATE SLOTDETA
   SET   SLOD_CODE = @SLOD_CODE
   WHERE SLOD_CODI = @SLOD_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA TMPCHOFERES
-- Fecha de Creacin: 13-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_TMPCHOFERES

*/
CREATE PROCEDURE [dbo].[PA_ACT_TMPCHOFERES]
  @FREC_CODI NVARCHAR(7)
, @CHO_RUT NVARCHAR(9)
, @CHO_RUTCLIE NVARCHAR(9)
, @CHO_NOMBRE NVARCHAR(40)
, @CHO_PATENTE NVARCHAR(10)
, @CHO_EMPRESA NVARCHAR(35)
AS

    IF NOT EXISTS (SELECT FREC_CODI FROM TMPCHOFERES WHERE FREC_CODI = @FREC_CODI)

        INSERT INTO TMPCHOFERES(
            FREC_CODI, CHO_RUT, CHO_RUTCLIE, CHO_NOMBRE, CHO_PATENTE, CHO_EMPRESA)
        VALUES(
            @FREC_CODI, @CHO_RUT, @CHO_RUTCLIE, @CHO_NOMBRE, @CHO_PATENTE, @CHO_EMPRESA)

    ELSE

        UPDATE TMPCHOFERES
        SET FREC_CODI = @FREC_CODI
          , CHO_RUT = @CHO_RUT
          , CHO_RUTCLIE = @CHO_RUTCLIE
          , CHO_NOMBRE = @CHO_NOMBRE
          , CHO_PATENTE = @CHO_PATENTE
          , CHO_EMPRESA = @CHO_EMPRESA
        WHERE FREC_CODI = @FREC_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_ACT_TMPCORREL]
@TMPC_CODI        NVARCHAR,
@TMPC_USUARIO   NVARCHAR,
@TMPC_PERSONAL  SMALLINT,
@TMPC_FECHAINI  NVARCHAR,
@TMPC_HORAINI   NVARCHAR,
@TMPC_FECHATER  NVARCHAR,
@TMPC_HORATER   NVARCHAR,
@TMPC_PROCESO   TINYINT
AS
 BEGIN
      IF NOT EXISTS ( SELECT TMPC_CODI
                  FROM      TMPCORREL
          WHERE  TMPC_CODI = @TMPC_CODI)


           INSERT INTO TMPCORREL
           ( TMPC_UNICA,
                     TMPC_CODI,
             TMPC_USUARIO,
             TMPC_PERSONAL,
             TMPC_FECHAINI,
             TMPC_HORAINI,
             TMPC_FECHATER,
             TMPC_HORATER,
             TMPC_PROCESO)
            VALUES
            (newid(),
                     @TMPC_CODI,
             @TMPC_USUARIO,
             @TMPC_PERSONAL,
             @TMPC_FECHAINI,
             @TMPC_HORAINI,
             @TMPC_FECHATER,
             @TMPC_HORATER,
             @TMPC_PROCESO)
    ELSE
             UPDATE TMPCORREL
              SET TMPC_USUARIO  = @TMPC_USUARIO,
                  TMPC_PERSONAL = @TMPC_PERSONAL,
                  TMPC_FECHAINI = @TMPC_FECHAINI,
                  TMPC_HORAINI  = @TMPC_HORAINI,
                  TMPC_FECHATER = @TMPC_FECHATER,
                  TMPC_HORATER  = @TMPC_HORATER,
                  TMPC_PROCESO  = @TMPC_PROCESO
             WHERE TMPC_CODI    = @TMPC_CODI
   END


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_ACT_TMPDETAPRED]
     @FPRE_CODI        NVARCHAR(7),
            @DPRE_CODI        NVARCHAR(2),
    @DPRE_CODPRO      NVARCHAR(7),
    @DPRE_CODSOPO      NVARCHAR(2),
    @DPRE_SOPOCLI      NVARCHAR(11),
    @DPRE_UNIDADES     INT,
    @DPRE_PESO         FLOAT,
    @DPRE_FECDES       NVARCHAR(10),
    @DPRE_RUTCLI       NVARCHAR(9),
    @DPRE_CONTCLI      NVARCHAR(7),
    @DPRE_FECPROD      NVARCHAR(10),
    @DPRE_CAMARA       NVARCHAR(2),
    @DPRE_BANDA        NVARCHAR(2),
    @DPRE_COLUM        NVARCHAR(2),
    @DPRE_PISO         NVARCHAR(2),
    @DPRE_NIVEL        NVARCHAR(1),
    @DPRE_ALMACEN      TINYINT,
    @DPRE_DCAJA        TINYINT,
    @DPRE_FOLIO        NVARCHAR(9),
    @DPRE_ACTIVA       TINYINT,
    @DPRE_RADIO        TINYINT ,
    @DPRE_TRACK        TINYINT ,
    @DPRE_CODVIG       NVARCHAR(1),
    @DPRE_PALLET       TINYINT,
    @DPRE_SLOT         NVARCHAR(3),
    @DPRE_TS           REAL,
    @DPRE_TM           REAL,
    @DPRE_TI           REAL,
    @DPRE_CODPER       CHAR(3),
    @DPRE_HORA         VARCHAR(10),
    @DPRE_FECN         NVARCHAR(10),
    @DPRE_PTR    INT,
    @DPRE_PICK    INT,
    @DPRE_ACTUNI   INT,
    @DPRE_TOTUNI    INT
--        @DPRE_CORRELATIVO  INT,
--        @DPRE_FOLIO_PALLET NVARCHAR(18)
    AS
           BEGIN
          IF NOT EXISTS ( SELECT DPRE_CODI
                                  FROM      TMPDETAPRED
                  WHERE  FPRE_CODI = @FPRE_CODI AND DPRE_PTR = @DPRE_PTR)
--                                    AND  DPRE_CODI = @DPRE_CODI )

             INSERT INTO TMPDETAPRED
                (FPRE_CODI, DPRE_CODI, DPRE_CODPRO,  DPRE_CODSOPO,    DPRE_SOPOCLI,
                 DPRE_UNIDADES,  DPRE_PESO,    DPRE_FECDES,     DPRE_RUTCLI,
                 DPRE_CONTCLI,   DPRE_FECPROD, DPRE_CAMARA,     DPRE_BANDA,
                      DPRE_COLUM,     DPRE_PISO,    DPRE_NIVEL,      DPRE_ALMACEN,
                     DPRE_DCAJA,     DPRE_FOLIO,   DPRE_ACTIVA,     DPRE_RADIO,
                       DPRE_TRACK,     DPRE_CODVIG,  DPRE_PALLET,     DPRE_SLOT,
                     DPRE_TS,        DPRE_TM,      DPRE_TI,         DPRE_CODPER,
                     DPRE_HORA,      DPRE_FECN, DPRE_PTR, DPRE_PICK, DPRE_ACTUNI, DPRE_TOTUNI)--,    DPRE_CORRELATIVO , DPRE_FOLIO_PALLET)
                  VALUES
                                (@FPRE_CODI, @DPRE_CODI, @DPRE_CODPRO,  @DPRE_CODSOPO,     @DPRE_SOPOCLI,
                 @DPRE_UNIDADES,  @DPRE_PESO,    @DPRE_FECDES,      @DPRE_RUTCLI,
                 @DPRE_CONTCLI,   @DPRE_FECPROD, @DPRE_CAMARA,      @DPRE_BANDA,
                      @DPRE_COLUM,     @DPRE_PISO,    @DPRE_NIVEL,       @DPRE_ALMACEN,
                     @DPRE_DCAJA,     @DPRE_FOLIO,   @DPRE_ACTIVA,      @DPRE_RADIO,
                       @DPRE_TRACK,     @DPRE_CODVIG,  @DPRE_PALLET,      @DPRE_SLOT,
                     @DPRE_TS,        @DPRE_TM,      @DPRE_TI,          @DPRE_CODPER,
                     @DPRE_HORA,      @DPRE_FECN, @DPRE_PTR, @DPRE_PICK, @DPRE_ACTUNI, @DPRE_TOTUNI) --,    @DPRE_CORRELATIVO, @DPRE_FOLIO_PALLET )

            ELSE
                     UPDATE TMPDETAPRED
                 SET   DPRE_CODI            = @DPRE_CODI,
                  DPRE_CODPRO     = @DPRE_CODPRO,
                  DPRE_CODSOPO   = @DPRE_CODSOPO,
                  DPRE_SOPOCLI     = @DPRE_SOPOCLI,
                  DPRE_UNIDADES = @DPRE_UNIDADES,
                  DPRE_PESO         = @DPRE_PESO,
                  DPRE_FECDES    = @DPRE_FECDES,
                  DPRE_RUTCLI     = @DPRE_RUTCLI,
                  DPRE_CONTCLI  = @DPRE_CONTCLI,
                  DPRE_FECPROD = DPRE_FECPROD,
                  DPRE_CAMARA = @DPRE_CAMARA,
                  DPRE_BANDA  = @DPRE_BANDA,
                  DPRE_COLUM    = @DPRE_COLUM,
                  DPRE_PISO         = @DPRE_PISO,
                  DPRE_NIVEL        = @DPRE_NIVEL,
                  DPRE_ALMACEN      = @DPRE_ALMACEN,
                  DPRE_DCAJA        = @DPRE_DCAJA,
                  DPRE_FOLIO        = @DPRE_FOLIO,
                  DPRE_ACTIVA       = @DPRE_ACTIVA,
                  DPRE_RADIO        = @DPRE_RADIO,
                  DPRE_TRACK        = @DPRE_TRACK,
                  DPRE_CODVIG       = @DPRE_CODVIG,
                  DPRE_PALLET       = @DPRE_PALLET,
                  DPRE_SLOT         = @DPRE_SLOT,
                  DPRE_TS           = @DPRE_TS,
                  DPRE_TM           = @DPRE_TM,
                  DPRE_TI           = @DPRE_TI,
                  DPRE_CODPER       = @DPRE_CODPER,
                  DPRE_HORA         = @DPRE_HORA,
                  DPRE_FECN         = @DPRE_FECN,
                  DPRE_PTR = @DPRE_PTR,
                  DPRE_PICK= @DPRE_PICK,
                  DPRE_ACTUNI = @DPRE_ACTUNI,
                  DPRE_TOTUNI = @DPRE_TOTUNI
--                                  DPRE_FOLIO_PALLET = @DPRE_FOLIO_PALLET
                WHERE FPRE_CODI = @FPRE_CODI
                AND  DPRE_PTR = @DPRE_PTR
--                                    AND  DPRE_CODI = @DPRE_CODI
                        END


GO
SET ANSI_NULLS OFF
GO

GO
-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA TMPDETARECE
-- Fecha de Creacin: 12-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_TMPDETARECE
*/
CREATE PROCEDURE [dbo].[PA_ACT_TMPDETARECE]
  @FREC_CODI NVARCHAR(7)
, @DREC_CODI NVARCHAR(2)
, @DREC_CODPRO NVARCHAR(7)
, @DREC_ORIGEN NVARCHAR(2)
, @DREC_CODSOPO NVARCHAR(2)
, @DREC_SOPOCLI NVARCHAR(11)
, @DREC_UNIDADES INT
, @DREC_PESO FLOAT
, @DREC_FECREC NVARCHAR(10)
, @DREC_RUTCLI NVARCHAR(9)
, @DREC_RUTPRODUCTOR VARCHAR(12)
, @DREC_CONTCLI NVARCHAR(7)
, @DREC_FECPROD NVARCHAR(10)
, @DREC_CAMARA NVARCHAR(2)
, @DREC_BANDA NVARCHAR(2)
, @DREC_COLUM NVARCHAR(2)
, @DREC_PISO NVARCHAR(2)
, @DREC_NIVEL NVARCHAR(1)
, @DREC_ALMACEN TINYINT
, @DREC_DCAJA TINYINT
, @DREC_TUNEL TINYINT
, @DREC_CODVIG NVARCHAR(1)
, @DREC_PALLET TINYINT
, @DREC_CODREL NVARCHAR(7)
, @DREC_NROSOPO INT
, @DREC_SLOT NVARCHAR(3)
, @DREC_DTGRACIA NVARCHAR(3)
, @DREC_CODSAG NVARCHAR(10)
, @DREC_TIPO INT
, @FECHAVENCIMIENTO CHAR(10)
, @LOTECLIENTE CHAR(10)
, @DREC_TS REAL
, @DREC_TM REAL
, @DREC_TI REAL
, @DREC_RECEPTUNEL INT
, @DREC_PROCTUNEL INT
, @DREC_TS_TUNEL REAL
, @DREC_TM_TUNEL REAL
, @DREC_TI_TUNEL REAL
, @DREC_CODPER CHAR(3)
, @DREC_HORA VARCHAR(10)
, @DREC_FECHOMO VARCHAR(10)
, @DREC_HORHOMO VARCHAR(10)
, @DREC_AUTHOMO INT
, @DREC_ESTADO VARCHAR(50)
, @DREC_OCUP INT
, @DREC_VALOR REAL
, @DREC_MONCODI NVARCHAR(2)
, @DREC_MEDCODI NVARCHAR(3)
AS

    IF NOT EXISTS (SELECT FREC_CODI FROM TMPDETARECE WHERE FREC_CODI = @FREC_CODI AND DREC_CODI =  @DREC_CODI)

        INSERT INTO TMPDETARECE(
          FREC_CODI, DREC_CODI, DREC_CODPRO, DREC_ORIGEN, DREC_CODSOPO, DREC_SOPOCLI, DREC_UNIDADES, DREC_PESO,
DREC_FECREC
        , DREC_RUTCLI, DREC_RUTPRODUCTOR, DREC_CONTCLI, DREC_FECPROD, DREC_CAMARA, DREC_BANDA, DREC_COLUM,
DREC_PISO
        , DREC_NIVEL, DREC_ALMACEN, DREC_DCAJA, DREC_TUNEL, DREC_CODVIG, DREC_PALLET, DREC_CODREL, DREC_NROSOPO,
DREC_SLOT
        , DREC_DTGRACIA, DREC_CODSAG, DREC_TIPO, FECHAVENCIMIENTO, LOTECLIENTE, DREC_TS, DREC_TM, DREC_TI,
DREC_RECEPTUNEL
        , DREC_PROCTUNEL, DREC_TS_TUNEL, DREC_TM_TUNEL, DREC_TI_TUNEL, DREC_CODPER, DREC_HORA, DREC_FECHOMO,
DREC_HORHOMO
        , DREC_AUTHOMO, DREC_ESTADO, DREC_OCUP, DREC_VALOR, DREC_MONCODI,DREC_MEDCODI)
        VALUES(
          @FREC_CODI, @DREC_CODI , @DREC_CODPRO, @DREC_ORIGEN, @DREC_CODSOPO, @DREC_SOPOCLI, @DREC_UNIDADES
        , @DREC_PESO, @DREC_FECREC, @DREC_RUTCLI, @DREC_RUTPRODUCTOR, @DREC_CONTCLI, @DREC_FECPROD, @DREC_CAMARA
        , @DREC_BANDA, @DREC_COLUM, @DREC_PISO, @DREC_NIVEL, @DREC_ALMACEN, @DREC_DCAJA, @DREC_TUNEL,
@DREC_CODVIG
        , @DREC_PALLET, @DREC_CODREL, @DREC_NROSOPO, @DREC_SLOT, @DREC_DTGRACIA, @DREC_CODSAG, @DREC_TIPO,
@FECHAVENCIMIENTO
        , @LOTECLIENTE, @DREC_TS, @DREC_TM, @DREC_TI, @DREC_RECEPTUNEL, @DREC_PROCTUNEL, @DREC_TS_TUNEL,
@DREC_TM_TUNEL
        , @DREC_TI_TUNEL, @DREC_CODPER, @DREC_HORA, @DREC_FECHOMO, @DREC_HORHOMO, @DREC_AUTHOMO, @DREC_ESTADO,
@DREC_OCUP, @DREC_VALOR, @DREC_MONCODI,@DREC_MEDCODI)

    ELSE

        UPDATE TMPDETARECE
        SET FREC_CODI = @FREC_CODI
          , DREC_CODI = @DREC_CODI
          , DREC_CODPRO = @DREC_CODPRO
          , DREC_ORIGEN = @DREC_ORIGEN
          , DREC_CODSOPO = @DREC_CODSOPO
          , DREC_SOPOCLI = @DREC_SOPOCLI
          , DREC_UNIDADES = @DREC_UNIDADES
          , DREC_PESO = @DREC_PESO
          , DREC_FECREC = @DREC_FECREC
          , DREC_RUTCLI = @DREC_RUTCLI
          , DREC_RUTPRODUCTOR = @DREC_RUTPRODUCTOR
          , DREC_CONTCLI = @DREC_CONTCLI
          , DREC_FECPROD = @DREC_FECPROD
          , DREC_CAMARA = @DREC_CAMARA
          , DREC_BANDA = @DREC_BANDA
          , DREC_COLUM = @DREC_COLUM
          , DREC_PISO = @DREC_PISO
          , DREC_NIVEL = @DREC_NIVEL
          , DREC_ALMACEN = @DREC_ALMACEN
          , DREC_DCAJA = @DREC_DCAJA
          , DREC_TUNEL = @DREC_TUNEL
          , DREC_CODVIG = @DREC_CODVIG
          , DREC_PALLET = @DREC_PALLET
          , DREC_CODREL = @DREC_CODREL
          , DREC_NROSOPO = @DREC_NROSOPO
          , DREC_SLOT = @DREC_SLOT
          , DREC_DTGRACIA = @DREC_DTGRACIA
          , DREC_CODSAG = @DREC_CODSAG
          , DREC_TIPO = @DREC_TIPO
          , FECHAVENCIMIENTO = @FECHAVENCIMIENTO
          , LOTECLIENTE = @LOTECLIENTE
          , DREC_TS = @DREC_TS
          , DREC_TM = @DREC_TM
          , DREC_TI = @DREC_TI
          , DREC_RECEPTUNEL = @DREC_RECEPTUNEL
          , DREC_PROCTUNEL = @DREC_PROCTUNEL
          , DREC_TS_TUNEL = @DREC_TS_TUNEL
          , DREC_TM_TUNEL = @DREC_TM_TUNEL
          , DREC_TI_TUNEL = @DREC_TI_TUNEL
          , DREC_CODPER = @DREC_CODPER
          , DREC_HORA = @DREC_HORA
          , DREC_FECHOMO = @DREC_FECHOMO
          , DREC_HORHOMO = @DREC_HORHOMO
          , DREC_AUTHOMO = @DREC_AUTHOMO
          , DREC_ESTADO = @DREC_ESTADO
          , DREC_OCUP = @DREC_OCUP
          , DREC_VALOR = @DREC_VALOR
          , DREC_MONCODI = @DREC_MONCODI  
          , DREC_MEDCODI = @DREC_MEDCODI  
        WHERE FREC_CODI = @FREC_CODI AND DREC_CODI =  @DREC_CODI
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA TMPDETCAJAS
-- Fecha de Creacin: 12-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_TMPDETARECE
*/

CREATE PROCEDURE [dbo].[PA_ACT_TMPDETCAJAS]
  @FREC_CODI NVARCHAR(7)
, @DREC_CODI NVARCHAR(2)
, @DETC_CODI NVARCHAR(2)
, @DETC_FPROD NVARCHAR(10)
, @DETC_FVENC NVARCHAR(10)
, @DETC_CANTIDAD NVARCHAR(10)
AS

    IF NOT EXISTS (SELECT FREC_CODI FROM TMPDETCAJAS WHERE FREC_CODI = @FREC_CODI AND DREC_CODI = @DREC_CODI AND
DETC_CODI = @DETC_CODI)

        INSERT INTO TMPDETCAJAS(
          FREC_CODI, DREC_CODI, DETC_CODI, DETC_FPROD, DETC_FVENC, DETC_CANTIDAD)
        VALUES(
          @FREC_CODI, @DREC_CODI, @DETC_CODI, @DETC_FPROD, @DETC_FVENC, @DETC_CANTIDAD)

    ELSE

        UPDATE TMPDETCAJAS
        SET FREC_CODI = @FREC_CODI
          , DREC_CODI = @DREC_CODI
          , DETC_CODI = @DETC_CODI
          , DETC_FPROD = @DETC_FPROD
          , DETC_FVENC = @DETC_FVENC
          , DETC_CANTIDAD = @DETC_CANTIDAD
        WHERE FREC_CODI = @FREC_CODI AND DREC_CODI = @DREC_CODI AND DETC_CODI = @DETC_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_ACT_TMPFICHPRED]
@FPRE_CODI      NVARCHAR (7), --  Numero de Folio de Predespacho
@FPRE_RUTCLI    NVARCHAR (9), --  Rut del Cliente
@FPRE_HORADES   NVARCHAR (5), --  Hora despacho
@FPRE_HORATER   NVARCHAR (5),
@FPRE_FECDES    NVARCHAR (10),
@FPRE_TOTSOPO   INT,
@FPRE_TOTUNIDAD INT,           -- TOTAL DE UNIDADES
@FPRE_TOTPESO   FLOAT,         -- TOTAL
@FPRE_RUTCOND   NVARCHAR (9),
@FPRE_CODIENCA  NVARCHAR (3),
@FPRE_ACTIVA    NVARCHAR (1),
@FPRE_FECHACT   NVARCHAR (10),
@FPRE_CODVIG    NVARCHAR (1),
@FPRE_GDESPA    NVARCHAR (7),
@FPRE_RADIO     NVARCHAR(1),
@FPRE_TIPO      INT,
@FPRE_PROCESO   INT,
@FPRE_SELLO     NVARCHAR (50),
@FPRE_TEM       REAL,
@FPRE_ANDEN     NVARCHAR (10),
--@FPRE_USUCRE    NVARCHAR (06),
@EST_CODI       INT
--@FPRE_PALLET    NVARCHAR(7)

AS
   BEGIN
     IF NOT EXISTS ( SELECT FPRE_CODI
                     FROM TMPFICHPRED
                     WHERE  FPRE_CODI = @FPRE_CODI)

          INSERT INTO TMPFICHPRED
         (FPRE_CODI      ,FPRE_RUTCLI,   FPRE_HORADES,  FPRE_HORATER , FPRE_FECDES, FPRE_TOTSOPO ,
              FPRE_TOTUNIDAD ,FPRE_TOTPESO,  FPRE_RUTCOND,  FPRE_CODIENCA, FPRE_ACTIVA,  FPRE_FECHACT ,
              FPRE_CODVIG    ,FPRE_GDESPA,   FPRE_RADIO  ,  FPRE_TIPO     ,FPRE_PROCESO ,FPRE_SELLO ,
              FPRE_TEM       ,FPRE_ANDEN, EST_CODI) --, FPRE_PALLET)--     ,FPRE_USUCRE  )
        VALUES
         (@FPRE_CODI      ,  @FPRE_RUTCLI,    @FPRE_HORADES   , @FPRE_HORATER  , @FPRE_FECDES,    @FPRE_TOTSOPO,
              @FPRE_TOTUNIDAD ,  @FPRE_TOTPESO   , @FPRE_RUTCOND  , @FPRE_CODIENCA , @FPRE_ACTIVA,
              @FPRE_FECHACT       ,  @FPRE_CODVIG    , @FPRE_GDESPA   , @FPRE_RADIO    , @FPRE_TIPO,
              @FPRE_PROCESO   ,  @FPRE_SELLO     , @FPRE_TEM       ,@FPRE_ANDEN, @EST_CODI) --, @FPRE_PALLET)--    , @FPRE_USUCRE)

     ELSE
      UPDATE TMPFICHPRED
     SET FPRE_RUTCLI    = @FPRE_RUTCLI,
             FPRE_HORADES   = @FPRE_HORADES,
             FPRE_HORATER   = @FPRE_HORATER,
             FPRE_FECDES    = @FPRE_FECDES,
             FPRE_TOTSOPO   = @FPRE_TOTSOPO,
             FPRE_TOTUNIDAD = @FPRE_TOTUNIDAD,
             FPRE_TOTPESO   = @FPRE_TOTPESO,
             FPRE_RUTCOND   = @FPRE_RUTCOND,
         FPRE_CODIENCA  = @FPRE_CODIENCA,
             FPRE_ACTIVA    = @FPRE_ACTIVA,
         FPRE_FECHACT   = @FPRE_FECHACT,
             FPRE_CODVIG    = @FPRE_CODVIG,
             FPRE_GDESPA    = @FPRE_GDESPA,
             FPRE_RADIO     = @FPRE_RADIO,
             FPRE_TIPO      = @FPRE_TIPO,
             FPRE_PROCESO   = @FPRE_PROCESO,
             FPRE_SELLO     = @FPRE_SELLO,
             FPRE_TEM       = @FPRE_TEM,
             FPRE_ANDEN     = @FPRE_ANDEN,
--    FPRE_USUCRE    = @FPRE_USUCRE,
             EST_CODI       = @EST_CODI
--             FPRE_PALLET    = @FPRE_PALLET
        WHERE FPRE_CODI     = @FPRE_CODI
    END


GO
SET ANSI_NULLS OFF
GO

GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ACTUALIZA TABLA TMPFICHRECE
-- Fecha de Creacin: 12-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ACT_TMPFICHRECE
*/
CREATE PROCEDURE [dbo].[PA_ACT_TMPFICHRECE]
  @FREC_CODI NVARCHAR(7)
, @FREC_RUTCLI NVARCHAR(9)
, @FREC_RUTPRODUCTOR VARCHAR(12)
, @FREC_CONTCLI NVARCHAR(7)
, @FREC_HORALLEG NVARCHAR(5)
, @FREC_HORAREC NVARCHAR(5)
, @FREC_HORATER NVARCHAR(5)
, @FREC_TURNREC NVARCHAR(1)
, @FREC_FECPROC NVARCHAR(10)
, @FREC_FECREC NVARCHAR(10)
, @FREC_GUIADES NVARCHAR(8)
, @FREC_TIPENTR NVARCHAR(2)
, @FREC_TOTSOPO INT
, @FREC_TOTUNIDAD INT
, @FREC_TOTPESO FLOAT
, @FREC_TEMPPRO REAL
, @FREC_RUTCOND NVARCHAR(9)
, @FREC_OBSERV NVARCHAR(50)
, @FREC_TIPDESC NVARCHAR(1)
, @FREC_CODIENCA NVARCHAR(3)
, @FREC_ORIGEN NVARCHAR(2)
, @FREC_CODVIG NVARCHAR(1)
, @FREC_RADIO NVARCHAR(1)
, @FREC_TIPO INT
, @FREC_RECEPTUNEL INT
, @FREC_ASPECTOSANITARIO NVARCHAR(15)
, @FREC_CONDGENERAL INT
, @FREC_PROCEDENCIA CHAR(10)
, @FREC_TS AS REAL
, @FREC_TM AS REAL
, @FREC_TI AS REAL
, @EST_CODI INT
, @FREC_USUCRE VARCHAR(3)
--, @FREC_FECMOD DATETIME
--, @FREC_FECCRE DATETIME
AS


    IF NOT EXISTS (SELECT FREC_CODI FROM TMPFICHRECE WHERE FREC_CODI = @FREC_CODI)

        INSERT INTO TMPFICHRECE(
          FREC_CODI, FREC_RUTCLI, FREC_RUTPRODUCTOR, FREC_CONTCLI, FREC_HORALLEG, FREC_HORAREC, FREC_HORATER
        , FREC_TURNREC, FREC_FECPROC, FREC_FECREC, FREC_GUIADES, FREC_TIPENTR, FREC_TOTSOPO, FREC_TOTUNIDAD,
FREC_TOTPESO
        , FREC_TEMPPRO, FREC_RUTCOND, FREC_OBSERV, FREC_TIPDESC, FREC_CODIENCA, FREC_ORIGEN, FREC_CODVIG,
FREC_RADIO
        , FREC_TIPO, FREC_RECEPTUNEL, FREC_ASPECTOSANITARIO, FREC_CONDGENERAL, FREC_PROCEDENCIA, EST_CODI
        , FREC_TS, FREC_TM, FREC_TI, FREC_USUCRE, FREC_FECMOD) --, FREC_FECCRE)
        VALUES(
          @FREC_CODI, @FREC_RUTCLI, @FREC_RUTPRODUCTOR, @FREC_CONTCLI, @FREC_HORALLEG, @FREC_HORAREC,
@FREC_HORATER
        , @FREC_TURNREC, @FREC_FECPROC, @FREC_FECREC, @FREC_GUIADES, @FREC_TIPENTR, @FREC_TOTSOPO,
@FREC_TOTUNIDAD, @FREC_TOTPESO
        , @FREC_TEMPPRO, @FREC_RUTCOND, @FREC_OBSERV, @FREC_TIPDESC, @FREC_CODIENCA, @FREC_ORIGEN, @FREC_CODVIG,
@FREC_RADIO
        , @FREC_TIPO, @FREC_RECEPTUNEL, @FREC_ASPECTOSANITARIO, @FREC_CONDGENERAL, @FREC_PROCEDENCIA, @EST_CODI
        , @FREC_TS, @FREC_TM, @FREC_TI,@FREC_USUCRE, GETDATE())--, @FREC_FECCRE)

    ELSE

        UPDATE TMPFICHRECE
        SET FREC_CODI = @FREC_CODI
          , FREC_RUTCLI = @FREC_RUTCLI
          , FREC_RUTPRODUCTOR = @FREC_RUTPRODUCTOR
          , FREC_CONTCLI = @FREC_CONTCLI
          , FREC_HORALLEG = @FREC_HORALLEG
          , FREC_HORAREC = @FREC_HORAREC
          , FREC_HORATER = @FREC_HORATER
          , FREC_TURNREC = @FREC_TURNREC
          , FREC_FECPROC = @FREC_FECPROC
          , FREC_FECREC = @FREC_FECREC
          , FREC_GUIADES = @FREC_GUIADES
          , FREC_TIPENTR = @FREC_TIPENTR
          , FREC_TOTSOPO = @FREC_TOTSOPO
          , FREC_TOTUNIDAD = @FREC_TOTUNIDAD
          , FREC_TOTPESO = @FREC_TOTPESO
          , FREC_TEMPPRO = @FREC_TEMPPRO
          , FREC_RUTCOND = @FREC_RUTCOND
          , FREC_OBSERV = @FREC_OBSERV
          , FREC_TIPDESC = @FREC_TIPDESC
          , FREC_CODIENCA = @FREC_CODIENCA
          , FREC_ORIGEN = @FREC_ORIGEN
          , FREC_CODVIG = @FREC_CODVIG
          , FREC_RADIO = @FREC_RADIO
          , FREC_TIPO = @FREC_TIPO
          , FREC_RECEPTUNEL = @FREC_RECEPTUNEL
          , FREC_ASPECTOSANITARIO = @FREC_ASPECTOSANITARIO
          , FREC_CONDGENERAL = @FREC_CONDGENERAL
          , FREC_PROCEDENCIA = @FREC_PROCEDENCIA
          , FREC_TS = @FREC_TS
          , FREC_TM = @FREC_TM
          , FREC_TI = @FREC_TI
        --  , EST_CODI = @EST_CODI
          , FREC_USUCRE = @FREC_USUCRE
          , FREC_FECMOD = GETDATE()
--          , FREC_FECCRE = @FREC_FECCRE
        WHERE FREC_CODI = @FREC_CODI
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    BORRA RECEPCIONES CON MAS DE 8 HORAS
-- Fecha de Creacin: 25-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_BATCH_TMPRECEPCION

*/

CREATE PROCEDURE [dbo].[PA_BATCH_TMPRECEPCION]
AS

    SELECT FREC_CODI
    INTO #ELIMREG
    FROM TMPFICHRECE
    WHERE  (480-DATEDIFF(MI, TMPFICHRECE.FREC_FECCRE, GETDATE()))<0

    DECLARE @FREC_CODI AS VARCHAR(7)
    SELECT @FREC_CODI = 0

    DECLARE CURRECEP CURSOR FOR SELECT FREC_CODI FROM #ELIMREG
    OPEN CURRECEP
    FETCH NEXT FROM CURRECEP INTO @FREC_CODI
    WHILE @@FETCH_STATUS = 0
    BEGIN

        DELETE FROM TMPCHOFERES
        WHERE FREC_CODI = @FREC_CODI

        DELETE FROM TMPDETCAJAS
        WHERE FREC_CODI = @FREC_CODI

        DELETE FROM TMPDETARECE
        WHERE FREC_CODI = @FREC_CODI

        DELETE FROM TMPFICHRECE
        WHERE FREC_CODI = @FREC_CODI
        FETCH NEXT FROM CURRECEP INTO @FREC_CODI
    END
    CLOSE CURRECEP
    DEALLOCATE CURRECEP


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    LISTA CLIENTES
-- Fecha de Creacin: 14-09-2007
-- Modificaciones:
-- Pruebas
/*
exec  PA_BUS_CLIENTE
*/
CREATE  PROCEDURE [dbo].[PA_BUS_CLIENTES]
AS

    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    SELECT DISTINCT LTRIM(RTRIM(CLI_RUT)) AS CLI_RUT, UPPER(LTRIM(RTRIM(CLI_NOMB))) AS CLI_NOMB
    FROM CLIENTES
    where cli_estado='A'
    ORDER BY 2

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:    BUSCA CONTRATOS POR CLIENTE

-- Fecha de Creacin:    29-06-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_BUS_CONTRATOSXCLI '825570004'
*/

CREATE PROCEDURE [dbo].[PA_BUS_CONTRATOSXCLI]
@CONT_RUTCLIE NVARCHAR(9)
AS

    SELECT Cont_Codi, Cont_Descr
    FROM CONTRATO
    WHERE LTRIM(RTRIM(Cont_RutClie)) = @CONT_RUTCLIE
    ORDER BY Cont_Codi


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:  BUSCA CORRELATIVO PARA TABLA DE TEMPORAL DE FACTURACION DE LOS SERVICIOS 09 - 14 -15 -16

-- Fecha de Creacin:    17-07-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_BUS_CORRELTMPSER 'TMPSERV_MINTUNEL'

*/
CREATE PROCEDURE [dbo].[PA_BUS_CORRELTABLA]
  @TABLA VARCHAR(30)
AS

    SET NOCOUNT ON
    BEGIN TRAN
        DECLARE @COD AS INT
        SET @COD = 0

        SELECT @COD = CODIGO + 1 FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM(@TABLA))
        IF @COD > 0
        BEGIN

            UPDATE CORRTABLAS
            SET CODIGO = @COD
            WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM(@TABLA))

        END
        ELSE
            BEGIN
                ROLLBACK TRAN
                SELECT -1
                RETURN
            END
    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
        SELECT 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
        SELECT @COD
    END

    RETURN


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO






-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    LISTA ESTADOS DE GUIAS
-- Fecha de Creacin: 14-09-2007
-- Modificaciones:
-- Pruebas
/*
exec  PA_BUS_ESTADOS
*/
CREATE  PROCEDURE [dbo].[PA_BUS_ESTADOS]
AS


    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    SELECT EST_CODI, UPPER(LTRIM(RTRIM(EST_GLOSA))) AS EST_GLOSA
    FROM TMPESTADOS
    WHERE EST_CODI < 2
    ORDER BY 2

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    LISTA GUIAS DE RECEPCION
-- Fecha de Creacin: 14-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_BUS_RECEPCION 0034111
select * from TMPDETARECE
select TOP 1 * from MAEPROD
select TOP 1 * from TIPOENV

*/

CREATE PROCEDURE [dbo].[PA_BUS_RECEPCION]
  @FREC_CODI AS INT
, @ESTADO AS INT
AS


    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    IF @ESTADO = 1
    BEGIN
        SELECT TMPFICHRECE.FREC_CODI, TMPFICHRECE.FREC_RUTCLI, TMPFICHRECE.FREC_RUTPRODUCTOR             , TMPFICHRECE.FREC_CONTCLI
            , TMPFICHRECE.FREC_HORALLEG, TMPFICHRECE.FREC_HORAREC, TMPFICHRECE.FREC_HORATER             , TMPFICHRECE.FREC_TURNREC
            , TMPFICHRECE.FREC_FECPROC, TMPFICHRECE.FREC_FECREC, TMPFICHRECE.FREC_GUIADES             , TMPFICHRECE.FREC_TIPENTR
            , TMPFICHRECE.FREC_TOTSOPO, TMPFICHRECE.FREC_TOTUNIDAD, TMPFICHRECE.FREC_TOTPESO            , TMPFICHRECE.FREC_TEMPPRO
            , TMPFICHRECE.FREC_RUTCOND, TMPFICHRECE.FREC_OBSERV, TMPFICHRECE.FREC_TIPDESC            , TMPFICHRECE.FREC_CODIENCA
            , TMPFICHRECE.FREC_ORIGEN, TMPFICHRECE.FREC_CODVIG, TMPFICHRECE.FREC_RADIO, TMPFICHRECE.FREC_TIPO
            , TMPFICHRECE.FREC_RECEPTUNEL, TMPFICHRECE.FREC_ASPECTOSANITARIO, TMPFICHRECE.FREC_CONDGENERAL
            , TMPFICHRECE.FREC_PROCEDENCIA, TMPFICHRECE.FREC_TS, TMPFICHRECE.FREC_TM, TMPFICHRECE.FREC_TI
            , TMPFICHRECE.EST_CODI, TMPFICHRECE.FREC_USUCRE, TMPFICHRECE.FREC_FECMOD
            , TMPDETARECE.DREC_TS, TMPDETARECE.DREC_TM, TMPDETARECE.DREC_TI, TMPDETARECE.DREC_CODPRO             , TMPDETARECE.DREC_CODSOPO
            , TMPDETARECE.DREC_SOPOCLI, TMPDETARECE.DREC_FECPROD, TMPDETARECE.FECHAVENCIMIENTO             , TMPDETARECE.LOTECLIENTE
            , TMPDETARECE.DREC_CAMARA, TMPDETARECE.DREC_BANDA, TMPDETARECE.DREC_SLOT            , TMPDETARECE.DREC_UNIDADES, TMPDETARECE.DREC_PESO
            , TMPDETARECE.DREC_ALMACEN, TMPDETARECE.DREC_COLUM, TMPDETARECE.DREC_PISO, TMPDETARECE.DREC_NIVEL
            , TMPDETARECE.DREC_CODSAG, TMPDETARECE.DREC_DCAJA, TMPDETARECE.DREC_TUNEL            , TMPDETARECE.DREC_DTGRACIA
            , TMPDETARECE.DREC_CODI, TMPDETARECE.DREC_TS, TMPDETARECE.DREC_TM, TMPDETARECE.DREC_TI            , TMPDETARECE.DREC_OCUP
            , TMPDETARECE.DREC_CODPER, TMPDETARECE.DREC_ESTADO
            , USUARIO.DESCRI
            , UPPER(CLIENTES.CLI_NOMB) AS CLI_NOMB
            , ISNULL(PRODUCTORES.CLI_RUT,'') AS RUTPROD, ISNULL(PRODUCTORES.CLI_NOMB,'') AS NOMBPROD
            , UPPER(CONTRATO.CONT_DESCR) AS CONT_DESCR
            , UPPER(ORIGEN.ORI_DESCR) AS ORI_DESCR
            , UPPER(TMPCHOFERES.CHO_NOMBRE) AS CHO_NOMBRE, TMPCHOFERES.CHO_PATENTE, TMPCHOFERES.CHO_EMPRESA
            , LTRIM(RTRIM(MAEPROD.MAE_DESCR)) AS MAE_DESCR
            , LTRIM(RTRIM(TIPOENV.TENV_DESCR)) AS TENV_DESCR
            , drec_valor,drec_moncodi,drec_medcodi
            /*UPPER(LTRIM(RTRIM(TMPESTADOS.EST_GLOSA))) AS EST_GLOSA, TMPFICHRECE.FREC_CODI, UPPER(LTRIM
(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB
            , CONVERT(VARCHAR(10),TMPFICHRECE.FREC_FECCRE,105) AS FREC_FECCRE, CONVERT(VARCHAR
(8),TMPFICHRECE.FREC_FECCRE,108) AS FREC_FECCRE
            , CONVERT(VARCHAR(10),TMPFICHRECE.FREC_FECMOD,105) AS FREC_FECCRE, CONVERT(VARCHAR
(8),TMPFICHRECE.FREC_FECMOD,108) AS FREC_FECCRE
            , UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS DESCRI*/
    --    SELECT *
        FROM TMPFICHRECE LEFT OUTER JOIN
            TMPDETARECE ON TMPFICHRECE.FREC_CODI = TMPDETARECE.FREC_CODI LEFT OUTER JOIN
            TMPCHOFERES ON TMPFICHRECE.FREC_CODI = TMPCHOFERES.FREC_CODI AND
            TMPFICHRECE.FREC_RUTCOND = TMPCHOFERES.CHO_RUT INNER JOIN
            USUARIO ON TMPFICHRECE.FREC_USUCRE = USUARIO.PERSONAL INNER JOIN
            CLIENTES ON TMPFICHRECE.FREC_RUTCLI = CLIENTES.CLI_RUT INNER JOIN
            TMPESTADOS ON TMPFICHRECE.EST_CODI = TMPESTADOS.EST_CODI LEFT OUTER JOIN
            PRODUCTORES ON TMPFICHRECE.FREC_RUTCLI = PRODUCTORES.CLI_RUT LEFT OUTER JOIN
            CONTRATO ON TMPFICHRECE.FREC_RUTCLI = CONTRATO.CONT_RUTCLIE AND
            TMPFICHRECE.FREC_CONTCLI = CONTRATO.CONT_CODI INNER JOIN
            ORIGEN ON TMPFICHRECE.FREC_ORIGEN = ORIGEN.ORI_CODI LEFT OUTER JOIN
            MAEPROD ON --TMPFICHRECE.FREC_RUTCLI = MAEPROD.MAE_CLIRUT AND
            TMPDETARECE.DREC_CODPRO = MAEPROD.MAE_CODI LEFT OUTER JOIN
            TIPOENV ON MAEPROD.MAE_TIPENV = TIPOENV.TENV_CODI
        WHERE TMPFICHRECE.FREC_CODI = @FREC_CODI
        ORDER BY TMPDETARECE.DREC_CODI

        SELECT TMPDETCAJAS.FREC_CODI, TMPDETCAJAS.DREC_CODI, TMPDETCAJAS.DETC_CODI
            , TMPDETCAJAS.DETC_FPROD, TMPDETCAJAS.DETC_FVENC, TMPDETCAJAS.DETC_CANTIDAD
        FROM TMPDETCAJAS
        WHERE TMPDETCAJAS.FREC_CODI = @FREC_CODI

    END
    ELSE
    BEGIN
        SELECT FICHRECE.FREC_CODI, FICHRECE.FREC_RUTCLI, FICHRECE.FREC_RUTPRODUCTOR, FICHRECE.FREC_CONTCLI
            , FICHRECE.FREC_HORALLEG, FICHRECE.FREC_HORAREC, FICHRECE.FREC_HORATER, FICHRECE.FREC_TURNREC
            , FICHRECE.FREC_FECPROC, FICHRECE.FREC_FECREC, FICHRECE.FREC_GUIADES, FICHRECE.FREC_TIPENTR
            , FICHRECE.FREC_TOTSOPO, FICHRECE.FREC_TOTUNIDAD, FICHRECE.FREC_TOTPESO, FICHRECE.FREC_TEMPPRO
            , FICHRECE.FREC_RUTCOND, FICHRECE.FREC_OBSERV, FICHRECE.FREC_TIPDESC, FICHRECE.FREC_CODIENCA
            , FICHRECE.FREC_ORIGEN, FICHRECE.FREC_CODVIG, FICHRECE.FREC_RADIO, FICHRECE.FREC_TIPO
            , FICHRECE.FREC_RECEPTUNEL, FICHRECE.FREC_ASPECTOSANITARIO, FICHRECE.FREC_CONDGENERAL
            , FICHRECE.FREC_PROCEDENCIA, NULL AS FREC_TS, NULL AS FREC_TM, NULL AS FREC_TI
            , 0 AS EST_CODI, '' AS FREC_USUCRE, '' AS FREC_FECMOD
            , DETARECE.DREC_TS, DETARECE.DREC_TM, DETARECE.DREC_TI, DETARECE.DREC_CODPRO            , DETARECE.DREC_CODSOPO
            , DETARECE.DREC_SOPOCLI, DETARECE.DREC_FECPROD, DETARECE.FECHAVENCIMIENTO, DETARECE.LoteCliente
            , DETARECE.DREC_CAMARA, DETARECE.DREC_BANDA, DETARECE.DREC_SLOT, DETARECE.DREC_UNIDADES            , DETARECE.DREC_PESO
            , DETARECE.DREC_ALMACEN, DETARECE.DREC_COLUM, DETARECE.DREC_PISO, DETARECE.DREC_NIVEL
            , DETARECE.DREC_CODSAG, DETARECE.DREC_DCAJA, DETARECE.DREC_TUNEL, DETARECE.DREC_DTGRACIA
            , DETARECE.DREC_CODI, DETARECE.DREC_TS, DETARECE.DREC_TM, DETARECE.DREC_TI, 0 AS DREC_OCUP
            , DETARECE.DREC_CODPER, DETARECE.DREC_ESTADO,DETARECE.drec_valor,DETARECE.drec_moncodi,DETARECE.drec_medcodi
            , USUARIO.DESCRI
            , UPPER(CLIENTES.CLI_NOMB) AS CLI_NOMB
            , ISNULL(PRODUCTORES.CLI_RUT,'') AS RUTPROD, ISNULL(PRODUCTORES.CLI_NOMB,'') AS NOMBPROD
            , UPPER(CONTRATO.CONT_DESCR) AS CONT_DESCR
            , UPPER(ORIGEN.ORI_DESCR) AS ORI_DESCR
            , UPPER(CHOFERES.CHO_NOMBRE) AS CHO_NOMBRE, CHOFERES.CHO_PATENTE, CHOFERES.CHO_EMPRESA
            , LTRIM(RTRIM(MAEPROD.MAE_DESCR)) AS MAE_DESCR
            , LTRIM(RTRIM(TIPOENV.TENV_DESCR)) AS TENV_DESCR
            /*UPPER(LTRIM(RTRIM(TMPESTADOS.EST_GLOSA))) AS EST_GLOSA, FICHRECE.FREC_CODI, UPPER(LTRIM(RTRIM
(CLIENTES.CLI_NOMB))) AS CLI_NOMB
            , CONVERT(VARCHAR(10),FICHRECE.FREC_FECCRE,105) AS FREC_FECCRE, CONVERT(VARCHAR
(8),FICHRECE.FREC_FECCRE,108) AS FREC_FECCRE
            , CONVERT(VARCHAR(10),FICHRECE.FREC_FECMOD,105) AS FREC_FECCRE, CONVERT(VARCHAR
(8),FICHRECE.FREC_FECMOD,108) AS FREC_FECCRE
            , UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS DESCRI*/
    --    SELECT TOP 1 * FROM FICHRECE
        FROM FICHRECE INNER JOIN
            DETARECE ON FICHRECE.FREC_CODI = LEFT(DETARECE.DREC_CODI,7) LEFT OUTER JOIN
            CHOFERES ON FICHRECE.FREC_RUTCOND = CHOFERES.CHO_RUT INNER JOIN
            USUARIO ON CONVERT(INT,ISNULL(DETARECE.DREC_CODPER,0)) = CONVERT(INT,USUARIO.PERSONAL) INNER JOIN
            CLIENTES ON FICHRECE.FREC_RUTCLI = CLIENTES.CLI_RUT LEFT OUTER JOIN
            PRODUCTORES ON FICHRECE.FREC_RUTCLI = PRODUCTORES.CLI_RUT INNER JOIN
            CONTRATO ON FICHRECE.FREC_RUTCLI = CONTRATO.CONT_RUTCLIE AND
            FICHRECE.FREC_CONTCLI = CONTRATO.CONT_CODI INNER JOIN
            ORIGEN ON FICHRECE.FREC_ORIGEN = ORIGEN.ORI_CODI INNER JOIN
            MAEPROD ON FICHRECE.FREC_RUTCLI = MAEPROD.MAE_CLIRUT AND
            DETARECE.DREC_CODPRO = MAEPROD.MAE_CODI INNER JOIN
            TIPOENV ON MAEPROD.MAE_TIPENV = TIPOENV.TENV_CODI
        WHERE FICHRECE.FREC_CODI = @FREC_CODI
        ORDER BY DETARECE.DREC_CODI

        SELECT LEFT(DETC_PALLET,7) AS FREC_CODI, SUBSTRING(DETC_PALLET,8,2) AS DREC_CODI, RIGHT(DETC_PALLET,2) AS DETC_CODI
            , DETCAJAS.DETC_FPROD, DETCAJAS.DETC_FVENC, DETCAJAS.DETC_CANTIDAD
        FROM DETCAJAS
        WHERE LEFT(DETCAJAS.DETC_PALLET,7) = @FREC_CODI

    END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:    BUSCA SERVICIOS POR CONTRATOS (SERVICIOS NUMERAL PROMEDIO MNIMO TNEL Y NUMERAL SUMA CONTRATOS MNIMO Y 
-- TNEL)

-- Fecha de Creacin:    29-06-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ING_ESCALASERV '0002900', '08', 2

*/

CREATE PROCEDURE [dbo].[PA_BUS_SERVXCONTR]
@ESCCONTR NVARCHAR(9)
AS

    SELECT DISTINCT  ESCSERV, TOTTRAMAS
    FROM ESCALASERV
    WHERE LTRIM(RTRIM(ESCCONTR)) = @ESCCONTR
    ORDER BY ESCSERV


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:    BUSCA TRAMOS POR CONTRATO Y SERVICIO (SERVICIOS NUMERAL PROMEDIO MNIMO TNEL Y NUMERAL SUMA CONTRATOS MNIMO Y TNEL)

-- Fecha de Creacin:    29-06-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_BUS_TRAMOXCONTRSERV '0002900', '08'

*/

CREATE PROCEDURE [dbo].[PA_BUS_TRAMOXCONTRSERV]
  @ESCCONTR NVARCHAR(9)
, @ESCSERV VARCHAR(2)
AS

    SELECT ESCALASERV.ESCCOD, ESCALASERV.TOTTRAMAS, TRAMO.TRAMNOMB, TRAMO.TRAMDESDE, TRAMO.TRAMHASTA, TRAMO.TRAMVAL
    FROM ESCALASERV INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE LTRIM(RTRIM(ESCALASERV.ESCCONTR)) = @ESCCONTR
        AND LTRIM(RTRIM(ESCALASERV.ESCSERV)) = @ESCSERV
--    ORDER BY ESCALASERV.ESCSERV


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    LISTA USUARIOS
-- Fecha de Creacin: 14-09-2007
-- Modificaciones:
-- Pruebas
/*
exec  PA_BUS_USUARIOS
*/
CREATE  PROCEDURE [dbo].[PA_BUS_USUARIOS]
AS


    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    SELECT DISTINCT LTRIM(RTRIM(PERSONAL)) AS CODIGO, UPPER(LTRIM(RTRIM(DESCRI))) AS DESCRI
    FROM USUARIO
    WHERE PERSONAL<>'' AND DESCRI <> ''
    ORDER BY 2

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



-- PA_CONDICIONESCONTRATO '0002100', '09'
CREATE PROCEDURE [dbo].[PA_CONDICIONESCONTRATO]
  @CONTR AS VARCHAR(7)
, @SERV AS VARCHAR(2)
AS

     SET NOCOUNT ON
    SET rowcount 0

--    DECLARE @CONTR AS VARCHAR(7)
--    DECLARE @SERV AS VARCHAR(7)
    DECLARE @DESCONTR AS VARCHAR(40)
    DECLARE @DIAGR AS SMALLINT
    DECLARE @TUNELG AS INT
    DECLARE @DIACONT AS SMALLINT
    DECLARE @PALL AS INT
    DECLARE @CONTRVAL AS DEC(12,2)
    DECLARE @MONDESC AS VARCHAR(30)
    DECLARE @MONVAL AS DEC(12,2)
    DECLARE @MEDDESC AS VARCHAR(30)

--    SET @CONTR = '0002100'
--    SET @SERV = '09'
    SET @DESCONTR = ''
    SET @DIAGR = 0
    SET @TUNELG = 0
    SET @DIACONT = 0
    SET @PALL = 0
    SET @CONTRVAL = 0
    SET @MONDESC = ''
    SET @MONVAL = 0
    SET @MEDDESC = ''

    SELECT @DIAGR=CONTRATO.CONT_DIAGRACIA, @TUNELG=CONTRATO.CONT_TUNELG, @DESCONTR=CONTRATO.CONT_DESCR
         , @DIACONT=CONTRATO.CONT_DIACONT, @PALL=CONTRATO.CONT_PALLET, @CONTRVAL = CONTRPARA.CPAR_VALOR
        , @MONDESC = MONEDAS.MON_DESCR, @MONVAL = MONEDAS.MON_VALOR
         , @MEDDESC = MEDIDAS.MED_DESCR
    FROM CONTRPARA INNER JOIN
         CONTRATO ON CONTRPARA.CPAR_CONTR = CONTRATO.CONT_CODI INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRPARA.CPAR_CONTR = @CONTR AND CONTRPARA.CPAR_SERVI = @SERV

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)

    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SELECT @DESCONTR AS DESCONTR, @DIAGR AS DIAGR, @TUNELG AS TUNELG, @DIACONT AS DIACONT
        , @PALL AS PALL, @CONTRVAL AS CONTRVAL, @MONDESC AS MONDESC, @MONVAL AS MONVAL
        , @MEDDESC AS MEDDESC, @VALUF AS VALUF, @FECUF AS FECUF, @VALDOLAR AS VALDOLAR
        , @FECDOLAR AS FECDOLAR


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ELIMINA REGISTRO TABLA DETCAJAS
-- Fecha de Creacin: 12-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_DEL_DETCAJAS

*/

CREATE PROCEDURE [dbo].[PA_DEL_DETCAJAS]
  @DETC_PALLET NVARCHAR(11)
AS

        DELETE FROM DETCAJAS
        WHERE LEFT(DETC_PALLET,7) = @DETC_PALLET


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_DEL_TMPDETAPRED]
@Fpre_codi NVARCHAR(7)
AS
       DELETE FROM TMPDETAPRED
       WHERE Fpre_codi = @Fpre_codi


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_DEL_TMPDETAPREDFILA]
@fpre_codi  NVARCHAR(7),
@dpre_ptr int
AS
       DELETE FROM TMPDETAPRED
       WHERE fpre_codi = @fpre_codi
         AND dpre_ptr = @dpre_ptr


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    BORRA REGISTRO TABLA TMPDETARECE
-- Fecha de Creacin: 16-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_DEL_TMPDETARECE

*/

CREATE PROCEDURE [dbo].[PA_DEL_TMPDETARECE]
  @FREC_CODI NVARCHAR(7)
, @DREC_CODI NVARCHAR(2)
AS


        DELETE FROM TMPDETARECE
        WHERE FREC_CODI = @FREC_CODI AND DREC_CODI =  @DREC_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    BORRA REGISTRO TABLA TMPDETCAJAS
-- Fecha de Creacin: 16-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_DEL_TMPDETCAJAS
*/
CREATE PROCEDURE [dbo].[PA_DEL_TMPDETCAJAS]
  @FREC_CODI NVARCHAR(7)
, @DREC_CODI NVARCHAR(2)
AS

        DELETE FROM TMPDETCAJAS
        WHERE FREC_CODI = @FREC_CODI AND DREC_CODI = @DREC_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_DEL_TMPFICHPRED]
  @fpre_codi NVARCHAR(7)
AS
       DELETE FROM TMPFICHPRED
       WHERE fpre_codi = @fpre_codi


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    BORRA TABLAS TEMPORALES DE RECEPCION SEGUN NUMERO DE GUIA
-- Fecha de Creacin: 25-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_DEL_TMPRECEPCION '0034113'
*/
CREATE PROCEDURE [dbo].[PA_DEL_TMPRECEPCION]
  @FREC_CODI NVARCHAR(7)
AS
        DELETE FROM TMPCHOFERES
        WHERE FREC_CODI = @FREC_CODI

        DELETE FROM TMPDETCAJAS
        WHERE FREC_CODI = @FREC_CODI

        DELETE FROM TMPDETARECE
        WHERE FREC_CODI = @FREC_CODI

        DELETE FROM TMPFICHRECE
        WHERE FREC_CODI = @FREC_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    ELIMINA DATOS TEMPORALES UTILIZADAS EN EL PROCESO DE FACTURACION DE LOS SERVICIOS NMPNT, NMT, NSCMT Y DE
-- Fecha de Creacin: 17-08/-2007
-- Modificaciones:
-- Pruebas
/*
exec  PA_DELTMPSERVICIOS 1
exec  PA_DELTMPSERVICIOS 20
*/


CREATE PROCEDURE [dbo].[PA_DEL_TMPSERVICIOS]
@IDENT INT
AS

    DELETE FROM TMPDETSERVICIOS WHERE IDENT = @IDENT
    DELETE FROM TMPCABSERVICIOS WHERE IDENT = @IDENT

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[PA_DERECHOENTRADA]
  @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @IDENT AS INTEGER=0
AS

    SET NOCOUNT ON
    SET rowcount 0
/*
    DECLARE @RUTCLI AS VARCHAR(9)
    DECLARE @CONTR AS VARCHAR(7)
    DECLARE @FECINI AS VARCHAR(10)
    DECLARE @FECFIN AS VARCHAR(10)
    DECLARE @IDENT AS INTEGER

    SET @RUTCLI = '796639407'
    SET @CONTR = '0002100'
    SET @FECINI = '2007/04/01'
    SET @FECFIN = '2007/04/30'
    SET @IDENT = 0
*/

    DECLARE @DESCONTR AS VARCHAR(40)
    DECLARE @DIAGR AS SMALLINT
    DECLARE @TUNELG AS INT
    DECLARE @DIACONT AS SMALLINT
    --DECLARE @PALL AS INT
    DECLARE @CONTRVAL AS DEC(12,2)
    DECLARE @MONDESC AS VARCHAR(30)
    DECLARE @MONVAL AS DEC(12,2)
    DECLARE @MEDDESC AS VARCHAR(30)

    SET @DESCONTR = ''
    SET @DIAGR = 0
    SET @TUNELG = 0
    SET @DIACONT = 0
    --SET @PALL = 0
    SET @CONTRVAL = 0
    SET @MONDESC = ''
    SET @MONVAL = 0
    SET @MEDDESC = ''

    SELECT @DIAGR=ISNULL(CONTRATO.CONT_DIAGRACIA,0), @TUNELG=ISNULL(CONTRATO.CONT_TUNELG,0), @DESCONTR=ISNULL(CONTRATO.CONT_DESCR,'')
         , @DIACONT=ISNULL(CONTRATO.CONT_DIACONT,0), @CONTRVAL = ISNULL(CONTRPARA.CPAR_VALOR,0)  --, @PALL=CONTRATO.CONT_PALLET
        , @MONDESC = ISNULL(MONEDAS.MON_DESCR,''), @MONVAL = ISNULL(MONEDAS.MON_VALOR,0)
         , @MEDDESC = MEDIDAS.MED_DESCR
    FROM CONTRPARA INNER JOIN
         CONTRATO ON CONTRPARA.CPAR_CONTR = CONTRATO.CONT_CODI INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRPARA.CPAR_CONTR = @CONTR AND CONTRPARA.CPAR_SERVI = '09'

    --DROP TABLE #DESPPER
    SELECT DISTINCT SUBSTRING(FICHRECE.FREC_FECREC,9,2)+'/'+SUBSTRING(FICHRECE.FREC_FECREC,6,2)+'/'+SUBSTRING(FICHRECE.FREC_FECREC,1,4) AS FECREC
                , SUBSTRING(DETADESPA.DDES_FECHA,9,2)+'/'+SUBSTRING(DETADESPA.DDES_FECHA,6,2)+'/'+SUBSTRING(DETADESPA.DDES_FECHA,1,4) AS FECDESPA
--                , FICHRECE.FREC_CODI AS CODRECE
                , DETARECE.DREC_CODI AS CODRECE, DETADESPA.DDES_CODI AS CODDESPA
                , DETADESPA.DDES_UNIDADES AS UNI, CONVERT(DEC(12,2),DETADESPA.DDES_PESO) AS PESO  --1046
--                , ISNULL(DETARECE.DREC_RECEPTUNEL,0) AS TUNEL
                , ISNULL(DETARECE.DREC_PROCTUNEL,0) AS TUNEL
--                    , (CASE WHEN ISNULL(DETARECE.DREC_RECEPTUNEL,0)  > 1 THEN CONVERT(VARCHAR(10),DATEADD(DD, @TUNELG, CONVERT(DATETIME,FICHRECE.FREC_FECREC,120)),111) ELSE FICHRECE.FREC_FECREC END) AS FIN_TUNEL
                    , (CASE WHEN ISNULL(DETARECE.DREC_PROCTUNEL,0)  > 1 THEN CONVERT(VARCHAR(10),DATEADD(DD, @TUNELG, CONVERT(DATETIME,FICHRECE.FREC_FECREC,120)),111) ELSE FICHRECE.FREC_FECREC END) AS FIN_TUNEL
                , ABS(DATEDIFF(DAY,  CONVERT(DATETIME, CONVERT(DATETIME,FICHRECE.FREC_FECREC,120)) , CONVERT(DATETIME, DDES_FECHA, 120)))  AS DT
                , DATEDIFF(DAY,  CONVERT(DATETIME, (CASE WHEN ISNULL(DETARECE.DREC_RECEPTUNEL,0) > 1 THEN CONVERT(VARCHAR(10),DATEADD(DD, @TUNELG, CONVERT(DATETIME,FICHRECE.FREC_FECREC,120)),111) ELSE FICHRECE.FREC_FECREC END), 120), CONVERT(DATETIME, DDES_FECHA, 120))  AS DE
                , 0 AS CT
                , 0 AS ST
                , 0 AS NUMSOP
                , 0 AS NTD
                , 0 AS COBRAR
                , FICHRECE.FREC_FECREC
                , DETADESPA.DDES_FECHA
    INTO #DESPPER
    FROM DETADESPA
        INNER JOIN FICHDESPA
            ON LEFT(DETADESPA.DDES_CODI,7) = FICHDESPA.FDES_CODI
        INNER JOIN DETARECE
            ON DETADESPA.DDES_CODRECE = DETARECE.DREC_CODI
        INNER JOIN FICHRECE
            ON LEFT(DETARECE.DREC_CODI,7) = FICHRECE.FREC_CODI
    WHERE FICHDESPA.FDES_FECHA BETWEEN @FECINI AND @FECFIN AND
         FICHDESPA.FDES_RUTCLI = @RUTCLI AND
         DETADESPA.DDES_PALLET = 1 AND
         FICHRECE.FREC_CONTCLI = @CONTR AND
         FICHDESPA.FDES_CODVIG = 0 AND
         DETADESPA.DDES_CODVIG = 0 AND
         FICHRECE.FREC_CODVIG = 0 AND
         DETARECE.DREC_CODVIG = 0 and
         FICHDESPA.fdes_origen<>'65' and
         FICHDESPA.fdes_origen<>'99' and
         FICHDESPA.fdes_origen<>'97' and
         FICHRECE.FREC_origen<>'65' and 
         FICHRECE.FREC_origen<>'99' and
         FICHRECE.FREC_origen<>'97'

    ORDER BY 13, 14, 3, 4, 5, 6

--/*
    -- PALLET SIN TUNEL, SI NUMERO DE DIAS DE ESTADIA DEL PALLET (TOTAL DE DIAS)
    -- ES MENOR O IGUAL AL CAMPO CONT_DIADRACIA DE LA TABLA CONTRATO, SI ES MAYOR NO HAY COBRO
--    SELECT FECREC, FECDESPA, CODRECE, CODDESPA, 0 AS CT, 1 AS ST, DE, 1 AS NUMSOP, UNI, PESO
    UPDATE #DESPPER
    SET CT = 0
      , ST = 1
      , NUMSOP = 1
      , COBRAR = 1
    FROM #DESPPER
    WHERE TUNEL <> 1 AND DE <= @DIAGR
--*/

    -- PALLET CON TUNEL, CALCULO NTD
/*
    SELECT FECREC, FECDESPA, CODRECE, CODDESPA, 1 AS CT
        , (CASE WHEN DE>0 THEN 1 ELSE 0 END) AS ST, DE, 1 AS NUMSOP, UNI, PESO, ABS(DE - @TUNELG) AS NTD
*/
    UPDATE #DESPPER
    SET NTD = @TUNELG + @DIAGR
      , NUMSOP = 1
      , CT = 1
    FROM #DESPPER
    WHERE TUNEL = 1 AND COBRAR = 0

    -- SI NUMERO DE DIAS DE ESTADIA DEL PALLET (DIAS CAMARA + DIAS TUNEL)
    -- ES MENOR O IGUAL AL NTD, SI ES MAYOR NO HAY COBRO
--    SELECT *
    UPDATE #DESPPER
    SET
   -- ST = (CASE WHEN DE>0 THEN 1 ELSE 0 END)
       COBRAR = 1
    FROM #DESPPER
    WHERE TUNEL = 1 AND DT <= NTD AND COBRAR = 0 AND DE>0

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)
    DECLARE @TOTSOP AS INTEGER
    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''
    SET @TOTSOP = 0

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
    SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)
    SELECT @TOTSOP = SUM(NUMSOP) FROM #DESPPER WHERE COBRAR = 1

    IF @IDENT <> 0
    BEGIN
        INSERT INTO TMPCABSERVICIOS
        SELECT  ISNULL(@IDENT, 0), ISNULL(@CONTR, 0), ISNULL(@CONTRVAL, 0), ISNULL(@MONDESC, 0), ISNULL(@MONVAL, 0)
            , ISNULL(@MEDDESC, 0), ISNULL(@TOTSOP, 0), 0, ISNULL(@VALUF, 0), ISNULL(@FECUF, 0)
            , ISNULL(@VALDOLAR, 0), ISNULL(@FECDOLAR, 0), 0, 0, 0, 0, 0, 0, ISNULL(@DIAGR, 0)
    END

    SELECT FECREC, FECDESPA, CODRECE, CODDESPA
        , CT, ST, DE, NUMSOP, UNI, PESO, @DIAGR AS DERENTRADA, @TOTSOP AS TOTSOP, TUNEL,DT,FIN_TUNEL, FREC_FECREC
    FROM #DESPPER
    WHERE COBRAR = 1
    ORDER BY CONVERT(DATETIME,FREC_FECREC,120), CONVERT(DATETIME,DDES_FECHA,120), CODRECE, CODDESPA
--    ORDER BY FREC_FECREC ,DDES_FECHA, CODRECE, CODDESPA
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:    INGRESO DE ESCALA PARA SERVICIOS NUMERAL PROMEDIO MNIMO TNEL Y NUMERAL SUMA CONTRATOS MNIMO Y TNEL

-- Fecha de Creacin:    29-06-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ING_ESCALASERV '0002900', '08', 2
SELECT CODIGO FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = 'ESCALA'
*/


CREATE PROCEDURE [dbo].[PA_ING_ESCALASERV]
  @ESCCONTR VARCHAR(7)
, @ESCSERV VARCHAR(2)
, @TOTTRAMAS INT
AS

    SET NOCOUNT ON
    BEGIN TRAN
        DECLARE @ESCCOD AS INT
        SET @ESCCOD = 0

        SELECT @ESCCOD = CODIGO + 1 FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = 'ESCALA'
        IF @ESCCOD > 0
        BEGIN

            UPDATE CORRTABLAS
            SET CODIGO = @ESCCOD
            WHERE RTRIM(LTRIM(TABLA)) = 'ESCALA'

            INSERT INTO ESCALASERV
                ( ESCCOD, ESCCONTR, ESCSERV, TOTTRAMAS)
            VALUES
                ( @ESCCOD, @ESCCONTR, @ESCSERV, @TOTTRAMAS)

            IF NOT EXISTS (SELECT * FROM CONTRPARA WHERE CPAR_CONTR = @ESCCONTR AND CPAR_SERVI = @ESCSERV)
                INSERT INTO CONTRPARA
                    ( CPAR_CONTR, CPAR_SERVI, CPAR_MARCA, CPAR_VALOR, CPAR_MONEDA, CPAR_MEDIDA,
CPAR_CODVIG)
                VALUES
                    (@ESCCONTR, @ESCSERV, '1', 0, '00', '',0 )
            ELSE
                UPDATE CONTRPARA
                SET CPAR_MARCA = CASE WHEN @TOTTRAMAS > 0 THEN 1 ELSE 0 END
                WHERE CPAR_CONTR = @ESCCONTR
                    AND @ESCSERV = CPAR_SERVI
        END
        ELSE
            BEGIN
                ROLLBACK TRAN
                SELECT -1
                RETURN
            END
    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
        SELECT 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
        SELECT @ESCCOD
    END

    RETURN


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



-- Autor:    Carolina Uribe Ruiz - ACL
-- Objetivo:    INGRESO DE TRAMOS DE TARIFICACION POR ESCALA PARA LOS SERVICIOS NUMERAL PROMEDIO MNIMO TNEL Y NUMERAL SUMA CONTRATOS MNIMO Y TNEL
-- Fecha de Creacin:    29-06-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_ING_TRAMOS '1', '1', 'TRAMO 1', 1,10,1000

*/


CREATE PROCEDURE [dbo].[PA_ING_TRAMOS]
  @TRAMCOD INT
, @ESCCOD AS INT
, @TRAMNOMB VARCHAR(50)
, @TRAMDESDE INT
, @TRAMHASTA INT
, @TRAMVAL REAL
, @TRAMINI INT
AS

    SET NOCOUNT ON
    BEGIN TRAN

        IF EXISTS(SELECT * FROM TRAMO WHERE TRAMCOD = @TRAMCOD AND ESCCOD = @ESCCOD)
            UPDATE TRAMO
            SET       TRAMNOMB = @TRAMNOMB
                , TRAMDESDE = @TRAMDESDE
                , TRAMHASTA = @TRAMHASTA
                , TRAMVAL = @TRAMVAL
            FROM TRAMO
            WHERE TRAMCOD = @TRAMCOD AND ESCCOD = @ESCCOD
        ELSE
            INSERT INTO TRAMO
                ( TRAMCOD, ESCCOD, TRAMNOMB, TRAMDESDE, TRAMHASTA, TRAMVAL)
            VALUES
                ( @TRAMCOD, @ESCCOD, @TRAMNOMB, @TRAMDESDE, @TRAMHASTA, @TRAMVAL)

        IF @TRAMINI >@TRAMCOD
            DELETE TRAMO
            WHERE ESCCOD = @ESCCOD AND TRAMCOD > @TRAMINI

    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
        DELETE ESCALASERV
        WHERE ESCCOD = @ESCCOD

        SELECT 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
        UPDATE ESCALASERV
        SET TOTTRAMAS = @TRAMCOD
        WHERE ESCCOD = @ESCCOD
        SELECT 1


    END


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_INS_DETAPRESLO]
@PRES_CODI    NVARCHAR(22),
@PRES_CASLO    NVARCHAR(10),
@PRES_CODPRO    NVARCHAR(14),
@PRES_UNIDADES    INT,
@PRES_PESO    FLOAT,
@PRES_FECPROD    NVARCHAR(20),
@PRES_FOLIO    NVARCHAR(22),
@PRES_ACTIVA    TINYINT,
@PRES_RADIO    TINYINT,
@PRES_CODVIG    TINYINT
AS
   INSERT INTO DETAPRESLO
   (PRES_UNICA,
    PRES_CODI,
    PRES_CASLO,
    PRES_CODPRO,
    PRES_UNIDADES,
    PRES_PESO,
    PRES_FECPROD,
    PRES_FOLIO,
    PRES_ACTIVA,
    PRES_RADIO,
    PRES_CODVIG)
   VALUES
   (NEWID(),
    @PRES_CODI,
    @PRES_CASLO,
    @PRES_CODPRO,
    @PRES_UNIDADES,
    @PRES_PESO,
    @PRES_FECPROD,
    @PRES_FOLIO,
    @PRES_ACTIVA,
    @PRES_RADIO,
    @PRES_CODVIG)


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE  [dbo].[PA_INS_FICHPRED]
@FPRE_CODI        NVARCHAR (14),
@FPRE_RUTCLI      NVARCHAR (18),
@FPRE_HORADES     NVARCHAR (10),
@FPRE_HORATER     NVARCHAR (10),
@FPRE_FECDES      NVARCHAR (20),
@FPRE_TOTSOPO     INT,
@FPRE_TOTUNIDAD   INT,
@FPRE_TOTPESO     FLOAT,
@FPRE_RUTCOND     NVARCHAR (18),
@FPRE_CODIENCA    NVARCHAR (06),
@FPRE_ACTIVA      NVARCHAR (02),
@FPRE_FECHACT     NVARCHAR (20),
@FPRE_CODVIG      NVARCHAR (02),
@FPRE_GDESPA      NVARCHAR (14),
@FPRE_RADIO       NVARCHAR (02),
@FPRE_TIPO        INT,
@FPRE_PROCESO     INT,
@FPRE_SELLO       VARCHAR  (50),
@FPRE_TEM         REAL,
@FPRE_ANDEN       NVARCHAR (20)
--@FPRE_USUCRE      NVARCHAR (12),
--@EST_CODI         INT
AS
BEGIN
    IF EXISTS ( SELECT FPRE_CODI
                FROM   FICHPRED
                WHERE  FPRE_CODI = @FPRE_CODI)

   UPDATE FICHPRED
   SET FPRE_RUTCLI      = @FPRE_RUTCLI,
       FPRE_HORADES     = @FPRE_HORADES,
       FPRE_HORATER     = @FPRE_HORATER,
       FPRE_FECDES      = @FPRE_FECDES,
       FPRE_TOTSOPO     = @FPRE_TOTSOPO,
       FPRE_TOTUNIDAD   = @FPRE_TOTUNIDAD,
       FPRE_TOTPESO     = @FPRE_TOTPESO,
       FPRE_RUTCOND     = @FPRE_RUTCOND,
       FPRE_CODIENCA    = @FPRE_CODIENCA,
       FPRE_ACTIVA      = @FPRE_ACTIVA,
       FPRE_FECHACT     = @FPRE_FECHACT,
       FPRE_CODVIG      = @FPRE_CODVIG,
       FPRE_GDESPA      = @FPRE_GDESPA,
       FPRE_RADIO       = @FPRE_RADIO,
       FPRE_TIPO        = @FPRE_TIPO,
       FPRE_PROCESO     = @FPRE_PROCESO,
       FPRE_SELLO       = @FPRE_SELLO,
       FPRE_TEM         = @FPRE_TEM,
       FPRE_ANDEN       = @FPRE_ANDEN
--       FPRE_USUCRE      = @FPRE_USUCRE,
--             EST_CODI         = @EST_CODI
          WHERE FPRE_CODI  = @FPRE_CODI
   ELSE
  INSERT INTO FICHPRED
   (FPRE_UNICA,
    FPRE_CODI,
    FPRE_RUTCLI,
    FPRE_HORADES,
    FPRE_HORATER,
    FPRE_FECDES,
    FPRE_TOTSOPO,
    FPRE_TOTUNIDAD,
    FPRE_TOTPESO,
    FPRE_RUTCOND,
    FPRE_CODIENCA,
    FPRE_ACTIVA,
    FPRE_FECHACT,
    FPRE_CODVIG,
    FPRE_GDESPA,
    FPRE_RADIO,
    FPRE_TIPO,
    FPRE_PROCESO,
    FPRE_SELLO,
    FPRE_TEM,
    FPRE_ANDEN)
--    FPRE_USUCRE,
--    EST_CODI)
   VALUES
   (NEWID(),
    @FPRE_CODI,
    @FPRE_RUTCLI,
    @FPRE_HORADES,
    @FPRE_HORATER,
    @FPRE_FECDES,
    @FPRE_TOTSOPO,
    @FPRE_TOTUNIDAD,
    @FPRE_TOTPESO,
    @FPRE_RUTCOND,
    @FPRE_CODIENCA,
    @FPRE_ACTIVA,
    @FPRE_FECHACT,
    @FPRE_CODVIG,
    @FPRE_GDESPA,
    @FPRE_RADIO,
    @FPRE_TIPO,
    @FPRE_PROCESO,
    @FPRE_SELLO,
    @FPRE_TEM,
    @FPRE_ANDEN )
--    @FPRE_USUCRE,
--    0)
END


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_INS_MOVPALLET]
@MOV_FOLIO              NVARCHAR(18),
@MOV_CODPER             NVARCHAR(06),
@MOV_CA                 NVARCHAR(04),
@MOV_BA                 NVARCHAR(06),
@MOV_CO                 NVARCHAR(04),
@MOV_PI                 NVARCHAR(04),
@MOV_NI                 NVARCHAR(02),
@MOV_FECHA              NVARCHAR(20),
@MOV_TIPO               NVARCHAR(04),
@MOV_HORA               NVARCHAR(20),
@MOV_TS                 REAL,
@MOV_TM                 REAL,
@MOV_TI                 REAL,
@MOV_DOC                NVARCHAR(20),
@MOV_RECEPTUNEL         INT,
@MOV_DESPACHO           INT,
@MOV_SALDO              INT,
@MOV_DOCDESPA           NVARCHAR(18),
@MOV_CHORUT             NVARCHAR(20),
@MOV_CHONOM             NVARCHAR(100),
@MOV_CHOPAT             NVARCHAR(20),
@MOV_CHOTRA             NVARCHAR(100),
@MOV_ANDEN              NVARCHAR(20)
AS
     INSERT INTO MOVPALLET
       (MOV_UNICA,
        MOV_FOLIO,
    MOV_CODPER,
    MOV_CA,
    MOV_BA,
    MOV_CO,
    MOV_PI,
    MOV_NI,
    MOV_FECHA,
    MOV_TIPO,
    MOV_HORA,
    MOV_TS,
    MOV_TM,
    MOV_TI,
    MOV_DOC,
    MOV_RECEPTUNEL,
    MOV_DESPACHO,
    MOV_SALDO,
    MOV_DOCDESPA,
    MOV_CHORUT,
    MOV_CHONOM,
    MOV_CHOPAT,
    MOV_CHOTRA,
    MOV_ANDEN)
     VALUES
       (NEWID(),
        @MOV_FOLIO,
    @MOV_CODPER,
    @MOV_CA,
    @MOV_BA,
    @MOV_CO,
    @MOV_PI,
    @MOV_NI,
    @MOV_FECHA,
    @MOV_TIPO,
    @MOV_HORA,
    @MOV_TS,
    @MOV_TM,
    @MOV_TI,
    @MOV_DOC,
    @MOV_RECEPTUNEL,
    @MOV_DESPACHO,
    @MOV_SALDO,
    @MOV_DOCDESPA,
    @MOV_CHORUT,
    @MOV_CHONOM,
    @MOV_CHOPAT,
    @MOV_CHOTRA,
    @MOV_ANDEN)


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_INS_PICKING]
@FOLIO        CHAR(10),
@DESPACHO    CHAR(10),
@CLIENTE    CHAR(10),
@CANTIDAD    FLOAT,
@PESO        FLOAT,
@PALLET        FLOAT,
@FECHA        DATETIME,
@CONTRATO    CHAR(10),
@CODIGO_RECEP    VARCHAR(50)
AS
   INSERT INTO PICKING
    (FOLIO,
     DESPACHO,
         CLIENTE,
         CANTIDAD,
         PESO,
         PALLET,
         FECHA,
         CONTRATO,
         CODIGO_RECEP)
   VALUES
    (@FOLIO,
     @DESPACHO,
         @CLIENTE,
         @CANTIDAD,
         @PESO,
         @PALLET,
         @FECHA,
         @CONTRATO,
         @CODIGO_RECEP)


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    Carolina Uribe Ruiz / ACL
-- Objetivo:    LIBERA POSICIONES DE CAMARAS
-- Fecha de Creacin: 26-09-2007
-- Modificaciones:
-- Pruebas
/*
exec  PA_LST_TMPSERVICIOS
*/




-- Autor:    Carolina Uribe Ruiz
-- Objetivo:
-- Fecha de Creacin:
-- Modificaciones:
-- Pruebas
/*
exec  PA_LST_TMPSERV_MINTUNEL
*/


CREATE PROCEDURE [dbo].[PA_LST_TMPSERV_MINTUNEL]
  @IDENT NUMERIC
, @SERV INT=0

AS

    SET NOCOUNT ON
    SET rowcount 0

    IF @SERV = 9
        SELECT CONTRVAL, MONDESC, MONVAL, MEDDESC, TOTSOP, VALUF, VALDOLAR, FECUF, FECDOLAR, CONTRDERENTR
        FROM TMPCABSERVICIOS
        WHERE TMPCABSERVICIOS.IDENT = @IDENT
    ELSE
        SELECT TMPCABSERVICIOS.IDENT, LINEA, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS, CONTRVAL,
MONDESC, MONVAL
            , MEDDESC, TOTSOP, VALNETO, VALUF, VALDOLAR, TOTCT, TOTST, TOTDP, TOTSTOCK, TOTUNI, TOTTONE
            , FECUF, FECDOLAR, CONTRDERENTR
        FROM TMPCABSERVICIOS INNER JOIN TMPDETSERVICIOS
            ON TMPCABSERVICIOS.IDENT = TMPDETSERVICIOS.IDENT
        WHERE TMPCABSERVICIOS.IDENT = @IDENT

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



-- Autor:    Carolina Uribe Ruiz
-- Objetivo:
-- Fecha de Creacin:
-- Modificaciones:
-- Pruebas
/*
exec  PA_LST_TMPSERVICIOS 1
*/


CREATE PROCEDURE [dbo].[PA_LST_TMPSERVICIOS]
@IDENT NUMERIC

AS

    SET NOCOUNT ON
    SET rowcount 0

    SELECT TMPCABSERVICIOS.IDENT, TMPCABSERVICIOS.CONTRATO, LINEA, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES,
TONELADAS, CONTRVAL, MONDESC, MONVAL
        , MEDDESC, TOTSOP, VALNETO, VALUF, VALDOLAR, TOTCT, TOTST, TOTDP, TOTSTOCK, TOTUNI, TOTTONE, CONTRDERENTR
        , FECUF, FECDOLAR, CONTRATO.CONT_DESCR
    FROM   TMPCABSERVICIOS INNER JOIN TMPDETSERVICIOS
            ON TMPCABSERVICIOS.IDENT = TMPDETSERVICIOS.IDENT
                AND TMPCABSERVICIOS.CONTRATO = TMPDETSERVICIOS.CONTRATO
        INNER JOIN CONTRATO
            ON TMPCABSERVICIOS.CONTRATO = CONTRATO.CONT_CODI
    WHERE TMPCABSERVICIOS.IDENT = @IDENT

    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




CREATE PROCEDURE [dbo].[PA_LST_TRAMOSXCLIE]
  @RUTCLI as  VARCHAR(9)
, @SERV as  VARCHAR(2)
, @CONTR AS VARCHAR(7)
AS


--    SET NOCOUNT ON
--    SET rowcount 0


    SELECT DISTINCT TRAMO.TRAMNOMB, TRAMO.TRAMDESDE, TRAMO.TRAMHASTA, TRAMVAL
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND ESCALASERV.ESCSERV = @SERV
        AND ESCALASERV.ESCCONTR = @CONTR


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_NUMERALES]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0
 DECLARE @DESCONTR AS VARCHAR(40)
 DECLARE @DIAGR AS SMALLINT
 DECLARE @TUNELG AS INT
 DECLARE @DIACONT AS SMALLINT
 DECLARE @MINPALL AS INT
 DECLARE @RECEPANT AS INT
 DECLARE @RUNIDANT AS INT
 DECLARE @RTONEANT AS INT
 DECLARE @DESPANT AS INT
 DECLARE @DUNIDANT AS INT
 DECLARE @DTONEANT AS INT
 DECLARE @RECEPPER AS INT
 DECLARE @DESPPER AS INT
 DECLARE @STOCK AS INT
 DECLARE @UNIDADES AS INT
 DECLARE @TONELADAS AS INT
 DECLARE @TOTDIAS AS INT
 DECLARE @CONTRVAL AS DEC(12,2)
 DECLARE @MONDESC AS VARCHAR(30)
 DECLARE @MONVAL AS DEC(12,2)
 DECLARE @MEDDESC AS VARCHAR(30)

 SET @DESCONTR = ''
 SET @DIAGR = 0
 SET @TUNELG = 0
 SET @DIACONT = 0
 SET @MINPALL = 0
 SET @STOCK = 0
 SET @RUNIDANT = 0
 SET @RTONEANT = 0
 SET @DUNIDANT = 0
 SET @DTONEANT = 0
 SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)
 SET @CONTRVAL = 0
 SET @MONDESC = ''
 SET @MONVAL = 0
 SET @MEDDESC = ''

 SELECT @DIAGR=CONTRATO.CONT_DIAGRACIA
      , @TUNELG=CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG END
      , @DESCONTR=CONTRATO.CONT_DESCR
      , @DIACONT=CONTRATO.CONT_DIACONT, @MINPALL=CONTRATO.CONT_PALLET
      , @CONTRVAL = CONTRPARA.CPAR_VALOR
      , @MONDESC = MONEDAS.MON_DESCR, @MONVAL = MONEDAS.MON_VALOR
      , @MEDDESC = MEDIDAS.MED_DESCR
 FROM CONTRPARA INNER JOIN
      CONTRATO ON CONTRPARA.CPAR_CONTR = CONTRATO.CONT_CODI INNER JOIN MONEDAS
      MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
      MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
 WHERE CONTRPARA.CPAR_CONTR = @CONTR
  AND CONTRPARA.CPAR_SERVI = 14


CREATE TABLE #NUMMIN (LINEA INT, FECHA VARCHAR(10), FECHA1 VARCHAR(10), CT INT, ST INT, DP INT, STOCK INT, FACTURAR INT, UNIDADES INT, TONELADAS DECIMAL(12,2))

DECLARE @LIN INT
DECLARE @ILIN INT
Declare @Dfechaini datetime
Declare @Dfechafin datetime

set @dfechaini = DATEADD(  DAY, (CASE WHEN @TUNELG=0 THEN 0 ELSE - @tuneLG - 2 END) , convert(datetime , @fecini,101))
set @dfechafin = convert(datetime , @fecfin,101)
set @LIN=1
while @dfechaini <= @dfechafin
begin
    INSERT INTO #NUMMIN(LINEA, FECHA, FECHA1, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS)
    VALUES(case when @tunelg=0 then @lin else @LIN - @tunelg - 2 end, convert(char,@dfechaini,103), convert(char,@dfechaini,111), 0, 0, 0, 0, 0, 0, 0)

    set @dfechaini = dateadd(day,1,@dfechaini)
    set @LIN = @LIN +1
end

	DECLARE @TOTCT AS INT
	DECLARE @TOTST AS INT
	DECLARE @TOTDP AS INT
	DECLARE @TOTSTOCK AS INT
	DECLARE @TOTSOP AS INT
	DECLARE @TOTUNI AS INT
	DECLARE @TOTTONE AS DEC(12,2)
	DECLARE @VALNETO AS DEC(12,2)
	DECLARE @VALUF AS DEC(12,2)
	DECLARE @FECUF AS VARCHAR(10)
	DECLARE @VALDOLAR AS DEC(12,2)
	DECLARE @FECDOLAR AS VARCHAR(10)
	SET @TOTCT = 0
	SET @TOTST = 0
	SET @TOTDP = 0
	SET @TOTSTOCK = 0
	SET @TOTSOP = 0
	SET @TOTUNI = 0
	SET @TOTTONE = 0
	SET @VALNETO = 0
	SET @VALUF = 0
	SET @FECUF = ''
	SET @VALDOLAR = 0
	SET @FECDOLAR = ''

DECLARE @FECHALIN AS VARCHAR(10)

SET @LIN = @LIN - 1
SET @ILIN=1
WHILE @ILIN <= @LIN 
BEGIN
       -- CALCULA 

      SELECT  @FECHALIN = FECHA1 FROM #NUMMIN WHERE LINEA = @ILIN

      UPDATE #NUMMIN
           SET CT = (SELECT COUNT(1) FROM DETARECE  WHERE DREC_PALLET=1 and DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC =  @FECHALIN AND DREC_TUNEL>=1),
	       ST = (SELECT COUNT(1) FROM DETARECE  WHERE DREC_PALLET=1 and DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC =  @FECHALIN AND DREC_TUNEL=0),
	       DP = (SELECT COUNT(1) FROM DETADESPA WHERE Ddes_PALLET=1 and DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  =  @FECHALIN )
      WHERE LINEA = @ILIN

      UPDATE #NUMMIN

       SET STOCK = (SELECT COUNT(1) FROM DETARECE  WHERE DREC_PALLET=1 and  DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN)
		    -
		   (SELECT COUNT(1) FROM DETAdespa WHERE Ddes_PALLET=1 and DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN)
	,UNIDADES = isnull((SELECT sum(isnull(drec_unidades,0)) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN),0)
			-
		    isnull((SELECT sum(isnull(ddes_unidades,0)) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN),0)
	,TONELADAS = isnull((SELECT sum(isnull(drec_PESO,0)) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN),0)
			-
		    isnull((SELECT sum(isnull(ddes_PESO,0)) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN),0)
       WHERE LINEA = @ILIN

      IF @ILIN=1
		UPDATE #NUMMIN SET FACTURAR = STOCK WHERE LINEA = @ILIN
	ELSE
	begin
		UPDATE #NUMMIN  SET FACTURAR = ST - DP + ISNULL((SELECT F.FACTURAR FROM #NUMMIN F WHERE F.LINEA = @ILIN - 1),0) WHERE LINEA = @ILIN

		UPDATE #NUMMIN SET FACTURAR = facturar + ISNULL((SELECT F.CT FROM #NUMMIN F WHERE F.LINEA = @ILIN - @TUNELG   ),0)
		WHERE LINEA = @ILIN
	end

       SET @ILIN= @ILIN + 1
END 

	UPDATE #NUMMIN SET FACTURAR = @MINPALL
	WHERE FACTURAR < @MINPALL and stock>0

 SELECT  @TOTSOP = SUM(FACTURAR), @VALNETO = (SUM(FACTURAR) * @CONTRVAL)
        , @TOTCT = SUM(CT), @TOTST = SUM(ST)
        , @TOTDP = SUM(DP), @TOTSTOCK = SUM(STOCK)
        , @TOTUNI = SUM(UNIDADES), @TOTTONE = SUM(TONELADAS)
 FROM #NUMMIN
 WHERE FECHA1 >=@FECINI

 SELECT  @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
  , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
  , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
  , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
 FROM MONEDAS

 SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
 SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

 IF @IDENT <> 0
 BEGIN
 -- select 'ins'
  INSERT INTO TMPCABSERVICIOS
  SELECT @IDENT, @CONTR, @CONTRVAL, @MONDESC, @MONVAL, @MEDDESC, @TOTSOP, ISNULL(@VALNETO,0), @VALUF, @FECUF,
     ISNULL(@VALDOLAR,0), ISNULL(@FECDOLAR,0), ISNULL(@TOTCT,0), ISNULL(@TOTST,0),
     ISNULL(@TOTDP,0), ISNULL(@TOTSTOCK,0), ISNULL(@TOTUNI,0), ISNULL(@TOTTONE,0), 0

  INSERT INTO TMPDETSERVICIOS
  SELECT @IDENT, @CONTR, LINEA, FECHA, CT, ST, DP, STOCK, ISNULL(FACTURAR,0), ISNULL(UNIDADES,0), ISNULL(TONELADAS,0)
  FROM #NUMMIN
  WHERE FECHA1 >=@FECINI
  ORDER BY 1
 END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




CREATE PROCEDURE [dbo].[PA_NUMERALMINTUNEL]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0
 DECLARE @DESCONTR AS VARCHAR(40)
 DECLARE @DIAGR AS SMALLINT
 DECLARE @TUNELG AS INT
 DECLARE @DIACONT AS SMALLINT
 DECLARE @MINPALL AS INT
 DECLARE @RECEPANT AS INT
 DECLARE @RUNIDANT AS INT
 DECLARE @RTONEANT AS INT
 DECLARE @DESPANT AS INT
 DECLARE @DUNIDANT AS INT
 DECLARE @DTONEANT AS INT
 DECLARE @RECEPPER AS INT
 DECLARE @DESPPER AS INT
 DECLARE @STOCK AS INT
 DECLARE @UNIDADES AS INT
 DECLARE @TONELADAS AS INT
 DECLARE @TOTDIAS AS INT
 DECLARE @CONTRVAL AS DEC(12,2)
 DECLARE @MONDESC AS VARCHAR(30)
 DECLARE @MONVAL AS DEC(12,2)
 DECLARE @MEDDESC AS VARCHAR(30)

 SET @DESCONTR = ''
 SET @DIAGR = 0
 SET @TUNELG = 0
 SET @DIACONT = 0
 SET @MINPALL = 0
 SET @STOCK = 0
 SET @RUNIDANT = 0
 SET @RTONEANT = 0
 SET @DUNIDANT = 0
 SET @DTONEANT = 0
 SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)
 SET @CONTRVAL = 0
 SET @MONDESC = ''
 SET @MONVAL = 0
 SET @MEDDESC = ''

 SELECT @DIAGR=CONTRATO.CONT_DIAGRACIA
      , @TUNELG=CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG END
      , @DESCONTR=CONTRATO.CONT_DESCR
      , @DIACONT=CONTRATO.CONT_DIACONT, @MINPALL=CONTRATO.CONT_PALLET
      , @CONTRVAL = CONTRPARA.CPAR_VALOR
      , @MONDESC = MONEDAS.MON_DESCR, @MONVAL = MONEDAS.MON_VALOR
      , @MEDDESC = MEDIDAS.MED_DESCR
 FROM CONTRPARA INNER JOIN
      CONTRATO ON CONTRPARA.CPAR_CONTR = CONTRATO.CONT_CODI INNER JOIN MONEDAS
      MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
      MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
 WHERE CONTRATO.CONT_estado='0' and CONTRPARA.CPAR_CONTR = @CONTR
  AND CONTRPARA.CPAR_SERVI = 14


CREATE TABLE #NUMMIN (LINEA INT, FECHA VARCHAR(10), FECHA1 VARCHAR(10), CT INT, ST INT, DP INT, STOCK INT, FACTURAR INT, UNIDADES INT, TONELADAS DECIMAL(12,2))

DECLARE @LIN INT
DECLARE @ILIN INT
Declare @Dfechaini datetime
Declare @Dfechafin datetime

set @dfechaini = DATEADD(  DAY, (CASE WHEN @TUNELG=0 THEN 0 ELSE - @tuneLG - 2 END) , convert(datetime , @fecini,101))
set @dfechafin = convert(datetime , @fecfin,101)
set @LIN=1
while @dfechaini <= @dfechafin
begin


    INSERT INTO #NUMMIN(LINEA, FECHA, FECHA1, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS)
    VALUES(case when @tunelg=0 then @lin else @LIN - @tunelg - 2 end, convert(char,@dfechaini,103), convert(char,@dfechaini,111), 0, 0, 0, 0, 0, 0, 0)

    set @dfechaini = dateadd(day,1,@dfechaini)
    set @LIN = @LIN +1
end

	DECLARE @TOTCT AS INT
	DECLARE @TOTST AS INT
	DECLARE @TOTDP AS INT
	DECLARE @TOTSTOCK AS INT
	DECLARE @TOTSOP AS INT
	DECLARE @TOTUNI AS INT
	DECLARE @TOTTONE AS DEC(12,2)
	DECLARE @VALNETO AS DEC(12,2)
	DECLARE @VALUF AS DEC(12,2)
	DECLARE @FECUF AS VARCHAR(10)
	DECLARE @VALDOLAR AS DEC(12,2)
	DECLARE @FECDOLAR AS VARCHAR(10)
	SET @TOTCT = 0
	SET @TOTST = 0
	SET @TOTDP = 0
	SET @TOTSTOCK = 0
	SET @TOTSOP = 0
	SET @TOTUNI = 0
	SET @TOTTONE = 0
	SET @VALNETO = 0
	SET @VALUF = 0
	SET @FECUF = ''
	SET @VALDOLAR = 0
	SET @FECDOLAR = ''

DECLARE @FECHALIN AS VARCHAR(10)

SET @LIN = @LIN - 1
SET @ILIN=1
WHILE @ILIN <= @LIN 
BEGIN
       -- CALCULA 

      SELECT  @FECHALIN = FECHA1 FROM #NUMMIN WHERE LINEA = @ILIN

      UPDATE #NUMMIN
           SET CT = (SELECT count(1) FROM DETARECE  WHERE drec_pallet=1 and DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC =  @FECHALIN AND DREC_TUNEL>=1),
	       ST = (SELECT count(1) FROM DETARECE  WHERE drec_pallet=1 and DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC =  @FECHALIN AND DREC_TUNEL=0),
	       DP = (SELECT count(1) FROM DETAdespa WHERE DDES_PALLET=1 and DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  =  @FECHALIN)
       WHERE LINEA = @ILIN

      UPDATE #NUMMIN

       SET
	STOCK = (SELECT count(1) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN  and drec_pallet=1)
		    -
	        (SELECT count(1) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN  and ddes_pallet=1)

	,UNIDADES = isnull((SELECT sum(isnull(drec_unidades,0)) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN),0)
			-
		    isnull((SELECT sum(isnull(ddes_unidades,0)) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN),0)
	,TONELADAS = isnull((SELECT sum(isnull(drec_PESO,0)) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN),0)
			-
		    isnull((SELECT sum(isnull(ddes_PESO,0)) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN),0)
       WHERE LINEA = @ILIN

      IF @ILIN=1
		UPDATE #NUMMIN SET FACTURAR = STOCK WHERE LINEA = @ILIN
	ELSE
	begin
		UPDATE #NUMMIN  SET FACTURAR = ST - DP + ISNULL((SELECT F.FACTURAR FROM #NUMMIN F WHERE F.LINEA = @ILIN - 1),0) WHERE LINEA = @ILIN

		UPDATE #NUMMIN SET FACTURAR = facturar + ISNULL((SELECT F.CT FROM #NUMMIN F WHERE F.LINEA = @ILIN - @TUNELG   ),0)
		WHERE LINEA = @ILIN
	end

       SET @ILIN= @ILIN + 1
END 

	UPDATE #NUMMIN SET FACTURAR = @MINPALL
	WHERE FACTURAR < @MINPALL and stock>0

 SELECT  @TOTSOP = SUM(FACTURAR), @VALNETO = (SUM(FACTURAR) * @CONTRVAL)
        , @TOTCT = SUM(CT), @TOTST = SUM(ST)
        , @TOTDP = SUM(DP), @TOTSTOCK = SUM(STOCK)
        , @TOTUNI = SUM(UNIDADES), @TOTTONE = SUM(TONELADAS)
 FROM #NUMMIN
 WHERE FECHA1 >=@FECINI

 SELECT  @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
  , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
  , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
  , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
 FROM MONEDAS

 SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
 SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

 IF @IDENT <> 0
 BEGIN
 -- select 'ins'
  INSERT INTO TMPCABSERVICIOS
  SELECT @IDENT, @CONTR, @CONTRVAL, @MONDESC, @MONVAL, @MEDDESC, @TOTSOP, ISNULL(@VALNETO,0), @VALUF, @FECUF,
     ISNULL(@VALDOLAR,0), ISNULL(@FECDOLAR,0), ISNULL(@TOTCT,0), ISNULL(@TOTST,0),
     ISNULL(@TOTDP,0), ISNULL(@TOTSTOCK,0), ISNULL(@TOTUNI,0), ISNULL(@TOTTONE,0), 0

  INSERT INTO TMPDETSERVICIOS
  SELECT @IDENT, @CONTR, LINEA, FECHA, CT, ST, DP, STOCK, ISNULL(FACTURAR,0), ISNULL(UNIDADES,0), ISNULL(TONELADAS,0)
  FROM #NUMMIN
  WHERE FECHA1 >=@FECINI
  ORDER BY 1
 END
	
 SELECT LINEA, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
      , @CONTRVAL AS CONTRVAL, @MONDESC AS MONDESC
      , @MONVAL AS MONVAL, @MEDDESC AS MEDDESC
      , @TOTSOP AS TOTSOP, @VALNETO AS VALNETO
      , @VALUF AS VALUF, @VALDOLAR AS VALDOLAR
      , @TOTCT AS TOTCT, @TOTST AS TOTST, @TOTDP AS TOTDP
      , @TOTSTOCK AS TOTSTOCK, @TOTUNI AS TOTUNI, @TOTTONE AS TOTTONE
      , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
 FROM #NUMMIN
 WHERE FECHA1 >=@FECINI
 ORDER BY 1
GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[PA_NUMERALPROMEDIOMINTUNEL]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0

    DECLARE @TOTTRAMO AS INT
    DECLARE @ESCCOD AS INT
    DECLARE @TOTDIAS AS INT


 IF @IDENT = 0
 BEGIN

    DECLARE @TABLA VARCHAR(30)
    SET @TABLA = 'TMPSERV_MINTUNEL'

    BEGIN TRAN
        DECLARE @CODI AS INT
        SET @CODI = 0

        SELECT @CODI = CODIGO + 1 FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))
        IF @CODI > 0
        BEGIN

            UPDATE CORRTABLAS
            SET CODIGO = @CODI
            WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))

        END
        ELSE
            BEGIN
                ROLLBACK TRAN
                SET @CODI = -1
            END
    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
	SET @CODI = 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
	SET @IDENT = @CODI
    END
 END 

    SELECT @TOTTRAMO = ESCALASERV.TOTTRAMAS
        , @ESCCOD = ESCALASERV.ESCCOD
    FROM ESCALASERV
    WHERE ESCALASERV.ESCCONTR = @CONTR
        AND ESCALASERV.ESCSERV = '15'

    DECLARE CURPALLET CURSOR FOR
	    SELECT CONTRATO.CONT_CODI
	    FROM CONTRATO INNER JOIN CONTRPARA
	        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
	        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
	         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
	         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
	    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
	        AND CONTRPARA.CPAR_SERVI = '15'
	        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
	        AND ESCALASERV.ESCSERV = '15'
	        AND CONTRPARA.CPAR_MARCA = '1'
    OPEN CURPALLET
    FETCH NEXT FROM CURPALLET INTO @CONTR
    WHILE @@FETCH_STATUS = 0
    BEGIN

	EXEC PA_NUMERALES @FECINI, @FECFIN, @RUTCLI, @CONTR, @IDENT

        FETCH NEXT FROM CURPALLET INTO @CONTR
    END
    CLOSE CURPALLET
    DEALLOCATE CURPALLET

    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)


    --DROP TABLE #CONTRATOS
    SELECT CONTRPARA.CPAR_CONTR, ESCALASERV.ESCCOD, 0 AS CONT  --CONTRATO.CONT_CODI,
        , CONTRATO.CONT_DIAGRACIA
        , (CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG-1 END) AS CONT_TUNELG
        , CONTRATO.CONT_DESCR
            , CONTRATO.CONT_DIACONT, CONTRATO.CONT_PALLET
            , 0 AS CPAR_VALOR
         , MONEDAS.MON_DESCR, MONEDAS.MON_VALOR
         , MEDIDAS.MED_DESCR
        , 0 AS STOCK
        , 0 AS UNIDADES
        , 0 AS TONELADAS
    INTO #CONTRATOS
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND CONTRPARA.CPAR_SERVI = '15'
        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
        AND ESCALASERV.ESCSERV = '15'
        AND CONTRPARA.CPAR_MARCA = '1'

    DECLARE @COD VARCHAR(7)
    DECLARE @DESDE VARCHAR(7)
    DECLARE @HASTA VARCHAR(10)
    DECLARE @VAL VARCHAR(7)

    DECLARE CURTRAMA CURSOR FOR SELECT TRAMCOD, TRAMDESDE, TRAMHASTA, TRAMVAL FROM TRAMO WHERE ESCCOD = @ESCCOD
    OPEN CURTRAMA
    FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    WHILE @@FETCH_STATUS = 0
    BEGIN

        UPDATE #CONTRATOS
        SET CONT = CONT+1
--        SELECT *
        FROM #CONTRATOS INNER JOIN TRAMO
            ON #CONTRATOS.ESCCOD = TRAMO.ESCCOD
        --WHERE TRAMO.TRAMCOD = TRAMCOD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL
        WHERE TRAMO.TRAMCOD = @COD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL

        FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    END
    CLOSE CURTRAMA
    DEALLOCATE CURTRAMA

    --DROP TABLE #CONTR
    SELECT * INTO #CONTR FROM #CONTRATOS WHERE CONT = @TOTTRAMO

    --DROP TABLE #RESUMEN
    SELECT distinct TMPDETSERVICIOS.CONTRATO AS CONTR
        , (SUM(FACTURAR) * #CONTR.CPAR_VALOR) AS VALNETO
              , SUM(CT) AS TOTCT
        , SUM(ST) AS TOTST
              , SUM(DP) AS TOTDP
        , SUM(TMPDETSERVICIOS.STOCK) AS TOTSTOCK
        , SUM(TMPDETSERVICIOS.FACTURAR) AS TOTSOP
              , SUM(TMPDETSERVICIOS.UNIDADES) AS TOTUNI
        , SUM(TMPDETSERVICIOS.TONELADAS) AS TOTTONE
        , #CONTR.MON_DESCR AS MONDESC
        , #CONTR.MON_VALOR as MONVAL
             , #CONTR.MED_DESCR AS MEDDESC
        , #CONTR.CONT_DESCR AS CONTRDESC
    INTO #RESUMEN
    FROM TMPDETSERVICIOS
        INNER JOIN #CONTR
            ON TMPDETSERVICIOS.CONTRATO = #CONTR.CPAR_CONTR COLLATE SQL_Latin1_General_CP1_CI_AS
        INNER JOIN ESCALASERV
            ON #CONTR.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS
            AND '15' = ESCALASERV.ESCSERV
    WHERE IDENT = @IDENT
    GROUP BY TMPDETSERVICIOS.CONTRATO, #CONTR.CPAR_VALOR, #CONTR.MON_DESCR, #CONTR.MON_VALOR, #CONTR.MED_DESCR, #CONTR.CONT_DESCR

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)

    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
    SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

    DECLARE @TOTALFAC  AS DEC(12,2)
    DECLARE @PROMEDIO  AS DEC(12,2)
    DECLARE @TARIFUNI AS DEC(12,2)
    SET @TOTALFAC = 0
    SET @PROMEDIO = 0
    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

    SELECT @TOTALFAC = SUM(FACTURAR) FROM TMPDETSERVICIOS WHERE IDENT = @IDENT
    SET @PROMEDIO = @TOTALFAC / @TOTDIAS


    SELECT DISTINCT @TARIFUNI = TRAMVAL
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND ESCALASERV.ESCSERV = '15'
        AND @PROMEDIO BETWEEN TRAMDESDE AND TRAMHASTA


    SELECT DISTINCT TMPDETSERVICIOS.CONTRATO AS CONTR
        , CONTRDESC
        , TOTSOP
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 1,2

    SELECT ISNULL(@TOTALFAC, 0) AS TOTALFAC, ISNULL(@PROMEDIO, 0) AS PROMEDIO, ISNULL(@TARIFUNI, 0) AS TARIFUNI, ISNULL((@TOTALFAC*@TARIFUNI), 0) AS TOTAL

    SELECT LINEA, TMPDETSERVICIOS.CONTRATO AS CONTR, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
        , MONDESC
        , MEDDESC
        , CONTRDESC
         , TOTCT, TOTST, TOTDP
         , TOTSTOCK, TOTSOP, TOTUNI, TOTTONE
         , ISNULL(@VALUF, 0) AS VALUF, ISNULL(@VALDOLAR, 0) AS VALDOLAR
         , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
         , @TOTDIAS AS DIASFACT
         , ISNULL(@TOTALFAC, 0) AS TOTALFAC
         , ISNULL(@PROMEDIO, 0) AS PROMEDIO
         , ISNULL(@TARIFUNI, 0) AS TARIFUNI
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 2,1,3
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[PA_NUMERALPROMEDIOMINTUNEL22]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0

    DECLARE @TOTTRAMO AS INT
    DECLARE @ESCCOD AS INT
    DECLARE @TOTDIAS AS INT


 IF @IDENT = 0
 BEGIN

    DECLARE @TABLA VARCHAR(30)
    SET @TABLA = 'TMPSERV_MINTUNEL'

    BEGIN TRAN
        DECLARE @CODI AS INT
        SET @CODI = 0

        SELECT @CODI = CODIGO + 1 FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))
        IF @CODI > 0
        BEGIN

            UPDATE CORRTABLAS
            SET CODIGO = @CODI
            WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))

        END
        ELSE
            BEGIN
                ROLLBACK TRAN
                SET @CODI = -1
            END
    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
	SET @CODI = 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
	SET @IDENT = @CODI
    END
 END 

    SELECT @TOTTRAMO = ESCALASERV.TOTTRAMAS
        , @ESCCOD = ESCALASERV.ESCCOD
    FROM ESCALASERV
    WHERE ESCALASERV.ESCCONTR = @CONTR
        AND ESCALASERV.ESCSERV = '15'

    DECLARE CURPALLET CURSOR FOR
	    SELECT CONTRATO.CONT_CODI
	    FROM CONTRATO INNER JOIN CONTRPARA
	        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
	        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
	         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
	         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
	    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
	        AND CONTRPARA.CPAR_SERVI = '15'
	        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
	        AND ESCALASERV.ESCSERV = '15'
	        AND CONTRPARA.CPAR_MARCA = '1'
    OPEN CURPALLET
    FETCH NEXT FROM CURPALLET INTO @CONTR
    WHILE @@FETCH_STATUS = 0
    BEGIN

	EXEC PA_NUMERALES @FECINI, @FECFIN, @RUTCLI, @CONTR, @IDENT

        FETCH NEXT FROM CURPALLET INTO @CONTR
    END
    CLOSE CURPALLET
    DEALLOCATE CURPALLET

    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)


    --DROP TABLE #CONTRATOS
    SELECT CONTRPARA.CPAR_CONTR, ESCALASERV.ESCCOD, 0 AS CONT  --CONTRATO.CONT_CODI,
        , CONTRATO.CONT_DIAGRACIA
        , (CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG-1 END) AS CONT_TUNELG
        , CONTRATO.CONT_DESCR
            , CONTRATO.CONT_DIACONT, CONTRATO.CONT_PALLET
            , 0 AS CPAR_VALOR
         , MONEDAS.MON_DESCR, MONEDAS.MON_VALOR
         , MEDIDAS.MED_DESCR
        , 0 AS STOCK
        , 0 AS UNIDADES
        , 0 AS TONELADAS
    INTO #CONTRATOS
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND CONTRPARA.CPAR_SERVI = '15'
        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
        AND ESCALASERV.ESCSERV = '15'
        AND CONTRPARA.CPAR_MARCA = '1'

    DECLARE @COD VARCHAR(7)
    DECLARE @DESDE VARCHAR(7)
    DECLARE @HASTA VARCHAR(10)
    DECLARE @VAL VARCHAR(7)

    DECLARE CURTRAMA CURSOR FOR SELECT TRAMCOD, TRAMDESDE, TRAMHASTA, TRAMVAL FROM TRAMO WHERE ESCCOD = @ESCCOD
    OPEN CURTRAMA
    FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    WHILE @@FETCH_STATUS = 0
    BEGIN

        UPDATE #CONTRATOS
        SET CONT = CONT+1
--        SELECT *
        FROM #CONTRATOS INNER JOIN TRAMO
            ON #CONTRATOS.ESCCOD = TRAMO.ESCCOD
        --WHERE TRAMO.TRAMCOD = TRAMCOD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL
        WHERE TRAMO.TRAMCOD = @COD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL

        FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    END
    CLOSE CURTRAMA
    DEALLOCATE CURTRAMA

    --DROP TABLE #CONTR
    SELECT * INTO #CONTR FROM #CONTRATOS WHERE CONT = @TOTTRAMO

    --DROP TABLE #RESUMEN
    SELECT distinct TMPDETSERVICIOS.CONTRATO AS CONTR
        , (SUM(FACTURAR) * #CONTR.CPAR_VALOR) AS VALNETO
              , SUM(CT) AS TOTCT
        , SUM(ST) AS TOTST
              , SUM(DP) AS TOTDP
        , SUM(TMPDETSERVICIOS.STOCK) AS TOTSTOCK
        , SUM(TMPDETSERVICIOS.FACTURAR) AS TOTSOP
              , SUM(TMPDETSERVICIOS.UNIDADES) AS TOTUNI
        , SUM(TMPDETSERVICIOS.TONELADAS) AS TOTTONE
        , #CONTR.MON_DESCR AS MONDESC
        , #CONTR.MON_VALOR as MONVAL
             , #CONTR.MED_DESCR AS MEDDESC
        , #CONTR.CONT_DESCR AS CONTRDESC
    INTO #RESUMEN
    FROM TMPDETSERVICIOS
        INNER JOIN #CONTR
            ON TMPDETSERVICIOS.CONTRATO = #CONTR.CPAR_CONTR COLLATE SQL_Latin1_General_CP1_CI_AS
        INNER JOIN ESCALASERV
            ON #CONTR.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS
            AND '15' = ESCALASERV.ESCSERV
    WHERE IDENT = @IDENT
    GROUP BY TMPDETSERVICIOS.CONTRATO, #CONTR.CPAR_VALOR, #CONTR.MON_DESCR, #CONTR.MON_VALOR, #CONTR.MED_DESCR, #CONTR.CONT_DESCR

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)

    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
    SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

    DECLARE @TOTALFAC  AS DEC(12,2)
    DECLARE @PROMEDIO  AS DEC(12,2)
    DECLARE @TARIFUNI AS DEC(12,2)
    SET @TOTALFAC = 0
    SET @PROMEDIO = 0
    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

    SELECT @TOTALFAC = SUM(FACTURAR) FROM TMPDETSERVICIOS WHERE IDENT = @IDENT
    SET @PROMEDIO = @TOTALFAC / @TOTDIAS


    SELECT DISTINCT @TARIFUNI = TRAMVAL
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND ESCALASERV.ESCSERV = '15'
        AND @PROMEDIO BETWEEN TRAMDESDE AND TRAMHASTA


    SELECT DISTINCT TMPDETSERVICIOS.CONTRATO AS CONTR
        , CONTRDESC
        , TOTSOP
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 1,2

    SELECT ISNULL(@TOTALFAC, 0) AS TOTALFAC, ISNULL(@PROMEDIO, 0) AS PROMEDIO, ISNULL(@TARIFUNI, 0) AS TARIFUNI, ISNULL((@TOTALFAC*@TARIFUNI), 0) AS TOTAL

    SELECT LINEA, TMPDETSERVICIOS.CONTRATO AS CONTR, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
        , MONDESC
        , MEDDESC
        , CONTRDESC
         , TOTCT, TOTST, TOTDP
         , TOTSTOCK, TOTSOP, TOTUNI, TOTTONE
         , ISNULL(@VALUF, 0) AS VALUF, ISNULL(@VALDOLAR, 0) AS VALDOLAR
         , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
         , @TOTDIAS AS DIASFACT
         , ISNULL(@TOTALFAC, 0) AS TOTALFAC
         , ISNULL(@PROMEDIO, 0) AS PROMEDIO
         , ISNULL(@TARIFUNI, 0) AS TARIFUNI
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 2,1,3
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




CREATE PROCEDURE [dbo].[PA_PA_NUMERALPROMEDIOMINTUNEL]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0
 DECLARE @DESCONTR AS VARCHAR(40)
 DECLARE @DIAGR AS SMALLINT
 DECLARE @TUNELG AS INT
 DECLARE @DIACONT AS SMALLINT
 DECLARE @MINPALL AS INT
 DECLARE @RECEPANT AS INT
 DECLARE @RUNIDANT AS INT
 DECLARE @RTONEANT AS INT
 DECLARE @DESPANT AS INT
 DECLARE @DUNIDANT AS INT
 DECLARE @DTONEANT AS INT
 DECLARE @RECEPPER AS INT
 DECLARE @DESPPER AS INT
 DECLARE @STOCK AS INT
 DECLARE @UNIDADES AS INT
 DECLARE @TONELADAS AS INT
 DECLARE @TOTDIAS AS INT
 DECLARE @CONTRVAL AS DEC(12,2)
 DECLARE @MONDESC AS VARCHAR(30)
 DECLARE @MONVAL AS DEC(12,2)
 DECLARE @MEDDESC AS VARCHAR(30)

 SET @DESCONTR = ''
 SET @DIAGR = 0
 SET @TUNELG = 0
 SET @DIACONT = 0
 SET @MINPALL = 0
 SET @STOCK = 0
 SET @RUNIDANT = 0
 SET @RTONEANT = 0
 SET @DUNIDANT = 0
 SET @DTONEANT = 0
 SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)
 SET @CONTRVAL = 0
 SET @MONDESC = ''
 SET @MONVAL = 0
 SET @MEDDESC = ''

 SELECT @DIAGR=CONTRATO.CONT_DIAGRACIA
      , @TUNELG=CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG END
      , @DESCONTR=CONTRATO.CONT_DESCR
      , @DIACONT=CONTRATO.CONT_DIACONT, @MINPALL=CONTRATO.CONT_PALLET
      , @CONTRVAL = CONTRPARA.CPAR_VALOR
      , @MONDESC = MONEDAS.MON_DESCR, @MONVAL = MONEDAS.MON_VALOR
      , @MEDDESC = MEDIDAS.MED_DESCR
 FROM CONTRPARA INNER JOIN
      CONTRATO ON CONTRPARA.CPAR_CONTR = CONTRATO.CONT_CODI INNER JOIN MONEDAS
      MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
      MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
 WHERE CONTRPARA.CPAR_CONTR = @CONTR
  AND CONTRPARA.CPAR_SERVI = 14


CREATE TABLE #NUMMIN (LINEA INT, FECHA VARCHAR(10), FECHA1 VARCHAR(10), CT INT, ST INT, DP INT, STOCK INT, FACTURAR INT, UNIDADES INT, TONELADAS DECIMAL(12,2))

DECLARE @LIN INT
DECLARE @ILIN INT
Declare @Dfechaini datetime
Declare @Dfechafin datetime

set @dfechaini = DATEADD(  DAY, (CASE WHEN @TUNELG=0 THEN 0 ELSE - @tuneLG - 2 END) , convert(datetime , @fecini,101))
set @dfechafin = convert(datetime , @fecfin,101)
set @LIN=1
while @dfechaini <= @dfechafin
begin
    INSERT INTO #NUMMIN(LINEA, FECHA, FECHA1, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS)
    VALUES(@LIN - @tunelg - 2, convert(char,@dfechaini,103), convert(char,@dfechaini,111), 0, 0, 0, 0, 0, 0, 0)

    set @dfechaini = dateadd(day,1,@dfechaini)
    set @LIN = @LIN +1
end

	DECLARE @TOTCT AS INT
	DECLARE @TOTST AS INT
	DECLARE @TOTDP AS INT
	DECLARE @TOTSTOCK AS INT
	DECLARE @TOTSOP AS INT
	DECLARE @TOTUNI AS INT
	DECLARE @TOTTONE AS DEC(12,2)
	DECLARE @VALNETO AS DEC(12,2)
	DECLARE @VALUF AS DEC(12,2)
	DECLARE @FECUF AS VARCHAR(10)
	DECLARE @VALDOLAR AS DEC(12,2)
	DECLARE @FECDOLAR AS VARCHAR(10)
	SET @TOTCT = 0
	SET @TOTST = 0
	SET @TOTDP = 0
	SET @TOTSTOCK = 0
	SET @TOTSOP = 0
	SET @TOTUNI = 0
	SET @TOTTONE = 0
	SET @VALNETO = 0
	SET @VALUF = 0
	SET @FECUF = ''
	SET @VALDOLAR = 0
	SET @FECDOLAR = ''

DECLARE @FECHALIN AS VARCHAR(10)

SET @LIN = @LIN - 1
SET @ILIN=1
WHILE @ILIN <= @LIN 
BEGIN
       -- CALCULA 

      SELECT  @FECHALIN = FECHA1 FROM #NUMMIN WHERE LINEA = @ILIN

      UPDATE #NUMMIN
           SET CT = (SELECT COUNT(1) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC =  @FECHALIN AND DREC_TUNEL>=1),
	       ST = (SELECT COUNT(1) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC =  @FECHALIN AND DREC_TUNEL=0),
	       DP = (SELECT COUNT(1) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  =  @FECHALIN AND DDES_PALLET=1)
       WHERE LINEA = @ILIN

      UPDATE #NUMMIN

       SET STOCK = (SELECT COUNT(1) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN)
		    -
		   (SELECT COUNT(1) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN AND DDES_PALLET=1)
	,UNIDADES = isnull((SELECT sum(isnull(drec_unidades,0)) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN),0)
			-
		    isnull((SELECT sum(isnull(ddes_unidades,0)) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN),0)
	,TONELADAS = isnull((SELECT sum(isnull(drec_PESO,0)) FROM DETARECE  WHERE DREC_RUTCLI=@RUTCLI AND DREC_CONTCLI=@CONTR AND DREC_CODVIG= 0 AND DREC_FECREC <=  @FECHALIN),0)
			-
		    isnull((SELECT sum(isnull(ddes_PESO,0)) FROM DETAdespa WHERE DDES_RUTCLI=@RUTCLI AND DDES_CONTCLI=@CONTR AND DDES_CODVIG= 0 AND DDES_FECHA  <=  @FECHALIN),0)
       WHERE LINEA = @ILIN

      IF @ILIN=1
		UPDATE #NUMMIN SET FACTURAR = STOCK WHERE LINEA = @ILIN
	ELSE
	begin
		UPDATE #NUMMIN  SET FACTURAR = ST - DP + ISNULL((SELECT F.FACTURAR FROM #NUMMIN F WHERE F.LINEA = @ILIN - 1),0) WHERE LINEA = @ILIN

		UPDATE #NUMMIN SET FACTURAR = facturar + ISNULL((SELECT F.CT FROM #NUMMIN F WHERE F.LINEA = @ILIN - @TUNELG   ),0)
		WHERE LINEA = @ILIN
	end

       SET @ILIN= @ILIN + 1
END 

	UPDATE #NUMMIN SET FACTURAR = @MINPALL
	WHERE FACTURAR < @MINPALL and stock>0

 SELECT  @TOTSOP = SUM(FACTURAR), @VALNETO = (SUM(FACTURAR) * @CONTRVAL)
        , @TOTCT = SUM(CT), @TOTST = SUM(ST)
        , @TOTDP = SUM(DP), @TOTSTOCK = SUM(STOCK)
        , @TOTUNI = SUM(UNIDADES), @TOTTONE = SUM(TONELADAS)
 FROM #NUMMIN
 WHERE FECHA1 >=@FECINI

 SELECT  @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
  , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
  , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
  , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
 FROM MONEDAS

 SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
 SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

 IF @IDENT <> 0
 BEGIN
  select 'ins'
  INSERT INTO TMPCABSERVICIOS
  SELECT @IDENT, @CONTR, @CONTRVAL, @MONDESC, @MONVAL, @MEDDESC, @TOTSOP, ISNULL(@VALNETO,0), @VALUF, @FECUF,
     ISNULL(@VALDOLAR,0), ISNULL(@FECDOLAR,0), ISNULL(@TOTCT,0), ISNULL(@TOTST,0),
     ISNULL(@TOTDP,0), ISNULL(@TOTSTOCK,0), ISNULL(@TOTUNI,0), ISNULL(@TOTTONE,0), 0

  INSERT INTO TMPDETSERVICIOS
  SELECT @IDENT, @CONTR, LINEA, FECHA, CT, ST, DP, STOCK, ISNULL(FACTURAR,0), ISNULL(UNIDADES,0), ISNULL(TONELADAS,0)
  FROM #NUMMIN
  WHERE FECHA1 >=@FECINI
  ORDER BY 1
 END
	
 SELECT LINEA, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
      , @CONTRVAL AS CONTRVAL, @MONDESC AS MONDESC
      , @MONVAL AS MONVAL, @MEDDESC AS MEDDESC
      , @TOTSOP AS TOTSOP, @VALNETO AS VALNETO
      , @VALUF AS VALUF, @VALDOLAR AS VALDOLAR
      , @TOTCT AS TOTCT, @TOTST AS TOTST, @TOTDP AS TOTDP
      , @TOTSTOCK AS TOTSTOCK, @TOTUNI AS TOTUNI, @TOTTONE AS TOTTONE
      , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
 FROM #NUMMIN
 WHERE FECHA1 >=@FECINI
 ORDER BY 1





GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




CREATE PROCEDURE [dbo].[PA_PROMEDIO]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS
 SET NOCOUNT ON
 SET rowcount 0

    DECLARE @TOTTRAMO AS INT
    DECLARE @ESCCOD AS INT
    DECLARE @TOTDIAS AS INT

    SELECT @TOTTRAMO = ESCALASERV.TOTTRAMAS
        , @ESCCOD = ESCALASERV.ESCCOD
    FROM ESCALASERV
    WHERE ESCALASERV.ESCCONTR = @CONTR
        AND ESCALASERV.ESCSERV = '15'

    DECLARE CURPALLET CURSOR FOR
	    SELECT CONTRATO.CONT_CODI
	    FROM CONTRATO INNER JOIN CONTRPARA
	        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
	        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
	         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
	         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
	    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
	        AND CONTRPARA.CPAR_SERVI = '15'
	        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
	        AND ESCALASERV.ESCSERV = '15'
	        AND CONTRPARA.CPAR_MARCA = '1'
    OPEN CURPALLET
    FETCH NEXT FROM CURPALLET INTO @CONTR
    WHILE @@FETCH_STATUS = 0
    BEGIN

	EXEC PA_NUMERALES @FECINI, @FECFIN, @RUTCLI, @CONTR, @IDENT

        FETCH NEXT FROM CURPALLET INTO @CONTR
    END
    CLOSE CURPALLET
    DEALLOCATE CURPALLET

    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

    SELECT @TOTTRAMO = ESCALASERV.TOTTRAMAS
        , @ESCCOD = ESCALASERV.ESCCOD
    FROM ESCALASERV
    WHERE ESCALASERV.ESCCONTR = @CONTR
        AND ESCALASERV.ESCSERV = '15'

    --DROP TABLE #CONTRATOS
    SELECT CONTRPARA.CPAR_CONTR, ESCALASERV.ESCCOD, 0 AS CONT  --CONTRATO.CONT_CODI,
        , CONTRATO.CONT_DIAGRACIA
        , (CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG-1 END) AS CONT_TUNELG
        , CONTRATO.CONT_DESCR
            , CONTRATO.CONT_DIACONT, CONTRATO.CONT_PALLET
            , 0 AS CPAR_VALOR
         , MONEDAS.MON_DESCR, MONEDAS.MON_VALOR
         , MEDIDAS.MED_DESCR
        , 0 AS STOCK
        , 0 AS UNIDADES
        , 0 AS TONELADAS
    INTO #CONTRATOS
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND CONTRPARA.CPAR_SERVI = '15'
        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
        AND ESCALASERV.ESCSERV = '15'
        AND CONTRPARA.CPAR_MARCA = '1'

    DECLARE @COD VARCHAR(7)
    DECLARE @DESDE VARCHAR(7)
    DECLARE @HASTA VARCHAR(10)
    DECLARE @VAL VARCHAR(7)

    DECLARE CURTRAMA CURSOR FOR SELECT TRAMCOD, TRAMDESDE, TRAMHASTA, TRAMVAL FROM TRAMO WHERE ESCCOD = @ESCCOD
    OPEN CURTRAMA
    FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    WHILE @@FETCH_STATUS = 0
    BEGIN

        UPDATE #CONTRATOS
        SET CONT = CONT+1
--        SELECT *
        FROM #CONTRATOS INNER JOIN TRAMO
            ON #CONTRATOS.ESCCOD = TRAMO.ESCCOD
        --WHERE TRAMO.TRAMCOD = TRAMCOD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL
        WHERE TRAMO.TRAMCOD = @COD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL

        FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    END
    CLOSE CURTRAMA
    DEALLOCATE CURTRAMA

    --DROP TABLE #CONTR
    SELECT * INTO #CONTR FROM #CONTRATOS WHERE CONT = @TOTTRAMO

    --DROP TABLE #RESUMEN
    SELECT distinct TMPDETSERVICIOS.CONTRATO AS CONTR
        , (SUM(FACTURAR) * #CONTR.CPAR_VALOR) AS VALNETO
              , SUM(CT) AS TOTCT
        , SUM(ST) AS TOTST
              , SUM(DP) AS TOTDP
        , SUM(TMPDETSERVICIOS.STOCK) AS TOTSTOCK
        , SUM(TMPDETSERVICIOS.FACTURAR) AS TOTSOP
              , SUM(TMPDETSERVICIOS.UNIDADES) AS TOTUNI
        , SUM(TMPDETSERVICIOS.TONELADAS) AS TOTTONE
        , #CONTR.MON_DESCR AS MONDESC
        , #CONTR.MON_VALOR as MONVAL
             , #CONTR.MED_DESCR AS MEDDESC
        , #CONTR.CONT_DESCR AS CONTRDESC
    INTO #RESUMEN
    FROM TMPDETSERVICIOS
        INNER JOIN #CONTR
            ON TMPDETSERVICIOS.CONTRATO = #CONTR.CPAR_CONTR COLLATE SQL_Latin1_General_CP1_CI_AS
        INNER JOIN ESCALASERV
            ON #CONTR.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS
            AND '15' = ESCALASERV.ESCSERV
    WHERE IDENT = @IDENT
    GROUP BY TMPDETSERVICIOS.CONTRATO, #CONTR.CPAR_VALOR, #CONTR.MON_DESCR, #CONTR.MON_VALOR, #CONTR.MED_DESCR, #CONTR.CONT_DESCR

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)

    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
    SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

    DECLARE @TOTALFAC  AS DEC(12,2)
    DECLARE @PROMEDIO  AS DEC(12,2)
    DECLARE @TARIFUNI AS DEC(12,2)
    SET @TOTALFAC = 0
    SET @PROMEDIO = 0
    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

    SELECT @TOTALFAC = SUM(FACTURAR) FROM TMPDETSERVICIOS WHERE IDENT = @IDENT
    SET @PROMEDIO = @TOTALFAC / @TOTDIAS


    SELECT DISTINCT @TARIFUNI = TRAMVAL
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND ESCALASERV.ESCSERV = '15'
        AND @PROMEDIO BETWEEN TRAMDESDE AND TRAMHASTA


    SELECT DISTINCT TMPDETSERVICIOS.CONTRATO
        , CONTRDESC
        , TOTSOP
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 1,2

    SELECT ISNULL(@TOTALFAC, 0) AS TOTALFAC, ISNULL(@PROMEDIO, 0) AS PROMEDIO, ISNULL(@TARIFUNI, 0) AS TARIFUNI, ISNULL((@TOTALFAC*@TARIFUNI), 0) AS TOTAL

    SELECT LINEA, TMPDETSERVICIOS.CONTRATO, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
        , MONDESC
        , MEDDESC
        , CONTRDESC
         , TOTCT, TOTST, TOTDP
         , TOTSTOCK, TOTSOP, TOTUNI, TOTTONE
         , ISNULL(@VALUF, 0) AS VALUF, ISNULL(@VALDOLAR, 0) AS VALDOLAR
         , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
         , @TOTDIAS AS DIASFACT
         , ISNULL(@TOTALFAC, 0) AS TOTALFAC
         , ISNULL(@PROMEDIO, 0) AS PROMEDIO
         , ISNULL(@TARIFUNI, 0) AS TARIFUNI
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 2,1,3



GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    Carolina Uribe Ruiz / ACL
-- Objetivo: RETORNA FECHA Y HORA DESDE LA BASE DE DATOS
-- Fecha de Creacin: 13/09/2007
-- Modificaciones:
-- Pruebas
/*
exec  PA_RET_FECHAHORA
*/
CREATE PROCEDURE [dbo].[PA_RET_FECHAHORA]
AS

    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    SELECT CONVERT(VARCHAR(10),GETDATE(),103) AS FECHA, CONVERT(VARCHAR(5),GETDATE(),108) AS HORA
    RETURN 0


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_RET_GUIASDESPC]
  @FPRE_CODI NVARCHAR(7)
AS

  UPDATE TMPFICHPRED
  SET EST_CODI = 2
  WHERE FPRE_CODI = @FPRE_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    RETORNA GUIAS DE RECEPCION
-- Fecha de Creacin:25-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_RET_GUIASRECEP

*/
CREATE PROCEDURE [dbo].[PA_RET_GUIASRECEP]
  @FREC_CODI NVARCHAR(7)
AS

        UPDATE TMPFICHRECE
        SET EST_CODI = 2
        WHERE FREC_CODI = @FREC_CODI


GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_SUMACONTRATOS]
  @FECINI AS VARCHAR(10)
, @FECFIN AS VARCHAR(10)
, @RUTCLI AS VARCHAR(9)
, @CONTR AS VARCHAR(7)
, @IDENT AS NUMERIC = 0
AS

    SET NOCOUNT ON
    SET rowcount 0

/*
    DECLARE @FECINI AS VARCHAR(10)
    DECLARE @FECFIN AS VARCHAR(10)
    DECLARE @RUTCLI AS VARCHAR(9)
    DECLARE @CONTR AS VARCHAR(7)
    DECLARE @IDENT AS NUMERIC

    SET @FECINI = '2008/04/01'
    SET @FECFIN = '2008/04/15'
    SET @RUTCLI = '965579109'  --'0021101'  '0021100'
    SET @CONTR = '0021100'
    SET @IDENT = 0 --32
*/

 IF @IDENT = 0
 BEGIN

    DECLARE @TABLA VARCHAR(30)
    SET @TABLA = 'TMPSERV_MINTUNEL'

    BEGIN TRAN
        DECLARE @CODI AS INT
        SET @CODI = 0

        SELECT @CODI = CODIGO + 1 FROM CORRTABLAS WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))
        IF @CODI > 0
        BEGIN

            UPDATE CORRTABLAS
            SET CODIGO = @CODI
            WHERE RTRIM(LTRIM(TABLA)) = RTRIM(LTRIM('TMPSERV_MINTUNEL'))

        END
        ELSE
            BEGIN
                ROLLBACK TRAN
                SET @CODI = -1
            END
    IF @@ERROR > 0
    BEGIN
        ROLLBACK TRAN
	SET @CODI = 0
    END
    ELSE
    BEGIN
        COMMIT TRAN
	SET @IDENT = @CODI
    END
 END 


    DECLARE @TOTTRAMO AS INT
    DECLARE @ESCCOD AS INT
    DECLARE @TOTDIAS AS INT

    SELECT @TOTTRAMO = ESCALASERV.TOTTRAMAS
        , @ESCCOD = ESCALASERV.ESCCOD
    FROM ESCALASERV
    WHERE ESCALASERV.ESCCONTR = @CONTR
        AND ESCALASERV.ESCSERV = '16'

    DECLARE CURPALLET CURSOR FOR
	    SELECT CONTRATO.CONT_CODI 
	    FROM CONTRATO INNER JOIN CONTRPARA
	        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
	        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
	         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
	         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
	    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
	        AND CONTRPARA.CPAR_SERVI = '16'
	        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
	        AND ESCALASERV.ESCSERV = '16'
	        AND CONTRPARA.CPAR_MARCA = '1'
    OPEN CURPALLET
    FETCH NEXT FROM CURPALLET INTO @CONTR
    WHILE @@FETCH_STATUS = 0
    BEGIN

	EXEC PA_NUMERALES @FECINI, @FECFIN, @RUTCLI, @CONTR, @IDENT

        FETCH NEXT FROM CURPALLET INTO @CONTR
    END
    CLOSE CURPALLET
    DEALLOCATE CURPALLET
--**********************************************************************************************************************************

    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

  --  DROP TABLE #CONTRATOS
    SELECT CONTRPARA.CPAR_CONTR, ESCALASERV.ESCCOD, 0 AS CONT  --CONTRATO.CONT_CODI,
        , CONTRATO.CONT_DIAGRACIA
        , (CASE WHEN CONTRATO.CONT_TUNELG=0 THEN 0 ELSE CONTRATO.CONT_TUNELG-1 END) AS CONT_TUNELG
        , CONTRATO.CONT_DESCR
            , CONTRATO.CONT_DIACONT, CONTRATO.CONT_PALLET
            , 0 AS CPAR_VALOR
        , MONEDAS.MON_DESCR, MONEDAS.MON_VALOR
        , MEDIDAS.MED_DESCR
        , 0 AS STOCK
        , 0 AS UNIDADES
        , 0 AS TONELADAS
    INTO #CONTRATOS
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS  INNER JOIN MONEDAS
         MONEDAS ON CONTRPARA.CPAR_MONEDA = MONEDAS.MON_CODI INNER JOIN
         MEDIDAS ON CONVERT(INT,CONTRPARA.CPAR_MEDIDA) = CONVERT(INT,MEDIDAS.MED_CODI)
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND CONTRPARA.CPAR_SERVI = '16'
        AND ESCALASERV.TOTTRAMAS = @TOTTRAMO
        AND ESCALASERV.ESCSERV = '16'
        AND CONTRPARA.CPAR_MARCA = '1'


    DECLARE @COD VARCHAR(7)
    DECLARE @DESDE VARCHAR(7)
    DECLARE @HASTA VARCHAR(10)
    DECLARE @VAL VARCHAR(7)

    DECLARE CURTRAMA CURSOR FOR SELECT TRAMCOD, TRAMDESDE, TRAMHASTA, TRAMVAL FROM TRAMO WHERE ESCCOD = @ESCCOD
    OPEN CURTRAMA
    FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    WHILE @@FETCH_STATUS = 0
    BEGIN

        UPDATE #CONTRATOS
        SET CONT = CONT+1
--        SELECT *
        FROM #CONTRATOS INNER JOIN TRAMO
            ON #CONTRATOS.ESCCOD = TRAMO.ESCCOD
        WHERE TRAMO.TRAMCOD = @COD AND TRAMDESDE = @DESDE AND TRAMHASTA = @HASTA AND TRAMVAL = @VAL

        FETCH NEXT FROM CURTRAMA INTO @COD, @DESDE, @HASTA, @VAL
    END
    CLOSE CURTRAMA
    DEALLOCATE CURTRAMA

--    DROP TABLE #CONTR
    SELECT * INTO #CONTR FROM #CONTRATOS WHERE CONT = @TOTTRAMO 

    SELECT @TOTDIAS = COUNT(*) FROM TMPDETSERVICIOS WHERE IDENT = @IDENT

--    DROP TABLE #RESUMEN
    SELECT TMPDETSERVICIOS.CONTRATO AS CONTR
        , (SUM(FACTURAR) * #CONTR.CPAR_VALOR) AS VALNETO
              , SUM(CT) AS TOTCT
        , SUM(ST) AS TOTST
              , SUM(DP) AS TOTDP
        , SUM(TMPDETSERVICIOS.STOCK) AS TOTSTOCK
        , SUM(TMPDETSERVICIOS.FACTURAR) AS TOTSOP
              , SUM(TMPDETSERVICIOS.UNIDADES) AS TOTUNI
        , SUM(TMPDETSERVICIOS.TONELADAS) AS TOTTONE
        , #CONTR.MON_DESCR AS MONDESC
        , #CONTR.MON_VALOR as MONVAL
        , #CONTR.MED_DESCR AS MEDDESC
        , #CONTR.CONT_DESCR AS CONTRDESC
        , #CONTR.CONT_PALLET AS CONT_PALLET
    INTO #RESUMEN
    FROM TMPDETSERVICIOS
        INNER JOIN #CONTR
            ON TMPDETSERVICIOS.CONTRATO = #CONTR.CPAR_CONTR COLLATE SQL_Latin1_General_CP1_CI_AS
        INNER JOIN ESCALASERV
            ON #CONTR.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS
            AND '16' = ESCALASERV.ESCSERV
    WHERE IDENT = @IDENT
    GROUP BY TMPDETSERVICIOS.CONTRATO, #CONTR.CPAR_VALOR, #CONTR.MON_DESCR, #CONTR.MON_VALOR, #CONTR.MED_DESCR, #CONTR.CONT_DESCR, #CONTR.CONT_PALLET

    DECLARE @VALUF AS DEC(12,2)
    DECLARE @FECUF AS VARCHAR(10)
    DECLARE @VALDOLAR AS DEC(12,2)
    DECLARE @FECDOLAR AS VARCHAR(10)

    SET @VALUF = 0
    SET @FECUF = ''
    SET @VALDOLAR = 0
    SET @FECDOLAR = ''

    SELECT @VALUF = CASE WHEN MON_CODI = '02' THEN MON_VALOR ELSE @VALUF END
        , @FECUF = CASE WHEN MON_CODI = '02' THEN MON_FECVAL ELSE @FECUF END
        , @VALDOLAR = CASE WHEN MON_CODI = '01' THEN MON_VALOR ELSE @VALDOLAR END
        , @FECDOLAR = CASE WHEN MON_CODI = '01' THEN MON_FECVAL ELSE @FECDOLAR END
    FROM MONEDAS

    SET @FECUF = SUBSTRING(@FECUF, 9, 2)+'/'+SUBSTRING(@FECUF, 6, 2)+'/'+SUBSTRING(@FECUF, 1, 4)
    SET @FECDOLAR = SUBSTRING(@FECDOLAR, 9, 2)+'/'+SUBSTRING(@FECDOLAR, 6, 2)+'/'+SUBSTRING(@FECDOLAR, 1, 4)

    DECLARE @TOTALFAC  AS DEC(12,2)
    DECLARE @PROMEDIO  AS DEC(12,2)
    DECLARE @TARIFUNI AS DEC(12,2)
    SET @TOTALFAC = 0
    SET @PROMEDIO = 0
    SET @TOTDIAS = (DATEDIFF(DAY, CONVERT(DATETIME, @FECINI, 111), CONVERT(DATETIME, @FECFIN, 111)) + 1)

    SELECT @TOTALFAC = SUM(FACTURAR) FROM TMPDETSERVICIOS WHERE IDENT = @IDENT

    SET @PROMEDIO = @TOTALFAC / @TOTDIAS

    SELECT DISTINCT @TARIFUNI = TRAMVAL
    FROM CONTRATO INNER JOIN CONTRPARA
        ON CONTRATO.CONT_CODI = CONTRPARA.CPAR_CONTR INNER JOIN ESCALASERV
        ON CONTRPARA.CPAR_CONTR = ESCALASERV.ESCCONTR COLLATE MODERN_SPANISH_CI_AS INNER JOIN TRAMO
        ON ESCALASERV.ESCCOD = TRAMO.ESCCOD
    WHERE CONTRATO.CONT_RUTCLIE = @RUTCLI
        AND ESCALASERV.ESCSERV = '16'
        AND @PROMEDIO BETWEEN TRAMDESDE AND TRAMHASTA


    SELECT DISTINCT TMPDETSERVICIOS.CONTRATO AS CONTR
        , CONTRDESC
        , TOTSOP
        , TOTSTOCK
        , CONT_PALLET
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 1,2


    DECLARE @CONTRA VARCHAR(7) 
    DECLARE @PALL AS INT
    DECLARE @SQL AS VARCHAR(5000)
    DECLARE @I AS INT

    SET @CONTRA = ''
    SET @PALL = 0
    SET @SQL = ''
    SET @I = 0
    DECLARE CURCONTR CURSOR FOR SELECT CPAR_CONTR, CONT_PALLET FROM #CONTR ORDER BY CPAR_CONTR
    OPEN CURCONTR
    FETCH NEXT FROM CURCONTR INTO @CONTRA, @PALL
    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @I = @I + 1
        SET @SQL = @SQL + ', (SELECT STOCK FROM TMPDETSERVICIOS WHERE CONTRATO = ' + CHAR(39) + @CONTRA +  CHAR(39) + ' AND LINEA = #SOPDIARIOS.LINEA) AS ' + CHAR(39) + @CONTRA + CHAR(39)

        FETCH NEXT FROM CURCONTR INTO @CONTRA, @PALL
    END
    CLOSE CURCONTR
    DEALLOCATE CURCONTR

--    DROP TABLE #SOPDIARIOS
    SELECT DISTINCT LINEA, FECHA
    INTO #SOPDIARIOS
    FROM TMPDETSERVICIOS
    WHERE IDENT = @IDENT

    DECLARE @SQL2 AS VARCHAR(5000)

    SET @SQL2 = ''
    SET @SQL2 = 'SELECT LINEA, FECHA' + @SQL
    SET @SQL2 = @SQL2 + ' FROM #SOPDIARIOS '
    EXEC (@SQL2)


    SELECT ISNULL(@TOTALFAC,0) AS TOTALFAC, ISNULL(@PROMEDIO,0) AS PROMEDIO, ISNULL(@TARIFUNI,0) AS TARIFUNI, (ISNULL(@TOTALFAC,0)*ISNULL(@TARIFUNI,0)) AS TOTAL

    SELECT LINEA, TMPDETSERVICIOS.CONTRATO AS CONTR, FECHA, CT, ST, DP, STOCK, FACTURAR, UNIDADES, TONELADAS
        , MONDESC
        , MEDDESC
        , CONTRDESC
         , TOTCT, TOTST, TOTDP
         , TOTSTOCK, TOTSOP, TOTUNI, TOTTONE
         , @VALUF AS VALUF, @VALDOLAR AS VALDOLAR
         , @FECUF AS FECUF, @FECDOLAR AS FECDOLAR
         , @TOTDIAS AS DIASFACT
         , @TOTALFAC AS TOTALFAC
         , @PROMEDIO AS PROMEDIO
         , @TARIFUNI AS TARIFUNI
    FROM TMPDETSERVICIOS INNER JOIN #RESUMEN
        ON TMPDETSERVICIOS.CONTRATO = #RESUMEN.CONTR
    WHERE IDENT = @IDENT
    ORDER BY 2,1,3

    SELECT CONT_PALLET FROM #CONTR ORDER BY CPAR_CONTR


    EXEC PA_LST_TRAMOSXCLIE @RUTCLI, '16', @CONTR

GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_VER_CLIENTES]
@CLI_RUT NVARCHAR(10)
AS
   SELECT CLI_NOMB FROM CLIENTES
   WHERE  CLI_RUT = @CLI_RUT


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_VER_DETAPRED]
@DPRE_CODI NVARCHAR(18)
AS
 SELECT  DPRE_CODI,
      DPRE_CODPRO,
         DPRE_CODSOPO,
       DPRE_SOPOCLI,
         DPRE_UNIDADES,
      DPRE_PESO,
      DPRE_FECDES,
      DPRE_RUTCLI,
      DPRE_CONTCLI,
      DPRE_FECPROD,
      DPRE_CAMARA,
      DPRE_BANDA,
      DPRE_COLUM,
      DPRE_PISO,
      DPRE_NIVEL,
      DPRE_ALMACEN,
      DPRE_DCAJA,
      DPRE_FOLIO,
      DPRE_ACTIVA,
      DPRE_RADIO,
      DPRE_TRACK,
      DPRE_CODVIG,
      DPRE_PALLET,
      DPRE_SLOT,
      DPRE_TS,
      DPRE_TM,
      DPRE_TI,
      DPRE_CODPER,
      DPRE_HORA,
      DPRE_FECN
--      DPRE_FOLIO_PALLET
   FROM  DETAPRED
   WHERE SUBSTRING(DPRE_CODI,1,7) = @DPRE_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_VER_FICHPRED]
@FPRE_CODI       NVARCHAR(14)
AS
   SELECT FPRE_CODI,
    FPRE_RUTCLI,
    FPRE_HORADES,
    FPRE_HORATER,
    FPRE_FECDES,
    FPRE_TOTSOPO,
    FPRE_TOTUNIDAD,
    FPRE_TOTPESO,
          FPRE_RUTCOND,
          FPRE_CODIENCA,
          FPRE_ACTIVA,
          FPRE_FECHACT,
          FPRE_CODVIG,
          FPRE_GDESPA,
          FPRE_RADIO,
          FPRE_TIPO,
          FPRE_PROCESO,
          FPRE_SELLO,
          FPRE_TEM,
          FPRE_ANDEN
--          FPRE_USUCRE
FROM      FICHPRED
WHERE    FPRE_CODI = @FPRE_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_VER_GUIASDESPEND]
  @EST_CODI     INT,  -- CODIGO DE ESTADO
  @FPRE_USUCRE  NVARCHAR(3),    -- USUARIO CREADOR
  @FPRE_RUTCLI  VARCHAR(9),     -- RUT DEL CLIENTE
  @FECCREINI    VARCHAR(10),    -- FECHA CREACION INICIO
  @FECCREFIN    VARCHAR(10)     -- FECHA CREACION FINAL
AS

   SET NOCOUNT ON
   SET ROWCOUNT 200
   SET ROWCOUNT 0
   SET DATEFORMAT mdy

      --- ESTADOS DE PENDIENTES Y POR UN CREADOR

               IF  @FPRE_USUCRE <> '000'
                  BEGIN
                     SELECT DISTINCT 'PENDIENTES' AS EST_GLOSA,                                -- ESTADO GUIA PREDESPACHO
                          TMPFICHPRED.FPRE_CODI,                                   -- GUIA   PREDESPACHO
                          UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB,      -- NOMBRE CLIENTE
                          TMPFICHPRED.FPRE_FECDES,                                 -- FECHA  CREACION
                          TMPFICHPRED.FPRE_FECDES AS FPRE_FECMOD,                               -- FECHA  ACTUAL
                          UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,        -- USUARIO
                          TMPFICHPRED.EST_CODI,
                          TMPFICHPRED.FPRE_PALLET,
                        TMPFICHPRED.FPRE_RUTCLI
                     FROM TMPFICHPRED INNER JOIN
                          USUARIO  ON TMPFICHPRED.FPRE_CODIENCA   = USUARIO.PERSONAL INNER JOIN
                          CLIENTES ON TMPFICHPRED.FPRE_RUTCLI     = CLIENTES.CLI_RUT
                     WHERE CONVERT(INT,TMPFICHPRED.FPRE_CODIENCA) = CONVERT(INT,@FPRE_USUCRE)
                        AND EST_CODI = @EST_CODI
                          AND (480-DATEDIFF(MI, TMPFICHPRED.FPRE_FECDES,CONVERT(VARCHAR(10),GETDATE(),111)))>=0
                  END


                IF  @FPRE_USUCRE = '000'
                    BEGIN
                        SELECT DISTINCT 'PENDIENTES' AS EST_GLOSA,                      -- ESTADO GUIA PREDESPACHO                     T   MPFICHPRED.FPRE_CODI,
                        TMPFICHPRED.FPRE_CODI,      -- GUIA   PREDESPACHO
                        UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB,      -- NOMBRE CLIENTE
                    TMPFICHPRED.FPRE_FECDES,                                 -- FECHA  CREACION
            TMPFICHPRED.FPRE_FECDES AS FPRE_FECMOD,                  -- FECHA  ACTUAL
                        UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,        -- USUARIO
                        TMPFICHPRED.EST_CODI,
                        TMPFICHPRED.FPRE_PALLET,
            TMPFICHPRED.FPRE_RUTCLI
                FROM    TMPFICHPRED INNER JOIN
             USUARIO    ON TMPFICHPRED.FPRE_CODIENCA     = USUARIO.PERSONAL INNER JOIN
             CLIENTES   ON TMPFICHPRED.FPRE_RUTCLI     = CLIENTES.CLI_RUT
        WHERE EST_CODI = @EST_CODI
                AND (480-DATEDIFF(MI, TMPFICHPRED.FPRE_FECDES,CONVERT(VARCHAR(10),GETDATE(),111)))>=0
                END


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



      --- ESTADOS DE PENDIENTES Y POR UN CREADOR
CREATE PROCEDURE [dbo].[PA_VER_GUIASDESPENDCREADAS]
  @EST_CODI     INT,  -- CODIGO DE ESTADO
  @FPRE_USUCRE AS VARCHAR(3),    -- USUARIO CREADOR
  @FPRE_RUTCLI AS VARCHAR(9),   -- RUT DEL CLIENTE
  @FECCREINI    VARCHAR(10),    -- FECHA CREACION INICIO
  @FECCREFIN    VARCHAR(10)     -- FECHA CREACION FINAL
AS
--SP_HELPTEXT PA_VER_GUIASDESPENDCREADAS     0 , '000' , '969849402' , '000000000' , '000000000'
--PA_VER_GUIASDESPENDCREADAS     0 , '909' , '96999710K' , '000000000' , '000000000'
   SET NOCOUNT ON
   SET ROWCOUNT 200
   SET ROWCOUNT 0
-- SELECT * FROM CLIENTES ORDER BY 3
      --- ESTADOS DE PENDIENTES Y POR UN CREADOR

---     IF  @FPRE_USUCRE <> '000'
--     BEGIN
          SELECT 'CREADAS' AS EST_GLOSA,    FPRE_CODIENCA,
               FICHPRED.FPRE_CODI ,
               UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB,
               FICHPRED.FPRE_FECDES,
               FICHPRED.FPRE_FECDES AS FPRE_FECMOD,
               UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,
--               ISNULL(FICHPRED.EST_CODI,0) AS EST_CODI,
               ISNULL(0,0) AS EST_CODI,
               '0' AS FPRE_PALLET,
               FICHPRED.FPRE_RUTCLI
          FROM  FICHPRED INNER JOIN USUARIO
               ON FICHPRED.FPRE_CODIENCA = USUARIO.PERSONAL INNER JOIN CLIENTES
               ON FICHPRED.FPRE_RUTCLI = CLIENTES.CLI_RUT
          WHERE FICHPRED.FPRE_ACTIVA = 0
                AND CONVERT(INT,FICHPRED.FPRE_CODIENCA) = CASE WHEN (@FPRE_USUCRE='000') THEN CONVERT(INT,FICHPRED.FPRE_CODIENCA) ELSE @FPRE_USUCRE END
                AND FICHPRED.FPRE_RUTCLI = CASE WHEN (@FPRE_RUTCLI='0') THEN FICHPRED.FPRE_RUTCLI ELSE @FPRE_RUTCLI END
                AND CONVERT(INT, ISNULL(REPLACE(REPLACE(FICHPRED.FPRE_FECDES,'/',''),'-',''),0)) >= CONVERT(INT,SUBSTRING(CONVERT(VARCHAR(10),DATEADD(MM,-3,GETDATE()),112),1,6)+'01')
                AND CONVERT(INT, ISNULL(REPLACE(REPLACE(FICHPRED.FPRE_FECDES,'/',''),'-',''),0)) <= CONVERT(INT,CONVERT(VARCHAR(10),GETDATE(),112)) --CONVERT(INT,SUBSTRING(CONVERT(VARCHAR(10),GETDATE(),112),1,6)+'01')
          ORDER BY FICHPRED.FPRE_CODI ASC
/*
     IF  @FPRE_USUCRE = '000'
     BEGIN
          SELECT 'CREADAS' AS EST_GLOSA,
               FICHPRED.FPRE_CODI,
               UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB,
               FICHPRED.FPRE_FECDES,
               GETDATE() AS FPRE_FECMOD,
               UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,
               ISNULL(FICHPRED.EST_CODI,0) AS EST_CODI,
               '0' AS FPRE_PALLET,
               FICHPRED.FPRE_RUTCLI
          FROM FICHPRED INNER JOIN USUARIO
                    ON FICHPRED.FPRE_CODIENCA = USUARIO.PERSONAL INNER JOIN CLIENTES
                    ON FICHPRED.FPRE_RUTCLI = CLIENTES.CLI_RUT
          WHERE FICHPRED.FPRE_ACTIVA <> 0
               AND FICHPRED.FREC_RUTCLI = CASE WHEN (@FREC_RUTCLI='') THEN FICHPRED.FPRE_RUTCLI ELSE @FPRE_RUTCLI END
               AND CONVERT(INT, ISNULL(REPLACE(REPLACE(FICHPRED.FPRE_FECDES,'/',''),'-',''),0)) >= CONVERT(INT,SUBSTRING(CONVERT(VARCHAR(10),DATEADD(MM,-3,GETDATE()),112),1,6)+'01')
               AND CONVERT(INT, ISNULL(REPLACE(REPLACE(FICHPRED.FPRE_FECDES,'/',''),'-',''),0)) <= CONVERT(INT,CONVERT(VARCHAR(10),GETDATE(),112)) --CONVERT(INT,SUBSTRING(CONVERT(VARCHAR(10),GETDATE(),112),1,6)+'01')

          ORDER   BY  FICHPRED.FPRE_CODI ASC
     END

*/


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_VER_GUIASDESPENDIENTES_PREDESPACHO]
  @EST_CODI     INT,  -- CODIGO DE ESTADO
  @FPRE_USUCRE  NVARCHAR(3),    -- USUARIO CREADOR
  @FPRE_RUTCLI  VARCHAR(9),     -- RUT DEL CLIENTE
  @FECCREINI    VARCHAR(10),    -- FECHA CREACION INICIO
  @FECCREFIN    VARCHAR(10)     -- FECHA CREACION FINAL
AS

   SET NOCOUNT ON
   SET ROWCOUNT 200
   SET ROWCOUNT 0

      --- ESTADOS DE PENDIENTES Y POR UN CREADOR

               IF  @FPRE_USUCRE <> '000'
                  BEGIN
                     SELECT 'CREADAS' AS EST_GLOSA,
                            FICHPRED.FPRE_CODI ,
                            UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB,
                            FICHPRED.FPRE_FECDES,
                            FICHPRED.FPRE_FECDES AS FPRE_FECMOD,
                            UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,
                            ISNULL(FICHPRED.EST_CODI,0) AS EST_CODI,
                            '0' AS FPRE_PALLET,
                            FICHPRED.FPRE_RUTCLI
                            FROM  FICHPRED,
                                  USUARIO ,
                                  CLIENTES
                          WHERE   FICHPRED.FPRE_USUCRE = USUARIO.PERSONAL
                            AND   FICHPRED.FPRE_RUTCLI = CLIENTES.CLI_RUT
                            AND   CONVERT(INT,FICHPRED.FPRE_USUCRE) = @FPRE_USUCRE
                            AND   FICHPRED.EST_CODI = 1
                           ORDER  BY FICHPRED.FPRE_CODI ASC
                    END

                IF  @FPRE_USUCRE = '000'
                    BEGIN
                    SELECT 'PENDIENTES' AS EST_GLOSA,
                            FICHPRED.FPRE_CODI,
                            UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB,
                            FICHPRED.FPRE_FECDES,
                            FICHPRED.FPRE_FECDES AS FPRE_FECMOD,
                            UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,
                            ISNULL(FICHPRED.EST_CODI,0) AS EST_CODI,
                            '0' AS FPRE_PALLET,
                            FICHPRED.FPRE_RUTCLI
                            FROM    FICHPRED, USUARIO, CLIENTES
                            WHERE   FICHPRED.FPRE_USUCRE     = USUARIO.PERSONAL
                              AND   FICHPRED.FPRE_RUTCLI     = CLIENTES.CLI_RUT
                              AND   FICHPRED.EST_CODI = 1
                           ORDER    BY FICHPRED.FPRE_CODI ASC
                   END


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE PROCEDURE [dbo].[PA_VER_GUIASPREDP]
@FPRE_USUCRE AS NVARCHAR(3)
AS

 SET NOCOUNT ON
 SET rowcount 200
 SET rowcount 0

 SET NOCOUNT ON
 SET rowcount 200
 SET rowcount 0

          SELECT DISTINCT UPPER(LTRIM(RTRIM(TMPESTADOS.EST_GLOSA))) AS EST_GLOSA,
          TMPFICHPRED.FPRE_CODI,
          UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB ,
          TMPFICHPRED.FPRE_FECDES,
          TMPFICHPRED.FPRE_FECDES AS FPRE_FECMOD,
          UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI,
          TMPFICHPRED.EST_CODI
          FROM TMPFICHPRED INNER JOIN
          USUARIO    ON TMPFICHPRED.FPRE_CODIENCA       = USUARIO.PERSONAL INNER JOIN
          CLIENTES   ON TMPFICHPRED.FPRE_RUTCLI      = CLIENTES.CLI_RUT INNER JOIN
          TMPESTADOS ON TMPFICHPRED.EST_CODI         = TMPESTADOS.EST_CODI
          WHERE CONVERT(INT, TMPFICHPRED.FPRE_CODIENCA) = CONVERT(INT,@FPRE_USUCRE)
             AND TMPFICHPRED.EST_CODI = 2


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO





-- Autor:    CAROLINA URIBE RUIZ / ACL
-- Objetivo:    LISTA GUIAS DE RECEPCION
-- Fecha de Creacin: 14-09-2007
-- Modificaciones:
-- Pruebas
/*
exec PA_VER_GUIASRECEP 1 , '050', '', '', ''
*/
CREATE PROCEDURE [dbo].[PA_VER_GUIASRECEP]
  @EST_CODI AS INT
, @FREC_USUCRE AS NVARCHAR(3)
, @FREC_RUTCLI AS VARCHAR(9)
, @FECCREINI VARCHAR(10)
, @FECCREFIN VARCHAR(10)
AS


    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    SET NOCOUNT ON
    SET rowcount 200
    SET rowcount 0

    --DROP TABLE #PENDIENTES
    SELECT DISTINCT UPPER(LTRIM(RTRIM(TMPESTADOS.EST_GLOSA))) AS EST_GLOSA, TMPFICHRECE.FREC_CODI, UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB
        , TMPFICHRECE.FREC_FECCRE
        , TMPFICHRECE.FREC_FECMOD
        , UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI
        , TMPFICHRECE.EST_CODI
    INTO #PENDIENTES
    FROM TMPFICHRECE INNER JOIN
        USUARIO ON TMPFICHRECE.FREC_USUCRE = USUARIO.PERSONAL INNER JOIN
        CLIENTES ON TMPFICHRECE.FREC_RUTCLI = CLIENTES.CLI_RUT INNER JOIN
        TMPESTADOS ON TMPFICHRECE.EST_CODI = TMPESTADOS.EST_CODI
    WHERE TMPFICHRECE.EST_CODI IN (1,2) AND --= CASE WHEN @EST_CODI=2 THEN TMPFICHRECE.EST_CODI ELSE @EST_CODI END AND
         CONVERT(INT,TMPFICHRECE.FREC_USUCRE) = CASE WHEN (@FREC_USUCRE ='') THEN CONVERT(INT,TMPFICHRECE.FREC_USUCRE) ELSE CONVERT(INT,@FREC_USUCRE) END AND
         TMPFICHRECE.FREC_RUTCLI = CASE WHEN (@FREC_RUTCLI='') THEN TMPFICHRECE.FREC_RUTCLI ELSE @FREC_RUTCLI END AND
         (CONVERT(VARCHAR(10),TMPFICHRECE.FREC_FECCRE,105) >= CASE WHEN (@FECCREINI ='') THEN CONVERT(VARCHAR(10),TMPFICHRECE.FREC_FECCRE,105) ELSE @FECCREINI END AND
         CONVERT(VARCHAR(10),TMPFICHRECE.FREC_FECCRE,105) <= CASE WHEN (@FECCREFIN ='') THEN CONVERT(VARCHAR(10),TMPFICHRECE.FREC_FECCRE,105) ELSE @FECCREFIN END) AND
         (480-DATEDIFF(MI, TMPFICHRECE.FREC_FECCRE, GETDATE()))>=0
--    UNION
    --DROP TABLE #CREADAS
    SELECT DISTINCT 'CREADA' AS EST_GLOSA, FICHRECE.FREC_CODI, UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB
        , FICHRECE.FREC_FECREC AS FREC_FECCRE
        , FICHRECE.FREC_FECREC AS FREC_FECMOD
        , UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI
        , 0 AS EST_CODI
    INTO #CREADAS
    FROM FICHRECE INNER JOIN
        DETARECE ON FICHRECE.FREC_CODI = LEFT(DETARECE.DREC_CODI,7) INNER JOIN
        USUARIO ON CONVERT(INT,ISNULL(DETARECE.DREC_CODPER,0)) = CONVERT(INT,USUARIO.PERSONAL) INNER JOIN
        CLIENTES ON FICHRECE.FREC_RUTCLI = CLIENTES.CLI_RUT
    WHERE FICHRECE.FREC_FECREC <> ''
        AND FICHRECE.FREC_RUTCLI = CASE WHEN (@FREC_RUTCLI='') THEN FICHRECE.FREC_RUTCLI ELSE @FREC_RUTCLI END
        AND CONVERT(INT, ISNULL(REPLACE(REPLACE(FICHRECE.FREC_FECREC,'/',''),'-',''),0)) >= CONVERT(INT,SUBSTRING(CONVERT(VARCHAR(10),DATEADD(MM,-3,GETDATE()),112),1,6)+'01')--Modificar meses para ver recepciones antiguas
        AND CONVERT(INT, ISNULL(REPLACE(REPLACE(FICHRECE.FREC_FECREC,'/',''),'-',''),0)) <= CONVERT(INT,CONVERT(VARCHAR(10),GETDATE(),112)) --CONVERT(INT,SUBSTRING(CONVERT(VARCHAR(10),GETDATE(),112),1,6)+'01')
        AND CONVERT(INT,DETARECE.DREC_CODPER) = CONVERT(INT,CASE WHEN (@FREC_USUCRE ='') THEN DETARECE.DREC_CODPER ELSE @FREC_USUCRE END )
        AND CONVERT(INT,DETARECE.DREC_CODPER) = CONVERT(INT,CASE WHEN (@FREC_USUCRE ='') THEN CONVERT(INT,DETARECE.DREC_CODPER) ELSE CONVERT(INT, @FREC_USUCRE) END )
--    ORDER BY 4

    IF @EST_CODI = 0
    BEGIN
        SELECT *
        FROM #CREADAS
        ORDER BY 3, CONVERT(VARCHAR(10), FREC_FECCRE ,105) DESC -- FREC_FECCRE
    END
    ELSE
        IF @EST_CODI = 1
        BEGIN
            SELECT *
            FROM #PENDIENTES
            WHERE EST_CODI = 1
            ORDER BY 3
        END
        ELSE
            IF @EST_CODI = 2
            BEGIN
                SELECT *
                FROM #PENDIENTES
                WHERE EST_CODI = 2
                ORDER BY 3
            END
            ELSE
            BEGIN
                SELECT *
                FROM #PENDIENTES
                ORDER BY 3

                SELECT *
                FROM #CREADAS
                ORDER BY 3, CONVERT(VARCHAR(10), FREC_FECCRE ,105) DESC
            END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO




CREATE PROCEDURE [dbo].[PA_VER_GUIASRECEPXCOD]
  @EST_CODI   AS INT,
  @FREC_CODI  AS NVARCHAR(14)
AS

 SET NOCOUNT ON
 SET rowcount 200
 SET rowcount 0

 SET NOCOUNT ON
 SET rowcount 200
 SET rowcount 0


 --DROP TABLE #PENDIENTES
 SELECT DISTINCT UPPER(LTRIM(RTRIM(TMPESTADOS.EST_GLOSA))) AS EST_GLOSA, TMPFICHRECE.FREC_CODI, UPPER(LTRIM(RTRIM
(CLIENTES.CLI_NOMB))) AS CLI_NOMB
  , TMPFICHRECE.FREC_FECCRE
  , TMPFICHRECE.FREC_FECMOD
  , UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI
  , TMPFICHRECE.EST_CODI
 INTO #PENDIENTES
 FROM TMPFICHRECE INNER JOIN
  USUARIO ON TMPFICHRECE.FREC_USUCRE = USUARIO.PERSONAL INNER JOIN
  CLIENTES ON TMPFICHRECE.FREC_RUTCLI = CLIENTES.CLI_RUT INNER JOIN
  TMPESTADOS ON TMPFICHRECE.EST_CODI = TMPESTADOS.EST_CODI
 WHERE FREC_CODI = @FREC_CODI
--          AND (480-DATEDIFF(MI, TMPFICHRECE.FREC_FECCRE , GETDATE()))>=0
-- UNION
 --DROP TABLE #CREADAS
 SELECT DISTINCT 'CREADA' AS EST_GLOSA
                , FICHRECE.FREC_CODI, UPPER(LTRIM(RTRIM(CLIENTES.CLI_NOMB))) AS CLI_NOMB
  , FICHRECE.FREC_FECREC AS FREC_FECCRE
  , FICHRECE.FREC_FECREC AS FREC_FECMOD
  , UPPER(LTRIM(RTRIM(USUARIO.DESCRI))) AS USUDESCRI
  , 0 AS EST_CODI
 INTO #CREADAS
 FROM FICHRECE INNER JOIN
  DETARECE ON FICHRECE.FREC_CODI = LEFT( DETARECE.DREC_CODI,7) INNER JOIN
  USUARIO ON CONVERT(INT,ISNULL(DETARECE.DREC_CODPER,0)) = CONVERT(INT,USUARIO.PERSONAL) INNER JOIN
  CLIENTES ON FICHRECE.FREC_RUTCLI = CLIENTES.CLI_RUT
 WHERE  FREC_CODI = @FREC_CODI

 IF @EST_CODI = 0
 BEGIN
  SELECT *
  FROM #CREADAS
  ORDER BY 3, CONVERT(VARCHAR(10), FREC_FECCRE ,105) DESC -- FREC_FECCRE
 END
 ELSE
  IF @EST_CODI = 1
  BEGIN
   SELECT *
   FROM #PENDIENTES
   WHERE EST_CODI = 1
   ORDER BY 3
  END
  ELSE
   IF @EST_CODI = 2
   BEGIN
    SELECT *
    FROM #PENDIENTES
    WHERE EST_CODI = 2
    ORDER BY 3
   END
   ELSE
   BEGIN
    SELECT *
    FROM #PENDIENTES
    ORDER BY 3

    SELECT *
    FROM #CREADAS
    ORDER BY 3, CONVERT(VARCHAR(10), FREC_FECCRE ,105) DESC
   END


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_VER_PRODUCTO]
@MAE_CODI NVARCHAR(14)
AS
SELECT  A.MAE_CODI,
        A.MAE_DESCR,
        B.TENV_DESCR
FROM MAEPROD A,
     TIPOENV B
WHERE   A.MAE_CODI  = @MAE_CODI
 AND    A.MAE_TIPENV=B.TENV_CODI


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_VER_REPORGUIASCREADAS]
@FPRE_CODI NVARCHAR(14)
AS
SELECT   B.DPRE_CODPRO,
  C.MAE_DESCR,
         ISNULL(C.MAE_FECCRE,0)    AS MAE_FECCRE,
         ISNULL(D.MOV_CA,0)        AS MOV_CA,
  ISNULL(D.MOV_BA,0)        AS MOV_BA ,
         ISNULL(D.MOV_CO,0)        AS MOV_CO,
  ISNULL(D.MOV_PI,0)        AS MOV_PI,
         ISNULL(D.MOV_NI,0)        AS MOV_NI,
         ISNULL(B.DPRE_UNIDADES,0) AS DPRE_UNIDADES,
         ISNULL(B.DPRE_PESO,0)     AS DPRE_PESO,
         ISNULL(B.DPRE_SOPOCLI,0)  AS DPRE_SOPOCLI,
         ISNULL(B.DPRE_FOLIO,0)    AS DPRE_FOLIO,
         ISNULL(B.DPRE_PALLET,0)   AS DPRE_PALLET,
         ISNULL(B.DPRE_TS,0)       AS DPRE_TS,
         ISNULL(B.DPRE_TM,0)       AS DPRE_TM,
         ISNULL(B.DPRE_TI,0)       AS DPRE_TI
FROM     FICHPRED   A,
         DETAPRED   B,
         MAEPROD    C,
         MOVPALLET  D
WHERE A.FPRE_CODI   = @FPRE_CODI
  AND A.FPRE_CODI   = SUBSTRING(B.DPRE_CODI,1,7)
  AND B.DPRE_CODPRO = C.MAE_CODI
  AND B.DPRE_FOLIO  = D.MOV_FOLIO


GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO



CREATE PROCEDURE [dbo].[PA_VER_ROLES]
@COD_USUARIO NVARCHAR(06),
@PRIVILEGIO  NVARCHAR(100)
AS
SELECT DISTINCT (select distinct A.DESCRI from usuario a where cast(A.PERSONAL as int)   = cast(@COD_USUARIO as int)),
       C.DESCRIPCION_ROL,
       C.CODIGO_ROL,
       D.PRIVILEGIO
FROM   USUARIO A,
       REL_USUARIOS_ROLES B ,
       ROLES C,
       PRIVILEGIOS D
WHERE 1=1
--  and cast(A.PERSONAL as int)   = cast(@COD_USUARIO as int)
  AND cast(@COD_USUARIO as int)   = cast(B.COD_USUARIO as int)
  AND B.COD_ROL    = C.CODIGO_ROL
  AND C.CODIGO_ROL = D.COD_ROL
  AND RTRIM(LTRIM(D.PRIVILEGIO )) = rtrim(ltrim(@PRIVILEGIO))



GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO






CREATE PROCEDURE [dbo].[PA_VER_TMPFICHPRED]
@FPRE_CODI       NVARCHAR(14)
AS
   SELECT FPRE_CODI,
      FPRE_RUTCLI,
      FPRE_HORADES,
      FPRE_HORATER,
      FPRE_FECDES,
      FPRE_TOTSOPO,
      FPRE_TOTUNIDAD,
      FPRE_TOTPESO,
          FPRE_RUTCOND,
          FPRE_CODIENCA,
          FPRE_ACTIVA,
          FPRE_FECHACT,
          FPRE_CODVIG,
          FPRE_GDESPA,
          FPRE_RADIO,
          FPRE_TIPO,
          FPRE_PROCESO,
          FPRE_SELLO,
          FPRE_TEM,
          FPRE_ANDEN,
          FPRE_USUCRE,
          EST_CODI,
          FPRE_PALLET,
          FPRE_TS,
      FPRE_TM,
      FPRE_TI
FROM     TMPFICHPRED
WHERE FPRE_CODI = @FPRE_CODI


GO

GO

GO
--drop VIEW GVW_SERVRECE AS
--SELECT Dvas_VasCod VAS, Serv_Cod SERV, Serv_Nom NOM,  Dvas_Unid UNID, Dvas_Cajas CAJAS, REPLACE(Dvas_Kilos,',','.')  AS KILOS 
--FROM FacServicios  LEFT JOIN FacVasDeta ON Serv_Cod=Dvas_ServCod 
--WHERE Serv_OrdR>0 AND Dvas_VasCod=(SELECT Vas_cod FROM FacVas WHERE Vas_Dcto='0002999' AND Vas_TipDoc='0') 


--SELECT * FROM FacServicios LEFT JOIN FacVasDeta ON Serv_Cod=Dvas_ServCod  
--WHERE Serv_OrdR>0 AND Dvas_VasCod='0005961'
----AND Dvas_VasCod IN((SELECT Vas_cod FROM FacVas WHERE Vas_Dcto='0002999' AND Vas_TipDoc='0'),NULL)
--ORDER BY Serv_OrdR
 

--SELECT CASE  WHEN isnull(UNID,0)= 0  AND isnull(UNID,0)=0  AND isnull(UNID,0)=0 THEN 'False'  ELSE 'True' END AS dvas_est, 
--Serv_Cod , Serv_Nom, isnull(UNID,0) dvas_unid, isnull(CAJAS,0) Dvas_Cajas, REPLACE(isnull(KILOS,0),',','.') Dvas_kilos 
--FROM GVW_SERVRECE vw RIGHT JOIN FacServicios se ON se.Serv_Cod=serv 
--WHERE VAS=(SELECT Vas_cod FROM FacVas WHERE Vas_Dcto='0002999' AND Vas_TipDoc='0')
--and  Serv_Incluir<>'0' AND  Serv_Incluir<>'2' ORDER BY Serv_OrdR


 


--		ALTER VIEW AAAAAA AS
--		SELECT Dvas_VasCod VAS, Serv_Cod SERV, Serv_Nom NOM, Dvas_Unid UNID, Dvas_Cajas CAJAS, REPLACE(Dvas_Kilos,',','.') AS KILOS 
--		FROM FacServicios LEFT JOIN FacVasDeta ON Serv_Cod=Dvas_ServCod 
--		WHERE Serv_OrdR>0 
--		AND Dvas_VasCod=(SELECT Vas_cod FROM FacVas WHERE Vas_Dcto='0002999' AND Vas_TipDoc='0') 
 
 
--		SELECT CASE  WHEN isnull(UNID,0)= 0  AND isnull(UNID,0)=0  AND isnull(UNID,0)=0 THEN 'False'  ELSE 'True' END AS dvas_est, 
--		Serv_Cod , Serv_Nom, isnull(UNID,0) dvas_unid, isnull(CAJAS,0) Dvas_Cajas, REPLACE(isnull(KILOS,0),',','.') Dvas_kilos  
--		FROM AAAAAA vw RIGHT JOIN FacServicios se ON se.Serv_Cod=serv 
--		WHERE  Serv_OrdR>'0' ORDER BY Serv_OrdR
		
                                       
--       	SELECT * FROM FacServicios LEFT JOIN FacVasDeta ON Serv_Cod=Dvas_ServCod 
--		WHERE Serv_OrdR>0 
--		AND Dvas_VasCod=(SELECT Vas_cod FROM FacVas WHERE Vas_Dcto='0002999' AND Vas_TipDoc='0')                                 
		
		
		
		CREATE PROCEDURE [dbo].[PAG_ADICIONALESRECE]
		(
			@codrece as varchar(7)
		)
		AS
		BEGIN
		
			declare @sql nvarchar(1000)
			set @sql = 'CREATE VIEW GVW_ADICRECE 
			AS
			SELECT Dvas_VasCod VAS, Serv_Cod SERV, Serv_Nom NOM, Dvas_Unid UNID, Dvas_Cajas CAJAS, REPLACE(Dvas_Kilos,'','',''.'') AS KILOS 
			FROM FacServicios LEFT JOIN FacVasDeta ON Serv_Cod=Dvas_ServCod 
			WHERE Serv_OrdR>0 
			AND Dvas_VasCod=(SELECT Vas_cod FROM FacVas WHERE Vas_Dcto=''@codrece'' AND Vas_TipDoc=0)'
			exec sp_executesql @sql
		
			--CREATE VIEW GVW_ADICRECE 
			--AS
			--SELECT Dvas_VasCod VAS, Serv_Cod SERV, Serv_Nom NOM, Dvas_Unid UNID, Dvas_Cajas CAJAS, REPLACE(Dvas_Kilos,',','.') AS KILOS 
			--FROM FacServicios LEFT JOIN FacVasDeta ON Serv_Cod=Dvas_ServCod 
			--WHERE Serv_OrdR>0 
			--AND Dvas_VasCod=(SELECT Vas_cod FROM FacVas WHERE Vas_Dcto=@codrece AND Vas_TipDoc='0') 
 
			SELECT CASE  WHEN isnull(UNID,0)= 0  AND isnull(UNID,0)=0  AND isnull(UNID,0)=0 THEN 'False'  ELSE 'True' END AS dvas_est, 
			Serv_Cod , Serv_Nom, isnull(UNID,0) dvas_unid, isnull(CAJAS,0) Dvas_Cajas, REPLACE(isnull(KILOS,0),',','.') Dvas_kilos  
			FROM GVW_ADICRECE vw RIGHT JOIN FacServicios se ON se.Serv_Cod=serv 
			WHERE  Serv_OrdR>'0' ORDER BY Serv_OrdR
			
			DROP VIEW GVW_ADICRECE
		END
		
		EXEC PAG_ADICIONALESRECE '0002999'
GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_AgregaCaja]
(
@codped AS numeric(18,0),
@caja AS VARCHAR(200),
@pallet AS VARCHAR(9),
@ultimo as int
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)

DECLARE @pedido as varchar(30)
DECLARE @kilos as float
DECLARE @cajas as int

SET @error=0

BEGIN TRANSACTION @trans
	BEGIN TRY 
	
		-- Cambiar estado de caja
	 	UPDATE DetaReceCajas SET caj_ped='1'  WHERE Caj_cod=@caja AND Caj_Pcod=@pallet
	 	
	 	-- Agrego movimiento
	 	--INSERT INTO movcajas(movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc)
	 	--VALUES(GETDATE(), @caja, @pallet, 'PW', @codped)
	 	
	 	--Capturo numero de pedido
		SELECT @pedido=pedido FROM Pedidos_ficha WHERE Orden=@codped

		SELECT @cajas=cajas, @kilos=kilos FROM Pedidos_detalle WHERE pedido=@pedido AND pallet=@pallet

		SET @kilos=ROUND((@kilos/@cajas)*(@cajas+1),2);
		SET @cajas=@cajas+1;
		
		UPDATE Pedidos_detalle SET cajas=@cajas, kilos=@kilos, parcial=@ultimo WHERE pedido=@pedido AND pallet=@pallet
 
 		UPDATE pedcaja SET pc_ncaja=@cajas, pc_kilos=@kilos WHERE pc_codped=@codped AND pc_numpal=@pallet
		-- Agrega caja
		INSERT INTO detapedcaja(dpc_codcaja, dpc_codped, dpc_numpal)VALUES(@caja, @codped, @pallet)
 	 	
 	 	
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END

GO

GO

GO

CREATE PROCEDURE [dbo].[PAG_CambioCaja]
(
@codped AS numeric(18,0),
@caj_inici AS VARCHAR(200),
@caj_final AS VARCHAR(200),
@pal_inici AS VARCHAR(9),
@pal_final AS VARCHAR(9)
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)
 

SET @error=0

BEGIN TRANSACTION @trans
	BEGIN TRY 
	-- Cambiar caja 1 de pallet
	 	UPDATE DetaReceCajas SET caj_ped='1', Caj_cod=@caj_final WHERE Caj_cod=@caj_inici AND Caj_Pcod=@pal_inici
	 	
	 	INSERT INTO movcajas(movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc)
	 	VALUES(GETDATE(), @caj_final, @pal_inici, 'CP', 0)
	 	
	-- Cambiar caja 2 de pallet
	 	UPDATE DetaReceCajas SET caj_ped='0', Caj_cod=@caj_inici WHERE Caj_cod=@caj_final AND Caj_Pcod=@pal_final
	 	 	
	 	INSERT INTO movcajas(movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc)
	 	VALUES(GETDATE(), @caj_inici, @pal_final, 'CP', 0)
	 	
	-- Cambiar estado de caja a despachar
	 	UPDATE detapedcaja SET dpc_codcaja=@caj_final WHERE dpc_codped=@codped AND dpc_codcaja=@caj_inici
	 	
	 	
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END



GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_CARGASELECCION]
(
@codpred AS varchar(7),
@codped as numeric(18,0),
@codusu as varchar(3)
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)

SET @error=0

BEGIN TRANSACTION @trans
	BEGIN TRY 
	 	INSERT INTO TMPDETAPRED(fpre_codi, dpre_codi, dpre_codpro, dpre_codsopo, dpre_unidades, dpre_peso, dpre_fecdes, dpre_rutcli, dpre_contcli, dpre_fecprod, 
	 							dpre_camara, dpre_banda, dpre_colum, dpre_piso, dpre_nivel, dpre_almacen, dpre_folio, dpre_activa, dpre_radio, dpre_track, 
	 							dpre_codvig, dpre_pallet, dpre_slot, dpre_TS, dpre_TM, dpre_TI, dpre_Ptr, dpre_Pick, dpre_CodPer, dpre_Hora, 
	 							dpre_fecn, dpre_ActUni, dpre_TotUni) 
						SELECT  @codpred, RIGHT('00' + Ltrim(Rtrim(ROW_NUMBER() OVER( ORDER BY racd_codi ))),2) AS 'codigo', mae_codi, drec_codsopo, pc_ncaja, ROUND(pc_kilos,2) as pc_kilos, Convert(Varchar(10),GETDATE(),111) as fec, drec_rutcli, drec_contcli, drec_fecprod, 
							    drec_camara, drec_banda, drec_colum, drec_piso, drec_nivel,'2', racd_codi, '0', '0', '0', 
								'0', CASE WHEN drec_codi=pc_ncaja THEN 1 ELSE 0 END, '0','0','0','0','0',ROW_NUMBER() OVER( ORDER BY racd_codi ),@codusu, Convert(varchar(5),GETDATE(),108), Convert(Varchar(10),GETDATE(),111), pc_ncaja, racd_unidades-pc_ncaja
								FROM pedcaja 
								INNER JOIN rackdeta ON racd_codi=pc_numpal 
								INNER JOIN detarece ON drec_codi=racd_codi 
								INNER JOIN maeprod ON mae_codi=drec_codpro WHERE pc_codped=@codped
		
			INSERT INTO DetaPredCajas(dpre_caja, dpre_npallet, dpre_nped)
			SELECT DISTINCT dpc_codcaja, dpc_numpal, @codped FROM detapedcaja WHERE dpc_codped=@codped
			 
		
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END

GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_EliminaCaja]
(
@codped AS numeric(18,0),
@pallet AS VARCHAR(200),
@codcaja AS VARCHAR(200)
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)

DECLARE @pedido as varchar(30)
DECLARE @kilos as float
DECLARE @cajas as int


SET @error=0

BEGIN TRANSACTION @trans
	BEGIN TRY 
	
	--rescato numero pedido
	SELECT @pedido=pedido FROM Pedidos_ficha WHERE Orden=@codped

	SELECT @cajas=cajas, @kilos=kilos FROM Pedidos_detalle WHERE pedido=@pedido AND pallet=@pallet

	
	SET @kilos=ROUND((@kilos/@cajas)*(@cajas-1),2);
	SET @cajas=@cajas-1;
	
	UPDATE Pedidos_detalle SET cajas=@cajas, kilos=@kilos, parcial='1'  WHERE pedido=@pedido AND pallet=@pallet
 
	UPDATE pedcaja SET pc_ncaja=@cajas, pc_kilos=@kilos WHERE pc_codped=@codped AND pc_numpal=@pallet
	
	-- Elimina caja
	DELETE detapedcaja WHERE dpc_codcaja=@codcaja AND dpc_numpal=@pallet AND dpc_codped=@codped
	
	UPDATE DetaReceCajas SET caj_ped='0' WHERE Caj_cod=@codcaja
	 
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END

GO

GO

GO
 
CREATE PROCEDURE [dbo].[PAG_EliminaPedido]
(
@codped AS numeric(18,0) -- Numero de Orden
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)
DECLARE @pedido as varchar(30)

SET @error=0

BEGIN TRANSACTION @trans
	BEGIN TRY 
		
		SELECT @pedido=pedido FROM Pedidos_ficha WHERE Orden=@codped
	
		DELETE FROM pedcaja  WHERE pc_codped=@codped
		
	 	UPDATE Pedidos_ficha SET codvig='1' WHERE Orden=@codped
	 	
	 	UPDATE rackdeta SET racd_estado='0' WHERE racd_codi in (SELECT pallet FROM Pedidos_detalle WHERE pedido=@pedido)
	 	
	 	UPDATE DetaReceCajas SET caj_ped ='0' FROM DetaReceCajas INNER JOIN detapedcaja ON dpc_codcaja = Caj_cod WHERE dpc_codped=@codped
	 	
	 	INSERT INTO movcajas(movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc)
	 	SELECT GETDATE(), dpc_codcaja, dpc_numpal, 'PA', @codped FROM detapedcaja WHERE dpc_codped=@codped
	 	
	 	
	 	DELETE FROM detapedcaja  WHERE dpc_codped=@codped
	 	
	 	DELETE FROM Pedidos_detalle WHERE pedido=@pedido
	 	
	 	DELETE FROM pedidoguias WHERE pguia_codped=@codped
	 	
	 	DELETE FROM pedidos_prg WHERE prg_orden=@codped
	 	
	 	----Actualiza movcajas
	 	--INSERT INTO movcajas(movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc)
	 	--SELECT GETDATE(), dpc_codcaja, dpc_numpal, 'PA', @codped FROM detapedcaja WHERE dpc_codped=@codped
	 	
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END



GO

GO

GO

CREATE PROCEDURE [dbo].[PAG_ElimPreDespacho]
(
@cod_pred AS VARCHAR(9),
@cod_ped AS numeric(18,0)
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)
 
SET @error=0

BEGIN TRANSACTION @trans
	BEGIN TRY 
	
	 	 DELETE FROM fichpred WHERE fpre_codi=@cod_pred
	 	 DELETE FROM detapred WHERE left(dpre_codi,7)= @cod_pred
	 	 DELETE FROM movpallet WHERE (mov_tipo = 'PD' OR mov_tipo='PR') AND mov_Doc =@cod_pred
	 	 UPDATE pedidos_ficha SET Ped_EstPred='0' WHERE orden=@cod_ped
	 	 UPDATE rackdeta SET racd_estado='0', racd_pred=''   WHERE racd_pred=@cod_pred
	 	 
	 	 if @cod_ped>0
	 	 BEGIN
	 		UPDATE pedcaja SET pc_estado='1' WHERE pc_codped=@cod_ped
	 		INSERT INTO movcajas(movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc)
			SELECT GETDATE(),dpc_codcaja, dpc_numpal, 'AP', @cod_ped FROM detapedcaja  WHERE dpc_codped=@cod_ped
	 	 END
	 	
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END



GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_ING_SEGUROS]
(
@Serv_Cod VARCHAR(3),
@Serv_Nom Varchar(50),
@Serv_MedPred as varchar(3),
@Serv_MonPred as varchar(2),
@Serv_Desc as varchar(1000),
@rece as numeric(18, 0),
@desp as numeric(18, 0),
@etiq as numeric(18, 0),
@serv_esc as numeric(18, 0),
@serv_sec as numeric(18, 0)
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)
 
DECLARE @recepcion as varchar(2)
DECLARE @despacho as varchar(2)
DECLARE @etiquetado as varchar(2)

SET @error=0

BEGIN TRANSACTION @trans
	if(SELECT COUNT(*) FROM FacServicios WHERE Serv_Cod=@Serv_Cod)=0
	BEGIN
		BEGIN TRY 

			--Si se agrega a la recepcin
			IF(@rece>0)
			BEGIN
				SET @recepcion=(SELECT MAX(Serv_OrdR) FROM FacServicios)+1
			END
			ELSE
			BEGIN
				SET @recepcion=null
			END
			
			--Si se agrega a despacho
			IF(@desp>0)
			BEGIN
				SET @despacho=(SELECT MAX(Serv_OrdD) FROM FacServicios)+1
			END
			ELSE
			BEGIN
				SET @despacho=null
			END
			
			--Si se agrega a etiquetado
			IF(@etiq>0)
			BEGIN
				SET @etiquetado=(SELECT MAX(Serv_OrdE) FROM FacServicios)+1
			END
			ELSE
			BEGIN
				SET @etiquetado=null
			END
			
			INSERT INTO FacServicios(Serv_Cod, Serv_Nom, Serv_MedPred, Serv_MonPred, Serv_descr, Serv_OrdR, Serv_OrdD, Serv_OrdE, Serv_Esc, Serv_Sec)
			VALUES					(@Serv_Cod, @Serv_Nom, @Serv_MedPred, @Serv_MonPred, @Serv_Desc, @recepcion, @despacho, @etiquetado, @serv_esc, @serv_sec)
		 	
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @trans;
			SELECT 1;
			RETURN;
		END CATCH
	END
	ELSE
	BEGIN
		UPDATE FacServicios SET Serv_Nom=@Serv_Nom, Serv_MedPred=@Serv_MedPred, Serv_MonPred=@Serv_MonPred, Serv_descr=@Serv_Desc,
		Serv_Esc=@serv_esc, Serv_Sec=@serv_sec WHERE Serv_Cod=@Serv_Cod
	END
		

SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END

GO

GO

GO

CREATE PROCEDURE [dbo].[PAG_INGPREDESPACHO]
(
@fpre_codi AS VARCHAR(7),			-- CODIGO PRE-DESPACHO
@fpre_rutcli as varchar(9),			-- RUT CLIENTE
@fpre_totsopo as int,				-- TOTAL DE SOPORTANTES
@fpre_totunidad as int,				-- TOTAL DE ENVASES
@fpre_totpeso as float,				-- TOTAL DE KILOS
@fpre_codienca as varchar(3),		-- ENCARGADO DE MOVIMIENTO
@fpre_sello as varchar(50),			-- SELLO
@fpre_contenedor as varchar(50),	-- CONTENEDOR
@fpre_rampla as varchar(15),		-- RAMPLA
@fpre_destino as varchar(20),		-- DESTINO
@fpre_observacion as varchar(255),	-- OBSERVACIONES DEL MOVIMIENTO
@fpre_nped as numeric(18,0),		-- NUMERO DE PEDIDO, SI NO TIENE OMISION 0
@fpre_etiq as varchar(1),			-- SI VA A ETIQUETADO   1 A ETIQ    0 NORMAL
@tipo as varchar(2),				-- TIPO DE MOVIMIENTO MOV_PALLET  PD|GESTION   PR|RADIO   PT|TABLET
@TS as float,						-- TEMP 1
@TM as float,						-- TEMP 2
@TI as float,						-- TEMP 3
@olor as varchar(10),               -- OLOR	
@hig as varchar(10),                -- HIGIENE
@cond as varchar(10),				-- CONDENSACION							
@codbod as varchar(10)              -- BODEGA
)
AS

DECLARE @error as  int
DECLARE @trans as VARCHAR(50)
DECLARE @PROMEDIO AS float
DECLARE @HoraInicio as varchar(5)

SET @error=0

SELECT @PROMEDIO=ROUND((@TS+@TM+@TI)/3,1) -- PROMEDIO AUTOMATICO, EVITAR PROBLEMAS DE CONFIG DE DISPOSITIVOS.
SELECT @HoraInicio=fpre_horades FROM TMPFICHPRED WHERE fpre_codi=@fpre_codi

IF(SELECT COUNT(*) FROM fichpred WHERE fpre_codi=@fpre_codi)=0

BEGIN 

BEGIN TRANSACTION @trans
	BEGIN TRY
			INSERT INTO fichpred(fpre_codi, fpre_rutcli, fpre_horades, fpre_horater, fpre_fecdes, fpre_totsopo, fpre_totunidad, fpre_totpeso, fpre_codienca, fpre_activa, fpre_fechact, fpre_codvig, fpre_gdespa, fpre_sello, fpre_tem, FPRE_USUCRE, fpre_contenedor, fpre_rampla, fpre_destino, fpre_Observacion, fpre_nped, fpre_etiq,estc_olor,estc_hig,estc_cond,cod_bod)
			VALUES(@fpre_codi, @fpre_rutcli, @HoraInicio, convert(varchar(5), getdate(), 8), convert(varchar(10), getdate(), 111), @fpre_totsopo, @fpre_totunidad, @fpre_totpeso, @fpre_codienca, 0, convert(varchar(10), getdate(), 111), 0, 0, @fpre_sello, @PROMEDIO, @fpre_codienca, @fpre_contenedor, @fpre_rampla, @fpre_destino, @fpre_observacion, @fpre_nped, @fpre_etiq,@olor,@hig,@cond,@codbod)
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH
	
	BEGIN TRY
			INSERT INTO detapred(dpre_codi, dpre_codpro, dpre_codsopo, dpre_sopocli, dpre_unidades, dpre_peso, dpre_camara, dpre_banda, dpre_colum, dpre_piso, dpre_nivel, dpre_fecdes, dpre_rutcli, dpre_contcli, dpre_fecprod, dpre_folio, dpre_activa, dpre_pallet, dpre_TS, dpre_TM, dpre_TI, dpre_CodPer, dpre_Hora, dpre_fecn)
			SELECT fpre_codi+dpre_codi, dpre_codpro, dpre_codsopo, dpre_sopocli, dpre_unidades, dpre_peso, dpre_camara, dpre_banda, dpre_colum, dpre_piso, dpre_nivel, dpre_fecdes, dpre_rutcli, dpre_contcli, dpre_fecprod, dpre_folio, dpre_activa, dpre_pallet, dpre_TS, dpre_TM, dpre_TI, dpre_CodPer, dpre_Hora, dpre_fecn FROM TMPDETAPRED WHERE fpre_codi=@fpre_codi
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 2;
		RETURN;
	END CATCH
	
	BEGIN TRY
			INSERT INTO movpallet(mov_folio, mov_codper, mov_ca, mov_ba, mov_co, mov_pi, mov_ni, mov_fecha, mov_tipo, mov_Doc, mov_hora, mov_TS, mov_TM, mov_TI, mov_docdespa, Mov_Despacho, Mov_Saldo)
			SELECT dpre_folio, @fpre_codienca, dpre_camara, dpre_banda, dpre_colum, dpre_piso, dpre_nivel, convert(varchar(10), getdate(), 111), @tipo, @fpre_codi, convert(varchar(5), getdate(), 8), @TS, @TM, @TI, 0, dpre_ActUni, dpre_TotUni FROM TMPDETAPRED WHERE fpre_codi=@fpre_codi
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 3;
		RETURN;
	END CATCH
		
	BEGIN TRY
			UPDATE pedcaja SET pc_estado='2' WHERE pc_codped=@fpre_nped
			DELETE FROM TMPDETAPRED WHERE fpre_codi=@fpre_codi
			DELETE FROM TMPFICHPRED WHERE fpre_codi=@fpre_codi
			UPDATE DetaReceCajas SET caj_ped='2' WHERE LEFT(caj_pcod,7)=@fpre_codi
		    UPDATE Pedidos_ficha SET Ped_EstPred=3 WHERE Orden=@fpre_nped
	END TRY
	BEGIN CATCH
			ROLLBACK TRANSACTION @trans;
			SELECT 5;
			RETURN;
	END CATCH


SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END
END

ELSE
BEGIN
	SELECT 4
	RETURN;
END
-- RETORNA:
--1 ERROR DE FICHA
--2 ERROR DE DETALLE 
--3 ERROR DE MOVPALLET
--4 YA INGRESADO
--------------------------------
--0 EJECUTA CORRECTAMENTE
GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_INVENTARIO]
(
@pallet as varchar(9),
@usuario as varchar(3),
@tipolect as varchar(30),
@valpro as numeric(18,0),
@valcli as numeric(18,0),
@valcan as numeric(18,0),
@camara as varchar(2),
@codpro as varchar(50)
)
AS
DECLARE @estado varchar(15)
DECLARE @trans varchar(MAX)
DECLARE @error int

SET @error=0

      IF (LEFT(@camara,1)='7' OR LEFT(@camara,1)='6')
            BEGIN
                  SELECT @estado='SIN POSICION'
            END
      ELSE
            BEGIN
                  SELECT @ESTADO='POSICIONADO'
            END
                        
BEGIN TRANSACTION @trans
      BEGIN TRY 
       
            IF (SELECT COUNT(*) FROM AINVENTARIO WHERE PALLET=@pallet)= 0
            BEGIN

                  INSERT INTO AINVENTARIO(PALLET, ESTADO, USUARIO, FECHA, TIPOLECT, VALPRODUCTO, VALCLIENTE, VALCANTIDAD, CODPRODUCTO)
                  VALUES(@pallet, @estado, @usuario, GETDATE(), @tipolect, @valcli, @valpro, @valcan, @codpro)
            END
                  ELSE
            BEGIN
                        UPDATE AINVENTARIO SET  ESTADO=@estado, USUARIO=@usuario, FECHA=GETDATE(), TIPOLECT=@tipolect, VALPRODUCTO=@valcli, VALCLIENTE=@valpro, VALCANTIDAD=@valcan, CODPRODUCTO=@codpro
                        WHERE PALLET=@pallet
            END
                  
            IF(@valcan=1)
            BEGIN
                  UPDATE detarece SET drec_rev='1' WHERE drec_codi=@pallet
            END
            
      END TRY
      BEGIN CATCH
            ROLLBACK TRANSACTION @trans;
            SELECT 1;
            RETURN;
      END CATCH

      IF(@error=0)
      BEGIN
            COMMIT TRANSACTION @trans
            SELECT 0;
      END
GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_LARGOETIQ]
(
@recepcion as varchar(7),
@estado as numeric(18,0),
@largo1 as numeric(18,0),
@largo2 as numeric(18,0),
@largo3 as numeric(18,0),
@largo4 as numeric(18,0),
@largo5 as numeric(18,0)
)
AS
IF (SELECT COUNT(*) FROM detareceestado WHERE rtraq_codi=@recepcion)=0
BEGIN

	INSERT INTO detareceestado(rtraq_codi, rtraq_est, rtraq_largo, rtraq_l2, rtraq_l3, rtraq_l4, rtraq_l5)
    VALUES(@recepcion, @estado, @largo1, @largo2, @largo3, @largo4, @largo5)
END
ELSE
BEGIN
	UPDATE detareceestado SET rtraq_largo=@largo1, rtraq_l2=@largo2, rtraq_l3=@largo3, rtraq_l4=@largo4, rtraq_l5=@largo5 WHERE rtraq_codi=@recepcion
END

GO

GO

GO
 CREATE PROCEDURE [dbo].[PAG_PALLETCHEQUEADO]
(
@estado AS int,					-- ESTADO 0= SIN REVISAR    1=REVISADO OK	2= MAL INGRESADO RECEPCION
@pallet as varchar(9),			-- NUMERO DE PALLETS
@usuario as varchar(3),			-- USUARIO
@tipo as int,					-- 1 REDE A FRIGO  2 FRIGO A REDE
@pedido as int					-- Codigo Pedido , cuando es 0 corresponde a @tipo=1
)
AS

DECLARE @error as  int
DECLARE @trans as VARCHAR(50)
DECLARE @leidos as int
DECLARE @total as int
DECLARE @terminado as int
SET @error=0

if @tipo=1
BEGIN 
IF(SELECT drec_rev FROM detarece WHERE drec_codi=@pallet)<>@estado
BEGIN
BEGIN TRANSACTION @trans
	BEGIN TRY
			UPDATE detarece SET drec_rev=@estado WHERE drec_codi=@pallet 
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH
	
	BEGIN TRY
			INSERT INTO LOG_RevisionPallets(rev_codpallet, rev_fecha, rev_codenca, rev_est, rev_tipo)VALUES(@pallet,GETDATE(),@usuario, @estado, @tipo)
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 2;
		RETURN;
	END CATCH
	
	 
SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END
END

ELSE
	BEGIN 
		SELECT 3;
		RETURN;
	END
END
ELSE
BEGIN 

IF(SELECT revisado FROM Pedidos_detalle WHERE pallet=@pallet)<>@estado
BEGIN
	BEGIN TRANSACTION @trans
	BEGIN TRY
			UPDATE Pedidos_detalle SET revisado=@estado WHERE pallet=@pallet AND pedido=(SELECT pedido FROM Pedidos_ficha WHERE Orden=@pedido)
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH
	
	BEGIN TRY 
			INSERT INTO LOG_RevisionPallets(rev_codpallet, rev_fecha, rev_codenca, rev_est, rev_tipo)VALUES(@pallet, GETDATE(), @usuario, @estado, @tipo)
			
			SELECT @leidos=SUM(revisado) FROM pedidos_ficha pf INNER JOIN Pedidos_detalle pd ON pf.pedido=pd.pedido WHERE pd.revisado='1' AND terminado<>'3' AND Orden=@pedido GROUP BY pf.pedido 
			SELECT @total=COUNT(*) FROM pedidos_ficha pf INNER JOIN Pedidos_detalle pd ON pf.pedido=pd.pedido WHERE terminado<>'3' AND Orden=@pedido GROUP BY pf.pedido 
			 
			if (@leidos=@total)
			BEGIN
				UPDATE Pedidos_ficha SET ped_revision='1' WHERE Orden=@pedido
			END
			
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 2;
		RETURN;
	END CATCH
	
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		if (SELECT ped_revision FROM Pedidos_ficha WHERE Orden=@pedido)=1
			BEGIN
				SELECT 5;
			END
		ELSE
			BEGIN
				SELECT 0;
			END
	END
ELSE
	BEGIN 
		SELECT 3;
		RETURN;
	END
END
ELSE
BEGIN
	SELECT 4;
	RETURN;
END
END

-- RETORNA:
--1 ERROR DE REGISTRO
--2 ERROR DE LOG 
--------------------------------
--0 EJECUTA CORRECTAMENTE
GO

GO

GO
 CREATE PROCEDURE [dbo].[PAG_PALLETREVISADO]
(
@estado AS int,					-- ESTADO 0= SIN REVISAR    1=REVISADO OK	2= MAL INGRESADO RECEPCION
@pallet as varchar(9),			-- NUMERO DE PALLETS
@usuario as varchar(3)			-- USUARIO
)
AS

DECLARE @error as  int
DECLARE @trans as VARCHAR(50)

SET @error=0

BEGIN 
IF(SELECT drec_rev FROM detarece WHERE drec_codi=@pallet)<>@estado
BEGIN
BEGIN TRANSACTION @trans
	BEGIN TRY
			UPDATE detarece SET drec_rev=@estado WHERE drec_codi=@pallet
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH
	
	BEGIN TRY
			INSERT INTO LOG_RevisionPallets(rev_codpallet, rev_fecha, rev_codenca, rev_est)VALUES(@pallet,GETDATE(),@usuario, @estado)
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 2;
		RETURN;
	END CATCH
	
	 
SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END
END

ELSE
	BEGIN 
		SELECT 3;
		RETURN;
	END
END
-- RETORNA:
--1 ERROR DE REGISTRO
--2 ERROR DE LOG 
--------------------------------
--0 EJECUTA CORRECTAMENTE
GO

GO

GO
CREATE PROCEDURE [dbo].[PAG_POSICIONAR]
(
@pallet AS varchar(9),			 
@camara as varchar(2),			 
@banda as varchar(2),			 
@columna as varchar(2),
@piso as varchar(2),
@nivel as varchar(2),
@tipo as varchar(2),
@encargado as varchar(3)
)
AS

DECLARE @error AS  int
DECLARE @trans AS VARCHAR(50)

DECLARE @fecha AS VARCHAR(10)
DECLARE @hora AS VARCHAR(5)

SELECT @fecha=CONVERT(VARCHAR(10),GETDATE(),111)
SELECT @hora=Convert(varchar(5), GetDate(), 108)

SET @error=0

BEGIN 
IF(SELECT COUNT(*) FROM rackdeta WHERE racd_codi=@pallet)=1
BEGIN
BEGIN TRANSACTION @trans
	BEGIN TRY
			INSERT INTO movpallet (mov_folio, mov_codper, mov_ca, mov_ba, mov_co, mov_pi, mov_ni, mov_fecha, mov_tipo, mov_hora)
			VALUES(@pallet, @encargado, @camara, @banda, @columna, @piso, @nivel, @fecha, @tipo, @hora)
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 1;
		RETURN;
	END CATCH
	
	BEGIN TRY
			UPDATE rackdeta SET racd_ca=@camara, racd_ba=@banda, racd_co=@columna, racd_pi=@piso, racd_ni=@nivel WHERE racd_codi=@pallet
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 2;
		RETURN;
	END CATCH
	
	 
	BEGIN TRY
			UPDATE detarece SET drec_camara=@camara, drec_banda=@banda, drec_colum=@columna, drec_piso=@piso, drec_nivel=@nivel WHERE drec_codi=@pallet
	END TRY
	BEGIN CATCH
		ROLLBACK TRANSACTION @trans;
		SELECT 3;
		RETURN;
	END CATCH
	
	
SELECT @error
	IF(@error=0)
	BEGIN
		COMMIT TRANSACTION @trans
		SELECT 0;
	END
END
ELSE
	BEGIN 
		SELECT 4;
		RETURN;
	END
END

-- RETORNA:
--1 ERROR DE MOVPALLET
--2 ERROR DE RACKDETA 
--3 ERROR DE DETARECE 
--4 PALLET NO EXISTE
--------------------------------
--0 EJECUTA CORRECTAMENTE
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[sp_servicio_24]
	 @Contrato as varchar(10),
	 @Rut_Clien  varchar(10), 
	 @Fec_Desde datetime,
	 @Fec_Hasta  datetime,
	@Servicio as float,
	@ID_Fact as float
as
declare
	@fecha datetime,
	@Fecha2 varchar(10),
	@unidades float,
	@peso float,
	@pallet float,
	@totunidades float,
	@totpeso float,
	@totpallet float,
	@Saltotunidades float,
	@Saltotpeso float,
	@Saltotpallet float,
	@totunidadesGer float,
	@totpesoGer float,
	@totpalletGer float,
	@Fec_String varchar(10),
	@Fec_String2 varchar(10),
	@num float,
	@Servicio_Serv varchar(3),  
	@Fecha_Serv varchar(6),
	@Fecha_Grupo float,
	@Fecha_servicio_24 datetime
		


begin
	
	select @unidades = 0
	select @peso = 0
	select @totpallet = 0

	select @saltotunidades = 0
	select @saltotpeso = 0
	select @saltotpallet = 0

	select @totunidades = 0
	select @totpeso = 0
	select @totpallet = 0

	select @totunidadesGer =0
	select @totpesoGer = 0
	select @totpalletGer = 0
	select @num = 1


	select @fec_string2 =  CONVERT(VARCHAR, @fec_desde, 120)
	select @Fecha_servicio_24 =  CONVERT(datetime, @fec_desde, 120)
	select @fec_string2 =  SUBSTRING(@fec_string2, 1, 4)   +  '/'  +  SUBSTRING(@fec_string2, 6, 2)  + '/' + SUBSTRING(@fec_string2, 9, 2) 
	
	select @unidades  =  isnull(sum(unidades),0) ,
		@peso = isnull(sum( peso) ,0),
		@pallet = isnull(sum(pallet), 0) 

	From Qry_detareceServicioWeb24  where
	rut = @Rut_Clien and
	Contrato =  @Contrato and
	FechaDiasGracia   <  @Fecha_servicio_24 and
	TipoRecepcion <> 1 and
--	fecha  < @fec_string2  and
	Vigente = 0


	select @Saltotunidades = @Saltotunidades + @unidades 
	select @Saltotpeso = @Saltotpeso + @peso 
	select @Saltotpallet = @Saltotpallet + @pallet 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	select @unidades  =  isnull(sum(drec_unidades),0) ,
		@peso = isnull(sum( drec_peso) ,0),
		@pallet = isnull(sum(drec_pallet), 0) 

	From detarece where
	drec_rutcli = @Rut_Clien and
	drec_contcli =  @Contrato and
	drec_fecrec  <  @fec_string2  and
	drec_RecepTunel = 1 and
	drec_codvig = 0


	select @Saltotunidades = @Saltotunidades + @unidades 
	select @Saltotpeso = @Saltotpeso + @peso 
	select @Saltotpallet = @Saltotpallet + @pallet 


--------------------------------------------------------------------------------------------------------------------------------------------------------------------

	select  	@unidades  = isnull(sum(ddes_unidades),0),
		@peso = isnull(sum(ddes_peso),0),
		@pallet = isnull(sum(ddes_pallet),0)
	from detadespa where
		ddes_rutcli = @Rut_Clien and
		ddes_contcli =  @Contrato and

		ddes_fecha  <  @fec_string2  and
		ddes_codvig = 0

	select @Saltotunidades = @Saltotunidades - @unidades 
	select @Saltotpeso = @Saltotpeso - @peso 
	select @Saltotpallet = @Saltotpallet - @pallet 

----------------------------------------------------------------------------------







	select @num = 1
	select @fecha  =  @fec_Desde
	
	
	
	select @num = 1
	select @fecha  =  @fec_Desde
	
	
		



		 while @fec_Hasta >= @fecha
		 begin

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select @Fecha_servicio_24 =  CONVERT(datetime, @fecha, 120)
			select @fec_string =  CONVERT(VARCHAR, @fecha, 120)
			select @fec_string =  SUBSTRING(@fec_string, 1, 4)   +  '/'  +  SUBSTRING(@fec_string, 6, 2)  + '/' + SUBSTRING(@fec_string, 9, 2) 
			
			select @fecha_serv =  SUBSTRING(@fec_string, 1, 4)  +   SUBSTRING(@fec_string, 6, 2)  
			select @fecha_Grupo = cast(@fecha_Serv as float)
			
			select @unidades  =  isnull(sum(unidades),0) ,
				@peso = isnull(sum( peso) ,0),
				@pallet = isnull(sum(pallet), 0) 
			 from Qry_detareceServicioWeb24 where
				rut = @Rut_Clien and
				contrato  =  @Contrato and
				
				FechaDiasGracia   =  @Fecha_servicio_24 and
				TipoRecepcion <> 1 and
--				fecha   =  @Fecha_servicio_24 and
				vigente = 0

		
			select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet
			If  @totunidades >  0
			begin
				select @Saltotunidades = @Saltotunidades + @totunidades
				select @Saltotpeso = @Saltotpeso + @totpeso
				select @Saltotpallet = @Saltotpallet + @totpallet
			end

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0


			select @unidades  =  isnull(sum(drec_unidades),0) ,
				@peso = isnull(sum( drec_peso) ,0),
				@pallet = isnull(sum(drec_pallet), 0) 
			 from detarece where
				drec_rutcli = @Rut_Clien and
				drec_contcli =  @Contrato and
				drec_fecrec = @fec_string  and
				drec_RecepTunel = 1 and
				drec_codvig = 0

		
			select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet
			If  @totunidades >  0
			begin
				select @Saltotunidades = @Saltotunidades + @totunidades
				select @Saltotpeso = @Saltotpeso + @totpeso
				select @Saltotpallet = @Saltotpallet + @totpallet
			end


			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select  	@unidades  = isnull(sum(unidades),0),
				@peso = isnull(sum(peso),0),
				@pallet = isnull(sum(pallet),0)
			from Qry_DetaDespaServicio24 where
				rut = @Rut_Clien and
				contrato =  @Contrato and
				
				fecha = @fec_string  and
				vigente = 0
			 select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet

			If  @totunidades  > 0
			begin
				select @Saltotunidades =  @Saltotunidades - @totunidades
				select @Saltotpeso = @Saltotpeso - @totpeso
				select @Saltotpallet = @Saltotpallet - @totpallet
			
			--select @totunidadesGer = @totunidadesGer + @totunidades
			end

			if @Saltotunidades > 0
			begin
				select @totunidadesGer = @totunidadesGer + @Saltotunidades
				select @totpesoGer = @totpesoGer + @Saltotpeso
				select @totpalletGer = @totpalletGer + @Saltotpallet
			
				
				insert into ServWeb (
					Sweb_codi,
					Sweb_Serv,
					Sweb_Cliente,
					Sweb_Fecha,
					Sweb_Cam1,
	
					Sweb_Cam2,
					Sweb_Cam3,
					Sweb_GrupFec,
					Sweb_Cam4
			--	Sweb_Cam5,
			--	Sweb_Cam6,
			---	Sweb_Cam7,
			--	Sweb_Cam8
	
					) 
				values (	
					@ID_Fact,
					@Servicio,
					@Rut_Clien,
					@Fecha,			
					 @saltotunidades,
			 		 @saltotpeso,
				 	@saltotpallet,
					@Fecha_Grupo,
					@Fecha_servicio_24
--					CONVERT(VARCHAR,  @fec_Hasta, 120)
					
				--@fec_desde,
				--@Fec_String2,
				--@totpalletGer,
				--@totunidadesGer
				)
			end 
			
			select   @fecha = DateAdd(day, 1, @fecha)  
			--select @Saltotunidades =  0
			--select @Saltotpeso = 0
			--select @Saltotpallet = 0
			
		 end  
	

end
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[sp_servicio_25] 
	 @Contrato as varchar(10),
	 @Rut_Clien  varchar(10),
 
	 @Fec_Desde datetime,
	 @Fec_Hasta  datetime,
	@Servicio as float,
	@ID_Fact as float
as
declare
	@fecha datetime,
	@Fecha2 varchar(10),
	@unidades float,
	@peso float,
	@pallet float,
	@totunidades float,
	@totpeso float,
	@totpallet float,
	@Saltotunidades float,
	@Saltotpeso float,
	@Saltotpallet float,
	@totunidadesGer float,
	@totpesoGer float,
	@totpalletGer float,
	@Fec_String varchar(10),
	@Fec_String2 varchar(10),
	@num float,
	@Servicio_Serv varchar(3),  
	@Fecha_Serv varchar(6),
	@Fecha_Grupo float
		


begin
	
	select @unidades = 0
	select @peso = 0
	select @totpallet = 0

	select @saltotunidades = 0
	select @saltotpeso = 0
	select @saltotpallet = 0

	select @totunidades = 0
	select @totpeso = 0
	select @totpallet = 0

	select @totunidadesGer =0
	select @totpesoGer = 0
	select @totpalletGer = 0
	select @num = 1


	select @fec_string2 =  CONVERT(VARCHAR, @fec_desde, 120)
	select @fec_string2 =  SUBSTRING(@fec_string2, 1, 4)   +  '/'  +  SUBSTRING(@fec_string2, 6, 2)  + '/' + SUBSTRING(@fec_string2, 9, 2) 
	
	select @unidades  =  isnull(sum(drec_unidades),0) ,
		@peso = isnull(sum( drec_peso) ,0),
		@pallet = isnull(sum(drec_pallet), 0) 

	From detarece where
	drec_rutcli = @Rut_Clien and
	drec_contcli =  @Contrato and
	drec_fecrec  <  @fec_string2  and
	drec_codvig = 0


	select @Saltotunidades = @Saltotunidades + @unidades 
	select @Saltotpeso = @Saltotpeso + @peso 
	select @Saltotpallet = @Saltotpallet + @pallet 


	select  	@unidades  = isnull(sum(ddes_unidades),0),
		@peso = isnull(sum(ddes_peso),0),
		@pallet = isnull(sum(ddes_pallet),0)
	from detadespa where
		ddes_rutcli = @Rut_Clien and
		ddes_contcli =  @Contrato and

		ddes_fecha  <  @fec_string2  and
		ddes_codvig = 0

	select @Saltotunidades = @Saltotunidades - @unidades 
	select @Saltotpeso = @Saltotpeso - @peso 
	select @Saltotpallet = @Saltotpallet - @pallet 


	select @num = 1
	select @fecha  =  @fec_Desde
	
	
	
	select @num = 1
	select @fecha  =  @fec_Desde
	
	
		



		 while @fec_Hasta >= @fecha
		 begin

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select @fec_string =  CONVERT(VARCHAR, @fecha, 120)
			select @fec_string =  SUBSTRING(@fec_string, 1, 4)   +  '/'  +  SUBSTRING(@fec_string, 6, 2)  + '/' + SUBSTRING(@fec_string, 9, 2) 
			
			select @fecha_serv =  SUBSTRING(@fec_string, 1, 4)  +   SUBSTRING(@fec_string, 6, 2)  
			select @fecha_Grupo = cast(@fecha_Serv as float)
			select @unidades  =  isnull(sum(drec_unidades),0) ,
				@peso = isnull(sum( drec_peso) ,0),
				@pallet = isnull(sum(drec_pallet), 0) 
			 from detarece where
				drec_rutcli = @Rut_Clien and
				drec_contcli =  @Contrato and
				drec_fecrec = @fec_string  and
				drec_codvig = 0

		
			select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet
			If  @totunidades >  0
			begin
				select @Saltotunidades = @Saltotunidades + @totunidades
				select @Saltotpeso = @Saltotpeso + @totpeso
				select @Saltotpallet = @Saltotpallet + @totpallet
			end

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select  	@unidades  = isnull(sum(ddes_unidades),0),
				@peso = isnull(sum(ddes_peso),0),
				@pallet = isnull(sum(ddes_pallet),0)
			from detadespa where
				ddes_rutcli = @Rut_Clien and
				ddes_contcli =  @Contrato and

				ddes_fecha = @fec_string  and
				ddes_codvig = 0
			 select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet

			If  @totunidades  > 0
			begin
				select @Saltotunidades =  @Saltotunidades - @totunidades
				select @Saltotpeso = @Saltotpeso - @totpeso
				select @Saltotpallet = @Saltotpallet - @totpallet
			
			--select @totunidadesGer = @totunidadesGer + @totunidades
			end

			if @Saltotunidades > 0
			begin
				select @totunidadesGer = @totunidadesGer + @Saltotunidades
				select @totpesoGer = @totpesoGer + @Saltotpeso
				select @totpalletGer = @totpalletGer + @Saltotpallet
			
				
				insert into ServWeb (
					Sweb_codi,
					Sweb_Serv,
					Sweb_Cliente,
					Sweb_Fecha,
					Sweb_Cam1,
	
					Sweb_Cam2,
					Sweb_Cam3,
					Sweb_GrupFec,
					Sweb_Cam4
			--	Sweb_Cam5,
			--	Sweb_Cam6,
			---	Sweb_Cam7,
			--	Sweb_Cam8
	
					) 
				values (	
					@ID_Fact,
					@Servicio,
					@Rut_Clien,
					@Fecha,			
					 @saltotunidades,
			 		 @saltotpeso,
				 	@saltotpallet,
					@Fecha_Grupo,
					@fec_Hasta
--					CONVERT(VARCHAR,  @fec_Hasta, 120)
					
				--@fec_desde,
				--@Fec_String2,
				--@totpalletGer,
				--@totunidadesGer
				)
			end 
			
			select   @fecha = DateAdd(day, 1, @fecha)  
			--select @Saltotunidades =  0
			--select @Saltotpeso = 0
			--select @Saltotpallet = 0
			
		 end  
	

end
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[sp_servicio_46] 
	 @Contrato as varchar(10),
	 @Rut_Clien  varchar(10),
 
	 @Fec_Desde datetime,
	 @Fec_Hasta  datetime,
	@Servicio as float,
	@ID_Fact as float
as
declare
	@fecha datetime,
	@Fecha2 varchar(10),
	@unidades float,
	@peso float,
	@pallet float,
	@totunidades float,
	@totpeso float,
	@totpallet float,
	@Saltotunidades float,
	@Saltotpeso float,
	@Saltotpallet float,
	@totunidadesGer float,
	@totpesoGer float,
	@totpalletGer float,
	@Fec_String varchar(10),
	@Fec_String2 varchar(10),
	@num float,
	@Servicio_Serv varchar(3),  
	@Fecha_Serv varchar(6),
	@Fecha_Grupo float
		


begin
	
	select @unidades = 0
	select @peso = 0
	select @totpallet = 0

	select @saltotunidades = 0
	select @saltotpeso = 0
	select @saltotpallet = 0

	select @totunidades = 0
	select @totpeso = 0
	select @totpallet = 0

	select @totunidadesGer =0
	select @totpesoGer = 0
	select @totpalletGer = 0
	select @num = 1


	select @fec_string2 =  CONVERT(VARCHAR, @fec_desde, 120)
	select @fec_string2 =  SUBSTRING(@fec_string2, 1, 4)   +  '/'  +  SUBSTRING(@fec_string2, 6, 2)  + '/' + SUBSTRING(@fec_string2, 9, 2) 
	
	select @unidades  =  isnull(sum(drec_unidades),0) ,
		@peso = isnull(sum( drec_peso) ,0),
		@pallet = isnull(sum(drec_pallet), 0) 

	From detarece where
	drec_rutcli = @Rut_Clien and
	drec_contcli =  @Contrato and
	drec_fecrec  <  @fec_string2  and
	drec_codvig = 0


	select @Saltotunidades = @Saltotunidades + @unidades 
	select @Saltotpeso = @Saltotpeso + @peso 
	select @Saltotpallet = @Saltotpallet + @pallet 


	select  	@unidades  = isnull(sum(ddes_unidades),0),
		@peso = isnull(sum(ddes_peso),0),
		@pallet = isnull(sum(ddes_pallet),0)
	from detadespa where
		ddes_rutcli = @Rut_Clien and
		ddes_contcli =  @Contrato and

		ddes_fecha  <  @fec_string2  and
		ddes_codvig = 0

	select @Saltotunidades = @Saltotunidades - @unidades 
	select @Saltotpeso = @Saltotpeso - @peso 
	select @Saltotpallet = @Saltotpallet - @pallet 


	select @num = 1
	select @fecha  =  @fec_Desde
	
	
	
	select @num = 1
	select @fecha  =  @fec_Desde
	
	
		



		 while @fec_Hasta >= @fecha
		 begin

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select @fec_string =  CONVERT(VARCHAR, @fecha, 120)
			select @fec_string =  SUBSTRING(@fec_string, 1, 4)   +  '/'  +  SUBSTRING(@fec_string, 6, 2)  + '/' + SUBSTRING(@fec_string, 9, 2) 
			
			select @fecha_serv =  SUBSTRING(@fec_string, 1, 4)  +   SUBSTRING(@fec_string, 6, 2)  
			select @fecha_Grupo = cast(@fecha_Serv as float)
			select @unidades  =  isnull(sum(drec_unidades),0) ,
				@peso = isnull(sum( drec_peso) ,0),
				@pallet = isnull(sum(drec_pallet), 0) 
			 from detarece where
				drec_rutcli = @Rut_Clien and
				drec_contcli =  @Contrato and
				drec_fecrec = @fec_string  and
				drec_codvig = 0

		
			select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet
			If  @totunidades >  0
			begin
				select @Saltotunidades = @Saltotunidades + @totunidades
				select @Saltotpeso = @Saltotpeso + @totpeso
				select @Saltotpallet = @Saltotpallet + @totpallet
			end

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select  	@unidades  = isnull(sum(ddes_unidades),0),
				@peso = isnull(sum(ddes_peso),0),
				@pallet = isnull(sum(ddes_pallet),0)
			from detadespa where
				ddes_rutcli = @Rut_Clien and
				ddes_contcli =  @Contrato and

				ddes_fecha = @fec_string  and
				ddes_codvig = 0
			 select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet

			If  @totunidades  > 0
			begin
				select @Saltotunidades =  @Saltotunidades - @totunidades
				select @Saltotpeso = @Saltotpeso - @totpeso
				select @Saltotpallet = @Saltotpallet - @totpallet
			
			--select @totunidadesGer = @totunidadesGer + @totunidades
			end

			if @Saltotunidades > 0
			begin
				select @totunidadesGer = @totunidadesGer + @Saltotunidades
				select @totpesoGer = @totpesoGer + @Saltotpeso
				select @totpalletGer = @totpalletGer + @Saltotpallet
			
				
				insert into ServWeb (
					Sweb_codi,
					Sweb_Serv,
					Sweb_Cliente,
					Sweb_Fecha,
					Sweb_Cam1,
	
					Sweb_Cam2,
					Sweb_Cam3,
					Sweb_GrupFec,
					Sweb_Cam4
			--	Sweb_Cam5,
			--	Sweb_Cam6,
			---	Sweb_Cam7,
			--	Sweb_Cam8
	
					) 
				values (	
					@ID_Fact,
					@Servicio,
					@Rut_Clien,
					@Fecha,			
					 @saltotunidades,
			 		 @saltotpeso,
				 	@saltotpallet,
					@Fecha_Grupo,
					@fec_Hasta
--					CONVERT(VARCHAR,  @fec_Hasta, 120)
					
				--@fec_desde,
				--@Fec_String2,
				--@totpalletGer,
				--@totunidadesGer
				)
			end 
			
			select   @fecha = DateAdd(day, 1, @fecha)  
			--select @Saltotunidades =  0
			--select @Saltotpeso = 0
			--select @Saltotpallet = 0
			
		 end  
	

end
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[sp_servicio_73]
	 @Contrato as varchar(10),
	 @Rut_Clien  varchar(10),
 
	 @Fec_Desde datetime,
	 @Fec_Hasta  datetime,
	@Servicio as float,
	@ID_Fact as float
as
declare
	@fecha datetime,
	@Fecha2 varchar(10),
	@unidades float,
	@peso float,
	@pallet float,
	@totunidades float,
	@totpeso float,
	@totpallet float,
	@Saltotunidades float,
	@Saltotpeso float,
	@Saltotpallet float,
	@totunidadesGer float,
	@totpesoGer float,
	@totpalletGer float,
	@Fec_String varchar(10),
	@Fec_String2 varchar(10),
	@num float,
	@Servicio_Serv varchar(3),  
	@Fecha_Serv varchar(6),
	@Fecha_Grupo float
		


begin
	
	select @unidades = 0
	select @peso = 0
	select @totpallet = 0

	select @saltotunidades = 0
	select @saltotpeso = 0
	select @saltotpallet = 0

	select @totunidades = 0
	select @totpeso = 0
	select @totpallet = 0

	select @totunidadesGer =0
	select @totpesoGer = 0
	select @totpalletGer = 0
	select @num = 1


	select @fec_string2 =  CONVERT(VARCHAR, @fec_desde, 120)
	select @fec_string2 =  SUBSTRING(@fec_string2, 1, 4)   +  '/'  +  SUBSTRING(@fec_string2, 6, 2)  + '/' + SUBSTRING(@fec_string2, 9, 2) 
	
	select @unidades  =  isnull(sum(drec_unidades),0) ,
		@peso = isnull(sum( drec_peso) ,0),
		@pallet = isnull(sum(drec_pallet), 0) 

	From detarece where
	drec_rutcli = @Rut_Clien and
	drec_contcli =  @Contrato and
	drec_fecrec  <  @fec_string2  and
	drec_codvig = 0


	select @Saltotunidades = @Saltotunidades + @unidades 
	select @Saltotpeso = @Saltotpeso + @peso 
	select @Saltotpallet = @Saltotpallet + @pallet 


	select  	@unidades  = isnull(sum(ddes_unidades),0),
		@peso = isnull(sum(ddes_peso),0),
		@pallet = isnull(sum(ddes_pallet),0)
	from detadespa where
		ddes_rutcli = @Rut_Clien and
		ddes_contcli =  @Contrato and

		ddes_fecha  <  @fec_string2  and
		ddes_codvig = 0

	select @Saltotunidades = @Saltotunidades - @unidades 
	select @Saltotpeso = @Saltotpeso - @peso 
	select @Saltotpallet = @Saltotpallet - @pallet 


	select @num = 1
	select @fecha  =  @fec_Desde
	
	
	
	select @num = 1
	select @fecha  =  @fec_Desde
	
	
		



		 while @fec_Hasta >= @fecha
		 begin

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select @fec_string =  CONVERT(VARCHAR, @fecha, 120)
			select @fec_string =  SUBSTRING(@fec_string, 1, 4)   +  '/'  +  SUBSTRING(@fec_string, 6, 2)  + '/' + SUBSTRING(@fec_string, 9, 2) 
			
			select @fecha_serv =  SUBSTRING(@fec_string, 1, 4)  +   SUBSTRING(@fec_string, 6, 2)  
			select @fecha_Grupo = cast(@fecha_Serv as float)
			select @unidades  =  isnull(sum(drec_unidades),0) ,
				@peso = isnull(sum( drec_peso) ,0),
				@pallet = isnull(sum(drec_pallet), 0) 
			 from detarece where
				drec_rutcli = @Rut_Clien and
				drec_contcli =  @Contrato and
				drec_fecrec = @fec_string  and
				drec_codvig = 0

		
			select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet
			If  @totunidades >  0
			begin
				select @Saltotunidades = @Saltotunidades + @totunidades
				select @Saltotpeso = @Saltotpeso + @totpeso
				select @Saltotpallet = @Saltotpallet + @totpallet
			end

			select @unidades = 0
			select @peso = 0
			select @pallet = 0
			select @totunidades = 0
			select @totpeso = 0
			select @totpallet = 0

			select  	@unidades  = isnull(sum(ddes_unidades),0),
				@peso = isnull(sum(ddes_peso),0),
				@pallet = isnull(sum(ddes_pallet),0)
			from detadespa where
				ddes_rutcli = @Rut_Clien and
				ddes_contcli =  @Contrato and

				ddes_fecha = @fec_string  and
				ddes_codvig = 0
			 select @totunidades = @totunidades + @unidades
			select @totpeso = @totpeso + @peso
			select @totpallet = @totpallet + @pallet

			If  @totunidades  > 0
			begin
				select @Saltotunidades =  @Saltotunidades - @totunidades
				select @Saltotpeso = @Saltotpeso - @totpeso
				select @Saltotpallet = @Saltotpallet - @totpallet
			
			--select @totunidadesGer = @totunidadesGer + @totunidades
			end

			if @Saltotunidades > 0
			begin
				select @totunidadesGer = @totunidadesGer + @Saltotunidades
				select @totpesoGer = @totpesoGer + @Saltotpeso
				select @totpalletGer = @totpalletGer + @Saltotpallet
			
				
				insert into ServWeb (
					Sweb_codi,
					Sweb_Serv,
					Sweb_Cliente,
					Sweb_Fecha,
					Sweb_Cam1,
	
					Sweb_Cam2,
					Sweb_Cam3,
					Sweb_GrupFec,
					Sweb_Cam4
			--	Sweb_Cam5,
			--	Sweb_Cam6,
			---	Sweb_Cam7,
			--	Sweb_Cam8
	
					) 
				values (	
					@ID_Fact,
					@Servicio,
					@Rut_Clien,
					@Fecha,			
					 @saltotunidades,
			 		 @saltotpeso,
				 	@saltotpallet,
					@Fecha_Grupo,
					@fec_Hasta
--					CONVERT(VARCHAR,  @fec_Hasta, 120)
					
				--@fec_desde,
				--@Fec_String2,
				--@totpalletGer,
				--@totunidadesGer
				)
			end 
			
			select   @fecha = DateAdd(day, 1, @fecha)  
			--select @Saltotunidades =  0
			--select @Saltotpeso = 0
			--select @Saltotpallet = 0
			
		 end  
	

end
GO
SET ANSI_NULLS OFF
GO

GO
CREATE PROCEDURE [dbo].[sp_TrazaPalletsCodigoIcestar]

    -- Add the parameters for the stored procedure here

    @Codigo nvarchar(9)

       

AS

BEGIN

    -- SET NOCOUNT ON added to prevent extra result sets from

    -- interfering with SELECT statements.

    SET NOCOUNT ON;

 

    -- Insert statements for procedure here

    

    

SELECT dbo.P_Usuario.UsuarioNombre AS PERSONAL, dbo.ClasificacionMovimiento.Cmov_Descrip AS DESCRIPCIN, dbo.movpallet.mov_CA AS CA, 

       dbo.movpallet.mov_BA AS BA, dbo.movpallet.mov_CO AS CO, dbo.movpallet.mov_PI AS PI, dbo.movpallet.mov_NI AS NI, dbo.movpallet.mov_Fecha AS FECHA, 

       dbo.movpallet.mov_Hora AS HORA

FROM   dbo.movpallet INNER JOIN

       dbo.ClasificacionMovimiento ON dbo.movpallet.mov_Tipo = dbo.ClasificacionMovimiento.Cmov_codi INNER JOIN

       dbo.P_Usuario ON dbo.movpallet.mov_codper = dbo.P_Usuario.UsuarioNumero

WHERE  dbo.movpallet.mov_folio = @Codigo AND dbo.movpallet.mov_Tipo <> 'SI'

ORDER BY mov_fecha, mov_hora

 

    END
GO

GO

GO
CREATE PROCEDURE [dbo].[webborradetarecetmp]
@codpal nvarchar(9)
AS
DECLARE @Error int;
DECLARE @HayError int;
BEGIN
    SET NOCOUNT ON;
    SET @Error=@@ERROR ;
    
    SELECT @HayError=0;
    BEGIN TRANSACTION
		
	BEGIN TRY		
			DELETE  FROM  tmpdetarece WHERE frec_codi= LEFT(@codpal,7) AND drec_codi=RIGHT(@codpal,2);
	END TRY
	BEGIN CATCH		
			ROLLBACK TRANSACTION;
			SELECT @HayError=1;
			RETURN 11;
	END CATCH
	
	IF @HayError=0	COMMIT TRANSACTION;
END
GO

GO

GO
CREATE PROCEDURE [dbo].[webgetseriechklst]
@codcorre nvarchar(5)
AS
BEGIN
    SET NOCOUNT ON;
    BEGIN TRANSACTION
    DECLARE @nnId bigint;
    DECLARE @IdCodigo bigint;
    DECLARE @mintmps_codi bigint
    
    SELECT @mintmps_codi= MIN(tmps_codi) FROM correlat_salto WHERE tmps_correl=convert(int,@codcorre)
    IF (@mintmps_codi > 0 )
	BEGIN
		SELECT @nnId=@mintmps_codi
		DELETE FROM correlat_salto WHERE tmps_correl=convert(int,@codcorre) and tmps_codi=@mintmps_codi
	END
	ELSE
	BEGIN
		SELECT @nnId = cor_correact FROM correlat WITH (HOLDLOCK) WHERE cor_codi=@codcorre
		IF NOT (@@ROWCOUNT = 1)
		BEGIN
			INSERT INTO correlat (cor_correact,cor_codi) values (1,@codcorre)
			SELECT @nnId = 1
		END
		UPDATE correlat SET cor_correact = @nnId + 1 WHERE cor_codi=@codcorre
	END
	COMMIT TRANSACTION
	RETURN @nnId
END
GO

GO

GO
CREATE PROCEDURE [dbo].[webingchklst]
@rutclie nvarchar(9),
@rutchof nvarchar(9),
@patente nvarchar(10),
@rampla nvarchar(20),
@turno numeric,
@movi numeric,
@cont numeric,
@temp nvarchar(10),
@guardia numeric,
@etrans nvarchar(40),
@fecha date,
@hora time,
@codcorre nvarchar(5),
@sello nvarchar(20),
@guia nvarchar(20)
AS
DECLARE @return_value int;
DECLARE @Error int;
DECLARE @cadserie nvarchar(7);
DECLARE @largo int;
BEGIN
    SET NOCOUNT ON;
    
    BEGIN TRANSACTION
    
		SET @Error=@@ERROR ;
		
		EXEC	@return_value = webgetseriechklst @codcorre;
		SELECT	'Serie' = @return_value;
		
		SELECT @largo=LEN(@return_value);
		SELECT @cadserie=REPLICATE('0', 7-@largo)+ltrim(str(@return_value));

		SELECT @largo=LEN(@rutchof);
		SELECT @rutchof=REPLICATE('0', 9-@largo)+@rutchof;
		
		IF (@Error<>0) 
		BEGIN
			ROLLBACK;
			SELECT	'Serie' = 0;
		END
		
		
DECLARE @patente_real VARCHAR SET @patente_real= (SELECT cho_patente from Choferes WHERE cho_rut= @rutchof);
DECLARE @rampla_real VARCHAR SET @rampla_real= (SELECT cho_patente2 from Choferes WHERE cho_rut= @rutchof);

IF (@patente!= @patente_real AND @rampla!= @rampla_real) BEGIN
   
   UPDATE Choferes SET cho_patente =@patente, cho_patente2 =@rampla WHERE cho_rut= @rutchof;

INSERT INTO zchecklist
		(CL_fol, Cl_RutCli, Cl_chorut, Cl_pate, Cl_Ram, Cl_Tur,
Cl_Mov,Cl_Cont,Cl_Ting,Cl_Gs,Cl_ChoEmp, CL_tablet,Cl_fec,cl_lleg,
Cl_Estfrigo,Cl_EstPor,Cl_DesSello,Cl_salGuia) 
VALUES (@cadserie,@rutclie,@rutchof,@patente,@rampla,@turno,
		@movi,@cont,@temp,@guardia,@etrans,1,@fecha,GETDATE(),
		0,0,@sello,@guia);

END ELSE IF  (@rampla!= @rampla_real) BEGIN

	  UPDATE Choferes SET cho_patente2 =@rampla WHERE cho_rut= @rutchof;

INSERT INTO zchecklist
		(CL_fol, Cl_RutCli, Cl_chorut, Cl_pate, Cl_Ram, Cl_Tur,
Cl_Mov,Cl_Cont,Cl_Ting,Cl_Gs,Cl_ChoEmp, CL_tablet,Cl_fec,cl_lleg,
Cl_Estfrigo,Cl_EstPor,Cl_DesSello,Cl_salGuia) 
VALUES 
		(@cadserie,@rutclie,@rutchof,@patente,@rampla,@turno,
		@movi,@cont,@temp,@guardia,@etrans,1,@fecha,GETDATE(),
		0,0,@sello,@guia);

END ELSE IF  (@patente!= @patente_real) BEGIN

	  UPDATE Choferes SET cho_patente =@patente WHERE cho_rut= @rutchof;

INSERT INTO zchecklist
		(CL_fol, Cl_RutCli, Cl_chorut, Cl_pate, Cl_Ram, Cl_Tur,
Cl_Mov,Cl_Cont,Cl_Ting,Cl_Gs,Cl_ChoEmp, CL_tablet,Cl_fec,cl_lleg,
Cl_Estfrigo,Cl_EstPor,Cl_DesSello,Cl_salGuia) 
VALUES 
		(@cadserie,@rutclie,@rutchof,@patente,@rampla,@turno,
		@movi,@cont,@temp,@guardia,@etrans,1,@fecha,GETDATE(),
		0,0,@sello,@guia);
      
 END ELSE

   INSERT INTO zchecklist
		(CL_fol, Cl_RutCli, Cl_chorut, Cl_pate, Cl_Ram, Cl_Tur,
Cl_Mov,Cl_Cont,Cl_Ting,Cl_Gs,Cl_ChoEmp, CL_tablet,Cl_fec,cl_lleg,
Cl_Estfrigo,Cl_EstPor,Cl_DesSello,Cl_salGuia) 
VALUES 
		(@cadserie,@rutclie,@rutchof,@patente,@rampla,@turno,
		@movi,@cont,@temp,@guardia,@etrans,1,@fecha,GETDATE(),
		0,0,@sello,@guia);
      
   END ;


            
		IF (@Error<>0) BEGIN
			ROLLBACK;
			SELECT	'Serie' = 0;
		END ELSE 
			COMMIT TRANSACTION
    
GO

GO

GO
CREATE PROCEDURE [dbo].[webingrecepcion]
@NumTmp			int,
@codcorre		nvarchar(5),
@Rerror			int output,
@cadserie nvarchar(7) output,
@codusuweb int
AS
DECLARE @return_value int;
DECLARE @Error int;
DECLARE @HayError int;
DECLARE @largo int;
DECLARE @frec_rutcli nvarchar(19);
DECLARE @frec_clfol nvarchar(7);

DECLARE @drec_codpro nvarchar(7);
DECLARE @drec_codsag nvarchar(15);
DECLARE @drec_codsopo nvarchar(3);
DECLARE @drec_fecprod nvarchar(10);
DECLARE @drec_unidades int;
DECLARE @drec_peso float;
DECLARE @drec_sopocli nvarchar(11);
DECLARE @fechavencimiento char(10);
DECLARE @lotecliente nvarchar(10);
DECLARE @drec_estado nvarchar(50);
DECLARE @codpal nvarchar(9);
DECLARE @temp float;
DECLARE @bloqueado nvarchar(1);
DECLARE @idrece int;
DECLARE @contador int;
DECLARE @NumPal nvarchar(2);
DECLARE @NPallet nvarchar(9);
DECLARE @TieneDetalle int;
DECLARE @TRANS nvarchar(20);
DECLARE @frec_totsopo int;
DECLARE @frec_totunidad int;
DECLARE @frec_totpeso float;
DECLARE @frec_temppro float;
DECLARE @ContTemp int;
DECLARE @frec_rutcond nvarchar(9);
DECLARE @CodAlmac int;
DECLARE @NombAlmac nvarchar(50);
DECLARE @Tunel int;
DECLARE @UsuCodigo nvarchar(3);
DECLARE @Camara nvarchar(2);
DECLARE @contrato nvarchar(7);
BEGIN
	SELECT @HayError=0;
	SELECT @TRANS=CONVERT(nvarchar(20),@NumTmp);
    SET NOCOUNT ON;
    
    SELECT	@TieneDetalle=COUNT(*) FROM webtmpdetarece WHERE codtpmrece=@NumTmp;		
	IF (@TieneDetalle=0)
	BEGIN
		UPDATE webtmpfichrece SET frec_abierto=1 WHERE frec_codigo=@NumTmp;
		SELECT	'error'=0,'Serie' = -1;
		RETURN 0;
	END
		
    BEGIN TRANSACTION @TRANS	
		EXEC @return_value = webgetseriechklst @codcorre;
		
		SELECT @largo=LEN(@return_value);
		SELECT @cadserie=REPLICATE('0', 7-@largo)+ltrim(str(@return_value));
		
		/******************************** OBTENCION DE DATOS ********************************/
		SELECT @contrato=frec_contcli, @Tunel=frec_RecepTunel ,@frec_rutcli=frec_rutcli,@frec_clfol=frec_clfol,@CodAlmac=convert(int,frec_tipoalmacenamiento),
		@Camara=frec_antecamara
		FROM webtmpfichrece WHERE frec_codigo=@NumTmp;
		
		SELECT @frec_rutcond=Cl_chorut FROM zCheckList WHERE  Cl_fol= @frec_clfol
		
		SELECT @frec_totunidad=SUM(drec_unidades),@frec_totpeso=SUM(drec_peso),@frec_totsopo=count(*),
		@frec_temppro=SUM(drec_temp)
		FROM webtmpdetarece WHERE codtpmrece=@NumTmp;
		
		SELECT @ContTemp = COUNT(*) FROM webtmpdetarece WHERE drec_temp is not null AND codtpmrece=@NumTmp;
		SELECT @frec_temppro=@frec_temppro/@ContTemp;
		
		SELECT @NombAlmac=almacenamiento FROM P_TipoAlmacenamiento WHERE id=@CodAlmac;
		
		SELECT @UsuCodigo=usu_codigo FROM webusuarios INNER JOIN Usuarios ON rutusu=usu_rut 
		WHERE codfor=@codusuweb
		/**************************** FIN OBTENCION DE DATOS ********************************/
			
		SELECT TOP 1 @bloqueado = bloqueado  FROM webtmpdetarece WHERE codtpmrece=@NumTmp;
		
		BEGIN TRY		
			INSERT INTO fichrece ( frec_codienca, frec_tipoalmacenamiento, frec_rutcli,frec_contcli,frec_horarec,
			frec_horater,frec_fecrec,frec_tiporecepcion,frec_guiades,frec_clfol,
			frec_tipdesc,frec_origen,frec_numSello,frec_observ,frec_antecamara,frec_olores,frec_contenedor,
			frec_higiene,frec_estiba,frec_daado,frec_RecepTunel,frec_codi,frec_codvig,frec_tablet,
			frec_totpeso,frec_totsopo,frec_totunidad,frec_horalleg,frec_temppro,frec_rutcond)
			SELECT @UsuCodigo,@NombAlmac,frec_rutcli,frec_contcli ,frec_horarec,
			frec_horater,frec_fecrec,frec_tiporecepcion,frec_guiades,frec_clfol,
			frec_tipdesc,frec_origen,frec_numSello,frec_observ,frec_antecamara,frec_olores,frec_contenedor,
			frec_higiene,frec_estiba,frec_daado,@Tunel,@cadserie,0,1,@frec_totpeso,@frec_totsopo,
			@frec_totunidad,cast(datepart(hour,GETDATE()) as char(2))+':'+cast(datepart(minute,GETDATE()) as char(2)),
			@frec_temppro,@frec_rutcond
			FROM webtmpfichrece WHERE frec_codigo=@NumTmp;
		END TRY	
		BEGIN CATCH	
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=1;
			SELECT	'Serie' = 0;
			SELECT	'error'=@HayError,'Serie' = @cadserie;
			RETURN 1;
		END CATCH
		
		BEGIN TRY
			UPDATE zCheckList SET Cl_RutCli=@frec_rutcli WHERE Cl_fol=@frec_clfol
		END TRY
		
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=2;
			SELECT	'Serie' = 0;
			SELECT	'error'=@HayError,'Serie' = @cadserie;	
			RETURN 1;
		END CATCH
			
		BEGIN TRY		
					INSERT INTO detarece
					(
					drec_rutcli,drec_fecrec,drec_camara,
					drec_codi,drec_codpro,drec_codsag ,drec_codsopo,
					drec_fecprod,drec_unidades ,drec_peso,drec_sopocli,
					fechavencimiento,lotecliente,drec_estado,drec_temp,
					drec_banda,drec_colum,drec_piso,drec_nivel,drec_almacen,
					drec_codvig,drec_pallet,drec_RecepTunel,drec_codper,drec_hora,
					frec_codi1,drec_etiqueta,drec_contcli) 
					SELECT
					@frec_rutcli,CONVERT(nvarchar(10),GETDATE(),111),@Camara,
					@cadserie+right(drec_codi,2) as  drec_codi,
					drec_codpro,drec_codsag,convert(nvarchar(2),convert(int,drec_codsopo)),
					drec_fecprod,drec_unidades,drec_peso,drec_sopocli,
					fechavencimiento,lotecliente,drec_estado,drec_temp,
					'0','0','0','0',2,'0',1,@Tunel,@UsuCodigo,cast(datepart(hour,GETDATE()) as char(2))+':'+cast(datepart(minute,GETDATE()) as char(2)),
					@cadserie,dbo.CREAETIQUETA('1780000000'+@cadserie+right(drec_codi,2)),@contrato
					FROM webtmpdetarece WHERE codtpmrece=@NumTmp;				
		END TRY
		BEGIN CATCH		
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=3;
				SELECT	'error'=@HayError,'Serie' = @cadserie;
				RETURN 11;
		END CATCH	
		
		BEGIN TRY	
				INSERT INTO rackdeta (racd_codi,racd_codpro,racd_unidades,racd_peso
				,racd_ca,racd_ba,racd_co,racd_pi,racd_ni,racd_estado
				,racd_fecpro,FechaVencimiento)
				SELECT drec_codi,drec_codpro,drec_unidades,drec_peso,drec_camara,'00','00','00','0',
				@bloqueado,drec_fecprod,FechaVencimiento
				FROM detarece WHERE @cadserie=left(drec_codi,len(drec_codi)-2)
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=4;
				SELECT	'error'=@HayError,'Serie' = @cadserie;
				RETURN 12;
		END CATCH	
		BEGIN TRY	
				INSERT INTO movpallet (mov_folio,mov_ca,mov_ba,mov_co,mov_pi,mov_ni,
				mov_fecha,mov_tipo,mov_hora,mov_codper,mov_TS,Mov_Saldo,mov_anden,mov_Doc)
				SELECT drec_codi,drec_camara,'00','00','00','0',CONVERT(nvarchar(10),GETDATE(),111),
				'EN',CONVERT(nvarchar(10),GETDATE(),108),
				drec_codper,drec_temp, drec_unidades,@Camara,@cadserie
				FROM detarece WHERE @cadserie=left(drec_codi,len(drec_codi)-2)
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=5;
				SELECT	'error'=@HayError,'Serie' = @cadserie;
				RETURN 13;
		END CATCH
		/*INGRESO FOTOS*/
		BEGIN TRY	
				INSERT INTO chk_imagesopo
				(id_pallets,cl_imgpat,cl_imgsel,cl_imgtem) 
				SELECT
				@cadserie+right(id_pallets,2) as id_pallets ,cl_imgpat,cl_imgsel,cl_imgtem
				FROM chk_imagestmp
				WHERE codtpmrece=@NumTmp;			
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=6;
				SELECT	'error'=@HayError,'Serie' = @cadserie;
				RETURN 14;
		END CATCH
		
		BEGIN TRY	
				UPDATE webtmpfichrece SET frec_abierto=1 WHERE frec_codigo=@NumTmp;
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=7;
				SELECT	'error'=@HayError,'Serie' = @cadserie;
				RETURN 14;
		END CATCH
	SELECT @Rerror=@HayError;
	IF (@HayError=0) 
	BEGIN
		COMMIT TRANSACTION @TRANS;
		SELECT	'error'=@HayError,'Serie' = @cadserie;
	END
END


GO

GO

GO
CREATE PROCEDURE [dbo].[webingrecepcion2]
@CodRece		nvarchar(7) output,
@codcorre		nvarchar(5),
@Rerror			int output,
@codusuweb      int
AS
DECLARE @return_value int;
DECLARE @Error int;
DECLARE @HayError int;
DECLARE @largo int;
DECLARE @frec_rutcli nvarchar(19);
DECLARE @frec_clfol nvarchar(7);

DECLARE @drec_codpro nvarchar(7);
DECLARE @drec_codsag nvarchar(15);
DECLARE @drec_codsopo nvarchar(3);
DECLARE @drec_fecprod nvarchar(10);
DECLARE @drec_unidades int;
DECLARE @drec_peso float;
DECLARE @drec_sopocli nvarchar(11);
DECLARE @fechavencimiento char(10);
DECLARE @lotecliente nvarchar(10);
DECLARE @drec_estado nvarchar(50);
DECLARE @codpal nvarchar(9);
DECLARE @temp float;
DECLARE @bloqueado nvarchar(1);
DECLARE @idrece int;
DECLARE @contador int;
DECLARE @NumPal nvarchar(2);
DECLARE @NPallet nvarchar(9);
DECLARE @TieneDetalle int;
DECLARE @TRANS nvarchar(20);
DECLARE @frec_totsopo int;
DECLARE @frec_totunidad int;
DECLARE @frec_totpeso float;
DECLARE @frec_temppro float;
DECLARE @ContTemp int;
DECLARE @frec_rutcond nvarchar(9);
DECLARE @CodAlmac int;
DECLARE @NombAlmac nvarchar(50);
DECLARE @Tunel int;
DECLARE @UsuCodigo nvarchar(3);
DECLARE @Camara nvarchar(2);
DECLARE @contrato nvarchar(7);
DECLARE @turno int;
DECLARE @bloqueaped int;
DECLARE @estacontenedor int;
DECLARE @contenedor nvarchar(20);
DECLARE @minutos as int;
DECLARE @hora as int;
DECLARE @minutoschr as nvarchar(2);
DECLARE @horachr as nvarchar(2);


BEGIN
	SELECT @HayError=0;
	SELECT @TRANS=CONVERT(nvarchar(20),@CodRece);
    SET NOCOUNT ON;
    
	SELECT @contenedor='';
    SELECT @estacontenedor=0;
    
	IF (CONVERT(time, GETDATE()) > CONVERT(time, '08:00:00')) AND (CONVERT(time, GETDATE()) <= CONVERT(time, '19:59:59'))
	SELECT @turno=1
	ELSE
	SELECT @turno=2

    SELECT	@TieneDetalle=COUNT(*) FROM TMPDETARECE WHERE frec_codi=@CodRece;		
	IF (@TieneDetalle=0)
	BEGIN
		/******** La recepcion no tiene detalle se cierra *******/
		UPDATE TMPFICHRECE SET frec_abierto=1 WHERE frec_codi=@CodRece;
		/******** Se devuelve el codigo a correlat_salto *******/
		DELETE FROM TMPFICHRECE  WHERE frec_codi=@CodRece;
		DELETE FROM detarececajas  WHERE LEFT(Caj_Pcod,7)=@CodRece;
		DELETE FROM chk_imagestmp WHERE codtpmrece =@CodRece;
		INSERT INTO correlat_salto (tmps_codi,tmps_correl,tmps_personal,tmps_fecha) VALUES (@CodRece,6,@codusuweb,convert(nvarchar(10),GETDATE(),111))
		SELECT	'error'=0,'Serie' = -1;
		RETURN 0;
	END
		
    BEGIN TRANSACTION @TRANS	
		
		/******************************** OBTENCION DE DATOS ********************************/
		SELECT @contrato=frec_contcli, @Tunel=frec_RecepTunel ,@frec_rutcli=frec_rutcli,@frec_clfol=frec_clfol,@CodAlmac=convert(int,frec_tipoalmacenamiento),
		@Camara=frec_antecamara,@contenedor=frec_contenedor
		FROM TMPFICHRECE WHERE frec_codi=@CodRece;
		
/******************************* VALIDACION DE CONTENEDOR  ******************************************/

		SELECT TOP 1 @bloqueado = bloqueado  FROM TMPDETARECE WHERE frec_codi=@CodRece;
		
		SELECT @bloqueaped=cont_BloqImp FROM contrato WHERE cont_codi= @contrato
		

		SELECT @estacontenedor=COUNT(*) FROM Proc_Importaciones WHERE pimp_ncont  LIKE '%'+@contenedor+'%'
		
		IF (@bloqueaped=1) 
		BEGIN
			IF (@estacontenedor=1)
				SELECT @bloqueado = 0;
			ELSE
				SELECT @bloqueado = 5;
		END
	--@bloqueaped=1 bloquea racd_estado=5
	--@estacontenedor=1 solo si @bloqueaped=1     racd_estado=0
/******************************** *******************************************************************/

		SELECT @frec_rutcond=Cl_chorut FROM zCheckList WHERE  Cl_fol= @frec_clfol
		
		SELECT @frec_totunidad=SUM(drec_unidades),@frec_totpeso=SUM(drec_peso),@frec_totsopo=count(*),
		@frec_temppro=SUM(drec_temp)
		FROM TMPDETARECE WHERE frec_codi=@CodRece;
		
		SELECT @ContTemp = COUNT(*) FROM TMPDETARECE WHERE drec_temp is not null AND frec_codi=@CodRece;
		SELECT @frec_temppro=@frec_temppro/@ContTemp;
		
		SELECT @NombAlmac=almacenamiento FROM P_TipoAlmacenamiento WHERE id=@CodAlmac;
		
		SELECT @UsuCodigo=usu_codigo FROM webusuarios INNER JOIN Usuarios ON rutusu=usu_rut 
		WHERE codfor=@codusuweb
		
		/**************************** FIN OBTENCION DE DATOS ********************************/
			
		SELECT @minutos=datepart(MI,GETDATE())
		IF (@minutos<10) SELECT @minutoschr='0'+CAST(@minutos as char(1))
		ELSE SELECT @minutoschr=CAST(@minutos as char(2))
		
		SELECT @hora=datepart(HH,GETDATE())
		IF (@hora<10) SELECT @horachr='0'+CAST(@hora as char(1))
		ELSE SELECT @horachr=CAST(@hora as char(2))
		
		
		BEGIN TRY	
			INSERT INTO fichrece ( frec_codienca, frec_tipoalmacenamiento, frec_rutcli,frec_contcli,frec_horarec,
			frec_horater,frec_fecrec,frec_tiporecepcion,frec_guiades,frec_clfol,
			frec_tipdesc,frec_origen,frec_numSello,frec_observ,frec_antecamara,frec_olores,frec_contenedor,
			frec_higiene,frec_estiba,frec_daado,frec_RecepTunel,frec_codi,frec_codvig,frec_tablet,
			frec_totpeso,frec_totsopo,frec_totunidad,frec_horalleg,frec_temppro,frec_rutcond,frec_turnrec)
			SELECT @UsuCodigo,@NombAlmac,frec_rutcli,frec_contcli ,frec_horarec,
			CONVERT(nvarchar(5),getdate(),108),frec_fecrec,frec_tipo,frec_guiades,frec_clfol,
			frec_tipdesc,frec_origen,frec_numSello,frec_observ,frec_antecamara,frec_olores,frec_contenedor,
			frec_higiene,frec_estiba,frec_daado,@Tunel,@CodRece,0,1,@frec_totpeso,@frec_totsopo,
			@frec_totunidad,frec_horalleg,@frec_temppro,@frec_rutcond,@turno
			FROM TMPFICHRECE WHERE frec_codi=@CodRece;
		END TRY	
		BEGIN CATCH	
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=1;
			SELECT	'Serie' = 0;
			SELECT	'error'=@HayError,'Serie' = @CodRece;
			RETURN 1;
		END CATCH
		
		BEGIN TRY
			UPDATE zCheckList SET Cl_RutCli=@frec_rutcli WHERE Cl_fol=@frec_clfol
		END TRY
		
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=2;
			SELECT	'Serie' = 0;
			SELECT	'error'=@HayError,'Serie' = @CodRece;	
			RETURN 1;
		END CATCH
			
		BEGIN TRY		
					INSERT INTO detarece
					(
					drec_rutcli,drec_fecrec,drec_camara,
					drec_codi,drec_codpro,drec_codsag ,drec_codsopo,
					drec_fecprod,drec_unidades ,drec_peso,drec_sopocli,
					fechavencimiento,lotecliente,drec_estado,drec_temp,
					drec_banda,drec_colum,drec_piso,drec_nivel,drec_almacen,
					drec_codvig,drec_pallet,drec_RecepTunel,drec_codper,drec_hora,
					frec_codi1,drec_etiqueta,drec_contcli,drec_arriendo,drec_codcaja) 
					SELECT
					@frec_rutcli,CONVERT(nvarchar(10),GETDATE(),111),@Camara,
					@CodRece+right(drec_codi,2) as  drec_codi,
					drec_codpro,drec_codsag,convert(nvarchar(2),convert(int,drec_codsopo)),
					drec_fecprod,drec_unidades,drec_peso,drec_sopocli,
					fechavencimiento,lotecliente,drec_estado,drec_temp,
					'0','0','0','0',2,'0',1,@Tunel,@UsuCodigo,cast(datepart(hour,GETDATE()) as char(2))+':'+cast(datepart(minute,GETDATE()) as char(2)),
					@CodRece,dbo.CREAETIQUETA('1780000000'+@CodRece+right(drec_codi,2)),@contrato,drec_arriendo,drec_codcaja
					FROM TMPDETARECE WHERE frec_codi=@CodRece;				
		END TRY
		BEGIN CATCH		
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=3;
				SELECT	'error'=@HayError,'Serie' = @CodRece;
				RETURN 11;
		END CATCH	

		BEGIN TRY	
				INSERT INTO rackdeta (racd_codi,racd_codpro,racd_unidades,racd_peso
				,racd_ca,racd_ba,racd_co,racd_pi,racd_ni,racd_estado
				,racd_fecpro,FechaVencimiento,LoteCliente)
				SELECT drec_codi,drec_codpro,drec_unidades,drec_peso,drec_camara,'00','00','00','0',
				@bloqueado,drec_fecprod,FechaVencimiento,lotecliente
				FROM detarece WHERE LEFT(drec_codi,7)=@CodRece
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=4;
				SELECT	'error'=@HayError,'Serie' = @CodRece;
				RETURN 12;
		END CATCH	
		BEGIN TRY	
				INSERT INTO movpallet (mov_folio,mov_ca,mov_ba,mov_co,mov_pi,mov_ni,
				mov_fecha,mov_tipo,mov_hora,mov_codper,mov_TS,Mov_Saldo,mov_anden,mov_Doc)
				SELECT drec_codi,drec_camara,'00','00','00','0',CONVERT(nvarchar(10),GETDATE(),111),
				'EN',CONVERT(nvarchar(10),GETDATE(),108),
				drec_codper,drec_temp, drec_unidades,@Camara,@CodRece
				FROM detarece WHERE @CodRece=left(drec_codi,len(drec_codi)-2)
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=5;
				SELECT	'error'=@HayError,'Serie' = @CodRece;
				RETURN 13;
		END CATCH
		/*INGRESO FOTOS*/
		BEGIN TRY	
				INSERT INTO chk_imagesopo
				(id_pallets,cl_imgpat,cl_imgsel,cl_imgtem) 
				SELECT
				id_pallets ,cl_imgpat,cl_imgsel,cl_imgtem
				FROM chk_imagestmp
				WHERE codtpmrece=@CodRece;			
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=6;
				SELECT	'error'=@HayError,'Serie' = @CodRece;
				RETURN 14;
		END CATCH
		
		BEGIN TRY	
				UPDATE TMPFICHRECE SET frec_abierto=1 WHERE frec_codi=@CodRece;
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=7;
				SELECT	'error'=@HayError,'Serie' = @CodRece;
				RETURN 14;
		END CATCH
		
		BEGIN TRY	
			UPDATE receimagen SET rimg_temp=1, rimg_rececodi=@CodRece WHERE rimg_rececodi= @CodRece and rimg_temp=0;
		END TRY
		BEGIN CATCH
				ROLLBACK TRANSACTION @TRANS;
				SELECT @HayError=8;
				SELECT	'error'=@HayError,'Serie' = @CodRece;
				RETURN 14;
		END CATCH
		
	/*SELECT @Rerror=@HayError;*/
	
	IF (@HayError=0) 
	BEGIN
		COMMIT TRANSACTION @TRANS;
		DELETE FROM TMPFICHRECE  WHERE frec_codi=@CodRece;
		DELETE FROM TMPDETARECE  WHERE frec_codi=@CodRece;
		DELETE FROM chk_imagestmp WHERE codtpmrece =@CodRece;
		SELECT	'error'=@HayError,'Serie' = @CodRece;
	END
	
END

GO

GO

GO
CREATE PROCEDURE [dbo].[webingredetarecetmp]
@drec_codi nvarchar(9),
@drec_codpro nvarchar(7),
@drec_codsag nvarchar(15),
@drec_codsopo nvarchar(3),
@drec_fecprod nvarchar(10),
@drec_unidades int,
@drec_peso float,
@drec_sopocli nvarchar(11),
@fechavencimiento char(10),
@lotecliente nvarchar(10),
@drec_estado nvarchar(50),
@codpal nvarchar(9),
@temp float,
@bloqueado nvarchar(1),
@idrece int
AS
DECLARE @Error int;
DECLARE @Cant int;
DECLARE @NumPal nvarchar(2);
DECLARE @Salida int;
DECLARE @HayError int;
BEGIN
    SET NOCOUNT ON;
    SET @Error=@@ERROR ;
    
    SELECT @Cant=0;
    SELECT @HayError=0;
    BEGIN TRANSACTION
		IF (@codpal='0')
		BEGIN
			
			SELECT @Cant=ISNULL(right(MAX(drec_codi),2),0)
			FROM webtmpdetarece WHERE codtpmrece =@drec_codi;

			SELECT @Cant=@Cant + 1 ;
			
			IF @Cant<10
				SELECT @NumPal='0'+CONVERT(nvarchar(1),@Cant);
			ELSE
				SELECT @NumPal=CONVERT(nvarchar(2),@Cant);
			
			SELECT @drec_codi=@drec_codi+@NumPal
		
			BEGIN TRY		
					INSERT INTO webtmpdetarece
					(drec_codi,drec_codpro,drec_codsag ,drec_codsopo,
					drec_fecprod,drec_unidades ,drec_peso,drec_sopocli ,
					fechavencimiento,lotecliente,drec_estado,drec_temp,codtpmrece,bloqueado) 
					VALUES 
					(@drec_codi,@drec_codpro,@drec_codsag ,convert(int,@drec_codsopo),
					convert(nvarchar(10),CONVERT(date,@drec_fecprod),111),@drec_unidades ,@drec_peso,@drec_sopocli,
					@fechavencimiento,@lotecliente,@drec_estado,round(@temp,2),@idrece,@bloqueado);
			END TRY
			BEGIN CATCH		
					ROLLBACK TRANSACTION;
					SELECT @HayError=1;
					RETURN 11;
			END CATCH	
		END
		ELSE
		BEGIN
			BEGIN TRY		
					UPDATE webtmpdetarece
					SET
					drec_codpro=@drec_codpro,
					drec_codsag=@drec_codsag,
					drec_codsopo=convert(int,@drec_codsopo),
					drec_fecprod=convert(nvarchar(10),CONVERT(date,@drec_fecprod),111),
					drec_unidades=@drec_unidades,
					drec_peso=@drec_peso,
					drec_sopocli=@drec_sopocli,
					fechavencimiento=@fechavencimiento,
					lotecliente=@lotecliente,
					drec_estado=@drec_estado,
					drec_temp=round(@temp,2),
					codtpmrece=@idrece
					WHERE drec_codi=@codpal;
			END TRY
			BEGIN CATCH		
					ROLLBACK TRANSACTION;
					SELECT @HayError=1;
					RETURN 11;
			END CATCH	
		END
		if @HayError=0	COMMIT TRANSACTION;
END
GO

GO

GO
                       
CREATE PROCEDURE [dbo].[webingredetarecetmp2]
@drec_codi nvarchar(9),
@drec_codpro nvarchar(7),
@drec_codsag nvarchar(15),
@drec_codsopo nvarchar(3),
@drec_fecprod nvarchar(10),
@drec_unidades int,
@drec_peso float,
@drec_sopocli nvarchar(11),
@fechavencimiento char(10),
@lotecliente nvarchar(10),
@drec_estado nvarchar(50),
@codpal nvarchar(9),
@temp float,
@bloqueado nvarchar(1),
@idrece int
AS
DECLARE @Error int;
DECLARE @Cant int;
DECLARE @NumPal nvarchar(2);
DECLARE @Salida int;
DECLARE @HayError int;
DECLARE @frec_rutcli nvarchar(19);
DECLARE @frec_fecrec nvarchar(10);

BEGIN
    SET NOCOUNT ON;
    SET @Error=@@ERROR ;
    
    SELECT @Cant=0;
    SELECT @HayError=0;
    BEGIN TRANSACTION
		IF (@codpal='0')
		BEGIN
			
			SELECT @Cant=ISNULL(right(MAX(drec_codi),2),0)
			FROM tmpdetarece WHERE frec_codi =@drec_codi;

			SELECT @frec_fecrec=frec_fecrec,@frec_rutcli=frec_rutcli FROM TMPFICHRECE WHERE frec_codi=@drec_codi;

			SELECT @Cant=@Cant + 1 ;
			
			IF @Cant<10
				SELECT @NumPal='0'+CONVERT(nvarchar(1),@Cant);
			ELSE
				SELECT @NumPal=CONVERT(nvarchar(2),@Cant);
			
			
			/*SELECT @drec_codi=@drec_codi+@NumPal
			SELECT  'INSERT INTO TMPDETARECE
			(frec_codi,drec_codpro,drec_codsag ,drec_codsopo,
			drec_fecprod,drec_unidades ,drec_peso,drec_sopocli ,
			fechavencimiento,lotecliente,drec_estado,drec_temp,codtmprece,bloqueado,drec_etiqueta,drec_codi)
			VALUES ('+@drec_codi+','+@drec_codpro+','+@drec_codsag+','+@drec_codsopo+','+
			convert(nvarchar(10),CONVERT(date,@drec_fecprod),111)+','+convert(nchar,@drec_unidades) +','+convert(nchar,@drec_peso)+','+@drec_sopocli+','+
			@fechavencimiento+','+@lotecliente+','+@drec_estado+','+convert(nchar,round(@temp,2))+','+convert(nchar,@idrece)
			+','+convert(nchar,@bloqueado)+','+dbo.CREAETIQUETA('1780000000'+@drec_codi+@NumPal)+','+@NumPal*/
					
			BEGIN TRY		
					INSERT INTO TMPDETARECE
					(frec_codi,drec_codpro,drec_codsag ,drec_codsopo,
					drec_fecprod,drec_unidades ,drec_peso,drec_sopocli ,
					fechavencimiento,lotecliente,drec_estado,drec_temp,codtmprece,bloqueado,drec_etiqueta,drec_codi,drec_fecrec,drec_rutcli)
					VALUES 
					(@drec_codi,@drec_codpro,@drec_codsag ,convert(int,@drec_codsopo),
					convert(nvarchar(10),CONVERT(date,@drec_fecprod),111),@drec_unidades ,@drec_peso,@drec_sopocli,
					convert(nvarchar(10),CONVERT(date,@fechavencimiento),111),@lotecliente,@drec_estado,round(@temp,2),@idrece,@bloqueado,dbo.CREAETIQUETA('1780000000'+@drec_codi+@NumPal),
					@NumPal,@frec_fecrec,@frec_rutcli);
			END TRY
			BEGIN CATCH		
					ROLLBACK TRANSACTION;
					SELECT @HayError=1;
					RETURN 11;
			END CATCH	
		END
		ELSE
		BEGIN
			BEGIN TRY		
					UPDATE TMPDETARECE
					SET
					drec_codpro=@drec_codpro,
					drec_codsag=@drec_codsag,
					drec_codsopo=convert(int,@drec_codsopo),
					drec_fecprod=convert(nvarchar(10),CONVERT(date,@drec_fecprod),111),
					drec_unidades=@drec_unidades,
					drec_peso=@drec_peso,
					drec_sopocli=@drec_sopocli,
					fechavencimiento=@fechavencimiento,
					lotecliente=@lotecliente,
					drec_estado=@drec_estado,
					drec_temp=round(@temp,2)
					/*,drec_etiqueta=dbo.CREAETIQUETA('1780000000'+@drec_codi),
					codtmprece=@idrece*/
					WHERE frec_codi= LEFT(@codpal,7) AND drec_codi=RIGHT(@codpal,2);
			END TRY
			BEGIN CATCH		
					ROLLBACK TRANSACTION;
					SELECT @HayError=1;
					RETURN 12;
			END CATCH	
		END
		if @HayError=0	COMMIT TRANSACTION;
END
GO

GO

GO

CREATE PROCEDURE [dbo].[webregistraped] 
@filexls		nvarchar(30),
@rutclie		nvarchar(10),
@transporte		nvarchar(100),
@pefecha		nvarchar(10),
@pehora		    nvarchar(5),
@destino		nvarchar(50),
@observacion	nvarchar(1000),
@listamail		nvarchar(300),
@Terror			int output

AS
DECLARE  @return_value int;
DECLARE  @numorden int;
DECLARE  @PALLET nvarchar(9);
DECLARE  @CANTCAJAS int;
DECLARE  @SALDO int;
DECLARE  @TOTKILOS float;
DECLARE  @CA nvarchar(2);
DECLARE  @BA nvarchar(2);
DECLARE  @CO nvarchar(2);
DECLARE  @PI nvarchar(2);
DECLARE  @NI nvarchar(2);
DECLARE  @pick int;
DECLARE  @LINEA int;
DECLARE  @HayError int;
DECLARE  @numped nvarchar(25);
DECLARE  @FF nvarchar(8);
DECLARE  @HH nvarchar(2);
DECLARE  @MM nvarchar(2);
DECLARE  @SS nvarchar(2);
DECLARE  @HORAP nvarchar(8);
DECLARE  @TRANS	nvarchar(10);
DECLARE  @POS	int;
DECLARE  @SW	int;
DECLARE  @FECHA nvarchar(10);
DECLARE  @HORA  nvarchar(5);

 SELECT @FECHA = convert(nvarchar (10),GETDATE(),111)
 SELECT @HORA  = convert(nvarchar (5),GETDATE(),108)
    
	SELECT   @HORAP=CONVERT(nvarchar(8), GETDATE(), 108) 
	SELECT   @FF=CONVERT(nvarchar(8),GETDATE(),112);
	SELECT   @HH=SUBSTRING (@HORAP, 1,2);
	SELECT   @MM=SUBSTRING (@HORAP, 4,2);
	SELECT   @SS=SUBSTRING (@HORAP, 7,2);

	SELECT   @numped=@FF+@HH+@MM+@SS+@rutclie;

	SELECT @TRANS=@rutclie;
	SELECT @HayError=0;
	
    SET NOCOUNT ON;
  
    BEGIN TRANSACTION @TRANS	
		BEGIN TRY
			SELECT @POS=1;
			INSERT INTO PEDIDOS_FICHA (PEDIDO, CLIENTE, TRANSPORTE, FECHA, HORA, DESTINO, OBSERVACION, MAIL, CODVIG, TERMINADO,fechapedido,packinglist)
			VALUES (@numped,@rutclie,@transporte,@pefecha,@pehora,@destino,@observacion,@listamail,'0','0',convert(datetime,getdate(),111),@filexls);
			
			SELECT @numorden=orden FROM PEDIDOS_FICHA WHERE PEDIDO=@numped;
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT	'error'=@HayError,'nped'=0,'nord'=0;
			RETURN @POS;
		END CATCH
		
		/*BEGIN TRY
			SELECT @POS=2;
			INSERT INTO PEDIDOS_PRG (PRG_ORDEN, PRG_HORA, PRG_FECHA, PRG_RUTCLIE,prg_modo)VALUES(@numorden,@pehora,@pefecha,@rutclie,'PACKING LIST');
		END TRY
		
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT	'error'=@HayError,'nped'=@numorden,'nord'=@pehora;
			RETURN @POS;
		END CATCH*/
		
		BEGIN TRY
			SELECT @POS=3;
			UPDATE rackdeta SET racd_estado=1  WHERE racd_codi in (	SELECT caj_pcod FROM PedWebTmp
			INNER JOIN detarececajas ON upper(caj_cod)=upper(pwt_codcaja)
			WHERE pwt_coding=@filexls
			GROUP BY caj_pcod);
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT	'error'=@HayError,'nped'=@numorden,'nord'=@pehora;
			RETURN @POS;
		END CATCH
		BEGIN TRY
			SELECT @POS=4;
			INSERT  pedcaja (pc_fecha,pc_codped,pc_hora,pc_ncaja,pc_numpal,pc_estado,pc_tpoped,pc_saldo,pc_rutclie,pc_kilos)
			SELECT @fecha,@numorden,@hora,COUNT(pwt_codcaja),caj_pcod ,1,3,racd_unidades,@rutclie,SUM(pwt_kilos)
			FROM PedWebTmp
			INNER JOIN (detarececajas INNER JOIN rackdeta ON racd_codi=caj_pcod) ON upper(caj_cod)=upper(pwt_codcaja)
			WHERE pwt_coding=@filexls
			AND caj_Pcod in
			(
			SELECT MAX(caj_pcod) FROM PedWebTmp INNER JOIN DetaReceCajas ON Caj_cod=pwt_codcaja AND Caj_ped=0 
			WHERE pwt_coding=@filexls 
			GROUP BY pwt_codcaja 
			
			)
			GROUP BY caj_pcod,racd_unidades,racd_ca,racd_ba,racd_co ,racd_pi,racd_ni
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT	'error'=@HayError,'nped'=@numorden,'nord'=@pehora;
			RETURN @POS;
		END CATCH
		BEGIN TRY	
			SELECT @POS=5;
			SELECT @LINEA=0;
			DECLARE RSGUIAS CURSOR FOR
			
			
			SELECT caj_pcod as pwt_pallet,COUNT(pwt_codcaja) as CANTCAJAS,racd_unidades as SALDO,SUM(pwt_kilos) as TOTKILOS,racd_ca as CA,racd_ba as BA,racd_co as CO,
			racd_pi AS PI,racd_ni as NI
			FROM PedWebTmp
			INNER JOIN (detarececajas INNER JOIN rackdeta ON racd_codi=caj_pcod) ON upper(caj_cod)=upper(pwt_codcaja)
			WHERE pwt_coding=@filexls AND caj_Pcod in
			(
			SELECT MAX(caj_pcod) FROM PedWebTmp INNER JOIN DetaReceCajas ON Caj_cod=pwt_codcaja AND Caj_ped=0 
			WHERE pwt_coding=@filexls 
			GROUP BY pwt_codcaja 
			
			)
			GROUP BY caj_pcod,racd_unidades,racd_ca,racd_ba,racd_co ,racd_pi,racd_ni
			
			
			/*FOR UPDATE OF caj_pcod*/
			OPEN RSGUIAS
			FETCH NEXT FROM RSGUIAS
			INTO @PALLET,@CANTCAJAS,@SALDO,@TOTKILOS,@CA,@BA,@CO,@PI,@NI;
			
			SELECT @POS=6;
			WHILE @@FETCH_STATUS = 0
			BEGIN	
			
				SELECT @pick=0;
				IF @CANTCAJAS<>@SALDO 
				BEGIN
					SELECT @pick=1;
				END
				SELECT @LINEA=@LINEA+1;
				INSERT INTO Pedidos_Detalle(PEDIDO, LINEA, PALLET, CAJAS, KILOS, POSICION, est,parcial) 
				VALUES(@numped,@LINEA, @PALLET, @CANTCAJAS, @TOTKILOS,@CA+'-'+@BA+'-'+@CO+'-'+@PI+'-'+@NI,'0',@pick);
				
				FETCH NEXT FROM RSGUIAS
				INTO @PALLET,@CANTCAJAS,@SALDO,@TOTKILOS,@CA,@BA,@CO,@PI,@NI;
			END
			CLOSE RSGUIAS
			DEALLOCATE RSGUIAS
		END TRY	
		BEGIN CATCH		
			CLOSE RSGUIAS
			DEALLOCATE RSGUIAS	
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT 'error'=@HayError,'nped'=0,'nord'=0;
			RETURN @POS;
		END CATCH
		BEGIN TRY
			SELECT @POS=7;
			INSERT INTO detapedcaja (dpc_numpal,dpc_estado,dpc_codcaja,dpc_codped) 
			SELECT MAX(caj_pcod), 1, pwt_codcaja, @numorden FROM PedWebTmp INNER JOIN DetaReceCajas ON Caj_cod=pwt_codcaja AND Caj_ped=0 
			WHERE pwt_coding=@filexls
			GROUP BY pwt_codcaja ORDER BY MAX(caj_pcod);
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT	'error'=@HayError,'nped'=0,'nord'=0;
			RETURN @POS;
		END CATCH
		BEGIN TRY
			SELECT @POS=8;
			UPDATE DetaReceCajas SET caj_ped=1 WHERE Caj_Est=0 AND caj_cod in  (SELECT pwt_codcaja FROM PedWebTmp WHERE pwt_coding=@filexls);
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT	'error'=@HayError,'nped'=0,'nord'=0;
			RETURN @POS;
		END CATCH
		BEGIN TRY
			SELECT @POS=9;
			UPDATE PedWebTmp SET pwt_estado =3,pwt_codped=@numorden WHERE pwt_coding=@filexls;
		END TRY
		BEGIN CATCH
			ROLLBACK TRANSACTION @TRANS;
			SELECT @HayError=@POS;
			SELECT 'error'=@HayError,'nped'=0,'nord'=0;
			RETURN @POS;
		END CATCH
		IF (@HayError=0) 
		BEGIN
			COMMIT TRANSACTION @TRANS;
			SELECT	'error'=@HayError,'nped'=@numped,'nord'=@numorden;
		END
		ELSE
		BEGIN
			SELECT	'error'=@HayError,'nped'=0,'nord'=0;
		END

GO

GO

GO

CREATE PROCEDURE [dbo].[webseleccioncajapallet]
@rutclie nvarchar(9),
@pedido  nvarchar(25),
@observacion  nvarchar(1000),
@transporte nvarchar(100),
@destino nvarchar(50),
@listamail nvarchar(300),
@pfecha nvarchar(10),
@phora nvarchar(5)
AS
DECLARE @Error int;
DECLARE @return_value int;

DECLARE @HayError int;
DECLARE @TRANS nvarchar(9);
DECLARE @pguia_nguia nvarchar(9);
DECLARE @pguia_fecha nvarchar(10);
DECLARE @pguia_ncajas int;
DECLARE @pguia_nsopo int;
DECLARE @pguia_hora nvarchar(10);
DECLARE @pguia_estado int;

DECLARE @racd_codi nvarchar(9);
DECLARE @racd_unidades int;
DECLARE @racd_peso float;
DECLARE @racd_ca nvarchar(2);
DECLARE @racd_ba nvarchar(2);
DECLARE @racd_co nvarchar(2);
DECLARE @racd_pi nvarchar(2);
DECLARE @racd_ni nvarchar(1)

DECLARE @caj_pcod nvarchar(9);
DECLARE @caj_cod nvarchar(200);
DECLARE @POS int;
DECLARE @SW int;
DECLARE @linea int;
DECLARE @xnumorden int;
DECLARE @TOT_UNIDADESBLOQ int;
DECLARE @TOT_KILOSBLOQ int;
 
	SELECT @TOT_UNIDADESBLOQ=0;
	SELECT @TOT_KILOSBLOQ=0;
	SELECT @HayError=0;
	SELECT @TRANS=@rutclie;
    SET NOCOUNT ON;
    SELECT @SW=0
    SELECT @POS=0;
    SELECT @linea=0;
    BEGIN TRANSACTION @TRANS	 
        
		BEGIN TRY	
		
			DECLARE RSGUIAS CURSOR FOR
			SELECT pguia_nguia,convert(nvarchar(10),pguia_fecha,103),pguia_ncajas,pguia_nsopo,convert(nvarchar(5),left(pguia_hora,5),1),pguia_estado FROM pedidoguias WHERE pguia_estado=0 AND pguia_rutclie=@rutclie
			FOR UPDATE OF pguia_estado;
			OPEN RSGUIAS
			FETCH NEXT FROM RSGUIAS
			INTO @pguia_nguia,@pguia_fecha,@pguia_ncajas,@pguia_nsopo,@pguia_hora,@pguia_estado
			SELECT @POS=1;
			WHILE @@FETCH_STATUS = 0
			BEGIN
				/*SELECT @pguia_nguia AS GUIA;*/
				IF (@SW=0)
				BEGIN
				
					INSERT INTO PEDIDOS_FICHA (PEDIDO, CLIENTE, TRANSPORTE, FECHA, HORA, DESTINO, OBSERVACION, MAIL, CODVIG, TERMINADO,fechapedido) VALUES (@pedido,@rutclie,@transporte,@pfecha,@phora,@destino,@observacion,@listamail,'0','0',@pguia_fecha+ + ' ' + @pguia_hora)  
					SELECT @SW=1
					
					SELECT @xnumorden = isnull(orden,0) FROM PEDIDOS_FICHA WHERE PEDIDO=@pedido
					/*INSERT INTO PEDIDOS_PRG (PRG_ORDEN, PRG_HORA, PRG_FECHA, PRG_RUTCLIE,prg_modo)VALUES(@xnumorden,@phora,@pfecha,@rutclie,'GUIAS')  */		    	
				END
				DECLARE RSSOPO CURSOR FOR
				SELECT racd_codi,racd_ca,racd_unidades,racd_peso,racd_ca,racd_ba,racd_co,racd_pi,racd_ni FROM rackdeta WHERE LEFT(racd_codi,7)=@pguia_nguia AND racd_estado=0
				OPEN RSSOPO
				FETCH NEXT FROM RSSOPO
				INTO @racd_codi,@racd_ca,@racd_unidades,@racd_peso,@racd_ca,@racd_ba,@racd_co,@racd_pi,@racd_ni
				SELECT @POS=2;
				WHILE @@FETCH_STATUS = 0
				BEGIN
					/*SELECT '                     '+@racd_codi+' - '+@pguia_fecha+' -  '+@pguia_hora*/			
					SELECT @linea=@linea + 1;
					SELECT @TOT_UNIDADESBLOQ=COUNT(*) ,@TOT_KILOSBLOQ=SUM(Caj_Kg)
					FROM DetaReceCajas INNER JOIN (rackdeta INNER JOIN detarece ON racd_codi=drec_codi) ON caj_pcod=racd_codi
					WHERE racd_estadopallet=0 AND caj_est=-1 AND Caj_Pcod=@racd_codi AND caj_ped=0
					GROUP BY Caj_Pcod		
					
					UPDATE rackdeta set RACD_ESTADO='2', racd_pedido_fec=@pguia_fecha, racd_pedido_hor=@pguia_hora WHERE racd_codi=@racd_codi
					INSERT pedcaja (pc_fecha,pc_codped,pc_hora,pc_ncaja,pc_numpal,pc_estado,pc_tpoped,pc_saldo,pc_rutclie,pc_kilos) 
					VALUES (@pguia_fecha,@xnumorden,@pguia_hora,@racd_unidades - @TOT_UNIDADESBLOQ,@racd_codi,0,4,@racd_unidades,@rutclie,@racd_peso - @TOT_KILOSBLOQ);
					
					/*SELECT @pedido +' - '+@linea+' - '+@racd_codi+' - '+@racd_unidades+' - ' +@racd_peso+' - '+@racd_ca+' - '+@racd_ba+' - '+@racd_co+' - '+@racd_pi+' - '+@racd_ni+' - '+'0'+' - '+0*/
					
					INSERT INTO Pedidos_Detalle(PEDIDO, LINEA, PALLET, CAJAS, KILOS, POSICION, est,parcial) 
					VALUES (@pedido,@linea,@racd_codi,@racd_unidades,@racd_peso,@racd_ca+'-'+@racd_ba+'-'+@racd_co+'-'+@racd_pi+'-'+@racd_ni,'0',0)
					
					DECLARE RSCAJA CURSOR FOR
					SELECT caj_pcod,caj_cod FROM DetaReceCajas WHERE caj_pcod=@racd_codi AND caj_est=0 
					OPEN RSCAJA
					FETCH NEXT FROM RSCAJA
					INTO @caj_pcod,@caj_cod
					SELECT @POS=3;
					WHILE @@FETCH_STATUS = 0
					BEGIN
						/*SELECT '                                     '+@caj_cod as CODCAJA;*/
						INSERT  detapedcaja (dpc_numpal,dpc_estado,dpc_codcaja,dpc_codped) VALUES (@caj_pcod,1,@caj_cod,@xnumorden);	
						
						FETCH NEXT FROM RSCAJA
						INTO @caj_pcod,@caj_cod
					END
					CLOSE RSCAJA
					DEALLOCATE RSCAJA
					UPDATE DetaReceCajas SET caj_ped=1 WHERE Caj_Pcod=@racd_codi;
					FETCH NEXT FROM RSSOPO
					INTO @racd_codi,@racd_ca,@racd_unidades,@racd_peso,@racd_ca,@racd_ba,@racd_co,@racd_pi,@racd_ni
				END
				CLOSE RSSOPO
				DEALLOCATE RSSOPO
				
				UPDATE pedidoguias SET pguia_estado=3,pguia_codped=@xnumorden WHERE pguia_estado=0 AND pguia_rutclie=@rutclie AND pguia_nguia=@pguia_nguia
				
				FETCH NEXT FROM RSGUIAS
				INTO @pguia_nguia,@pguia_fecha,@pguia_ncajas,@pguia_nsopo,@pguia_hora,@pguia_estado
			END
			CLOSE RSGUIAS
			DEALLOCATE RSGUIAS
			SELECT @POS=4;
			/*OPEN RSGUIAS*/
		END TRY	
		BEGIN CATCH	
			IF (@POS=1)
			BEGIN
				CLOSE RSGUIAS
				DEALLOCATE RSGUIAS	
			END
			IF (@POS=2)
			BEGIN
				CLOSE RSGUIAS
				DEALLOCATE RSGUIAS	
				CLOSE RSSOPO
				DEALLOCATE RSSOPO
			END
			IF (@POS=3)
			BEGIN
				CLOSE RSGUIAS
				DEALLOCATE RSGUIAS	
				CLOSE RSSOPO
				DEALLOCATE RSSOPO
				CLOSE RSCAJA
				DEALLOCATE RSCAJA
			END
			
			ROLLBACK TRANSACTION @TRANS;
			
			SELECT @HayError=@POS;
			SELECT 'error'=@HayError;
			RETURN @POS;
		END CATCH
		
		IF (@HayError=0) 
		BEGIN
			COMMIT TRANSACTION @TRANS;
			SELECT	'error'=@HayError,'numorden'=@xnumorden;
		END
GO

GO

GO
CREATE PROCEDURE [dbo].[webtmpingrecprod]
@frec_tipoalmacenamiento	varchar(50),
@frec_rutcli				nvarchar(19),
@frec_contcli				nvarchar(7),
@frec_horarec				nvarchar(5),
@frec_horater				nvarchar(5),
@frec_fecrec				nvarchar(10),
@frec_tiporecepcion			nvarchar(1),
@frec_guiades				nvarchar(8),
@frec_clfol					nvarchar(50),
@frec_tipdesc				nvarchar(1),
@frec_origen				nvarchar(2),
@frec_numSello				nvarchar(25),
@frec_observ				nvarchar(50),
@frec_antecamara			nvarchar(2),
@frec_olores				nvarchar(2),
@frec_higiene				varchar(2),
@frec_estiba				nvarchar(2),
@frec_danado				nvarchar(2),
@frec_RecepTunel			int,
@frec_contenedor			nvarchar(20),
@serie int output,
@HayError int output
AS
DECLARE @idrece int;
BEGIN
	SELECT @HayError=0;
    SET NOCOUNT ON;
    BEGIN TRANSACTION
		BEGIN TRY		
			INSERT INTO webtmpfichrece
			(frec_tipoalmacenamiento, frec_rutcli,frec_contcli,frec_horarec,
			frec_horater,frec_fecrec,frec_tiporecepcion,frec_guiades,frec_clfol ,
			frec_tipdesc,frec_origen,frec_numSello,frec_observ,frec_antecamara,frec_olores,frec_higiene,frec_estiba,frec_daado,frec_RecepTunel,frec_contenedor) 
			VALUES 
			(@frec_tipoalmacenamiento,@frec_rutcli,@frec_contcli,@frec_horarec,
			@frec_horater,@frec_fecrec,@frec_tiporecepcion,@frec_guiades,@frec_clfol,
			@frec_tipdesc,@frec_origen,@frec_numSello,@frec_observ,@frec_antecamara,@frec_olores,@frec_higiene,@frec_estiba,@frec_danado,@frec_RecepTunel,@frec_contenedor);
		END TRY	
		BEGIN CATCH	
			ROLLBACK TRANSACTION;
			SELECT @HayError=1;
		END CATCH
	
	IF (@HayError=0) 
	BEGIN
		COMMIT TRANSACTION;
		SELECT @serie = max(frec_codigo) FROM webtmpfichrece
	END
	
END
GO

GO

GO
CREATE PROCEDURE [dbo].[webtmpingrecprod2]
@frec_tipoalmacenamiento	varchar(50),
@frec_rutcli				nvarchar(19),
@frec_contcli				nvarchar(7),
@frec_horarec				nvarchar(5),
@frec_horater				nvarchar(5),
@frec_fecrec				nvarchar(10),
@frec_tiporecepcion			nvarchar(1),
@frec_guiades				nvarchar(8),
@frec_clfol					nvarchar(50),
@frec_tipdesc				nvarchar(1),
@frec_origen				nvarchar(2),
@frec_numSello				nvarchar(25),
@frec_observ				nvarchar(50),
@frec_antecamara			nvarchar(2),
@frec_olores				nvarchar(2),
@frec_higiene				varchar(2),
@frec_estiba				nvarchar(2),
@frec_danado				nvarchar(2),
@frec_RecepTunel			int,
@frec_contenedor			nvarchar(20),
@serie nvarchar(7) output,
@HayError int output

AS
DECLARE @idrece int;
DECLARE @return_value int;
DECLARE @largo int;
DECLARE @codcorre nvarchar(5);
DECLARE @fechhoralleg nvarchar(10);
BEGIN
	SELECT @HayError=0;
	SELECT @codcorre='006';
    SET NOCOUNT ON;
    BEGIN TRANSACTION
    
		
		SELECT @fechhoralleg = convert(nvarchar(5),cl_lleg,108) FROM zCheckList WHERE Cl_fol=@frec_clfol
		
		EXEC @return_value = webgetseriechklst @codcorre;
		SELECT @largo=LEN(@return_value);
		SELECT @serie=REPLICATE('0', 7-@largo)+ltrim(str(@return_value));
		
		BEGIN TRY	
		
		
			INSERT INTO TMPFICHRECE
			(frec_tipoalmacenamiento, frec_rutcli,frec_contcli,frec_horarec,
			frec_fecrec,frec_tipo,frec_guiades,frec_clfol ,frec_horalleg,
			frec_tipdesc,frec_origen,frec_numSello,frec_observ,frec_antecamara,
			frec_olores,frec_higiene,frec_estiba,frec_daado,frec_RecepTunel,
			frec_contenedor,frec_codigo,frec_codi) 
			VALUES
			(@frec_tipoalmacenamiento,@frec_rutcli,@frec_contcli,@frec_horarec,
			@frec_fecrec,@frec_tiporecepcion,@frec_guiades,@frec_clfol,@fechhoralleg,
			@frec_tipdesc,@frec_origen,@frec_numSello,@frec_observ,@frec_antecamara,
			@frec_olores,@frec_higiene,@frec_estiba,@frec_danado,@frec_RecepTunel,
			@frec_contenedor,@serie,@serie);
		END TRY	
		BEGIN CATCH	
			ROLLBACK TRANSACTION;
			SELECT @HayError=1;
		END CATCH
	
	IF (@HayError=0) 
	BEGIN
		COMMIT TRANSACTION;
		SELECT @serie;
	END

END
GO

GO

GO
CREATE FUNCTION [dbo].[B64aBin](@Base64 VARCHAR(MAX))
RETURNS VARBINARY(MAX)
AS
BEGIN
    DECLARE @Bin VARBINARY(MAX)
    
    /*
        SELECT CONVERT(VARCHAR(MAX), dbo.f_Base64ToBinary('Q29udmVydGluZyB0aGlzIHRleHQgdG8gQmFzZTY0Li4u'))
    */
    
    SET @Bin = CAST(N'' AS XML).value('xs:base64Binary(sql:variable("@Base64"))', 'VARBINARY(MAX)')
 
    RETURN @Bin
END
GO

GO

GO
CREATE FUNCTION [dbo].[CAJASACUMULADAS](@FECHA1 As varchar(10),@FECHA2 As Varchar(10),@RUT As Varchar(20),@CONTRATO As Varchar(20))  
RETURNS int   
AS   
 
BEGIN  
    DECLARE @diferencia_dias int;
	DECLARE @total int
	DECLARE @i int
	DECLARE @consulta int
	DECLARE @FECHA varchar(20)
	SET @FECHA = @FECHA1
	SET @i = 0
	SET @total = 0
	SET @diferencia_dias = (SELECT DATEDIFF(day, CAST(REPLACE(CONVERT(varchar(10), CAST(@FECHA1 AS DATE), 120),'-','/') AS DATE), CAST(REPLACE(CONVERT(varchar(10), CAST(@FECHA2 AS DATE), 120),'-','/') AS DATE)) )
    
	WHILE (@i <= @diferencia_dias)
      BEGIN  

	SET @consulta = (SELECT isnull(SUM(drec_unidades),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=REPLACE(CONVERT(varchar(10), CAST(@FECHA AS DATE), 120),'-','/') AND drec_codvig='0' AND drec_rutcli=@RUT AND drec_contcli=@CONTRATO)
      -(SELECT  isnull(SUM(ddes_unidades),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=REPLACE(CONVERT(varchar(10), CAST(@FECHA AS DATE), 120),'-','/') AND ddes_codvig='0' AND ddes_rutcli=@RUT AND ddes_contcli=@CONTRATO) 
	
	SET @total = @total + @consulta

	  SET @i=@i+1
      SET @FECHA = REPLACE(CONVERT(varchar(10), DATEADD(day,1, CAST(@FECHA AS DATE)), 120),'-','/')
      CONTINUE  
    END  
     
    RETURN @total;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[CodeBase64](@bin VARBINARY(MAX))
RETURNS VARCHAR(MAX)
AS
BEGIN
    DECLARE @Base64 VARCHAR(MAX)
    
    /*
        SELECT dbo.f_BinaryToBase64(CONVERT(VARBINARY(MAX), 'Converting this text to Base64...'))
    */
    
    SET @Base64 = CAST(N'' AS XML).value('xs:base64Binary(xs:hexBinary(sql:variable("@bin")))','VARCHAR(MAX)')
    
    RETURN @Base64
END
GO

GO

GO
CREATE FUNCTION [dbo].[CREAETIQUETA]
(
	@NE nvarchar(20)
)
 RETURNS nvarchar(20)
 AS
 BEGIN
	DECLARE @DV int;
	DECLARE @Suma int;
	DECLARE @Multiplo int;
	DECLARE @Codigo as nvarchar(20);
	DECLARE @Largo as int;
	DECLARE @Pos int;
	DECLARE @Valor int;
	SET @Largo=len(@NE);
	SET @Suma=0;
	SET @Pos=1;
	WHILE @Pos<=@Largo
	BEGIN
		IF (@Pos % 2)=0	BEGIN SET @Multiplo=1; END
		ELSE			BEGIN SET @Multiplo=3; END
		SET @Valor=convert(int,SUBSTRING(@NE, @Pos, 1)) * @Multiplo
		SELECT @Suma=@Suma+@Valor;
		SET @Pos=@Pos+1;
	END
	
	SET @Suma =(@Suma-(FLOOR(@Suma/10)*10))
	if @Suma>0
	BEGIN
		SET @Suma=10-@Suma;
	END
	SET @Codigo=@NE+convert(nchar(1),@Suma);
	RETURN @Codigo;
 END
GO

GO

GO
CREATE FUNCTION [dbo].[DIFERENCIA_HORAS]( @FECHA1 varchar(23), @FECHA2 varchar(23))  
RETURNS varchar(8)   
AS   
 
BEGIN  

   DECLARE @FECHA  DATETIME;
   DECLARE @MES1 varchar(2);
   DECLARE @DIA1 varchar(2);
   DECLARE @YEAR1 varchar(4);
   DECLARE @RESTO1 varchar(12);
   DECLARE @MES2 varchar(2);
   DECLARE @DIA2 varchar(2);
   DECLARE @YEAR2 varchar(4);
   DECLARE @RESTO2 varchar(12);
   DECLARE @HORA   varchar(20);

   SET @FECHA1 = (LTRIM(RTRIM(@FECHA1)));
   SET @FECHA2 = (LTRIM(RTRIM(@FECHA2)));

   SET @MES1 = SUBSTRING(@FECHA1,6,2);
   SET @DIA1 = SUBSTRING(@FECHA1,9,2);
   SET @YEAR1 = SUBSTRING(@FECHA1,0,5);
   SET @RESTO1 = SUBSTRING(@FECHA1,12,12);

   SET @FECHA1 = @YEAR1+'-'+@DIA1+'-'+@MES1+' '+@RESTO1;

   SET @MES2 = SUBSTRING(@FECHA2,6,2);
   SET @DIA2 = SUBSTRING(@FECHA2,9,2);
   SET @YEAR2 = SUBSTRING(@FECHA2,0,5);
   SET @RESTO2 = SUBSTRING(@FECHA2,12,12);

   SET @FECHA2 = @YEAR2+'-'+@DIA2+'-'+@MES2+' '+@RESTO2;


   SET @FECHA  = (SELECT CAST(@FECHA2 AS DATETIME)-CAST(@FECHA1 AS DATETIME))
   SET @HORA   = (SELECT CONVERT(varchar(8),@FECHA,108))
       
    RETURN @HORA;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[DIFERENCIA_HORAS_ANDENES](@CODIGO As varchar(10))  
RETURNS varchar(8)   
AS   
 
BEGIN  
   DECLARE @FECHA1 varchar(30);
   DECLARE @FECHA2 varchar(30);
   DECLARE @FECHA  datetime;
   DECLARE @HORA   varchar(8);
   SET @CODIGO = (LTRIM(RTRIM(@CODIGO)));

   SET @FECHA1 = (SELECT TOP(1) FECHA FROM VW_ANDENES WHERE ORDEN =@CODIGO AND MOVIMIENTO='APERTURA' ORDER BY ORDEN DESC);
   SET @FECHA2 = (SELECT TOP(1) FECHA FROM VW_ANDENES WHERE ORDEN =@CODIGO AND MOVIMIENTO='CIERRE' ORDER BY ORDEN DESC);


   SET @FECHA  = (SELECT CAST(@FECHA2 AS DATETIME)-CAST(@FECHA1 AS DATETIME))
   SET @HORA   = (SELECT CONVERT(varchar(8),@FECHA,108))
       
    RETURN @HORA;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[DIFERENCIA_HORAS_ANDENES_RECE](@CODIGO As varchar(10))  

RETURNS varchar(8)   
AS   
 
BEGIN  
   DECLARE @FECHA1 varchar(30);
   DECLARE @FECHA2 varchar(30);
   DECLARE @FECHA  datetime;
   DECLARE @HORA   varchar(8);
   SET @CODIGO = (LTRIM(RTRIM(@CODIGO)));

   SET @FECHA1 = (SELECT TOP(1) FECHA FROM VW_ANDENES_RECE WHERE FOLIO =@CODIGO AND MOVIMIENTO='APERTURA' ORDER BY FOLIO DESC);
   SET @FECHA2 = (SELECT TOP(1) FECHA FROM VW_ANDENES_RECE WHERE FOLIO =@CODIGO AND MOVIMIENTO='CIERRE' ORDER BY FOLIO DESC);


   SET @FECHA  = (SELECT CAST(@FECHA2 AS DATETIME)-CAST(@FECHA1 AS DATETIME))
   SET @HORA   = (SELECT CONVERT(varchar(8),@FECHA,108))
       
    RETURN @HORA;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[f_BinaryToBase64](@bin VARBINARY(MAX))
RETURNS VARCHAR(MAX)
AS
BEGIN
    DECLARE @Base64 VARCHAR(MAX)
    
    /*
        SELECT dbo.f_BinaryToBase64(CONVERT(VARBINARY(MAX), 'Converting this text to Base64...'))
    */
    
    SET @Base64 = CAST(N'' AS XML).value('xs:base64Binary(xs:hexBinary(sql:variable("@bin")))','VARCHAR(MAX)')
    
    RETURN @Base64
END
GO

GO

GO



CREATE FUNCTION [dbo].[FN_EXISTE_ESCSERV] (@CONT_RUTCLIE VARCHAR(9))
RETURNS INT AS
BEGIN


    DECLARE @EXISTE AS BIT
    SET @EXISTE = 0

    IF EXISTS(SELECT ESCALASERV.ESCCONTR FROM ESCALASERV INNER JOIN CONTRATO ON ESCALASERV.ESCCONTR =
CONTRATO.CONT_CODI WHERE CONTRATO.CONT_RUTCLIE = @CONT_RUTCLIE)
        SET @EXISTE = 1
    ELSE
        SET @EXISTE = 0

    RETURN @EXISTE

END



GO

GO

GO


CREATE FUNCTION [dbo].[FN_RET_ULTDIAMES] (@AO INT, @MES AS INT )
RETURNS INT  AS
BEGIN

    DECLARE @DIA AS INT
    SET @DIA = 0

    IF @MES = 1
        SET @DIA = 31
    ELSE
        IF @MES = 2
            IF @AO % 4  = 0
                SET @DIA = 29
            ELSE
                SET @DIA = 28
        ELSE
            IF @MES = 3
                SET @DIA = 31
            ELSE
                IF @MES = 4
                    SET @DIA = 30
                ELSE
                    IF @MES = 5
                        SET @DIA = 31
                    ELSE
                        IF @MES = 6
                            SET @DIA = 30
                        ELSE
                            IF @MES = 7
                                SET @DIA = 31
                            ELSE
                                IF @MES = 8
                                    SET @DIA = 31
                                ELSE
                                    IF @MES = 9
                                        SET @DIA = 30
                                    ELSE
                                        IF @MES = 10
                                            SET @DIA = 31
                                        ELSE
                                            IF @MES = 11
                                                SET @DIA = 30
                                            ELSE
                                                IF @MES = 12
                                                    SET @DIA = 31

    RETURN @DIA

END






GO

GO

GO
CREATE FUNCTION [dbo].[FOTOSPIC](@CAMARA AS VARCHAR(4),@CORD AS VARCHAR (5),@PISO AS VARCHAR(3))  
RETURNS @DATOS TABLE 
(
TIPOP VARCHAR(50),
PISO INT,
CANTIDAD INT
)
AS   
BEGIN

DECLARE @I INT 
	DECLARE @CONSULTA varchar(50);
	DECLARE @CONSULTA2 varchar(20);
	DECLARE @TIPOP VARCHAR(40);
	DECLARE @COUN INT
		 
		 SET @I =1
		

		  
		  SET @CONSULTA = (SELECT  tipopallet from VG_PARAFOTO  where racd_ca=@CAMARA and  cordenada=@cord AND racd_pi=@PISO GROUP BY tipopallet );
		  
	      SET @CONSULTA2 =(SELECT COUNT(tipopallet)AS CO  from VG_PARAFOTO  where racd_ca=@CAMARA and  cordenada=@cord AND racd_pi=@PISO );

		   SET @COUN =ROUND(@CONSULTA2,0)

	  INSERT INTO @DATOS VALUES (@CONSULTA,@piso,@COUN)



	
    RETURN;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[FOTOSPISOS](@CAMARA AS VARCHAR(4),@CORD AS VARCHAR (5))  
RETURNS @DATOS TABLE 
(

TIPOP VARCHAR(50),
PISO INT,
CANTIDAD INT

)
AS   
BEGIN
   DECLARE @I INT 
	DECLARE @CONSULTA varchar(50);
	DECLARE @CONSULTA2 varchar(20);
	DECLARE @TIPOP VARCHAR(40);
	DECLARE @COUN INT
		 
		 SET @I =1
		
WHILE(@I <8)
		  BEGIN
		  
		  SET @CONSULTA = (SELECT  tipopallet from VG_PARAFOTO  where racd_ca=@CAMARA and  cordenada=@cord AND racd_pi=@I GROUP BY tipopallet );
		  
	      SET @CONSULTA2 =(SELECT COUNT(tipopallet)AS CO  from VG_PARAFOTO  where racd_ca=@CAMARA and  cordenada=@cord AND racd_pi=@I );

		   SET @COUN =ROUND(@CONSULTA2,0)

	  INSERT INTO @DATOS VALUES (@CONSULTA,@I,@COUN)
	  SET @I = @I+1;
	CONTINUE;
	END
RETURN;
END;
GO

GO

GO

CREATE FUNCTION [dbo].[PESAJE_PRODUCTOS] (@GUIA AS VARCHAR(10))  
RETURNS @DATOS TABLE 
(
DESCRIPCION VARCHAR(40),
KILOS VARCHAR(10),
CAJAS VARCHAR (10),
GUIA VARCHAR(10)
)
AS   
BEGIN



	DECLARE @PESO_GUIA_1 VARCHAR(10)
	DECLARE @PESO_GUIA_2 VARCHAR(10)
	DECLARE @PESO_GUIA_3 VARCHAR(10)
	DECLARE @CAJA_GUIA_1 VARCHAR(10)
	DECLARE @CAJA_GUIA_2 VARCHAR(10)
	DECLARE @CAJA_GUIA_3 VARCHAR(10)
	DECLARE @DESCRIPCION_1 VARCHAR(100)
	DECLARE @DESCRIPCION_2 VARCHAR(100)
	DECLARE @DESCRIPCION_3 VARCHAR(100)
	DECLARE @GUIA_2 VARCHAR(7)
	DECLARE @CONTENEDOR VARCHAR(50)
	DECLARE @RUTGUIA VARCHAR(15)
	DECLARE @DIFERENCIA1_PESO VARCHAR(10)
	DECLARE @DIFERENCIA2_PESO VARCHAR(10)
	DECLARE @DIFERENCIA1_CAJA VARCHAR(10)
	DECLARE @DIFERENCIA2_CAJA VARCHAR(10)

	/*OBTENGO EL CONTENEDOR Y RUT DE LA GUIA DE INGRESO NUMERO 1 PARA PODER OBTENER LOS DATOS DE LA SEGUNDA GUIA*/
	SET @CONTENEDOR = CAST((SELECT frec_contenedor FROM fichrece WHERE frec_codi=@GUIA) AS VARCHAR);
	SET @RUTGUIA    = CAST((SELECT frec_rutcli FROM fichrece WHERE frec_codi=@GUIA) AS VARCHAR);
	SET @GUIA_2     = CAST((SELECT frec_codi FROM fichrece WHERE frec_codi!=@GUIA AND frec_contenedor=@CONTENEDOR AND frec_rutcli=@RUTGUIA) AS VARCHAR);
	
	SET @PESO_GUIA_1 = CAST((SELECT SUM(drec_peso) FROM detarece WHERE frec_codi1=@GUIA) AS VARCHAR);
	SET @PESO_GUIA_2 = CAST((SELECT SUM(drec_peso) FROM detarece WHERE frec_codi1=@GUIA_2) AS VARCHAR);
	SET @PESO_GUIA_3 = CAST((SELECT kilos_guia FROM fichrece WHERE frec_codi=@GUIA) AS VARCHAR);

	SET @CAJA_GUIA_1 = CAST((SELECT SUM(drec_unidades) FROM detarece WHERE frec_codi1=@GUIA) AS VARCHAR);
	SET @CAJA_GUIA_2 = CAST((SELECT SUM(drec_unidades) FROM detarece WHERE frec_codi1=@GUIA_2) AS VARCHAR);
	SET @CAJA_GUIA_3 = CAST((SELECT uni_guia FROM fichrece WHERE frec_codi=@GUIA) AS VARCHAR);

	SET @DESCRIPCION_1 = 'GUIA ANTES DE PROCESO: '+@GUIA;
	SET @DESCRIPCION_2 = 'GUIA DESPUES DE PROCESO: '+@GUIA_2;
	SET @DESCRIPCION_3 = 'GUIA DE CLIENTE';


   SET @DIFERENCIA1_PESO = (ISNULL(CAST(@PESO_GUIA_3 AS INT),0)-ISNULL(CAST(@PESO_GUIA_1 AS INT),0))
   SET @DIFERENCIA2_PESO = (ISNULL(CAST(@PESO_GUIA_3 AS INT),0)-ISNULL(CAST(@PESO_GUIA_2 AS INT),0))

   SET @DIFERENCIA1_CAJA = (ISNULL(CAST(@CAJA_GUIA_3 AS INT),0)-ISNULL(CAST(@CAJA_GUIA_1 AS INT),0))
   SET @DIFERENCIA2_CAJA = (ISNULL(CAST(@CAJA_GUIA_3 AS INT),0)-ISNULL(CAST(@CAJA_GUIA_2 AS INT),0))

	INSERT INTO @DATOS VALUES (@DESCRIPCION_3,@PESO_GUIA_3,@CAJA_GUIA_3,'')
	INSERT INTO @DATOS VALUES (@DESCRIPCION_1,@PESO_GUIA_1,@CAJA_GUIA_1,@GUIA)
	/*INSERT INTO @DATOS VALUES ('DIFERENCIA CON GUIA DE CLIENTE',@DIFERENCIA1_PESO,@DIFERENCIA1_CAJA)*/
	INSERT INTO @DATOS VALUES (@DESCRIPCION_2,@PESO_GUIA_2,@CAJA_GUIA_2,@GUIA_2)
	/*INSERT INTO @DATOS VALUES ('DIFERENCIA CON GUIA DE CLIENTE',@DIFERENCIA2_PESO,@DIFERENCIA2_CAJA)*/
     
    RETURN;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[PROMEDIO_SOPORTANTES](@DIAS AS INT,@MES AS VARCHAR (2),@YEAR AS VARCHAR(4),@CONTRATO AS VARCHAR (20),@CLIENTE AS VARCHAR (9))  
RETURNS @DATOS TABLE 
(
PROMEDIO  INT,
NUMERO INT
)
AS   
BEGIN

    DECLARE @I int;
	DECLARE @SOPORTANTES int;
	DECLARE @FECHA_ACTUAL DATE;
    DECLARE @FECHA_INICIAL varchar(10);
	DECLARE @FECHA_FINAL DATE;
	DECLARE @NUMERO int;
	DECLARE @D int;
	DECLARE @DI varchar(10);
	DECLARE @FECHA varchar(10);
	DECLARE @CONSULTA varchar(10);
	DECLARE @RESULTADO int;
	DECLARE @PROMEDIO int;

	SET @I            = 1;
	SET @SOPORTANTES  = 0;
	SET @FECHA_ACTUAL = CAST((SELECT CAST(YEAR(GETDATE()) AS VARCHAR)+'/'+CAST(MONTH(GETDATE()) AS VARCHAR)+'/'+CAST(DAY(GETDATE()) AS VARCHAR)) AS DATE);
	SET @NUMERO       = 0;
	SET @PROMEDIO        = 0;

    
	WHILE (@I <= @DIAS)
      BEGIN  
	  SET @D = @I;

	  IF (@D<10) 
	  SET @DI = '0'+CAST(@D AS VARCHAR); 
	  ELSE 
	  SET @DI = CAST(@D AS VARCHAR); 
	  /*END IF*/
	  
	  SET @FECHA = @YEAR+'/'+@MES+'/'+@DI
	  SET @FECHA_FINAL = CAST(@FECHA AS DATE)


	  IF (@CONTRATO = 'TODOS')
	  SET @CONSULTA = (SELECT (SELECT isnull(SUM(drec_pallet),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=@FECHA AND drec_codvig='0' AND drec_rutcli=@CLIENTE)
                    -(SELECT  isnull(SUM(ddes_pallet),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=@FECHA
                     AND ddes_codvig='0' AND ddes_rutcli=@CLIENTE) AS SOPORTANTES);
      ELSE
      SET @CONSULTA = (SELECT (SELECT isnull(SUM(drec_pallet),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=@FECHA AND drec_codvig='0' 
                        AND drec_rutcli=@CLIENTE AND drec_contcli=@CONTRATO)-(SELECT  isnull(SUM(ddes_pallet),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=@FECHA 
                     AND ddes_codvig='0' AND ddes_rutcli=@CLIENTE AND ddes_contcli=@CONTRATO) AS SOPORTANTES);
      /*END IF*/

	    
		IF (@FECHA_ACTUAL<@FECHA_FINAL)
	       SET @SOPORTANTES = @SOPORTANTES+0;
        ELSE
	      IF (@CONSULTA < > '' AND @CONSULTA < > '0')
			BEGIN
              SET @SOPORTANTES = @SOPORTANTES+CAST(@CONSULTA AS INT);
              SET @NUMERO = @NUMERO+1;
		     END
          /*END IF*/
		/*END IF*/
	

	  SET @I = @I+1;

	  IF(@NUMERO>0) 
	  BEGIN
        SET @PROMEDIO = ROUND((@SOPORTANTES / @NUMERO),0);
	  END
	  /*END IF*/



      CONTINUE  
    END  

	

	INSERT INTO @DATOS VALUES (@PROMEDIO,@NUMERO)
     
    RETURN;  
END; 
GO

GO

GO

CREATE FUNCTION [dbo].[QRY_KARDEX](@FECINI AS DATETIME, @FECTER AS DATETIME, @CONT AS VARCHAR(9), @CLIENTE AS VARCHAR(9))

RETURNS @TABLA TABLE( 
FECHA VARCHAR(10) NOT NULL,  ENTRADA NUMERIC(18,0) NOT NULL, SALIDA NUMERIC(18,0) NOT NULL, 
SALDO NUMERIC(18,0) NOT NULL, EKIL FLOAT NOT NULL, SKIL FLOAT NOT NULL, S2KIL FLOAT NOT NULL)
AS 

BEGIN		

		DECLARE @ENT AS NUMERIC(18,0)
		DECLARE @SAL AS NUMERIC(18,0)
		DECLARE @SAL2 AS NUMERIC(18,0)
		
		DECLARE @KENT AS float
		DECLARE @KSAL AS float
		DECLARE @KSAL2 AS float
		
IF @CONT=''
	BEGIN
	
		SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_rutcli=@CLIENTE AND convert(date,drec_fecrec,111)<convert(varchar(10),@FECINI,111) AND drec_pallet='1'
		SELECT @KSAL = SUM(ddes_peso) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  convert(date,ddes_fecha,111)<convert(varchar(10),@FECINI,111)  
		
		SELECT @ENT = SUM(drec_pallet) FROM detarece WHERE drec_rutcli=@CLIENTE AND convert(date,drec_fecrec,111)<convert(date,@FECINI,111) AND drec_pallet='1'
		SELECT @SAL = SUM(ddes_pallet) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  convert(date,ddes_fecha,111)<convert(date,@FECINI,111) 
		
		SET @SAL2=@ENT-@SAL
		SET @KSAL2=@KENT-@KSAL
		
		WHILE(@FECINI<=@FECTER)
			BEGIN 
			
				SELECT @ENT = SUM(drec_pallet) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1'
				SELECT @SAL = SUM(ddes_pallet) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  ddes_FECHA=convert(varchar(10),@FECINI,111)  
				SET @SAL2=(ISNULL(@SAL2,0)+ISNULL(@ENT,0))-ISNULL(@SAL,0)
			
				SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1'
				SELECT @KSAL = SUM(ddes_peso) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  ddes_FECHA=convert(varchar(10),@FECINI,111)  
				SET @KSAL2=(ISNULL(@KSAL2,0)+ISNULL(@KENT,0))-ISNULL(@KSAL,0)
		
				INSERT INTO @TABLA VALUES(convert(varchar(10),@FECINI,111),ISNULL(@ENT,0),ISNULL(@SAL,0),isnull(@SAL2,0), isnull(ROUND(@KENT,2),0), isnull(ROUND(@KSAL,2),0),isnull(ROUND(@KSAL2,2),0))
				SET @ENT=0
				SET @SAL=0
				SET @FECINI=DATEADD(DAY,1,@FECINI)
			END 

	END
ELSE
	BEGIN 
		SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),@FECINI,111) AND drec_pallet='1'
		SELECT @KSAL = SUM(ddes_peso) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_fecha<convert(varchar(10),@FECINI,111)  
		
		SELECT @ENT = SUM(drec_pallet) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),DATEADD(DAY,-1,@FECINI),111) AND drec_pallet='1'
		SELECT @SAL = SUM(ddes_pallet) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_FECHA<convert(varchar(10),DATEADD(DAY,-1,@FECINI),111)  
		
		SET @SAL2=@ENT-@SAL
		SET @KSAL2=@KENT-@KSAL
		
		WHILE(@FECINI<=@FECTER)
			BEGIN 
			
				SELECT @ENT = SUM(drec_pallet) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1'
				SELECT @SAL = SUM(ddes_pallet) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_FECHA=convert(varchar(10),@FECINI,111)  
				SET @SAL2=(ISNULL(@SAL2,0)+ISNULL(@ENT,0))-ISNULL(@SAL,0)
			
				SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1'
				SELECT @KSAL = SUM(ddes_peso) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_FECHA=convert(varchar(10),@FECINI,111)  
				SET @KSAL2=(ISNULL(@KSAL2,0)+ISNULL(@KENT,0))-ISNULL(@KSAL,0)
		
				INSERT INTO @TABLA VALUES(convert(varchar(10),@FECINI,111),ISNULL(@ENT,0),ISNULL(@SAL,0),isnull(@SAL2,0), isnull(ROUND(@KENT,2),0), isnull(ROUND(@KSAL,2),0),isnull(ROUND(@KSAL2,2),0))
				SET @ENT=0
				SET @SAL=0
				SET @FECINI=DATEADD(DAY,1,@FECINI)
			END 
	END
	RETURN 
END

GO

GO

GO

CREATE FUNCTION [dbo].[QRY_KARDEXCONGRACIA](@FECINI AS DATETIME, @FECTER AS DATETIME, @CONT AS VARCHAR(9), @CLIENTE AS VARCHAR(9), @GRACIA AS INTEGER)
-- ENVIAR DIA DE GRACIA COMO NEGATIVO
RETURNS @TABLA TABLE( 
FECHA VARCHAR(10) NOT NULL,  ENTRADA NUMERIC(18,0) NOT NULL, SALIDA NUMERIC(18,0) NOT NULL, 
SALDO NUMERIC(18,0) NOT NULL, EKIL FLOAT NOT NULL, SKIL FLOAT NOT NULL, S2KIL FLOAT NOT NULL)
AS 

BEGIN		

		DECLARE @ENT AS NUMERIC(18,0)
		DECLARE @SAL AS NUMERIC(18,0)
		DECLARE @SAL2 AS NUMERIC(18,0)
		
		DECLARE @KENT AS float
		DECLARE @KSAL AS float
		DECLARE @KSAL2 AS float
		
IF @CONT=''
	BEGIN
	
		--SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec<convert(varchar(10),@FECINI,111) AND drec_pallet='1'
			-- TOTAL DE ENTRADAS A LA FECHA , Y LO CON TUNEL A (FECHA-GRACIA)
			SELECT @ENT = isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec<convert(varchar(10),@FECINI,111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
			SELECT @ENT = @ENT+isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec<convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
			
			SELECT @SAL = isnull(SUM(ddes_pallet),0) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  ddes_FECHA<convert(varchar(10),@FECINI,111)  
			
			SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec<convert(varchar(10),DATEADD(DAY, @GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
			SELECT @KENT = @KENT+isnull(SUM(drec_peso),0) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec<convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
			
			SELECT @KSAL = isnull(SUM(ddes_peso),0) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  ddes_fecha<convert(varchar(10),@FECINI,111)  
			
			
			SET @SAL2=@ENT-@SAL
			SET @KSAL2=@KENT-@KSAL
		
		WHILE(@FECINI<=@FECTER)
			BEGIN 
				SELECT @ENT = isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
				SELECT @ENT = @ENT+isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec=convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
				
				SELECT @SAL = SUM(ddes_pallet) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND ddes_fecha=convert(varchar(10),@FECINI,111)  
				SET @SAL2=(ISNULL(@SAL2,0)+ISNULL(@ENT,0))-ISNULL(@SAL,0)
			
				SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
				SELECT @KENT = @KENT+isnull(SUM(drec_peso),0) FROM detarece WHERE drec_rutcli=@CLIENTE AND drec_fecrec=convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
			
				SELECT @KSAL = SUM(ddes_peso) FROM detadespa WHERE ddes_rutcli=@CLIENTE AND  ddes_fecha=convert(varchar(10),@FECINI,111)  
				SET @KSAL2=(ISNULL(@KSAL2,0)+ISNULL(@KENT,0))-ISNULL(@KSAL,0)
		
				INSERT INTO @TABLA VALUES(convert(varchar(10),@FECINI,111),ISNULL(@ENT,0),ISNULL(@SAL,0),isnull(@SAL2,0), isnull(ROUND(@KENT,2),0), isnull(ROUND(@KSAL,2),0),isnull(ROUND(@KSAL2,2),0))
				SET @ENT=0
				SET @SAL=0
				SET @FECINI=DATEADD(DAY,1,@FECINI)
			END 

	END
ELSE
	BEGIN 
	
			-- TOTAL DE ENTRADAS A LA FECHA , Y LO CON TUNEL A (FECHA-GRACIA)
			SELECT @ENT = isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),@FECINI,111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
			SELECT @ENT = @ENT+isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
			
			SELECT @SAL = isnull(SUM(ddes_pallet),0) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_FECHA<convert(varchar(10),@FECINI,111)  
			
			SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),DATEADD(DAY, @GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
			SELECT @KENT = @KENT+isnull(SUM(drec_peso),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
			
			SELECT @KSAL = isnull(SUM(ddes_peso),0) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_fecha<convert(varchar(10),@FECINI,111)  
			
			
			SET @SAL2=@ENT-@SAL
			SET @KSAL2=@KENT-@KSAL
		
		WHILE(@FECINI<=@FECTER)
			BEGIN 
				SELECT @ENT = isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
				SELECT @ENT = @ENT+isnull(SUM(drec_pallet),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec=convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
				
				SELECT @SAL = SUM(ddes_pallet) FROM detadespa WHERE ddes_contcli=@CONT AND ddes_fecha=convert(varchar(10),@FECINI,111)  
				SET @SAL2=(ISNULL(@SAL2,0)+ISNULL(@ENT,0))-ISNULL(@SAL,0)
			
				SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec=convert(varchar(10),@FECINI,111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
				SELECT @KENT = @KENT+isnull(SUM(drec_peso),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec=convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
			
				SELECT @KSAL = ISNULL(SUM(ddes_peso),0)  FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_fecha=convert(varchar(10),@FECINI,111)  
				SET @KSAL2=(ISNULL(@KSAL2,0)+ISNULL(@KENT,0))-ISNULL(@KSAL,0)
		
				INSERT INTO @TABLA VALUES(convert(varchar(10),@FECINI,111),ISNULL(@ENT,0),ISNULL(@SAL,0),isnull(@SAL2,0), isnull(ROUND(@KENT,2),0), isnull(ROUND(@KSAL,2),0),isnull(ROUND(@KSAL2,2),0))
				SET @ENT=0
				SET @SAL=0
				SET @FECINI=DATEADD(DAY,1,@FECINI)
			END 
	END
	RETURN 
END



--DECLARE @KENT AS FLOAT
--DECLARE @KSAL AS FLOAT
--DECLARE @FECINI AS DATETIME 
--DECLARE @FECTER AS DATETIME
--DECLARE @CONT AS VARCHAR(9)
--DECLARE @GRACIA AS INTEGER
--set @FECINI='01-07-2014 16:53:11'
--SET @CONT='0002730'
--SET @GRACIA=0

--SELECT @KENT = SUM(drec_peso) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),DATEADD(DAY, @GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel<>'2'
--SELECT @KENT = @KENT+isnull(SUM(drec_peso),0) FROM detarece WHERE drec_contcli=@CONT AND drec_fecrec<convert(varchar(10),DATEADD(DAY,@GRACIA,@FECINI),111) AND drec_pallet='1' AND drec_RecepTunel='2'
--SELECT @KSAL= ISNULL(SUM(ddes_peso),0) FROM detadespa WHERE ddes_contcli=@CONT AND  ddes_fecha<convert(varchar(10),@FECINI,111)  
			
--SELECT @KENT
--SELECT @KSAL

--SELECT * FROM dbo.QRY_KARDEXCONGRACIA(, '31-07-2014 16:53:11', '0002730','',0)
GO

GO

GO
CREATE FUNCTION [dbo].[QRY_SOPORTANTES_DESPACHO](@PEDIDO AS numeric(18,0), @PALLETS AS VARCHAR(MAX), @SOPORTANTES AS INTEGER, @INICIAL AS INTEGER, @val AS VARCHAR(MAX))

RETURNS @TABLA TABLE( 
SOPORTANTE VARCHAR(9) NOT NULL, 
CAJASCONCAT TEXT NOT NULL

)  
AS 
 BEGIN

  SELECT @PALLETS=@PALLETS+''+dpc_numpal FROM DetaReceCajasped WHERE dpc_codped=@PEDIDO GROUP BY dpc_numpal
  		WHILE (@SOPORTANTES>0)
			BEGIN
			--PRINT SUBSTRING(@PALLETS,@INICIAL,7)
			IF (SELECT COUNT(*) FROM DetaReceCajasped WHERE dpc_numpal=SUBSTRING(@PALLETS,@INICIAL,9) AND dpc_codped=@PEDIDO) > 0 
					BEGIN
						SELECT @val=@val +'  -  '+dpc_codcaja 
						FROM DetaReceCajasped INNER JOIN detarece ON drec_codi=dpc_numpal INNER JOIN maeprod ON drec_codpro=mae_codi WHERE dpc_numpal=SUBSTRING(@PALLETS,@INICIAL,9) AND dpc_codped=@PEDIDO
					
						SET @val = SUBSTRING(@val,6,LEN(@val))
					
						INSERT INTO @TABLA VALUES(SUBSTRING(@PALLETS,@INICIAL,9),@val)
						SET @val=''
					END
			--ELSE
			--		BEGIN 
			--			INSERT INTO @TABLA VALUES('CAGE','LOL')
			--		END			
					
				SET @SOPORTANTES=@SOPORTANTES-1
				SET @INICIAL=@INICIAL+9
			END
			RETURN 
		END	
GO

GO

GO
CREATE FUNCTION [dbo].[QRY_SOPORTANTES_TRAQUEO](@RECEPCION AS VARCHAR(15),@PALLETS AS VARCHAR(MAX), @SOPORTANTES AS INTEGER, @INICIAL AS INTEGER, @val AS VARCHAR(MAX))

RETURNS @TABLA TABLE( 
SOPORTANTE VARCHAR(9) NOT NULL, 
CAJASCONCAT VARCHAR(MAX) NOT NULL
)  
AS
 BEGIN
 
 IF (SELECT COUNT(*) from DetaReceCajas WHERE  LEFT(Caj_Pcod,7)=@recepcion)>0 
 BEGIN
  SELECT @PALLETS=@PALLETS+''+drec_codi FROM detarece WHERE frec_codi1=@RECEPCION
  		WHILE (@SOPORTANTES>0)
			BEGIN
			--PRINT SUBSTRING(@PALLETS,@INICIAL,7)
			--IF (SELECT COUNT(*) FROM DetaReceCajas WHERE Caj_Pcod=SUBSTRING(@PALLETS,@INICIAL,9)) > 0 
			--		BEGIN
						SELECT @val=@val +'  -  '+Caj_cod   --, Caj_Pcod, drec_codpro, mae_descr, drec_unidades, drec_peso 
						FROM DetaReceCajas INNER JOIN detarece ON drec_codi=Caj_Pcod INNER JOIN maeprod ON drec_codpro=mae_codi WHERE Caj_Pcod=SUBSTRING(@PALLETS,@INICIAL,9) --AND Caj_Pcod=@RECEPCION		
					
						SET @val = SUBSTRING(@val,6,LEN(@val))
					
						INSERT INTO @TABLA VALUES(SUBSTRING(@PALLETS,@INICIAL,9),@val)
						SET @val=''
					--END			
				SET @SOPORTANTES=@SOPORTANTES-1
				SET @INICIAL=@INICIAL+9
			END
		END	
		RETURN 
END
GO

GO

GO
CREATE FUNCTION [dbo].[QRY_SOPORTANTES_TRAQUEO_nvo](@RECEPCION AS VARCHAR(15),@PALLETS AS VARCHAR(MAX), @SOPORTANTES AS INTEGER, @INICIAL AS INTEGER, @val AS VARCHAR(MAX))

RETURNS @TABLA TABLE( 
SOPORTANTE VARCHAR(9) NOT NULL, 
CAJASCONCAT VARCHAR(MAX) NOT NULL
)  
AS
 BEGIN
 
 IF (SELECT COUNT(*) from DetaReceCajas WHERE  LEFT(Caj_Pcod,7)=@recepcion)>0 
 BEGIN
  SELECT @PALLETS=@PALLETS+''+drec_codi FROM detarece WHERE frec_codi1=@RECEPCION
  		WHILE (@SOPORTANTES>0)
			BEGIN
			--PRINT SUBSTRING(@PALLETS,@INICIAL,7)
			--iF (SELECT COUNT(*) FROM DetaReceCajas WHERE Caj_Pcod=SUBSTRING(@PALLETS,@INICIAL,9)) > 0 
			--		BEGIN
						SELECT @val=@val +'  -  '+Caj_cod   --, Caj_Pcod, drec_codpro, mae_descr, drec_unidades, drec_peso 
						FROM DetaReceCajas INNER JOIN detarece ON drec_codi=Caj_Pcod INNER JOIN maeprod ON drec_codpro=mae_codi WHERE Caj_Pcod=SUBSTRING(@PALLETS,@INICIAL,9) --AND Caj_Pcod=@RECEPCION		
					
						SET @val = SUBSTRING(@val,6,LEN(@val))
					
						INSERT INTO @TABLA VALUES(SUBSTRING(@PALLETS,@INICIAL,9),@val)
						SET @val=''
					--END			
				SET @SOPORTANTES=@SOPORTANTES-1
				SET @INICIAL=@INICIAL+9
			END
			END	
		RETURN 
END
GO

GO

GO
CREATE FUNCTION [dbo].[SOPORTANTESACUMULADOS](@FECHA1 As varchar(10),@FECHA2 As Varchar(10),@RUT As Varchar(20),@CONTRATO As Varchar(20))  
RETURNS int   
AS   
 
BEGIN  
    DECLARE @diferencia_dias int;
	DECLARE @total int
	DECLARE @i int
	DECLARE @consulta int
	DECLARE @FECHA varchar(20)
	SET @FECHA = @FECHA1
	SET @i = 0
	SET @total = 0
	SET @diferencia_dias = (SELECT DATEDIFF(day, CAST(REPLACE(CONVERT(varchar(10), CAST(@FECHA1 AS DATE), 120),'-','/') AS DATE), CAST(REPLACE(CONVERT(varchar(10), CAST(@FECHA2 AS DATE), 120),'-','/') AS DATE)) )
    
	WHILE (@i <= @diferencia_dias)
      BEGIN  

	SET @consulta = (SELECT isnull(SUM(drec_pallet),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=REPLACE(CONVERT(varchar(10), CAST(@FECHA AS DATE), 120),'-','/') AND drec_codvig='0' AND drec_rutcli=@RUT AND drec_contcli=@CONTRATO)
      -(SELECT  isnull(SUM(ddes_pallet),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=REPLACE(CONVERT(varchar(10), CAST(@FECHA AS DATE), 120),'-','/') AND ddes_codvig='0' AND ddes_rutcli=@RUT AND ddes_contcli=@CONTRATO) 
	
	SET @total = @total + @consulta

	  SET @i=@i+1
      SET @FECHA = REPLACE(CONVERT(varchar(10), DATEADD(day,1, CAST(@FECHA AS DATE)), 120),'-','/')
      CONTINUE  
    END  
     
    RETURN @total;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[Split] (@String nvarchar (4000), @Delimitador nvarchar (10)) 
                returns @ValueTable table ([Value] nvarchar(4000))
begin
 declare @NextString nvarchar(4000)
 declare @Pos int
 declare @NextPos int
 declare @CommaCheck nvarchar(1)
  
 --Inicializa
 set @NextString = ''
 set @CommaCheck = right(@String,1) 
  
 set @String = @String + @Delimitador
  
 --Busca la posicin del primer delimitador
 set @Pos = charindex(@Delimitador,@String)
 set @NextPos = 1
  
 --Itera mientras exista un delimitador en el string
 while (@pos <>  0)  
 begin
  set @NextString = substring(@String,1,@Pos - 1)
  
  insert into @ValueTable ( [Value]) Values (@NextString)
  
  set @String = substring(@String,@pos +1,len(@String))
   
  set @NextPos = @Pos
  set @pos  = charindex(@Delimitador,@String)
 end
  
 return
end
GO

GO

GO
CREATE FUNCTION [dbo].[SUMA_HORAS]( @HORA1 varchar(8), @HORA2 varchar(8))  
RETURNS varchar(8)   
AS   
 
BEGIN  

DECLARE @HORA1_FLOAT float;
DECLARE @HORA2_FLOAT float;
DECLARE @HORA_TOTAL float;
DECLARE @HORA int;
DECLARE @MINUTOS int;
DECLARE @HORA_FINAL varchar(8);
   
SET @HORA1_FLOAT = (SELECT SUM(CAST(CONVERT(DATETIME, CAST(@HORA1 AS time)) AS FLOAT)) AS HORA);
SET @HORA2_FLOAT = (SELECT SUM(CAST(CONVERT(DATETIME, CAST(@HORA2 AS time)) AS FLOAT)) AS HORA);

SET @HORA_TOTAL = @HORA1_FLOAT + @HORA2_FLOAT;

SET @HORA     = FLOOR(@HORA_TOTAL);
SET @MINUTOS  = (SELECT (@HORA_TOTAL - FLOOR(@HORA_TOTAL)) * 60);

SET @HORA_FINAL = (SELECT RIGHT('00' + CONVERT(varchar(2), @HORA), 2) + ':' + RIGHT('00' + CONVERT(varchar(2), @MINUTOS), 2));

       
    RETURN @HORA_FINAL;  
END; 






GO

GO

GO
CREATE FUNCTION [dbo].[TEMPERATURA_RECEPCION](@CODIGO As varchar(7))  
RETURNS @informacion TABLE 
(
    Cl_Ting varchar(50) NULL, 
    frec_rutcli varchar(50) NULL, 
    asociar varchar(50) NULL
)
AS
BEGIN

   DECLARE @val INT;
   SET @val = (SELECT  COUNT(Cl_Ting)
   FROM fichrece, clientes, contrato , choferes, P_TipoEstiba, P_TipoHigiene, P_TipoOlores , origen, P_TipoRecepcion, usuarios, P_TipoDao, P_TipoCargaDescarga, P_TipoTunel,p_EstadoDocumento,zChecklist
   WHERE cont_codi=frec_contcli AND cli_rut=frec_rutcli and cho_rut= frec_rutcond AND IdEstiba=frec_estiba AND frec_clfol = Cl_fol
   AND frec_higiene=IdHigiene AND frec_olores=idOlor AND ori_codi=frec_origen AND idRecepcion=frec_tiporecepcion  AND iddao=frec_daado AND tcar_codi=frec_tipdesc
   AND personal=frec_codienca AND frec_RecepTunel=IdTunel AND ed_codi=frec_codvig AND frec_codi=@CODIGO);


IF (@val>0)
INSERT @INFORMACION  
SELECT Cl_Ting,frec_rutcli, '1' As asociar
 FROM fichrece, clientes, contrato , choferes, P_TipoEstiba, P_TipoHigiene, P_TipoOlores , origen, P_TipoRecepcion, usuarios, P_TipoDao, P_TipoCargaDescarga, P_TipoTunel,p_EstadoDocumento,zChecklist
 WHERE cont_codi=frec_contcli AND cli_rut=frec_rutcli and cho_rut= frec_rutcond AND IdEstiba=frec_estiba AND frec_clfol = Cl_fol
 AND frec_higiene=IdHigiene AND frec_olores=idOlor AND ori_codi=frec_origen AND idRecepcion=frec_tiporecepcion  AND iddao=frec_daado AND tcar_codi=frec_tipdesc
 AND personal=frec_codienca AND frec_RecepTunel=IdTunel AND ed_codi=frec_codvig AND frec_codi=@CODIGO
ELSE
BEGIN
IF (@val<=0)
  INSERT @INFORMACION 
    SELECT  '0' As Cl_Ting, '0' As frec_rutcli, '1' As asociar
END;


RETURN
END
GO

GO

GO
CREATE FUNCTION [dbo].[TONELADAS_CONGELADAS](@DIAS AS INT,@MES AS VARCHAR (2),@YEAR AS VARCHAR(4),@CONTRATO AS VARCHAR (20),@CLIENTE AS VARCHAR (9))  
RETURNS @DATOS TABLE 
(
TONELADAS  INT
)
AS   
BEGIN



	DECLARE @FECHA_ACTUAL DATE;
    DECLARE @FECHA_INICIAL varchar(10);
	DECLARE @FECHA_FINAL DATE;
	DECLARE @DI varchar(10);
	DECLARE @FECHA varchar(10);
	DECLARE @CONSULTA varchar(10);
	DECLARE @TONELADAS int;


	SET @FECHA_ACTUAL = CAST((SELECT CAST(YEAR(GETDATE()) AS VARCHAR)+'/'+CAST(MONTH(GETDATE()) AS VARCHAR)+'/'+CAST(DAY(GETDATE()) AS VARCHAR)) AS DATE);
	SET @TONELADAS    = 0;
	   
    SET @FECHA_INICIAL = @YEAR+'/'+@MES+'/01'
	SET @FECHA_FINAL   = @YEAR+'/'+@MES+'/'+CAST(@DIAS AS VARCHAR)

	IF (@FECHA_ACTUAL<@FECHA_FINAL)
	BEGIN
	       SET @FECHA_FINAL = @FECHA_ACTUAL;
	END

	
	  IF (@CONTRATO = 'TODOS')
	  SET @CONSULTA = (SELECT (SUM(drec_peso)/1000) AS TONELADAS FROM detarece, clientes 
                      WHERE drec_RecepTunel='2' AND drec_rutcli = cli_rut AND
                      drec_rutcli = @CLIENTE AND 
                      drec_fecrec BETWEEN @FECHA_INICIAL AND @FECHA_FINAL);
      ELSE
      SET @CONSULTA = (SELECT (SUM(drec_peso)/1000) AS TONELADAS FROM detarece, clientes 
                      WHERE drec_RecepTunel='2' AND drec_rutcli = cli_rut AND
                      drec_rutcli = @CLIENTE AND 
                      drec_fecrec BETWEEN @FECHA_INICIAL AND @FECHA_FINAL AND drec_contcli=@CONTRATO);
      /*END IF*/

	  IF (@CONSULTA = '')
	  BEGIN 
	  SET @CONSULTA = 0
	  END

	    
	 SET @TONELADAS = ROUND(@CONSULTA,0)
	

	INSERT INTO @DATOS VALUES (@TONELADAS)
     
    RETURN;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[TONELADASACUMULADAS](@FECHA1 As varchar(10),@FECHA2 As Varchar(10),@RUT As Varchar(20),@CONTRATO As Varchar(20))  
RETURNS int   
AS   
 
BEGIN  
    DECLARE @diferencia_dias int;
	DECLARE @total int
	DECLARE @i int
	DECLARE @consulta int
	DECLARE @FECHA varchar(20)
	SET @FECHA = @FECHA1
	SET @i = 0
	SET @total = 0
	SET @diferencia_dias = (SELECT DATEDIFF(day, CAST(REPLACE(CONVERT(varchar(10), CAST(@FECHA1 AS DATE), 120),'-','/') AS DATE), CAST(REPLACE(CONVERT(varchar(10), CAST(@FECHA2 AS DATE), 120),'-','/') AS DATE)) )
    
	WHILE (@i <= @diferencia_dias)
      BEGIN  

	SET @consulta = (SELECT isnull(SUM(drec_peso),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=REPLACE(CONVERT(varchar(10), CAST(@FECHA AS DATE), 120),'-','/') AND drec_codvig='0' AND drec_rutcli=@RUT AND drec_contcli=@CONTRATO)
      -(SELECT  isnull(SUM(ddes_peso),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=REPLACE(CONVERT(varchar(10), CAST(@FECHA AS DATE), 120),'-','/') AND ddes_codvig='0' AND ddes_rutcli=@RUT AND ddes_contcli=@CONTRATO) 
	
	SET @total = @total + @consulta

	  SET @i=@i+1
      SET @FECHA = REPLACE(CONVERT(varchar(10), DATEADD(day,1, CAST(@FECHA AS DATE)), 120),'-','/')
      CONTINUE  
    END  
     
    RETURN @total;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[ULTIMOS_7_DIAS](@RUT VARCHAR(12))  
RETURNS @DATOS TABLE 
(
FECHA  varchar(10),
SOPORTANTES VARCHAR(12)
)
AS   
BEGIN


   DECLARE @I int;
   DECLARE @K int;
   DECLARE @FECHA1 varchar(10);
   DECLARE @FECHA_A varchar(10);
   DECLARE @SOPORTANTES varchar(10);

   SET @I = 1;

   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,CAST(GETDATE() AS DATE),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,CAST(GETDATE() AS DATE),106),'-','/'));
   SET @SOPORTANTES =(SELECT (SELECT isnull(SUM(drec_pallet),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=@FECHA_A AND drec_codvig='0' AND drec_rutcli=@RUT)
                    -(SELECT  isnull(SUM(ddes_pallet),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=@FECHA_A AND ddes_codvig='0' AND ddes_rutcli=@RUT) AS SOPORTANTES);
   
   INSERT INTO @DATOS VALUES (@FECHA1,@SOPORTANTES)

  WHILE(@I<7)
   BEGIN
   SET @K = @I*-1;
   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),'-','/'));
   SET @SOPORTANTES =(SELECT (SELECT isnull(SUM(drec_pallet),0) As RECEPCIONES FROM detarece WHERE drec_fecrec<=@FECHA_A AND drec_codvig='0' AND drec_rutcli=@RUT)
                    -(SELECT  isnull(SUM(ddes_pallet),0) As DESPACHOS FROM detadespa WHERE ddes_fecha<=@FECHA_A AND ddes_codvig='0' AND ddes_rutcli=@RUT) AS SOPORTANTES);
   
   INSERT INTO @DATOS VALUES (@FECHA1,@SOPORTANTES)

   SET @I = @I+1;
   CONTINUE
  END

     
    RETURN;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[ULTIMOS_7_DIAS_DESPACHOS](@RUT VARCHAR(12))  
RETURNS @DATOS TABLE 
(
FECHA  varchar(10),
DESPACHOS VARCHAR(12)
)
AS   
BEGIN


   DECLARE @I int;
   DECLARE @K int;
   DECLARE @FECHA1 varchar(10);
   DECLARE @FECHA_A varchar(10);
   DECLARE @DESPACHOS varchar(10);

   SET @I = 1;

   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,CAST(GETDATE() AS DATE),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,CAST(GETDATE() AS DATE),106),'-','/'));
   SET @DESPACHOS   =(SELECT ISNULL((SELECT COUNT(fdes_codi) AS DESPACHOS FROM fichdespa WHERE fdes_fecha BETWEEN @FECHA_A AND @FECHA_A AND fdes_rutcli = @RUT),0));
   
   SET @DESPACHOS = (FLOOR(ROUND(@DESPACHOS,0,1)));
   INSERT INTO @DATOS VALUES (@FECHA1,@DESPACHOS)

  WHILE(@I<7)
   BEGIN
   SET @K = @I*-1;
   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),'-','/'));
   SET @DESPACHOS   =(SELECT ISNULL((SELECT COUNT(fdes_codi) AS DESPACHOS FROM fichdespa WHERE fdes_fecha BETWEEN @FECHA_A AND @FECHA_A AND fdes_rutcli = @RUT),0));
   
   SET @DESPACHOS = (FLOOR(ROUND(@DESPACHOS,0,1)));   
   INSERT INTO @DATOS VALUES (@FECHA1,@DESPACHOS)

   SET @I = @I+1;
   CONTINUE
  END

     
    RETURN;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[ULTIMOS_7_DIAS_RECEPCIONES](@RUT VARCHAR(12))  
RETURNS @DATOS TABLE 
(
FECHA  varchar(10),
RECEPCIONES VARCHAR(12)
)
AS   
BEGIN


   DECLARE @I int;
   DECLARE @K int;
   DECLARE @FECHA1 varchar(10);
   DECLARE @FECHA_A varchar(10);
   DECLARE @RECEPCIONES varchar(10);

   SET @I = 1;

   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,CAST(GETDATE() AS DATE),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,CAST(GETDATE() AS DATE),106),'-','/'));
   SET @RECEPCIONES   =(SELECT ISNULL((SELECT COUNT(frec_codi) AS RECEPCIONES FROM fichrece WHERE frec_fecrec BETWEEN @FECHA_A AND @FECHA_A AND frec_rutcli = @RUT),0));
   
   SET @RECEPCIONES = (FLOOR(ROUND(@RECEPCIONES,0,1)));
   INSERT INTO @DATOS VALUES (@FECHA1,@RECEPCIONES)

  WHILE(@I<7)
   BEGIN
   SET @K = @I*-1;
   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),'-','/'));
   SET @RECEPCIONES   =(SELECT ISNULL((SELECT COUNT(frec_codi) AS RECEPCIONES FROM fichrece WHERE frec_fecrec BETWEEN @FECHA_A AND @FECHA_A AND frec_rutcli = @RUT),0));
   
   SET @RECEPCIONES = (FLOOR(ROUND(@RECEPCIONES,0,1)));   
   INSERT INTO @DATOS VALUES (@FECHA1,@RECEPCIONES)

   SET @I = @I+1;
   CONTINUE
  END

     
    RETURN;  
END; 
GO

GO

GO
CREATE FUNCTION [dbo].[ULTIMOS_7_DIAS_TUNEL](@RUT VARCHAR(12))  
RETURNS @DATOS TABLE 
(
FECHA  varchar(10),
TONELADAS VARCHAR(12)
)
AS   
BEGIN


   DECLARE @I int;
   DECLARE @K int;
   DECLARE @FECHA1 varchar(10);
   DECLARE @FECHA_A varchar(10);
   DECLARE @TONELADAS varchar(10);

   SET @I = 1;

   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,CAST(GETDATE() AS DATE),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,CAST(GETDATE() AS DATE),106),'-','/'));
   SET @TONELADAS   =(SELECT ISNULL((SELECT (SUM(drec_peso)/1000) AS TONELADAS FROM detarece, clientes WHERE drec_RecepTunel='2' AND drec_rutcli = cli_rut 
                      AND drec_fecrec BETWEEN @FECHA_A AND @FECHA_A 
					  AND drec_rutcli = @RUT),0));

   SET @TONELADAS = (FLOOR(ROUND(@TONELADAS,0,1)));
   INSERT INTO @DATOS VALUES (@FECHA1,@TONELADAS)

  WHILE(@I<7)
   BEGIN
   SET @K = @I*-1;
   SET @FECHA1      = (SELECT CONVERT(varchar(10),CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),103));
   SET @FECHA_A     = (SELECT REPLACE(CONVERT(date,DATEADD(DAY,@K,CAST(GETDATE() AS DATE)),106),'-','/'));
   SET @TONELADAS   =(SELECT ISNULL((SELECT (SUM(drec_peso)/1000) AS TONELADAS FROM detarece, clientes WHERE drec_RecepTunel='2' AND drec_rutcli = cli_rut 
                      AND drec_fecrec BETWEEN @FECHA_A AND @FECHA_A 
					  AND drec_rutcli = @RUT),0));

   SET @TONELADAS = (FLOOR(ROUND(@TONELADAS,0,1)));
   INSERT INTO @DATOS VALUES (@FECHA1,@TONELADAS)

   SET @I = @I+1;
   CONTINUE
  END

     
    RETURN;  
END; 
GO
CREATE VIEW [dbo].[VG_POS_TRAN]
AS
SELECT        dbo.detarece.drec_rutcli, dbo.clientes.cli_nomb, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, 
                         dbo.rackdeta.racd_codi
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
GROUP BY dbo.detarece.drec_rutcli, dbo.clientes.cli_nomb, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, 
                         dbo.rackdeta.racd_codi
HAVING        (dbo.rackdeta.racd_ca > N'06')

GO

GO

GO
CREATE VIEW [dbo].[VG_TRAN]
AS
SELECT        drec_rutcli, cli_nomb, COUNT(drec_rutcli) AS TRANS
FROM            dbo.VG_POS_TRAN
GROUP BY drec_rutcli, cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[VG_POS_LIBRES]
AS
SELECT        dbo.detarece.drec_rutcli, dbo.clientes.cli_nomb, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
GROUP BY dbo.detarece.drec_rutcli, dbo.clientes.cli_nomb, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi
HAVING        (dbo.rackdeta.racd_ca = N'01') OR
                         (dbo.rackdeta.racd_ca = N'02') OR
                         (dbo.rackdeta.racd_ca = N'03') OR
                         (dbo.rackdeta.racd_ca = N'04') OR
                         (dbo.rackdeta.racd_ca = N'05') OR
                         (dbo.rackdeta.racd_ca = N'06')

GO

GO

GO
CREATE VIEW [dbo].[VG_POS]
AS
SELECT        drec_rutcli, cli_nomb, COUNT(drec_rutcli) AS POS
FROM            dbo.VG_POS_LIBRES
GROUP BY drec_rutcli, cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[VG_CLI]
AS
SELECT        TOP (100) PERCENT dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.VG_POS.POS, dbo.VG_TRAN.drec_rutcli, dbo.VG_TRAN.TRANS
FROM            dbo.clientes LEFT OUTER JOIN
                         dbo.VG_TRAN ON dbo.clientes.cli_rut = dbo.VG_TRAN.drec_rutcli LEFT OUTER JOIN
                         dbo.VG_POS ON dbo.clientes.cli_rut = dbo.VG_POS.drec_rutcli
ORDER BY dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[GvwContenedores]
as
SELECT MAX(frec_codi) AS CODI, frec_contenedor AS CONT, frec_totsopo AS RECE, 
(SELECT isnull(SUM(ddes_pallet),0)FROM detadespa WHERE LEFT(ddes_codrece,7)=frec_codi) AS DESP,
frec_rutcond AS CHO, SUM(pimp_totsopo) AS DESBLOQ 
FROM fichrece  INNER JOIN contrato ON cont_codi=frec_contcli LEFT JOIN Proc_Importaciones ON pimp_codrece=frec_codi
WHERE cont_BloqImp='1'  AND frec_codvig='0'
GROUP BY frec_contenedor, frec_totsopo, frec_codi, frec_rutcond
GO

GO

GO
CREATE VIEW [dbo].[GvwContBloq]
AS
SELECT LEFT(racd_codi,7) as RECEPCION, isnull(frec_contenedor,'0')as frec_contenedor, frec_guiades  FROM rackdeta INNER JOIN detarece ON drec_codi=racd_codi INNER JOIN fichrece fr ON fr.frec_codi=frec_codi1
WHERE  racd_estado='5' GROUP BY LEFT(racd_codi,7) , frec_contenedor, frec_guiades


GO

GO

GO
CREATE VIEW [dbo].[GvwContFinal]
AS
SELECT CONT, isnull(frec_contenedor,0)AS BLOQ , (SELECT MAX(frec_codi) FROM fichrece WHERE frec_contenedor=CONT) AS RECE, 
isnull(fcon_petiq,0) AS ETIQ, isnull(fcon_prev,0) AS REV, SUM( isnull(rece,0)) AS SUMRECE, sum( isnull(desp,0)) AS SUMDESPA
FROM GvwContenedores LEFT JOIN GvwContBloq ON CONT=frec_contenedor LEFT JOIN fichcont ON fcon_cont=CONT
WHERE CONT is not null AND CONT<>'' AND CONT<>'0'
GROUP BY CONT, frec_contenedor, fcon_petiq, fcon_prev
GO

GO

GO
CREATE VIEW [dbo].[qry_pedidoswebok_inteligenteOK]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi AS PALLET, dbo.rackdeta.racd_unidades AS UNIDADES, dbo.rackdeta.racd_peso AS KILOS, 
                      dbo.rackdeta.racd_solicitado AS SOLICITADO, dbo.detarece.drec_fecrec AS FECHARECEPCION, CONVERT(varchar, CONVERT(datetime, 
                      CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) AS FechaVencimiento2, dbo.detarece.drec_contcli AS CONTRATO, 
                      dbo.detarece.drec_rutcli AS RUT, dbo.detarece.drec_codpro AS CODPRO, dbo.maeprod.mae_descr AS PRODUCTO, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.rackdeta.racd_pedido_fec AS PEDIDOFECHA, dbo.rackdeta.racd_pedido_hor AS PEDIDOHORA, dbo.rackdeta.racd_pedido AS PEDIDO, 
                      dbo.rackdeta.racd_estadopallet AS ESTADOPALLET, CASE WHEN RACD_CA = '99' AND (RACD_BA >= '01' AND RACD_BA <= '05') 
                      THEN '1' ELSE '0' END AS TUNEL, CASE WHEN RACD_UNIDADES <> DREC_UNIDADES THEN '1' ELSE '0' END AS PUCHOS, 
                      CASE WHEN RACD_SOLICITADO >= 0 THEN RACD_UNIDADES - RACD_SOLICITADO ELSE RACD_UNIDADES END AS STOCK, 
                      CASE WHEN CDAN_CAJAS IS NULL THEN 0 ELSE CDAN_CAJAS END AS CAJASDANADAS
FROM         dbo.CAJAS_DANADAS RIGHT OUTER JOIN
                      dbo.rackdeta ON dbo.CAJAS_DANADAS.CDAN_PALLET = dbo.rackdeta.racd_codi LEFT OUTER JOIN
                      dbo.tipoenv INNER JOIN
                      dbo.maeprod INNER JOIN
                      dbo.detarece ON dbo.maeprod.mae_codi = dbo.detarece.drec_codpro ON dbo.tipoenv.tenv_codi = dbo.maeprod.mae_tipenv ON 
                      dbo.rackdeta.racd_codi = dbo.detarece.drec_codi
WHERE     (dbo.rackdeta.racd_codi > 2000099)

GO

GO

GO
CREATE VIEW [dbo].[qry_pedidowebok_inteligente_productos]
AS
SELECT     TOP 100 PERCENT RUT, CONTRATO, CODPRO, PRODUCTO
FROM         dbo.qry_pedidoswebok_inteligenteOK
WHERE     (PEDIDO = 0) AND (ESTADOPALLET = 0) AND (TUNEL = 0) AND (STOCK > 0) AND (CAJASDANADAS = 0)
GROUP BY RUT, CONTRATO, CODPRO, PRODUCTO
ORDER BY PRODUCTO

GO

GO

GO
CREATE VIEW [dbo].[QRY_detadespa_pallet_despa1]
AS
SELECT     TOP 100 PERCENT dbo.detadespa.ddes_codrece, SUM(dbo.detadespa.ddes_pallet) AS pallet, dbo.detadespa.ddes_fecha, dbo.detadespa.ddes_rutcli, 
                      dbo.fichdespa.fdes_GuiaCliente, dbo.fichdespa.fdes_destino
FROM         dbo.detadespa INNER JOIN
                      dbo.fichdespa ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.fichdespa.fdes_codi
WHERE     (dbo.detadespa.ddes_codrece >= 4000001) AND (dbo.detadespa.ddes_pallet = 1)
GROUP BY dbo.detadespa.ddes_codrece, dbo.detadespa.ddes_fecha, dbo.detadespa.ddes_rutcli, dbo.fichdespa.fdes_GuiaCliente, 
                      dbo.fichdespa.fdes_destino
ORDER BY dbo.detadespa.ddes_codrece

GO

GO

GO
CREATE VIEW [dbo].[QRY_RECEPCIONADOS_DESPACHADOS1]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_codcli, dbo.detarece.drec_sopocli, dbo.detarece.drec_codi, dbo.detarece.drec_unidades, 
                      dbo.detarece.drec_fecrec, dbo.fichrece.frec_guiades, dbo.QRY_detadespa_pallet_despa1.ddes_fecha, 
                      dbo.QRY_detadespa_pallet_despa1.fdes_GuiaCliente, dbo.QRY_detadespa_pallet_despa1.fdes_destino, dbo.detarece.drec_rutcli
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.detarece.drec_codi, 7) = dbo.fichrece.frec_codi LEFT OUTER JOIN
                      dbo.QRY_detadespa_pallet_despa1 ON dbo.detarece.drec_codi = dbo.QRY_detadespa_pallet_despa1.ddes_codrece
ORDER BY dbo.detarece.drec_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_Tarifa_Clientes]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_rut AS TAR_RUT, dbo.clientes.cli_nomb AS TAR_NOMBRE, dbo.contrato.cont_codi AS TAR_CODCONT, 
                      dbo.contrato.cont_descr AS TAR_CONTRATO, dbo.contrpara.cpar_servi AS TAR_CODSERV, dbo.servicios.ser_descr AS TAR_SERVICIO, 
                      dbo.contrpara.cpar_valor AS TAR_VALOR, dbo.monedas.mon_descr AS TAR_MONEDA, dbo.monedas.mon_valor AS TAR_MONVALOR, 
                      dbo.escala.esc_dtramo1 AS TAR_DTRAMO1, dbo.escala.esc_htramo1 AS TAR_HTRAMO1, dbo.escala.esc_valor1 AS TAR_VALOR1, 
                      dbo.escala.esc_dtramo2 AS TAR_DTRAMO2, dbo.escala.esc_htramo2 AS TAR_HTRAMO2, dbo.escala.esc_valor2 AS TAR_VALOR2, 
                      dbo.escala.esc_dtramo3 AS TAR_DTRAMO3, dbo.escala.esc_htramo3 AS TAR_HTRAMO3, dbo.escala.esc_valor3 AS TAR_VALOR3, 
                      dbo.escala.esc_dtramo4 AS TAR_DTRAMO4, dbo.escala.esc_htramo4 AS TAR_HTRAMO4, dbo.escala.esc_valor4 AS TAR_VALOR4, 
                      dbo.contrpara.cpar_medida AS TAR_CODMED, dbo.servicios.ser_escala AS TAR_ESCALA
FROM         dbo.contrato INNER JOIN
                      dbo.clientes ON dbo.contrato.cont_rutclie = dbo.clientes.cli_rut INNER JOIN
                      dbo.contrpara ON dbo.contrato.cont_codi = dbo.contrpara.cpar_contr INNER JOIN
                      dbo.servicios ON dbo.contrpara.cpar_servi = dbo.servicios.ser_codi INNER JOIN
                      dbo.monedas ON dbo.contrpara.cpar_moneda = dbo.monedas.mon_codi LEFT OUTER JOIN
                      dbo.escala ON dbo.contrpara.cpar_contr = dbo.escala.esc_contr AND dbo.contrpara.cpar_servi = dbo.escala.esc_servi
WHERE     (dbo.clientes.cli_estado = 'A') AND (dbo.contrpara.cpar_marca = 1) AND (dbo.contrato.cont_estado = 0)
ORDER BY dbo.clientes.cli_nomb, dbo.contrato.cont_codi, dbo.contrpara.cpar_servi

GO

GO

GO
CREATE VIEW [dbo].[Qry_Tarifa_Clientesok]
AS
SELECT     dbo.Qry_Tarifa_Clientes.TAR_RUT, dbo.Qry_Tarifa_Clientes.TAR_NOMBRE, dbo.Qry_Tarifa_Clientes.TAR_CODCONT, 
                      dbo.Qry_Tarifa_Clientes.TAR_CONTRATO, dbo.Qry_Tarifa_Clientes.TAR_CODSERV, dbo.Qry_Tarifa_Clientes.TAR_SERVICIO, 
                      dbo.Qry_Tarifa_Clientes.TAR_VALOR, dbo.Qry_Tarifa_Clientes.TAR_MONEDA, dbo.Qry_Tarifa_Clientes.TAR_MONVALOR, 
                      dbo.Qry_Tarifa_Clientes.TAR_DTRAMO1, dbo.Qry_Tarifa_Clientes.TAR_HTRAMO1, dbo.Qry_Tarifa_Clientes.TAR_VALOR1, 
                      dbo.Qry_Tarifa_Clientes.TAR_DTRAMO2, dbo.Qry_Tarifa_Clientes.TAR_HTRAMO2, dbo.Qry_Tarifa_Clientes.TAR_VALOR2, 
                      dbo.Qry_Tarifa_Clientes.TAR_DTRAMO3, dbo.Qry_Tarifa_Clientes.TAR_HTRAMO3, dbo.Qry_Tarifa_Clientes.TAR_VALOR3, 
                      dbo.Qry_Tarifa_Clientes.TAR_DTRAMO4, dbo.Qry_Tarifa_Clientes.TAR_HTRAMO4, dbo.Qry_Tarifa_Clientes.TAR_VALOR4, 
                      dbo.medidas.med_descr AS TAR_MEDIDA, dbo.Qry_Tarifa_Clientes.TAR_ESCALA
FROM         dbo.Qry_Tarifa_Clientes INNER JOIN
                      dbo.medidas ON dbo.Qry_Tarifa_Clientes.TAR_CODMED = CONVERT(INT, dbo.medidas.med_codi)

GO

GO

GO
CREATE VIEW [dbo].[VG_ULTMOVPALLET]
AS
SELECT        mov_folio, MAX(mov_fecha) AS ultmov
FROM            dbo.movpallet
GROUP BY mov_folio

GO

GO

GO
CREATE VIEW [dbo].[VG_PERMOV]
AS
SELECT        dbo.movpallet.mov_codper, dbo.VG_ULTMOVPALLET.mov_folio, dbo.VG_ULTMOVPALLET.ultmov, MAX(dbo.movpallet.mov_hora) AS HR
FROM            dbo.movpallet INNER JOIN
                         dbo.VG_ULTMOVPALLET ON dbo.movpallet.mov_folio = dbo.VG_ULTMOVPALLET.mov_folio AND dbo.movpallet.mov_fecha = dbo.VG_ULTMOVPALLET.ultmov
GROUP BY dbo.movpallet.mov_codper, dbo.VG_ULTMOVPALLET.mov_folio, dbo.VG_ULTMOVPALLET.ultmov

GO

GO

GO
CREATE VIEW [dbo].[VG_HORAIL]
AS
SELECT        mov_folio, mov_fecha, MAX(mov_hora) AS HORA
FROM            dbo.movpallet
GROUP BY mov_folio, mov_fecha

GO

GO

GO
CREATE VIEW [dbo].[vg_rackdeta_2d]
AS
SELECT        dbo.rackdeta.racd_codi AS Soportante, dbo.clientes.cli_nomb AS Cliente, dbo.maeprod.mae_descr AS Producto, 
                         dbo.Usuarios.usu_nombre + N' ' + dbo.Usuarios.usu_ap AS Ultimo, dbo.VG_PERMOV.ultmov AS Fecha, dbo.rackdeta.racd_co, dbo.rackdeta.racd_ca, 
                         dbo.rackdeta.racd_ba, dbo.rackdeta.racd_pi, dbo.VG_PERMOV.HR, dbo.rackdeta.racd_unidades AS Unidades, dbo.tiposopo.tsop_descr AS TipoPallet
FROM            dbo.detarece INNER JOIN
                         dbo.rackdeta INNER JOIN
                         dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.clientes ON dbo.maeprod.mae_clirut = dbo.clientes.cli_rut ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                         dbo.tiposopo ON dbo.detarece.drec_codsopo = dbo.tiposopo.codcorto RIGHT OUTER JOIN
                         dbo.Usuarios INNER JOIN
                         dbo.VG_PERMOV ON dbo.Usuarios.usu_codigo = dbo.VG_PERMOV.mov_codper RIGHT OUTER JOIN
                         dbo.VG_HORAIL ON dbo.VG_PERMOV.mov_folio = dbo.VG_HORAIL.mov_folio AND dbo.VG_PERMOV.ultmov = dbo.VG_HORAIL.mov_fecha AND 
                         dbo.VG_PERMOV.HR = dbo.VG_HORAIL.HORA ON dbo.rackdeta.racd_codi = dbo.VG_PERMOV.mov_folio
GROUP BY dbo.rackdeta.racd_codi, dbo.clientes.cli_nomb, dbo.maeprod.mae_descr, dbo.Usuarios.usu_nombre + N' ' + dbo.Usuarios.usu_ap, dbo.Usuarios.usu_ap, 
                         dbo.VG_PERMOV.ultmov, dbo.rackdeta.racd_co, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_pi, dbo.VG_PERMOV.HR, 
                         dbo.rackdeta.racd_unidades, dbo.tiposopo.tsop_descr

GO

GO

GO
CREATE VIEW [dbo].[Qry_suma_de_pallet_detadespa]
AS
SELECT     ddes_codrece, SUM(ddes_unidades) AS Unidades
FROM         dbo.detadespa
WHERE     (ddes_codvig = 0)
GROUP BY ddes_codrece

GO

GO

GO
CREATE VIEW [dbo].[Qry_Unidades_Recepcionadas_Despachadas]
AS
SELECT     dbo.detarece.drec_codi AS Pallet, dbo.detarece.drec_unidades AS Und_Recep, dbo.Qry_suma_de_pallet_detadespa.Unidades, 
                      dbo.clientes.cli_nomb
FROM         dbo.detarece INNER JOIN
                      dbo.Qry_suma_de_pallet_detadespa ON dbo.detarece.drec_codi = dbo.Qry_suma_de_pallet_detadespa.ddes_codrece AND 
                      dbo.detarece.drec_unidades <> dbo.Qry_suma_de_pallet_detadespa.Unidades AND 
                      dbo.detarece.drec_unidades < dbo.Qry_suma_de_pallet_detadespa.Unidades INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_Tarifa_ClientesOK2]
AS
SELECT     TOP 100 PERCENT dbo.ESCALASERV.ESCCONTR, dbo.ESCALASERV.ESCSERV, dbo.TRAMO.TRAMCOD, dbo.TRAMO.ESCCOD, 
                      dbo.TRAMO.TRAMNOMB, dbo.TRAMO.TRAMDESDE, dbo.TRAMO.TRAMHASTA, dbo.TRAMO.TRAMVAL, dbo.ESCALASERV.TOTTRAMAS
FROM         dbo.ESCALASERV INNER JOIN
                      dbo.TRAMO ON dbo.ESCALASERV.ESCCOD = dbo.TRAMO.ESCCOD
ORDER BY dbo.ESCALASERV.ESCCONTR, dbo.ESCALASERV.ESCSERV, dbo.ESCALASERV.ESCCOD, dbo.TRAMO.TRAMCOD

GO

GO

GO
CREATE VIEW [dbo].[Qry_Tarifa_ClientesOK3]
AS
SELECT     dbo.Qry_Tarifa_Clientesok.TAR_RUT, dbo.Qry_Tarifa_Clientesok.TAR_NOMBRE, dbo.Qry_Tarifa_Clientesok.TAR_CODCONT, 
                      dbo.Qry_Tarifa_Clientesok.TAR_CONTRATO, dbo.Qry_Tarifa_Clientesok.TAR_CODSERV, dbo.Qry_Tarifa_Clientesok.TAR_SERVICIO, 
                      dbo.Qry_Tarifa_Clientesok.TAR_VALOR, dbo.Qry_Tarifa_Clientesok.TAR_MONEDA, dbo.Qry_Tarifa_Clientesok.TAR_MONVALOR, 
                      dbo.Qry_Tarifa_Clientesok.TAR_DTRAMO1, dbo.Qry_Tarifa_Clientesok.TAR_HTRAMO1, dbo.Qry_Tarifa_Clientesok.TAR_VALOR1, 
                      dbo.Qry_Tarifa_Clientesok.TAR_DTRAMO2, dbo.Qry_Tarifa_Clientesok.TAR_HTRAMO2, dbo.Qry_Tarifa_Clientesok.TAR_VALOR2, 
                      dbo.Qry_Tarifa_Clientesok.TAR_DTRAMO3, dbo.Qry_Tarifa_Clientesok.TAR_HTRAMO3, dbo.Qry_Tarifa_Clientesok.TAR_VALOR3, 
                      dbo.Qry_Tarifa_Clientesok.TAR_DTRAMO4, dbo.Qry_Tarifa_Clientesok.TAR_HTRAMO4, dbo.Qry_Tarifa_Clientesok.TAR_VALOR4, 
                      dbo.Qry_Tarifa_Clientesok.TAR_MEDIDA, dbo.Qry_Tarifa_Clientesok.TAR_ESCALA, dbo.Qry_Tarifa_ClientesOK2.TRAMNOMB, 
                      dbo.Qry_Tarifa_ClientesOK2.TRAMDESDE, dbo.Qry_Tarifa_ClientesOK2.TRAMHASTA, dbo.Qry_Tarifa_ClientesOK2.TRAMVAL
FROM         dbo.Qry_Tarifa_Clientesok LEFT OUTER JOIN
                      dbo.Qry_Tarifa_ClientesOK2 ON dbo.Qry_Tarifa_Clientesok.TAR_CODSERV = dbo.Qry_Tarifa_ClientesOK2.ESCSERV AND 
                      dbo.Qry_Tarifa_Clientesok.TAR_CODCONT = dbo.Qry_Tarifa_ClientesOK2.ESCCONTR

GO

GO

GO
CREATE VIEW [dbo].[VG_PARAFOTO]
AS
SELECT        dbo.vg_rackdeta_2d.Soportante AS cantidad, dbo.vg_rackdeta_2d.TipoPallet, dbo.vg_rackdeta_2d.racd_ca, dbo.vg_rackdeta_2d.racd_co, 
                         dbo.vg_rackdeta_2d.racd_ba, dbo.vg_rackdeta_2d.racd_pi, dbo.CamaraMantenedor.Cordenada
FROM            dbo.vg_rackdeta_2d LEFT OUTER JOIN
                         dbo.CamaraMantenedor ON dbo.vg_rackdeta_2d.racd_ca = dbo.CamaraMantenedor.Camara AND dbo.vg_rackdeta_2d.racd_ba = dbo.CamaraMantenedor.Banda AND 
                         dbo.vg_rackdeta_2d.racd_co = dbo.CamaraMantenedor.Columna
GROUP BY dbo.vg_rackdeta_2d.TipoPallet, dbo.vg_rackdeta_2d.racd_ca, dbo.vg_rackdeta_2d.racd_co, dbo.vg_rackdeta_2d.racd_ba, dbo.vg_rackdeta_2d.racd_pi, 
                         dbo.CamaraMantenedor.Cordenada, dbo.vg_rackdeta_2d.Soportante
HAVING        (dbo.vg_rackdeta_2d.Soportante IS NOT NULL)

GO

GO

GO
CREATE VIEW [dbo].[vwcajaspedidas]
AS
SELECT pc_numpal,SUM(pc_ncaja) as cajas,pc_rutclie,pc_codped 
FROM pedcaja WHERE pc_estado=1 or pc_estado=2
GROUP BY pc_numpal,pc_rutclie,pc_codped

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_STOCK_DETALLERGP]
AS
SELECT        dbo.detarece.drec_rutcli AS RUTCLIENTE, dbo.detarece.drec_contcli AS CONTRATO, dbo.rackdeta.racd_codi AS PALLET, dbo.detarece.drec_codpro AS CODIGO, 
                         dbo.maeprod.mae_codcli AS CODIGOCLIENTE, dbo.maeprod.mae_descr AS DESCRIPCION, dbo.rackdeta.racd_unidades AS TOT_UNIDADES, 
                         ROUND(dbo.rackdeta.racd_peso, 2) AS TOT_KILOS, FORMAT(CONVERT(DATE, CAST(dbo.detarece.drec_fecprod AS VARCHAR(10))), 'dd/MM/yyyy') AS FECHAPROD, 
                         FORMAT(CONVERT(DATE, CAST(dbo.detarece.drec_fecrec AS VARCHAR(10))), 'dd/MM/yyyy') AS FECHARECE, dbo.rackdeta.FechaVencimiento, CONVERT(varchar, 
                         CONVERT(datetime, CONVERT(datetime, CONVERT(date, dbo.detarece.FechaVencimiento), 105)), 111) AS FechaVencimiento2, DATEDIFF(DD, GETDATE(), 
                         CONVERT(date, dbo.detarece.FechaVencimiento)) AS DIAS_VENCIMIENTO, dbo.detarece.drec_sopocli AS PALLETCLIENTE, dbo.detarece.drec_codsag AS RCPSAG, 
                         dbo.rackdeta.racd_ca AS CA, dbo.rackdeta.racd_ba AS BA, dbo.rackdeta.racd_co AS CO, dbo.rackdeta.racd_pi AS PI, dbo.rackdeta.racd_ni AS NI, 
                         dbo.rackdeta.racd_estado AS ESTADO, dbo.RACKDETA_ESTADO.DESCRIPCION AS ESTADODESC, dbo.clientes.cli_nomb, dbo.tipoenv.tenv_descr AS envase, 
                         dbo.clientes.cli_mail, dbo.clientes.Mail2, dbo.rackdeta.LoteCliente, dbo.contrato.cont_descr AS DESCCONT, dbo.detarece.Estpallet AS CALIDAD, 
                         dbo.rackdeta.racd_pedi AS CAJAS_PEDIDAS, dbo.fichrece.frec_tipoalmacenamiento AS ALMACENAMIENTO, dbo.fichrece.frec_guiades AS GUIA, 
                         dbo.fichrece.frec_codi, dbo.rackdeta.racd_webusu
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.RACKDETA_ESTADO ON dbo.rackdeta.racd_estado = dbo.RACKDETA_ESTADO.CODIGO INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                         dbo.contrato ON dbo.detarece.drec_contcli = dbo.contrato.cont_codi INNER JOIN
                         dbo.fichrece ON dbo.fichrece.frec_codi = LEFT(dbo.rackdeta.racd_codi, 7)
WHERE        (dbo.detarece.drec_codvig = '0')

GO

GO

GO
CREATE VIEW [dbo].[VW_PEDIDO_PALLET]
AS
SELECT        dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_KILOS / dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_UNIDADES AS Kilosunit, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_KILOS / dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_UNIDADES * ISNULL(dbo.vwcajaspedidas.cajas, 0) 
                         AS KilosPed, dbo.QRY_PRECISA_STOCK_DETALLERGP.RUTCLIENTE, dbo.QRY_PRECISA_STOCK_DETALLERGP.CONTRATO, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET, dbo.QRY_PRECISA_STOCK_DETALLERGP.CODIGO, dbo.QRY_PRECISA_STOCK_DETALLERGP.CODIGOCLIENTE, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.DESCRIPCION, dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_UNIDADES - ISNULL(dbo.vwcajaspedidas.cajas, 0) 
                         AS totpedidos, dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_UNIDADES - ISNULL(dbo.vwcajaspedidas.cajas, 0) - ISNULL
                             ((SELECT        SUM(dbo.Pedidos_detalle.cajas) AS CAJAS_PEDIDAS_SUM
                                 FROM            dbo.Pedidos_detalle INNER JOIN
                                                          dbo.Pedidos_ficha ON dbo.Pedidos_detalle.pedido = dbo.Pedidos_ficha.pedido
                                 WHERE        (dbo.Pedidos_detalle.pallet = dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET) AND (dbo.Pedidos_ficha.terminado <> '3')), 0) AS saldopedido, 
                         (CASE WHEN ESTADO = '1' THEN '' + CAJAS_PEDIDAS + '' ELSE '0' END) AS CAJAS_PEDIDAS, dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_UNIDADES, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.TOT_KILOS, dbo.QRY_PRECISA_STOCK_DETALLERGP.FECHAPROD, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.FECHARECE, dbo.QRY_PRECISA_STOCK_DETALLERGP.FechaVencimiento, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.FechaVencimiento2, dbo.QRY_PRECISA_STOCK_DETALLERGP.DIAS_VENCIMIENTO, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLETCLIENTE, dbo.QRY_PRECISA_STOCK_DETALLERGP.RCPSAG, dbo.QRY_PRECISA_STOCK_DETALLERGP.CA, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.BA, dbo.QRY_PRECISA_STOCK_DETALLERGP.CO, dbo.QRY_PRECISA_STOCK_DETALLERGP.PI, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.NI, dbo.QRY_PRECISA_STOCK_DETALLERGP.ESTADO, dbo.QRY_PRECISA_STOCK_DETALLERGP.ESTADODESC, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.cli_nomb, dbo.QRY_PRECISA_STOCK_DETALLERGP.envase, dbo.QRY_PRECISA_STOCK_DETALLERGP.cli_mail, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.Mail2, dbo.QRY_PRECISA_STOCK_DETALLERGP.LoteCliente, dbo.QRY_PRECISA_STOCK_DETALLERGP.DESCCONT,
                             (SELECT        CASE (MAX(fechora_ingreso)) WHEN '' THEN 'O' ELSE 'X' END AS Expr1
                               FROM            dbo.tuneles
                               WHERE        (SUBSTRING(frec_codi, 11, 9) = dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET)) AS ing_tunel,
                             (SELECT        MAX(fechora_salida) AS Expr1
                               FROM            dbo.tuneles AS tuneles_3
                               WHERE        (SUBSTRING(frec_codi, 11, 9) = dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET)) AS fec_sal, GETDATE() AS hoy, DATEDIFF(hh,
                             (SELECT        MAX(fechora_salida) AS Expr1
                               FROM            dbo.tuneles AS tuneles_2
                               WHERE        (SUBSTRING(frec_codi, 11, 9) = dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET)), GETDATE()) AS diff,
                             (SELECT DISTINCT cli_hrs_homog
                               FROM            dbo.clientes
                               WHERE        (cli_rut = '763285790')) AS hrs_homog,
                             (SELECT DISTINCT cli_hrs_homog
                               FROM            dbo.clientes AS clientes_1
                               WHERE        (cli_rut = '763285790')) - DATEDIFF(hh,
                             (SELECT        MAX(fechora_salida) AS Expr1
                               FROM            dbo.tuneles AS tuneles_1
                               WHERE        (SUBSTRING(frec_codi, 11, 9) = dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET)), GETDATE()) AS restante,
                             (SELECT        CASE frec_RecepTunel WHEN 2 THEN 'SI' ELSE 'NO' END AS Expr1
                               FROM            dbo.fichrece
                               WHERE        (frec_codi = SUBSTRING(dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET, 1, 7))) AS ir_a_tunel,
                             (SELECT        CASE WHEN MAX(mov_folio) IS NULL THEN 'NO' ELSE 'SI' END AS Expr1
                               FROM            dbo.movpallet
                               WHERE        (dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET = mov_folio) AND (mov_ca IN (61, 62))) AS ingreso_tunel, 
                         dbo.QRY_PRECISA_STOCK_DETALLERGP.CALIDAD, dbo.QRY_PRECISA_STOCK_DETALLERGP.ALMACENAMIENTO
FROM            dbo.QRY_PRECISA_STOCK_DETALLERGP LEFT OUTER JOIN
                         dbo.vwcajaspedidas ON dbo.QRY_PRECISA_STOCK_DETALLERGP.PALLET = dbo.vwcajaspedidas.pc_numpal AND 
                         dbo.vwcajaspedidas.pc_rutclie = '763285790'
WHERE        (dbo.QRY_PRECISA_STOCK_DETALLERGP.RUTCLIENTE = '763285790') AND (dbo.QRY_PRECISA_STOCK_DETALLERGP.CODIGO = '9000189')

GO

GO

GO
CREATE VIEW [dbo].[vwcajasporpedir]
AS
SELECT pc_numpal,SUM(pc_ncaja) as cajasp,pc_rutclie FROM pedcaja WHERE pc_estado=0
GROUP BY pc_numpal,pc_rutclie
GO

GO

GO
CREATE VIEW [dbo].[vwestadopedguia]
AS
SELECT        dbo.fichrece.frec_codi, dbo.fichrece.frec_fecrec, dbo.fichrece.frec_guiades, dbo.fichrece.frec_rutcli, SUM(dbo.rackdeta.racd_unidades) AS unidades, SUM(1) 
                         AS Soportantes, SUM(dbo.detarece.drec_peso) AS FREC_TOTPESO, SUM(ISNULL(dbo.vwcajaspedidas.cajas, 0)) AS cpedidas, dbo.fichrece.frec_contcli, 
                         dbo.rackdeta.racd_estado, CASE WHEN (SUM(isnull(cajasp, 0)) = 0 AND racd_estado = 1) THEN SUM(isnull(racd_unidades, 0)) - SUM(isnull(cajas, 0)) 
                         WHEN (SUM(isnull(cajasp, 0)) > 0 AND racd_estado = 1) THEN SUM(isnull(cajasp, 0)) ELSE 0 END AS cajassel
FROM            dbo.fichrece INNER JOIN
                         dbo.detarece INNER JOIN
                         dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi ON LEFT(dbo.detarece.drec_codi, LEN(dbo.detarece.drec_codi) - 2) 
                         = dbo.fichrece.frec_codi LEFT OUTER JOIN
                         dbo.vwcajaspedidas ON dbo.rackdeta.racd_codi = dbo.vwcajaspedidas.pc_numpal LEFT OUTER JOIN
                         dbo.vwcajasporpedir ON dbo.rackdeta.racd_codi = dbo.vwcajasporpedir.pc_numpal
WHERE        (dbo.fichrece.frec_codvig = 0) AND (dbo.rackdeta.racd_estado <> '5')
GROUP BY dbo.fichrece.frec_guiades, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_codi, dbo.fichrece.frec_fecrec, dbo.rackdeta.racd_estado, dbo.fichrece.frec_contcli

GO

GO

GO
CREATE VIEW [dbo].[Qry_detarrece_a_fichrece]
AS
SELECT     LEFT(drec_codi, 7) AS Recepcion, SUM(drec_unidades) AS Unidades, SUM(drec_peso) AS Peso, drec_codvig
FROM         dbo.detarece
GROUP BY LEFT(drec_codi, 7), drec_codvig
HAVING      (drec_codvig = N'0')

GO

GO

GO
CREATE VIEW [dbo].[Qry_dtadespa_ a_fichdespa]
AS
SELECT     dbo.fichrece.frec_codi, dbo.fichrece.frec_totunidad, dbo.Qry_detarrece_a_fichrece.Unidades, dbo.fichrece.frec_totpeso, 
                      dbo.Qry_detarrece_a_fichrece.Peso
FROM         dbo.fichrece INNER JOIN
                      dbo.Qry_detarrece_a_fichrece ON dbo.fichrece.frec_codi = dbo.Qry_detarrece_a_fichrece.Recepcion AND 
                      dbo.fichrece.frec_totunidad <> dbo.Qry_detarrece_a_fichrece.Unidades

GO

GO

GO
CREATE VIEW [dbo].[Qry_Diferencias_en_Recepciones]
AS
SELECT     TOP 100 PERCENT dbo.Qry_detarrece_a_fichrece.Recepcion, dbo.Qry_detarrece_a_fichrece.Unidades, dbo.fichrece.frec_totunidad, 
                      dbo.Qry_detarrece_a_fichrece.Peso, dbo.fichrece.frec_totpeso, dbo.clientes.cli_nomb, dbo.fichrece.frec_fecrec
FROM         dbo.Qry_detarrece_a_fichrece INNER JOIN
                      dbo.fichrece ON dbo.Qry_detarrece_a_fichrece.Recepcion = dbo.fichrece.frec_codi AND 
                      dbo.Qry_detarrece_a_fichrece.Unidades <> dbo.fichrece.frec_totunidad INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
ORDER BY dbo.Qry_detarrece_a_fichrece.Recepcion DESC

GO

GO

GO
CREATE VIEW [dbo].[VIEW_STOCK_ANDREW]
AS
SELECT     TOP (100) PERCENT dbo.DetaReceCajas.caj_Pcod AS PALET, dbo.DetaReceCajas.caj_cod AS CAJA, dbo.DetaReceCajas.caj_Calidad AS CALIDAD, 
                      dbo.DetaReceCajas.caj_Calibre AS CALIBRE, dbo.DetaReceCajas.caj_felab AS FELAV, dbo.DetaReceCajas.caj_fvenc AS FVEN, 
                      dbo.DetaReceCajas.caj_unid AS UNIDAD, dbo.DetaReceCajas.caj_Kg AS KG, dbo.DetaReceCajas.caj_ped AS ESTADO
FROM         dbo.DetaReceCajas INNER JOIN
                      dbo.rackdeta ON dbo.rackdeta.racd_codi = dbo.DetaReceCajas.caj_Pcod INNER JOIN
                      dbo.detarece ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '967831506') AND (dbo.DetaReceCajas.caj_ped <> 3)
ORDER BY CAJA

GO

GO

GO
CREATE VIEW [dbo].[VIEW_SINPALET]
AS
SELECT DISTINCT TOP (100) PERCENT CAJA, CALIBRE, FELAV, FVEN, UNIDAD, KG, ESTADO
FROM         dbo.VIEW_STOCK_ANDREW
ORDER BY CAJA

GO

GO

GO
CREATE VIEW [dbo].[Qry_detadespa_a_fichdespa2]
AS
SELECT     TOP 100 PERCENT LEFT(ddes_codrece, 7) AS despacho, SUM(ddes_unidades) AS unidades, SUM(ddes_peso) AS peso, SUM(ddes_pallet) AS dpallet, 
                      ddes_rutcli
FROM         dbo.detadespa
WHERE     (ddes_codvig = 0)
GROUP BY LEFT(ddes_codrece, 7), ddes_rutcli
ORDER BY LEFT(ddes_codrece, 7) DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_compara_detadespa_con_fichdespa]
AS
SELECT     dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_totunidad, dbo.fichdespa.fdes_totpeso, dbo.Qry_detadespa_a_fichdespa2.unidades, 
                      dbo.Qry_detadespa_a_fichdespa2.peso
FROM         dbo.fichdespa INNER JOIN
                      dbo.Qry_detadespa_a_fichdespa2 ON dbo.fichdespa.fdes_codi = dbo.Qry_detadespa_a_fichdespa2.despacho AND 
                      dbo.Qry_detadespa_a_fichdespa2.peso - dbo.fichdespa.fdes_totpeso > 1

GO

GO

GO
CREATE VIEW [dbo].[Qry_diferencias_de_unidades]
AS
SELECT     TOP 100 PERCENT dbo.Qry_detadespa_a_fichdespa2.unidades AS Dunidades, dbo.fichrece.frec_totunidad, 
                      dbo.Qry_detadespa_a_fichdespa2.peso AS Dpeso, dbo.fichrece.frec_totpeso, dbo.Qry_detadespa_a_fichdespa2.dpallet, 
                      dbo.Qry_detadespa_a_fichdespa2.despacho AS ddespacho, dbo.fichrece.frec_totsopo, 
                      dbo.fichrece.frec_totpeso - dbo.Qry_detadespa_a_fichdespa2.peso AS diferencia, dbo.clientes.cli_nomb
FROM         dbo.Qry_detadespa_a_fichdespa2 INNER JOIN
                      dbo.fichrece ON dbo.Qry_detadespa_a_fichdespa2.despacho = dbo.fichrece.frec_codi AND 
                      dbo.Qry_detadespa_a_fichdespa2.peso <> dbo.fichrece.frec_totpeso INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.fichrece.frec_rutcli = '825570004') AND (dbo.fichrece.frec_totpeso - dbo.Qry_detadespa_a_fichdespa2.peso > 1)
ORDER BY dbo.Qry_detadespa_a_fichdespa2.despacho

GO

GO

GO
CREATE VIEW [dbo].[VG_DETALLE_TOTES_BINS]
AS
SELECT        dbo.rackdeta.racd_codi, dbo.detarece.drec_tipo AS Expr1, dbo.detarece.*, dbo.detarece.drec_codsopo AS Expr2, dbo.clientes.cli_nomb, dbo.rackdeta.racd_ca, 
                         dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE        (dbo.detarece.drec_codsopo = N'5') OR
                         (dbo.detarece.drec_codsopo = N'3') OR
                         (dbo.detarece.drec_codsopo = N'4') OR
                         (dbo.detarece.drec_codsopo = N'10')

GO

GO

GO
CREATE VIEW [dbo].[VG_COUNT_AUTOSOPORTANTES]
AS
SELECT        COUNT(*) AS TOTAL
FROM            dbo.VG_DETALLE_TOTES_BINS

GO

GO

GO
CREATE VIEW [dbo].[VG_DETALLE_AUTOSOPORTANTE]
AS
SELECT        dbo.VG_DETALLE_TOTES_BINS.racd_codi AS PALLET, dbo.clientes.cli_nomb AS CLIENTE, dbo.tiposopo.tsop_descr AS SOPORTANTE, 
                         dbo.VG_DETALLE_TOTES_BINS.drec_camara AS CA, dbo.VG_DETALLE_TOTES_BINS.racd_ba AS BA, dbo.VG_DETALLE_TOTES_BINS.racd_co AS CO, 
                         dbo.VG_DETALLE_TOTES_BINS.racd_pi AS PI, dbo.VG_DETALLE_TOTES_BINS.racd_ni AS NI
FROM            dbo.VG_DETALLE_TOTES_BINS INNER JOIN
                         dbo.clientes ON dbo.VG_DETALLE_TOTES_BINS.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.tiposopo ON dbo.VG_DETALLE_TOTES_BINS.drec_codsopo = dbo.tiposopo.codcorto

GO

GO

GO
CREATE VIEW [dbo].[VFAC_TUNEL_CLI]
AS
SELECT        frec_unica, frec_codi, frec_rutcli, frec_rutproductor, frec_contcli, frec_horalleg, frec_horarec, frec_horater, frec_turnrec, frec_fecproc, frec_fecrec, frec_fecter, 
                         frec_guiades, frec_tipentr, frec_totsopo, frec_totunidad, frec_totpeso, frec_temppro, frec_rutcond, frec_observ, frec_tipdesc, frec_codienca, frec_origen, frec_codvig, 
                         frec_radio, frec_tipo, frec_RecepTunel, frec_AspectoSanitario, frec_CondGeneral, frec_procedencia, frec_paso, frec_antecamara, frec_numSello, frec_termografo, 
                         frec_tiporecepcion, frec_observ2, frec_tipoalmacenamiento, frec_contenedor, frec_patente, frec_almac, frec_empresa, frec_olores, frec_higiene, frec_estiba, 
                         frec_daado, frec_TS, frec_TM, frec_TI, frec_clfol, frec_Enviada, frec_tablet, frec_traq, frec_emis, frec_packinglist
FROM            dbo.fichrece
WHERE        (frec_RecepTunel = 2) AND (CONVERT(DATETIME, frec_fecrec, 120) BETWEEN N'01-01-2015' AND N'21-10-2015')

GO

GO

GO
CREATE VIEW [dbo].[VFAC_TON_PORCLIENTE]
AS
SELECT        frec_rutcli, SUM(frec_totpeso) AS TONE, MONTH(CONVERT(DATE, frec_fecrec)) AS Expr1
FROM            dbo.VFAC_TUNEL_CLI
GROUP BY frec_rutcli, frec_fecrec

GO

GO

GO
CREATE VIEW [dbo].[VISTA_SI_PEDIR]
AS
SELECT     dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.DetaReceCajas.caj_codenca, dbo.DetaReceCajas.caj_Est, dbo.DetaReceCajas.caj_TipError, 
                      dbo.DetaReceCajas.caj_ped, dbo.DetaReceCajas.caj_fecha, dbo.DetaReceCajas.caj_Calidad, dbo.DetaReceCajas.caj_Calibre, dbo.DetaReceCajas.caj_felab, 
                      dbo.DetaReceCajas.caj_fvenc, dbo.DetaReceCajas.caj_unid, dbo.DetaReceCajas.caj_Kg, dbo.DetaReceCajas.caj_libras, dbo.DetaReceCajas.caj_producto, 
                      dbo.DetaReceCajas.caj_Id, dbo.DetaReceCajas.caj_lote, dbo.DetaReceCajas.caj_maquilador, dbo.detapedcaja.dpc_estado
FROM         dbo.DetaReceCajas INNER JOIN
                      dbo.rackdeta ON dbo.rackdeta.racd_codi = dbo.DetaReceCajas.caj_Pcod INNER JOIN
                      dbo.detarece ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi FULL OUTER JOIN
                      dbo.detapedcaja ON dbo.DetaReceCajas.caj_cod = dbo.detapedcaja.dpc_codcaja
WHERE     (dbo.DetaReceCajas.caj_ped = 0) AND (dbo.detapedcaja.dpc_estado IS NULL)

GO

GO

GO
CREATE VIEW [dbo].[VISTA_STOCK_PEDIR]
AS
SELECT     dbo.detarece.drec_rutcli, MAX(dbo.VISTA_SI_PEDIR.caj_Pcod) AS Pallet, dbo.VISTA_SI_PEDIR.caj_cod, dbo.VISTA_SI_PEDIR.caj_ped, 
                      dbo.VISTA_SI_PEDIR.caj_Calidad, dbo.VISTA_SI_PEDIR.caj_Calibre, dbo.VISTA_SI_PEDIR.caj_felab, dbo.VISTA_SI_PEDIR.caj_fvenc, dbo.VISTA_SI_PEDIR.caj_unid, 
                      dbo.VISTA_SI_PEDIR.caj_Kg
FROM         dbo.DetaReceCajas INNER JOIN
                      dbo.rackdeta ON dbo.rackdeta.racd_codi = dbo.DetaReceCajas.caj_Pcod INNER JOIN
                      dbo.detarece ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi RIGHT OUTER JOIN
                      dbo.VISTA_SI_PEDIR ON dbo.DetaReceCajas.caj_Pcod = dbo.VISTA_SI_PEDIR.caj_Pcod AND dbo.DetaReceCajas.caj_cod = dbo.VISTA_SI_PEDIR.caj_cod
GROUP BY dbo.detarece.drec_rutcli, dbo.VISTA_SI_PEDIR.caj_cod, dbo.VISTA_SI_PEDIR.caj_ped, dbo.VISTA_SI_PEDIR.caj_Calidad, dbo.VISTA_SI_PEDIR.caj_Calibre, 
                      dbo.VISTA_SI_PEDIR.caj_felab, dbo.VISTA_SI_PEDIR.caj_fvenc, dbo.VISTA_SI_PEDIR.caj_unid, dbo.VISTA_SI_PEDIR.caj_Kg

GO

GO

GO
CREATE VIEW [dbo].[ss]
AS
SELECT     drec_rutcli, MAX(Pallet) AS pallet, caj_cod, caj_ped
FROM         dbo.VISTA_STOCK_PEDIR
GROUP BY drec_rutcli, caj_cod, caj_ped

GO

GO

GO
CREATE VIEW [dbo].[REPORTE_HORA_DIF]
AS
SELECT        dbo.Pedidos_ficha.Orden, MIN(DISTINCT dbo.Pedido_Est.fecha_reg) AS Fecha, GETDATE() AS HOY, dbo.Pedidos_ficha.fechaTermino
FROM            dbo.Pedido_Est INNER JOIN
                         dbo.Pedidos_detalle ON dbo.Pedido_Est.pallet = dbo.Pedidos_detalle.pallet INNER JOIN
                         dbo.Pedidos_ficha ON dbo.Pedidos_detalle.pedido = dbo.Pedidos_ficha.pedido
GROUP BY dbo.Pedidos_ficha.Orden, dbo.Pedidos_ficha.terminado, dbo.Pedidos_ficha.fechaTermino
HAVING        (dbo.Pedidos_ficha.fechaTermino IS NOT NULL)

GO

GO

GO
CREATE VIEW [dbo].[VG_REPORTE_HORAS_TRABAJADAS]
AS
SELECT        Orden, Fecha, fechaTermino, CONVERT(varchar(5), DATEADD(minute, DATEDIFF(minute, Fecha, fechaTermino), 0), 108) AS DIFF
FROM            dbo.REPORTE_HORA_DIF

GO

GO

GO
CREATE VIEW [dbo].[PR_PEDIDOSPALLET]
AS
SELECT        pedido, COUNT(pallet) AS SOP
FROM            dbo.Pedidos_detalle
GROUP BY pedido

GO

GO

GO
CREATE VIEW [dbo].[PR_REPORTE_HORATRABAJADA]
AS
SELECT        dbo.Pedidos_ficha.Orden AS PEDIDO, dbo.clientes.cli_nomb AS CLIENTE, dbo.Pedidos_ficha.fechapedido AS [FECHA PEDIDO], 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.Fecha AS INICIO, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino AS TERMINO, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF AS [HRS PREP.], CONVERT(varchar(5), DATEADD(minute, DATEDIFF(minute, dbo.Pedidos_ficha.fechapedido, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino), 0), 108) AS [HRS PEDIDO], Pedidos_ficha_1.Encargado, dbo.PR_PEDIDOSPALLET.SOP, CONVERT(int, 
                         SUBSTRING(dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF, 4, 2), 102) + CONVERT(int, SUBSTRING(dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF, 0, 3), 102) 
                         * 60 AS MP
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut INNER JOIN
                         dbo.Pedidos_ficha AS Pedidos_ficha_1 ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = Pedidos_ficha_1.Orden INNER JOIN
                         dbo.PR_PEDIDOSPALLET ON dbo.Pedidos_ficha.pedido = dbo.PR_PEDIDOSPALLET.pedido
WHERE        (CONVERT(DATE, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino) = CONVERT(DATE, GETDATE(), 105))

GO

GO

GO
CREATE VIEW [dbo].[PR_REPORTE_HORATRABAJADA2]
AS
SELECT        PEDIDO, CLIENTE, [FECHA PEDIDO], INICIO, TERMINO, [HRS PREP.], [HRS PEDIDO], Encargado, SOP, MP, CAST(ROUND(MP * 1.00 / SOP, 2) AS FLOAT) 
                         AS [S/M]
FROM            dbo.PR_REPORTE_HORATRABAJADA

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V4222]
AS
SELECT     dbo.maeprod.mae_clirut AS RutClien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.rackdeta.racd_peso AS PESO, dbo.rackdeta.racd_codpro AS CODIGO, 
                      dbo.rackdeta.racd_unidades AS CANTIDAD, dbo.detarece.drec_fecprod AS FECPRO, dbo.rackdeta.racd_codi AS FRIGORI, 
                      dbo.detarece.drec_fecrec AS FECREC, dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.detarece.drec_contcli, dbo.detarece.drec_RecepTunel,
                       dbo.detarece.drec_ProcTunel, dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, 
                      dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, 
                      dbo.detarece.FechaVencimiento, 105)), 111) AS FechaVencimiento2, dbo.fichrece.frec_guiades, dbo.fichrece.frec_procedencia, 
                      dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.CAJAS_DANADAS.CDAN_FECHA, dbo.CAJAS_DANADAS.CDAN_HORA, 
                      dbo.CAJAS_DANADAS.CDAN_CAJAS + ' ' + dbo.CAJAS_DANADAS.CDAN_OBSERVACION AS CDAN_OBSERVACION, 
                      dbo.CAJAS_DANADAS.CDAN_ESTADO, dbo.CAJAS_DANADAS.CDAN_LINK, DATEDIFF(hour, 
                      dbo.rackdeta.racd_pedido_fec + ' ' + dbo.rackdeta.racd_pedido_hor, GETDATE()) AS HORAS_PEDIDO
FROM         dbo.rackdeta INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.detarece.drec_codi, 7) = dbo.fichrece.frec_codi LEFT OUTER JOIN
                      dbo.CAJAS_DANADAS ON dbo.rackdeta.racd_codi = dbo.CAJAS_DANADAS.CDAN_PALLET

GO

GO

GO
CREATE VIEW [dbo].[Qry_pedidosWebok_Guia24]
AS
SELECT     TOP 100 PERCENT RutClien AS cliente, frec_guiades AS guiacliente, FECREC AS fecha, LEFT(FRIGORI, 7) AS recepcion, COUNT(FRIGORI) AS tot_pallet, 
                      SUM(PESO) AS tot_peso, SUM(CANTIDAD) AS tot_unidades, drec_contcli AS contrato, SUM(racd_solicitado) AS Tot_solicitado, SUM(CONVERT(int, 
                      racd_pedido)) AS palletsolicitados, COUNT(CDAN_OBSERVACION) AS observaciones
FROM         dbo.QRY_SOPORTANTES_V4222
WHERE     (racd_estadopallet = '0') AND (RutClien = '968873601')
GROUP BY RutClien, LEFT(FRIGORI, 7), frec_guiades, FECREC, drec_contcli
ORDER BY RutClien, frec_guiades DESC

GO

GO

GO
CREATE VIEW [dbo].[RP_SUMAHORAS]
AS
SELECT        CONVERT(varchar(5), DATEADD(minute, DATEDIFF(minute, dbo.Pedidos_ficha.fechapedido, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino), 0), 108) 
                         AS [HRS PEDIDO], dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF, dbo.informes_programa.prg_min AS MINUTOS
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut CROSS JOIN
                         dbo.informes_programa
WHERE        (CONVERT(DATE, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino) = CONVERT(DATE, GETDATE(), 105)) AND (dbo.informes_programa.prg_inf_cod = '12')

GO

GO

GO
CREATE VIEW [dbo].[MAYOR]
AS
SELECT        { fn HOUR(DIFF) } AS MAYOR
FROM            dbo.RP_SUMAHORAS
WHERE        ({ fn HOUR(DIFF) } > 0)

GO

GO

GO
CREATE VIEW [dbo].[MENOR]
AS
SELECT        { fn HOUR(DIFF) } AS MAYOR
FROM            dbo.RP_SUMAHORAS
WHERE        ({ fn HOUR(DIFF) } < 1)

GO

GO

GO
CREATE VIEW [dbo].[RP_MAYOR]
AS
SELECT        COUNT(DIFF) AS MAYOR
FROM            dbo.RP_SUMAHORAS
WHERE        ({ fn HOUR(DIFF) } > 0) OR
                         ({ fn MINUTE(DIFF) } > MINUTOS)

GO

GO

GO
CREATE VIEW [dbo].[RP_MENOR]
AS
SELECT        COUNT(DIFF) AS MENOR
FROM            dbo.RP_SUMAHORAS
WHERE        ({ fn HOUR(DIFF) } = 0) AND ({ fn MINUTE(DIFF) } <= MINUTOS)

GO

GO

GO
CREATE VIEW [dbo].[VG_CLIENTES_EN_ANDENES]
AS
SELECT        dbo.zCheckList.Cl_fol, dbo.clientes.cli_nomb, dbo.zCheckList.Cl_pate, dbo.P_MovChecklist.Mov_desc, dbo.zCheckList.Cl_chorut, dbo.choferes.cho_nombre, 
                         dbo.zCheckList.Cl_RutCli
FROM            dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.P_MovChecklist ON dbo.zCheckList.Cl_Mov = dbo.P_MovChecklist.mov_codi INNER JOIN
                         dbo.choferes ON dbo.zCheckList.Cl_chorut = dbo.choferes.cho_rut
WHERE        (dbo.zCheckList.Cl_EstPor = '1')
GROUP BY dbo.zCheckList.Cl_fol, dbo.clientes.cli_nomb, dbo.zCheckList.Cl_pate, dbo.P_MovChecklist.Mov_desc, dbo.zCheckList.Cl_chorut, dbo.choferes.cho_nombre, 
                         dbo.zCheckList.Cl_RutCli

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES_GRILLA]
AS
SELECT        dbo.VG_CLIENTES_EN_ANDENES.Cl_RutCli, dbo.VG_CLIENTES_EN_ANDENES.cli_nomb, dbo.VG_CLIENTES_EN_ANDENES.cho_nombre, 
                         dbo.VG_CLIENTES_EN_ANDENES.Cl_chorut, dbo.VG_CLIENTES_EN_ANDENES.Cl_fol, dbo.AndenesReg.Anden, COUNT(dbo.VG_CLIENTES_EN_ANDENES.Cl_fol) 
                         AS summov
FROM            dbo.VG_CLIENTES_EN_ANDENES LEFT OUTER JOIN
                         dbo.AndenesReg ON dbo.VG_CLIENTES_EN_ANDENES.Cl_fol = dbo.AndenesReg.Folio
GROUP BY dbo.VG_CLIENTES_EN_ANDENES.Cl_RutCli, dbo.VG_CLIENTES_EN_ANDENES.cli_nomb, dbo.VG_CLIENTES_EN_ANDENES.cho_nombre, 
                         dbo.VG_CLIENTES_EN_ANDENES.Cl_chorut, dbo.VG_CLIENTES_EN_ANDENES.Cl_fol, dbo.AndenesReg.Anden
HAVING        (COUNT(dbo.VG_CLIENTES_EN_ANDENES.Cl_fol) < 2)

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V4223]
AS
SELECT     dbo.maeprod.mae_clirut AS RutClien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.rackdeta.racd_peso AS PESO, dbo.rackdeta.racd_codpro AS CODIGO, 
                      dbo.rackdeta.racd_unidades AS CANTIDAD, dbo.detarece.drec_fecprod AS FECPRO, dbo.rackdeta.racd_codi AS FRIGORI, 
                      dbo.detarece.drec_fecrec AS FECREC, dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.detarece.drec_contcli, dbo.detarece.drec_RecepTunel,
                       dbo.detarece.drec_ProcTunel, dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, 
                      dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, 
                      dbo.detarece.FechaVencimiento, 105)), 111) AS FechaVencimiento2, dbo.fichrece.frec_guiades, dbo.fichrece.frec_procedencia, 
                      dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.CAJAS_DANADAS.CDAN_FECHA, dbo.CAJAS_DANADAS.CDAN_HORA, 
                      dbo.CAJAS_DANADAS.CDAN_CAJAS + ' ' + dbo.CAJAS_DANADAS.CDAN_OBSERVACION AS CDAN_OBSERVACION, 
                      dbo.CAJAS_DANADAS.CDAN_ESTADO, dbo.CAJAS_DANADAS.CDAN_LINK, DATEDIFF([hour], 
                      dbo.rackdeta.racd_pedido_fec + ' ' + dbo.rackdeta.racd_pedido_hor, GETDATE()) AS HORAS_PEDIDO, DATEDIFF(DD, GETDATE(), 
                      dbo.detarece.FechaVencimiento) AS DIAS_VENCIMIENTO, dbo.CAJAS_DANADAS.CDAN_CAJAS
FROM         dbo.rackdeta INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.detarece.drec_codi, 7) = dbo.fichrece.frec_codi LEFT OUTER JOIN
                      dbo.CAJAS_DANADAS ON dbo.rackdeta.racd_codi = dbo.CAJAS_DANADAS.CDAN_PALLET
WHERE     (dbo.rackdeta.racd_peso > 0)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLETVENCIDOS]
AS
SELECT     TOP 100 PERCENT dbo.QRY_SOPORTANTES_V4223.FRIGORI, dbo.clientes.cli_nomb, dbo.QRY_SOPORTANTES_V4223.DIAS_VENCIMIENTO, 
                      dbo.clientes.cli_rut
FROM         dbo.QRY_SOPORTANTES_V4223 INNER JOIN
                      dbo.clientes ON dbo.QRY_SOPORTANTES_V4223.RutClien = dbo.clientes.cli_rut
ORDER BY dbo.QRY_SOPORTANTES_V4223.DIAS_VENCIMIENTO

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[uno_tmp]
as
select ddes_rutcli as rut , ddes_codpro as codigo ,count(*) as total  ,sum(ddes_pallet) as palet ,sum( ddes_unidades) as Unidades,sum(ddes_peso) as peso from detadespa  group by ddes_codpro,ddes_rutcli 

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[dos_tmp]
as
select drec_rutcli as rut,drec_codpro as codigo,count(*) as cantidad ,sum(drec_pallet) as palet,sum(drec_unidades) as unidades,sum(drec_peso) as peso from detarece as a,maeprod as b where a.drec_codvig = '0' and b.mae_codi=a.drec_codpro group by a.drec_codpro, a.drec_rutcli 

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[stock_temp] as
select 
d.codigo,d.rut,
palet=
case 
when d.codigo not in (select codigo from uno_tmp where d.codigo=codigo) then max(d.palet)
when d.codigo in (select codigo from uno_tmp where d.codigo=codigo) then sum(d.palet-u.palet)
end,
unidades=
case 
when d.codigo not in (select codigo from uno_tmp where d.codigo=codigo) then max(d.unidades)
when d.codigo in (select codigo from uno_tmp where d.codigo=codigo) then sum(d.unidades-u.unidades)
end,
peso=
case 
when d.codigo not in (select codigo from uno_tmp where d.codigo=codigo) then max(d.peso)
when d.codigo in (select codigo from uno_tmp where d.codigo=codigo) then sum(d.peso-u.peso)
end




from 
uno_tmp as u,dos_tmp as d 
where 
(d.codigo=u.codigo or d.codigo not in (select codigo from uno_tmp where d.codigo=codigo)) and
(d.rut=u.rut) 
group by d.codigo,d.rut


GO

GO

GO
CREATE VIEW [dbo].[Qry_detadespa_suma_x_cliente]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_rut, dbo.clientes.cli_nomb, SUM(dbo.detadespa.ddes_unidades) AS Dunidades, SUM(dbo.detadespa.ddes_peso) 
                      AS Dpeso, SUM(dbo.detadespa.ddes_pallet) AS Dpallet
FROM         dbo.clientes INNER JOIN
                      dbo.detadespa ON dbo.clientes.cli_rut = dbo.detadespa.ddes_rutcli
WHERE     (dbo.detadespa.ddes_codvig = 0) AND (dbo.clientes.cli_estado = 'A')
GROUP BY dbo.clientes.cli_rut, dbo.clientes.cli_nomb
ORDER BY dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[Qry_detarece_suma_x_cliente]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_rut, dbo.clientes.cli_nomb, SUM(dbo.detarece.drec_unidades) AS Runidades, SUM(dbo.detarece.drec_peso) 
                      AS Rpeso, SUM(dbo.detarece.drec_pallet) AS Rpallet
FROM         dbo.detarece INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.clientes.cli_estado = 'A') AND (dbo.detarece.drec_codvig = 0)
GROUP BY dbo.clientes.cli_rut, dbo.clientes.cli_nomb
ORDER BY dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[Qry_stock_acumulado_pallet_bins]
AS
SELECT     dbo.Qry_detadespa_suma_x_cliente.cli_rut, dbo.Qry_detadespa_suma_x_cliente.cli_nomb, 
                      dbo.Qry_detarece_suma_x_cliente.Rpallet - dbo.Qry_detadespa_suma_x_cliente.Dpallet AS PALLET, 
                      dbo.Qry_detarece_suma_x_cliente.Runidades - dbo.Qry_detadespa_suma_x_cliente.Dunidades AS UNIDADES, 
                      dbo.Qry_detarece_suma_x_cliente.Rpeso - dbo.Qry_detadespa_suma_x_cliente.Dpeso AS PESO
FROM         dbo.Qry_detadespa_suma_x_cliente INNER JOIN
                      dbo.Qry_detarece_suma_x_cliente ON dbo.Qry_detadespa_suma_x_cliente.cli_rut = dbo.Qry_detarece_suma_x_cliente.cli_rut
WHERE     (dbo.Qry_detarece_suma_x_cliente.Rpallet - dbo.Qry_detadespa_suma_x_cliente.Dpallet > 0)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_STOCK_DETALLE]
AS
SELECT        dbo.detarece.drec_rutcli AS RUTCLIENTE, dbo.detarece.drec_contcli AS CONTRATO, dbo.rackdeta.racd_codi AS PALLET, dbo.detarece.drec_codpro AS CODIGO, 
                         dbo.maeprod.mae_codcli AS CODIGOCLIENTE, dbo.maeprod.mae_descr AS DESCRIPCION, dbo.rackdeta.racd_unidades AS TOT_UNIDADES, 
                         ROUND(dbo.rackdeta.racd_peso, 2) AS TOT_KILOS, dbo.detarece.drec_fecprod AS FECHAPROD, dbo.detarece.drec_fecrec AS FECHARECE, 
                         dbo.rackdeta.FechaVencimiento, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, CONVERT(date, dbo.detarece.FechaVencimiento), 105)), 111) 
                         AS FechaVencimiento2, DATEDIFF(DD, GETDATE(), CONVERT(date, dbo.detarece.FechaVencimiento)) AS DIAS_VENCIMIENTO, 
                         dbo.detarece.drec_sopocli AS PALLETCLIENTE, dbo.detarece.drec_codsag AS RCPSAG, dbo.rackdeta.racd_ca AS CA, dbo.rackdeta.racd_ba AS BA, 
                         dbo.rackdeta.racd_co AS CO, dbo.rackdeta.racd_pi AS PI, dbo.rackdeta.racd_ni AS NI, dbo.rackdeta.racd_estado AS ESTADO, 
                         dbo.RACKDETA_ESTADO.DESCRIPCION AS ESTADODESC, dbo.clientes.cli_nomb, dbo.tipoenv.tenv_descr AS envase, dbo.clientes.cli_mail, dbo.clientes.Mail2, 
                         dbo.detarece.LoteCliente, dbo.fichrece.frec_guiades, dbo.detarece.Estpallet AS CALIDAD, dbo.fichrece.frec_tipoalmacenamiento AS ALMACENAMIENTO
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.RACKDETA_ESTADO ON dbo.rackdeta.racd_estado = dbo.RACKDETA_ESTADO.CODIGO INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                         dbo.fichrece ON dbo.fichrece.frec_codi = LEFT(dbo.rackdeta.racd_codi, 7)
WHERE        (dbo.detarece.drec_codvig = '0')

GO

GO

GO
CREATE VIEW [dbo].[ok]
AS
SELECT     TOP 100 PERCENT *
FROM         dbo.QRY_PRECISA_STOCK_DETALLE
WHERE     (RUTCLIENTE = '825570004') AND (ESTADO = '1')
ORDER BY CODIGO

GO

GO

GO
CREATE VIEW [dbo].[VG_SUMPORCAM]
AS
SELECT        COUNT(Camara) AS SUM, TipoPos, Camara
FROM            dbo.CamaraMantenedor
GROUP BY TipoPos, Camara

GO

GO

GO
CREATE VIEW [dbo].[camaraparacru]
AS
SELECT        Camara, Banda, Columna, CONVERT(int, Piso) AS pisoint, TipoPos
FROM            dbo.CamaraMantenedor

GO

GO

GO
CREATE VIEW [dbo].[VG_SUMPORCAM2]
AS
SELECT        dbo.camaraparacru.Camara, COUNT(dbo.rackdeta.racd_ni) AS sumocup, dbo.camaraparacru.TipoPos
FROM            dbo.camaraparacru FULL OUTER JOIN
                         dbo.rackdeta ON dbo.camaraparacru.Camara = dbo.rackdeta.racd_ca AND dbo.camaraparacru.Banda = dbo.rackdeta.racd_ba AND 
                         dbo.camaraparacru.Columna = dbo.rackdeta.racd_co AND dbo.camaraparacru.pisoint = dbo.rackdeta.racd_pi
GROUP BY dbo.camaraparacru.Camara, dbo.camaraparacru.TipoPos
HAVING        (dbo.camaraparacru.Camara = N'03')

GO

GO

GO
CREATE VIEW [dbo].[VG_PARCIALESPOS]
AS
SELECT        dbo.VG_SUMPORCAM.Camara, dbo.VG_SUMPORCAM.TipoPos, dbo.VG_SUMPORCAM.SUM, dbo.VG_SUMPORCAM2.sumocup, 
                         dbo.VG_SUMPORCAM.SUM - dbo.VG_SUMPORCAM2.sumocup AS libre
FROM            dbo.VG_SUMPORCAM INNER JOIN
                         dbo.VG_SUMPORCAM2 ON dbo.VG_SUMPORCAM.Camara = dbo.VG_SUMPORCAM2.Camara AND 
                         dbo.VG_SUMPORCAM.TipoPos = dbo.VG_SUMPORCAM2.TipoPos
WHERE        (dbo.VG_SUMPORCAM.Camara = N'03')

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_Inventario_0]
AS

SELECT 
	racd_unidades as cantidad, 
	racd_peso as peso, 
	racd_fecpro as fechaprod, 
	racd_codi as numsopo, 
	racd_codpro as codigo 
FROM rackdeta 
UNION 
SELECT 
	slod_unidades as cantidad, 
	slod_peso*slod_unidades as peso, 
	slod_fecpro as fechaprod, 
	substring(slod_codi,6,9) as numsopo,  
	slod_codpro as codigo 
FROM slotdeta




GO

GO

GO
CREATE VIEW [dbo].[Qry_Inventario]
AS
SELECT     dbo.detarece.drec_contcli AS drec_contcli, dbo.Qry_Inventario_0.*, dbo.detarece.drec_codsag AS codsag
FROM         dbo.detarece INNER JOIN
                      dbo.Qry_Inventario_0 ON dbo.detarece.drec_codi = dbo.Qry_Inventario_0.numsopo
WHERE     (dbo.Qry_Inventario_0.numsopo >= '002000000')

GO

GO

GO
CREATE VIEW [dbo].[Qry_Soportantes_v21]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVACE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod, dbo.Qry_Inventario.numsopo, dbo.detarece.drec_contcli, dbo.maeprod.mae_codcli, dbo.Qry_Inventario.codsag, 
                      dbo.detarece.FechaVencimiento, DATEDIFF(DD, GETDATE(), dbo.detarece.FechaVencimiento) AS DIAS_VENCIMIENTO
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_Num_Soportantes]
AS
SELECT     racd_codpro, COUNT(racd_codi) AS Num_Soportantes
FROM         dbo.rackdeta
GROUP BY racd_codpro


GO

GO

GO
CREATE VIEW [dbo].[qry_inventario_resumido_ariztia]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, SUM(dbo.Qry_Inventario.cantidad) AS SumaDecantidad,
                       dbo.tipoenv.tenv_descr AS ENVACE, SUM(dbo.Qry_Inventario.peso) AS SumaDepeso, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Num_Soportantes.Num_Soportantes
FROM         dbo.Qry_Num_Soportantes RIGHT OUTER JOIN
                      dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi ON 
                      dbo.Qry_Num_Soportantes.racd_codpro = dbo.Qry_Inventario.codigo
WHERE     (dbo.maeprod.mae_clirut = '825570004')
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Num_Soportantes.Num_Soportantes
ORDER BY dbo.Qry_Inventario.codigo

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V422]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod AS FECPRO, dbo.Qry_Inventario.numsopo AS FRIGORI, dbo.detarece.drec_fecrec AS FECREC, 
                      dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.Qry_Inventario.drec_contcli, dbo.detarece.drec_RecepTunel, dbo.detarece.drec_ProcTunel, 
                      dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, 
                      dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) 
                      AS fechavencimiento2, dbo.fichrece.frec_guiades, dbo.fichrece.frec_procedencia, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_ca, 
                      dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, 
                      dbo.CAJAS_DANADAS.CDAN_FECHA, dbo.CAJAS_DANADAS.CDAN_HORA, 
                      dbo.CAJAS_DANADAS.CDAN_CAJAS + ' ' + dbo.CAJAS_DANADAS.CDAN_OBSERVACION AS CDAN_OBSERVACION, 
                      dbo.CAJAS_DANADAS.CDAN_ESTADO, dbo.CAJAS_DANADAS.CDAN_LINK
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.Qry_Inventario.numsopo, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi LEFT OUTER JOIN
                      dbo.CAJAS_DANADAS ON dbo.rackdeta.racd_codi = dbo.CAJAS_DANADAS.CDAN_PALLET
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[QRY_SOPORTANTES_V3]
AS
SELECT     TOP 100 PERCENT 
		dbo.maeprod.mae_clirut AS rutclien, 
		dbo.maeprod.mae_descr AS DESCRIP, 
		dbo.tipoenv.tenv_descr AS ENVASE, 
                      	dbo.detarece.drec_sopocli AS SOPCLI_R, 
		dbo.Qry_Inventario.peso, 
		dbo.Qry_Inventario.codigo, 
		dbo.Qry_Inventario.cantidad, 
                      	dbo.Qry_Inventario.fechaprod AS FECPRO, 
		dbo.Qry_Inventario.numsopo AS FRIGORI, 
		dbo.rackdeta.racd_ca AS CA, 
		dbo.rackdeta.racd_ba AS BS, 
                      	dbo.rackdeta.racd_co AS CO, 
		dbo.rackdeta.racd_pi AS PI, 
		dbo.rackdeta.racd_ni AS N, 
		dbo.detarece.drec_fecrec AS FECREC
FROM         dbo.rackdeta INNER JOIN
                      dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi ON dbo.rackdeta.racd_codi = dbo.Qry_Inventario.numsopo
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo



GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V4]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod AS FECPRO, dbo.Qry_Inventario.numsopo AS FRIGORI, dbo.detarece.drec_fecrec AS FECREC
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V41]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod AS FECPRO, dbo.Qry_Inventario.numsopo AS FRIGORI, dbo.detarece.drec_fecrec AS FECREC, 
                      dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.Qry_Inventario.drec_contcli, dbo.detarece.drec_RecepTunel, dbo.detarece.drec_ProcTunel, 
                      dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, 
                      dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) 
                      AS fechavencimiento2
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V42ok]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod AS FECPRO, dbo.Qry_Inventario.numsopo AS FRIGORI, dbo.detarece.drec_fecrec AS FECREC, 
                      dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.Qry_Inventario.drec_contcli, dbo.detarece.drec_RecepTunel, dbo.detarece.drec_ProcTunel, 
                      dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, 
                      dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) 
                      AS fechavencimiento2, dbo.fichrece.frec_guiades, dbo.fichrece.frec_procedencia, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_ca, 
                      dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, 
                      dbo.detarece.drec_unidades AS UnidadesOrigen, DATEDIFF(d, GETDATE(), CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 
                      105), 111)) AS Dias_Vencimiento
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.Qry_Inventario.numsopo, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V42]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod AS FECPRO, dbo.Qry_Inventario.numsopo AS FRIGORI, dbo.detarece.drec_fecrec AS FECREC, 
                      dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.Qry_Inventario.drec_contcli, dbo.detarece.drec_RecepTunel, dbo.detarece.drec_ProcTunel, 
                      dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, 
                      dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) 
                      AS fechavencimiento2, dbo.fichrece.frec_guiades, dbo.fichrece.frec_procedencia, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_ca, 
                      dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, dbo.rackdeta.racd_estadopallet, 
                      dbo.rackdeta.racd_solicitado
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.Qry_Inventario.numsopo, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V43_GUIAS]
AS
SELECT     TOP 100 PERCENT dbo.fichrece.frec_guiades, dbo.fichrece.frec_codi, dbo.detarece.drec_fecrec, dbo.Qry_Inventario.cantidad, dbo.Qry_Inventario.peso, 
                      dbo.Qry_Inventario.drec_contcli, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) 
                      AS fechavencimiento2, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.detarece.drec_RecepTunel, 
                      dbo.detarece.drec_ProcTunel, dbo.rackdeta.racd_pedido_fec, dbo.rackdeta.racd_pedido_hor
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.Qry_Inventario.numsopo, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.rackdeta.racd_pedido = 0) OR
                      (dbo.rackdeta.racd_pedido IS NULL)
ORDER BY dbo.Qry_Inventario.codigo

GO

GO

GO
CREATE VIEW [dbo].[Qry_Soportantes_v2]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVACE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod, dbo.Qry_Inventario.numsopo, dbo.detarece.drec_contcli, dbo.maeprod.mae_codcli, dbo.Qry_Inventario.codsag, 
                      dbo.detarece.FechaVencimiento
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_inventario_detallado]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, SUM(dbo.Qry_Inventario.cantidad) AS SumaDecantidad,
                       dbo.tipoenv.tenv_descr AS ENVACE, SUM(dbo.Qry_Inventario.peso) AS SumaDepeso, dbo.Qry_Inventario.codigo
FROM         dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.Qry_Inventario ON dbo.maeprod.mae_codi = dbo.Qry_Inventario.codigo
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.Qry_Inventario.codigo
ORDER BY dbo.Qry_Inventario.codigo


GO

GO

GO

CREATE VIEW [dbo].[Qry_Inventario_Detallado_2]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, SUM(dbo.Qry_Inventario.cantidad) AS SumaDecantidad,
                       dbo.tipoenv.tenv_descr AS ENVACE, SUM(dbo.Qry_Inventario.peso) AS SumaDepeso, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Inventario.drec_contcli
FROM         dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.Qry_Inventario ON dbo.maeprod.mae_codi = dbo.Qry_Inventario.codigo
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.drec_contcli
ORDER BY dbo.Qry_Inventario.codigo


GO

GO

GO

CREATE VIEW [dbo].[Qry_inventario_resumido]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, SUM(dbo.Qry_Inventario.cantidad) AS SumaDecantidad,
                       dbo.tipoenv.tenv_descr AS ENVACE, SUM(dbo.Qry_Inventario.peso) AS SumaDepeso, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Num_Soportantes.Num_Soportantes
FROM         dbo.Qry_Num_Soportantes RIGHT OUTER JOIN
                      dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi ON 
                      dbo.Qry_Num_Soportantes.racd_codpro = dbo.Qry_Inventario.codigo
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Num_Soportantes.Num_Soportantes
ORDER BY dbo.Qry_Inventario.codigo


GO

GO

GO

CREATE VIEW [dbo].[QRY_Inventario_Resumido_2]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, SUM(dbo.Qry_Inventario.cantidad) AS SumaDecantidad,
                       dbo.tipoenv.tenv_descr AS ENVACE, SUM(dbo.Qry_Inventario.peso) AS SumaDepeso, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Num_Soportantes.Num_Soportantes, dbo.Qry_Inventario.drec_contcli
FROM         dbo.Qry_Num_Soportantes RIGHT OUTER JOIN
                      dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi ON 
                      dbo.Qry_Num_Soportantes.racd_codpro = dbo.Qry_Inventario.codigo
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.Qry_Inventario.codigo, 
                      dbo.Qry_Num_Soportantes.Num_Soportantes, dbo.Qry_Inventario.drec_contcli
ORDER BY dbo.Qry_Inventario.codigo


GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V411]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS rutclien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.Qry_Inventario.peso, dbo.Qry_Inventario.codigo, dbo.Qry_Inventario.cantidad, 
                      dbo.Qry_Inventario.fechaprod AS FECPRO, dbo.Qry_Inventario.numsopo AS FRIGORI, dbo.detarece.drec_fecrec AS FECREC, 
                      dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.Qry_Inventario.drec_contcli, dbo.detarece.drec_RecepTunel, dbo.detarece.drec_ProcTunel, 
                      dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, 
                      dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) 
                      AS fechavencimiento2, dbo.detarece.drec_unidades AS UnidadesOrigen
FROM         dbo.Qry_Inventario INNER JOIN
                      dbo.clientes INNER JOIN
                      dbo.maeprod ON dbo.clientes.cli_rut = dbo.maeprod.mae_clirut INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.Qry_Inventario.codigo = dbo.maeprod.mae_codi INNER JOIN
                      dbo.detarece ON dbo.Qry_Inventario.numsopo = dbo.detarece.drec_codi
ORDER BY dbo.maeprod.mae_descr, dbo.Qry_Inventario.codigo

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[infinv] as
select
racd_codpro as codigo,
drec_rutcli as rut,
sum(drec_pallet)as palet ,
sum(racd_unidades) as unidades ,
sum(racd_peso) as peso 
from 
rackdeta, detarece 
where 
rackdeta.racd_codi = detarece.drec_codi  
group by 
 racd_codpro,detarece.drec_rutcli 


GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[diferencia] 
as
select 
	c.cli_nomb as nombre,
	i.rut as RUT,
	i.codigo as codigo,
	(s.palet-i.palet) as palet,
	(s.unidades-i.unidades) as unidades,
	(s.peso-i.peso) as peso
from
	clientes as c,
	infinv as i,
	stock_temp  as s
where
	i.rut=s.rut and 
	i.codigo=s.codigo and 
	(i.palet-s.palet)<>0 and 
	c.cli_rut=i.rut 

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[detalle_dif] as
select 
	c.cli_nomb as nombre,
	i.rut as RUT,
	i.codigo as codigo,
	s.palet as palet_stoc,
	i.palet as palet_invt,
	s.unidades as unidades_stoc, 
	i.unidades as unidades_invt,
	s.peso as peso_stoc,
	i.peso as peso_invt
from
	clientes as c,
	infinv as i,
	stock_temp  as s
where
	i.rut=s.rut and 
	i.codigo=s.codigo and 
	(i.palet-s.palet)<>0 and 
	c.cli_rut=i.rut 

GO

GO

GO
CREATE VIEW [dbo].[RPT_AGROSUPERDES]
AS
SELECT        cli_rut, cli_nomb, cli_direcc, cli_comuna
FROM            dbo.clientes
WHERE        (cli_nomb = 'FAENADORA SAN VICENTE LTDA.') OR
                         (cli_nomb = 'AGROSUPER LO MIRANDA')

GO

GO

GO
CREATE VIEW [dbo].[RPT_AGROSUPER_DES]
AS
SELECT        SUBSTRING(dbo.detadespa.ddes_codi, 0, 8) AS despacho, dbo.detadespa.ddes_rutcli, dbo.detarece.drec_codpro, dbo.maeprod.mae_descr, 
                         SUM(dbo.detadespa.ddes_unidades) AS unidades, SUM(dbo.detadespa.ddes_peso) AS kilos, dbo.RPT_AGROSUPERDES.cli_nomb, 
                         dbo.RPT_AGROSUPERDES.cli_direcc, dbo.RPT_AGROSUPERDES.cli_comuna, dbo.fichdespa.fdes_observ, dbo.fichdespa.fdes_sello, dbo.fichdespa.fdes_totsopo, 
                         dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_rutcond, dbo.choferes.cho_nombre, dbo.fichdespa.fdes_destino, dbo.choferes.cho_patente, 
                         dbo.choferes.cho_patente2
FROM            dbo.detadespa INNER JOIN
                         dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.RPT_AGROSUPERDES ON dbo.detadespa.ddes_rutcli = dbo.RPT_AGROSUPERDES.cli_rut INNER JOIN
                         dbo.fichdespa ON dbo.detadespa.ddes_codpred = dbo.fichdespa.fdes_codpred INNER JOIN
                         dbo.choferes ON dbo.fichdespa.fdes_rutcond = dbo.choferes.cho_rut
GROUP BY SUBSTRING(dbo.detadespa.ddes_codi, 0, 8), dbo.detadespa.ddes_rutcli, dbo.detarece.drec_codpro, dbo.maeprod.mae_descr, dbo.RPT_AGROSUPERDES.cli_nomb, 
                         dbo.RPT_AGROSUPERDES.cli_direcc, dbo.RPT_AGROSUPERDES.cli_comuna, dbo.fichdespa.fdes_observ, dbo.fichdespa.fdes_sello, dbo.fichdespa.fdes_totsopo, 
                         dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_rutcond, dbo.choferes.cho_nombre, dbo.fichdespa.fdes_destino, dbo.choferes.cho_patente, dbo.choferes.cho_patente2

GO

GO

GO
CREATE VIEW [dbo].[QRY_PCC1_TEMPERATURA]
AS
SELECT     TOP 100 PERCENT LEFT(drec_codi, 7) AS RECEPCION, drec_TS AS TS, drec_TM AS TM, drec_TI AS TI
FROM         dbo.detarece
WHERE     (drec_codvig = '0')
GROUP BY LEFT(drec_codi, 7), drec_TS, drec_TM, drec_TI
ORDER BY LEFT(drec_codi, 7) DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_PCC1]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_nomb AS CLIENTE, dbo.fichrece.frec_codi AS RECEPCION, dbo.fichrece.frec_totsopo AS TOTALPALLET, 
                      dbo.fichrece.frec_horarec AS HORA, dbo.fichrece.frec_fecrec AS FECHA, dbo.fichrece.frec_observ AS OBSERVACION, 
                      dbo.usuario.descri AS SUPERVISOR, dbo.QRY_PCC1_TEMPERATURA.TS, dbo.QRY_PCC1_TEMPERATURA.TM, dbo.QRY_PCC1_TEMPERATURA.TI, 
                      dbo.fichrece.frec_RecepTunel AS TIPOALMACENAMIENTO, dbo.fichrece.frec_tiporecepcion
FROM         dbo.fichrece INNER JOIN
                      dbo.usuario ON dbo.fichrece.frec_codienca = dbo.usuario.personal INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.QRY_PCC1_TEMPERATURA ON dbo.fichrece.frec_codi = dbo.QRY_PCC1_TEMPERATURA.RECEPCION
WHERE     (dbo.fichrece.frec_codvig = '0') AND (dbo.fichrece.frec_fecrec > '2011/12/31')
ORDER BY dbo.fichrece.frec_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_detadespa_pallet_despa]
AS
SELECT     TOP 100 PERCENT ddes_codrece, SUM(ddes_pallet) AS pallet, ddes_fecha, ddes_rutcli
FROM         dbo.detadespa
GROUP BY ddes_codrece, ddes_fecha, ddes_rutcli
ORDER BY ddes_codrece

GO

GO

GO
CREATE VIEW [dbo].[QRY_recepcionados_despachados]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codi, dbo.detarece.drec_fecrec, dbo.qry_detadespa_pallet_despa.ddes_fecha, dbo.detarece.drec_sopocli, 
                      dbo.detarece.drec_rutcli
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.qry_detadespa_pallet_despa ON dbo.detarece.drec_codi = dbo.qry_detadespa_pallet_despa.ddes_codrece
ORDER BY dbo.detarece.drec_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_despacho_1]
AS
SELECT     dbo.fichdespa.fdes_fecha AS FECHEGRE, dbo.fichdespa.fdes_hora AS HORAEGRE, dbo.fichdespa.fdes_codi AS GUIAEGRE, 
                      dbo.origen.ori_descr AS DESCORDE, dbo.fichdespa.fdes_rutcli AS RUTCLIEN, dbo.nomiper.nper_nomb AS nombpers, 
                      dbo.choferes.cho_nombre AS nombcond, dbo.choferes.cho_rut AS rutcondu, dbo.choferes.cho_patente AS numpaten, 
                      dbo.choferes.cho_empresa AS emptrans, dbo.fichdespa.fdes_totsopo AS totasopo, dbo.fichdespa.fdes_totunidad AS totaenva, 
                      dbo.fichdespa.fdes_totpeso AS totapeso, dbo.clientes.cli_nomb AS NOMCLIEN, dbo.fichdespa.fdes_observ AS observac, 
                      dbo.fichdespa.fdes_tipcarga AS desccade, dbo.fichdespa.fdes_GuiaCliente, dbo.fichdespa.fdes_tempdespacho, dbo.fichdespa.fdes_destino
FROM         dbo.fichdespa LEFT OUTER JOIN
                      dbo.origen ON dbo.fichdespa.fdes_origen = dbo.origen.ori_codi INNER JOIN
                      dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.choferes ON dbo.fichdespa.fdes_rutcond = dbo.choferes.cho_rut LEFT OUTER JOIN
                      dbo.nomiper ON dbo.fichdespa.fdes_codienca = dbo.nomiper.nper_codi
WHERE     (dbo.fichdespa.fdes_codvig <> 1)

GO

GO

GO
CREATE VIEW [dbo].[qry_detadespa_detalle_cajas_resumen]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.detadespa.ddes_codi, 7) AS despacho, dbo.detarece.drec_rutcli, COUNT(dbo.DetareceCajas.drec_unidades) 
                      AS tot_cajas
FROM         dbo.detadespa INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi AND dbo.detadespa.ddes_unidades = dbo.detarece.drec_unidades INNER JOIN
                      dbo.DetareceCajas ON dbo.detarece.drec_codi = LEFT(dbo.DetareceCajas.drec_codi, 9)
GROUP BY LEFT(dbo.detadespa.ddes_codi, 7), dbo.detarece.drec_rutcli

GO

GO

GO
CREATE VIEW [dbo].[qry_despacho_11]
AS
SELECT     TOP 100 PERCENT dbo.Qry_despacho_1.*, dbo.qry_detadespa_detalle_cajas_resumen.tot_cajas AS tot_cajas
FROM         dbo.Qry_despacho_1 LEFT OUTER JOIN
                      dbo.qry_detadespa_detalle_cajas_resumen ON dbo.Qry_despacho_1.GUIAEGRE = dbo.qry_detadespa_detalle_cajas_resumen.despacho
ORDER BY dbo.Qry_despacho_1.GUIAEGRE DESC

GO

GO

GO
CREATE VIEW [dbo].[VFAC_TONELADAS_MES_FIN]
AS
SELECT        frec_rutcli, SUM(TONE / 1000) AS TONELA, Expr1 AS MES
FROM            dbo.VFAC_TON_PORCLIENTE
GROUP BY frec_rutcli, Expr1

GO

GO

GO
CREATE VIEW [dbo].[VG_TUNELES_PORFECHA]
AS
SELECT        dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.clientes.cli_nomb, dbo.fichrece.frec_totpeso, dbo.fichrece.frec_RecepTunel, dbo.fichrece.frec_fecrec, 
                         dbo.fichrece.frec_totsopo, dbo.fichrece.frec_totunidad
FROM            dbo.fichrece INNER JOIN
                         dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
WHERE        (dbo.fichrece.frec_RecepTunel = 2)

GO

GO

GO
CREATE VIEW [dbo].[VG_TUNELES_GROUP]
AS
SELECT        frec_rutcli, cli_nomb, SUM(frec_totsopo) AS SOPORTANTES, SUM(frec_totunidad) AS UNIDADES, SUM(frec_totpeso) AS PESO
FROM            dbo.VG_TUNELES_PORFECHA
GROUP BY frec_rutcli, cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[Qry_recepcion_1]
AS
SELECT     dbo.clientes.cli_nomb AS NOMCLIEN, dbo.clientes.cli_rut AS RUTCLIEN, dbo.fichrece.frec_fecrec AS FECHRECE, 
                      dbo.fichrece.frec_horarec AS HORARECE, dbo.fichrece.frec_codi AS GUIARECE, dbo.fichrece.frec_guiades AS GUIADESP, 
                      dbo.origen.ori_descr AS descorde, dbo.nomiper.nper_nomb AS nombpers, dbo.fichrece.frec_horater AS horaterm, 
                      dbo.fichrece.frec_tipdesc AS desccade, dbo.fichrece.frec_temppro AS tempprom, dbo.fichrece.frec_turnrec AS turnrece, 
                      dbo.choferes.cho_nombre AS NOMBCOND, dbo.choferes.cho_patente AS numpaten, dbo.choferes.cho_empresa AS emptrans, 
                      dbo.choferes.cho_rut AS rutcondu, dbo.fichrece.frec_totsopo AS totasopo, dbo.fichrece.frec_totunidad AS totaenva, 
                      dbo.fichrece.frec_totpeso AS totapeso, dbo.fichrece.frec_observ AS observac, dbo.fichrece.frec_contcli, dbo.fichrece.frec_termografo, 
                      dbo.fichrece.frec_procedencia, dbo.contrato.cont_descr
FROM         dbo.fichrece LEFT OUTER JOIN
                      dbo.contrato ON dbo.fichrece.frec_contcli = dbo.contrato.cont_codi LEFT OUTER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.origen ON dbo.fichrece.frec_origen = dbo.origen.ori_codi LEFT OUTER JOIN
                      dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut LEFT OUTER JOIN
                      dbo.nomiper ON dbo.fichrece.frec_codienca = dbo.nomiper.nper_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_detarececajas_resumen]
AS
SELECT     TOP 100 PERCENT LEFT(drec_codi, 7) AS recepcion, COUNT(drec_codi) AS totalcajas
FROM         dbo.DetareceCajas
GROUP BY LEFT(drec_codi, 7)

GO

GO

GO
CREATE VIEW [dbo].[Qry_recepcion_4]
AS
SELECT     TOP 100 PERCENT dbo.Qry_recepcion_1.*, dbo.qry_detarececajas_resumen.totalcajas AS tot_cajas
FROM         dbo.Qry_recepcion_1 LEFT OUTER JOIN
                      dbo.qry_detarececajas_resumen ON dbo.Qry_recepcion_1.GUIARECE = dbo.qry_detarececajas_resumen.recepcion
ORDER BY dbo.Qry_recepcion_1.GUIARECE DESC

GO

GO

GO
CREATE VIEW [dbo].[RP_MAYORMENOR]
AS
SELECT        dbo.RP_MAYOR.MAYOR, dbo.RP_MENOR.MENOR
FROM            dbo.RP_MAYOR CROSS JOIN
                         dbo.RP_MENOR

GO

GO

GO
CREATE VIEW [dbo].[VG_DETARECE_AGRUPADO]
AS
SELECT        frec_codi1, drec_rutcli, SUM(drec_unidades) AS Unidades, SUM(drec_peso) AS Kilos, COUNT(frec_codi1) AS Pallets
FROM            dbo.detarece
GROUP BY frec_codi1, drec_rutcli

GO

GO

GO
CREATE VIEW [dbo].[VG_CUADRATURA_RECEP]
AS
SELECT        dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_totunidad, dbo.fichrece.frec_totpeso, dbo.VG_DETARECE_AGRUPADO.Unidades, 
                         dbo.VG_DETARECE_AGRUPADO.Pallets, dbo.fichrece.frec_totunidad - dbo.VG_DETARECE_AGRUPADO.Unidades AS Dif
FROM            dbo.fichrece INNER JOIN
                         dbo.VG_DETARECE_AGRUPADO ON dbo.fichrece.frec_codi = dbo.VG_DETARECE_AGRUPADO.frec_codi1

GO

GO

GO
CREATE VIEW [dbo].[VG_TOTAL RECEPCIONADO_CLIENTES]
AS
SELECT        dbo.clientes.cli_nomb, dbo.clientes.cli_rut, SUM(dbo.VG_CUADRATURA_RECEP.Pallets) AS REC_PALL, SUM(dbo.VG_CUADRATURA_RECEP.frec_totunidad) 
                         AS REC_CAJ
FROM            dbo.VG_CUADRATURA_RECEP INNER JOIN
                         dbo.clientes ON dbo.VG_CUADRATURA_RECEP.frec_rutcli = dbo.clientes.cli_rut
GROUP BY dbo.clientes.cli_nomb, dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_STOCK_RESUMEN]
AS
SELECT        dbo.detarece.drec_rutcli AS RUTCLIENTE, dbo.detarece.drec_contcli AS CONTRATO, dbo.detarece.drec_codpro AS CODIGO, 
                         dbo.maeprod.mae_codcli AS CODIGOCLIENTE, dbo.maeprod.mae_descr AS DESCRIPCION, COUNT(dbo.rackdeta.racd_codi) AS TOT_PALLET, 
                         SUM(dbo.rackdeta.racd_unidades) AS TOT_UNIDADES, ROUND(SUM(dbo.detarece.drec_peso / NULLIF (dbo.detarece.drec_unidades * dbo.rackdeta.racd_unidades, 
                         0)), 2) AS TOT_KILOS, dbo.maeprod.mae_tipenv, dbo.tipoenv.tenv_descr AS envase
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE        (dbo.detarece.drec_codvig = '0')
GROUP BY dbo.detarece.drec_rutcli, dbo.detarece.drec_contcli, dbo.detarece.drec_codpro, dbo.maeprod.mae_codcli, dbo.maeprod.mae_descr, dbo.maeprod.mae_tipenv, 
                         dbo.tipoenv.tenv_descr

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_STOCK_RESUMEN_SINCONTRATOS]
AS
SELECT     TOP 100 PERCENT RUTCLIENTE, CODIGO, CODIGOCLIENTE, DESCRIPCION, SUM(TOT_PALLET) AS TOTAL_PALLET, SUM(TOT_UNIDADES) 
                      AS TOTAL_UNIDADES, SUM(TOT_KILOS) AS TOTAL_KILOS, envase
FROM         dbo.QRY_PRECISA_STOCK_RESUMEN
GROUP BY RUTCLIENTE, CODIGO, CODIGOCLIENTE, DESCRIPCION, envase
ORDER BY CODIGO

GO

GO

GO
CREATE VIEW [dbo].[VISTA_DETARECECAJASPARASTOCK]
AS
SELECT        caj_cod, caj_Calidad, caj_Calibre, caj_felab, caj_fvenc, caj_unid, caj_Kg, caj_Id, caj_lote, caj_Pcod, caj_producto
FROM            dbo.DetaReceCajas
WHERE        (caj_Calibre IS NOT NULL)

GO

GO

GO
CREATE VIEW [dbo].[VG_STOCK_CLIENTES]
AS
SELECT        dbo.ss.drec_rutcli, dbo.ss.pallet, dbo.ss.caj_cod, dbo.ss.caj_ped, dbo.VISTA_DETARECECAJASPARASTOCK.caj_Calidad, 
                         dbo.VISTA_DETARECECAJASPARASTOCK.caj_Calibre, dbo.VISTA_DETARECECAJASPARASTOCK.caj_felab, dbo.VISTA_DETARECECAJASPARASTOCK.caj_fvenc, 
                         dbo.VISTA_DETARECECAJASPARASTOCK.caj_unid, dbo.VISTA_DETARECECAJASPARASTOCK.caj_Kg, dbo.VISTA_DETARECECAJASPARASTOCK.caj_Id, 
                         dbo.VISTA_DETARECECAJASPARASTOCK.caj_lote, dbo.VISTA_DETARECECAJASPARASTOCK.caj_producto
FROM            dbo.VISTA_DETARECECAJASPARASTOCK INNER JOIN
                         dbo.ss ON dbo.VISTA_DETARECECAJASPARASTOCK.caj_cod = dbo.ss.caj_cod
GROUP BY dbo.ss.drec_rutcli, dbo.ss.pallet, dbo.ss.caj_cod, dbo.ss.caj_ped, dbo.VISTA_DETARECECAJASPARASTOCK.caj_Calidad, 
                         dbo.VISTA_DETARECECAJASPARASTOCK.caj_Calibre, dbo.VISTA_DETARECECAJASPARASTOCK.caj_felab, dbo.VISTA_DETARECECAJASPARASTOCK.caj_fvenc, 
                         dbo.VISTA_DETARECECAJASPARASTOCK.caj_unid, dbo.VISTA_DETARECECAJASPARASTOCK.caj_Kg, dbo.VISTA_DETARECECAJASPARASTOCK.caj_Id, 
                         dbo.VISTA_DETARECECAJASPARASTOCK.caj_lote, dbo.VISTA_DETARECECAJASPARASTOCK.caj_producto

GO

GO

GO
CREATE VIEW [dbo].[VG_HORAS_PEDIDO]
AS
SELECT        dbo.Pedidos_ficha.Orden AS PEDIDO, dbo.clientes.cli_nomb AS CLIENTE, dbo.Pedidos_ficha.fechapedido AS [FECHA PEDIDO], 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.Fecha AS INICIO, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino AS TERMINO, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF AS [HRS PREP.], CONVERT(varchar(5), DATEADD(minute, DATEDIFF(minute, dbo.Pedidos_ficha.fechapedido, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino), 0), 108) AS [HRS PEDIDO]
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[View_2]
AS
SELECT        dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF AS [HRS PREP.]
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut
WHERE        (CONVERT(DATE, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino) = CONVERT(DATE, GETDATE(), 105))

GO

GO

GO
CREATE VIEW [dbo].[RP_SUMH]
AS
SELECT        dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF AS [HRS PREP.]
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut
WHERE        (CONVERT(DATE, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino) = CONVERT(DATE, GETDATE(), 105))

GO

GO

GO
CREATE VIEW [dbo].[VG_PEDIDOS_ENCARGADO]
AS
SELECT        dbo.Pedidos_ficha.Orden AS PEDIDO, dbo.clientes.cli_nomb AS CLIENTE, dbo.Pedidos_ficha.fechapedido AS [FECHA PEDIDO], 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.Fecha AS INICIO, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino AS TERMINO, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF AS [HRS PREP.], CONVERT(varchar(5), DATEADD(minute, DATEDIFF(minute, dbo.Pedidos_ficha.fechapedido, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino), 0), 108) AS [HRS PEDIDO], Pedidos_ficha_1.Encargado, dbo.PR_PEDIDOSPALLET.SOP, 
                         dbo.Usuarios.usu_codigo AS COD, Pedidos_ficha_1.codvig AS ESTADO
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut INNER JOIN
                         dbo.Pedidos_ficha AS Pedidos_ficha_1 ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = Pedidos_ficha_1.Orden INNER JOIN
                         dbo.PR_PEDIDOSPALLET ON dbo.Pedidos_ficha.pedido = dbo.PR_PEDIDOSPALLET.pedido INNER JOIN
                         dbo.Usuarios ON Pedidos_ficha_1.Encargado = dbo.Usuarios.descri

GO

GO

GO
CREATE VIEW [dbo].[VG_PEDIDOS_SEMANAL]
AS
SELECT        dbo.Pedidos_ficha.Orden AS PEDIDO, dbo.clientes.cli_nomb AS CLIENTE, dbo.Pedidos_ficha.fechapedido AS [FECHA PEDIDO], 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.Fecha AS INICIO, dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino AS TERMINO, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.DIFF AS [HRS PREP.], CONVERT(varchar(5), DATEADD(minute, DATEDIFF(minute, dbo.Pedidos_ficha.fechapedido, 
                         dbo.VG_REPORTE_HORAS_TRABAJADAS.fechaTermino), 0), 108) AS [HRS PEDIDO], Pedidos_ficha_1.Encargado, dbo.PR_PEDIDOSPALLET.SOP
FROM            dbo.VG_REPORTE_HORAS_TRABAJADAS INNER JOIN
                         dbo.Pedidos_ficha ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = dbo.Pedidos_ficha.Orden INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut INNER JOIN
                         dbo.Pedidos_ficha AS Pedidos_ficha_1 ON dbo.VG_REPORTE_HORAS_TRABAJADAS.Orden = Pedidos_ficha_1.Orden INNER JOIN
                         dbo.PR_PEDIDOSPALLET ON dbo.Pedidos_ficha.pedido = dbo.PR_PEDIDOSPALLET.pedido
WHERE        (dbo.Pedidos_ficha.fechaTermino >= CONVERT(date, DATEADD(day, - 7, GETDATE())))

GO

GO

GO
CREATE VIEW [dbo].[QryTrazabilidad]
AS
SELECT     TOP 100 PERCENT dbo.movpallet.mov_unica, dbo.movpallet.mov_folio, dbo.movpallet.mov_codper, dbo.movpallet.mov_ca, dbo.movpallet.mov_ba, 
                      dbo.movpallet.mov_co, dbo.movpallet.mov_pi, dbo.movpallet.mov_ni, dbo.movpallet.mov_fecha, dbo.movpallet.mov_tipo, dbo.movpallet.mov_hora, 
                      dbo.movpallet.mov_TS, dbo.movpallet.mov_TM, dbo.movpallet.mov_Doc, dbo.movpallet.mov_RecepTunel, dbo.movpallet.mov_TI, 
                      dbo.nomiper.nper_nomb, dbo.ClasificacionMovimiento.Cmov_Descrip, dbo.DestinoPallet.DPal_desc, dbo.movpallet.Mov_Despacho, 
                      dbo.movpallet.Mov_Saldo, dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.movpallet.mov_chorut, dbo.movpallet.mov_docdespa, 
                      dbo.movpallet.mov_chonom, dbo.movpallet.mov_chopat, dbo.movpallet.mov_chotra, dbo.movpallet.mov_anden, dbo.detarece.FechaVencimiento, 
                      dbo.detarece.LoteCliente, dbo.maeprod.mae_descr, dbo.detarece.drec_codpro
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut RIGHT OUTER JOIN
                      dbo.movpallet ON dbo.detarece.drec_codi = dbo.movpallet.mov_folio LEFT OUTER JOIN
                      dbo.DestinoPallet ON dbo.movpallet.mov_RecepTunel = dbo.DestinoPallet.DPal_codi LEFT OUTER JOIN
                      dbo.ClasificacionMovimiento ON 
                      dbo.movpallet.mov_tipo = dbo.ClasificacionMovimiento.Cmov_codi COLLATE SQL_Latin1_General_CP1_CI_AS LEFT OUTER JOIN
                      dbo.nomiper ON CAST(dbo.movpallet.mov_codper AS smallint) = CAST(dbo.nomiper.nper_codi AS smallint)

GO

GO

GO
CREATE VIEW [dbo].[Qry_Trazabilidad_Ver_un_mov]
AS
SELECT     TOP 100 PERCENT COUNT(mov_folio) AS Num_Movimiento, mov_folio, cli_nomb
FROM         dbo.QryTrazabilidad
WHERE     (mov_fecha >= '2007/01/01')
GROUP BY mov_folio, cli_nomb
ORDER BY mov_folio DESC

GO

GO

GO
CREATE VIEW [dbo].[VIEW_DETATESPA_CONFOLIO]
AS
SELECT     ddes_unica, ddes_codi, ddes_codpro, ddes_codsopo, ddes_sopocli, ddes_unidades, ddes_peso, ddes_fecprod, ddes_fecha, ddes_rutcli, ddes_contcli, ddes_camara, 
                      ddes_almacen, ddes_codpred, ddes_codrece, ddes_codvig, ddes_pallet, ddes_pedido, SUBSTRING(ddes_codi, 1, 7) AS FOLIO
FROM         dbo.detadespa

GO

GO

GO
CREATE VIEW [dbo].[VIEW_DETADESPA_FICHDESPA_ORIGENES]
AS
SELECT     dbo.VIEW_DETATESPA_CONFOLIO.ddes_unica, dbo.VIEW_DETATESPA_CONFOLIO.ddes_codi, dbo.VIEW_DETATESPA_CONFOLIO.ddes_codpro, 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_codsopo, dbo.VIEW_DETATESPA_CONFOLIO.ddes_sopocli, dbo.VIEW_DETATESPA_CONFOLIO.ddes_unidades, 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_fecprod, dbo.VIEW_DETATESPA_CONFOLIO.ddes_peso, dbo.VIEW_DETATESPA_CONFOLIO.ddes_fecha, 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_rutcli, dbo.VIEW_DETATESPA_CONFOLIO.ddes_contcli, dbo.VIEW_DETATESPA_CONFOLIO.ddes_camara, 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_almacen, dbo.VIEW_DETATESPA_CONFOLIO.ddes_codpred, dbo.VIEW_DETATESPA_CONFOLIO.ddes_codrece, 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_codvig, dbo.VIEW_DETATESPA_CONFOLIO.ddes_pallet, dbo.VIEW_DETATESPA_CONFOLIO.ddes_pedido, 
                      dbo.VIEW_DETATESPA_CONFOLIO.FOLIO, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_origen, dbo.origen.ori_descr
FROM         dbo.VIEW_DETATESPA_CONFOLIO INNER JOIN
                      dbo.fichdespa ON dbo.VIEW_DETATESPA_CONFOLIO.FOLIO = dbo.fichdespa.fdes_codi INNER JOIN
                      dbo.origen ON dbo.fichdespa.fdes_origen = dbo.origen.ori_codi
WHERE     (dbo.VIEW_DETATESPA_CONFOLIO.ddes_codvig = N'0') AND (dbo.VIEW_DETATESPA_CONFOLIO.ddes_fecha BETWEEN N'2015/06/01' AND N'2015/06/30')

GO

GO

GO
CREATE VIEW [dbo].[VISTA_PREDCAJAS]
AS
SELECT     movc_codi, movc_fecha, movc_codcaja, movc_codrece, movc_tipo, movc_ndoc
FROM         dbo.movcajas
WHERE     (movc_tipo = 'PW') OR
                      (movc_tipo = 'PD')

GO

GO

GO
CREATE VIEW [dbo].[web_estado_3]
AS
SELECT     dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.DetaReceCajas.caj_ped, dbo.detapedcaja.dpc_codped, 
                      MIN(dbo.VIEW_DETATESPA_CONFOLIO.ddes_codpred) AS ddes_codpred, MIN(dbo.VIEW_DETATESPA_CONFOLIO.FOLIO) AS FOLIO
FROM         dbo.VISTA_PREDCAJAS RIGHT OUTER JOIN
                      dbo.VIEW_DETATESPA_CONFOLIO INNER JOIN
                      dbo.detarece INNER JOIN
                      dbo.DetaReceCajas ON dbo.detarece.drec_codi = dbo.DetaReceCajas.caj_Pcod ON 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_codrece = dbo.DetaReceCajas.caj_Pcod ON 
                      dbo.VIEW_DETATESPA_CONFOLIO.ddes_codrece = dbo.VISTA_PREDCAJAS.movc_codrece AND 
                      dbo.DetaReceCajas.caj_cod = dbo.VISTA_PREDCAJAS.movc_codcaja LEFT OUTER JOIN
                      dbo.detapedcaja ON dbo.DetaReceCajas.caj_Pcod = dbo.detapedcaja.dpc_numpal AND dbo.DetaReceCajas.caj_cod = dbo.detapedcaja.dpc_codcaja
GROUP BY dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.DetaReceCajas.caj_ped, dbo.detapedcaja.dpc_codped
HAVING      (dbo.DetaReceCajas.caj_ped = 3) AND (dbo.detapedcaja.dpc_codped IS NOT NULL)

GO

GO

GO
CREATE VIEW [dbo].[WEB_CONSULTACLIENTE_TRASA]
AS
SELECT     dbo.DetaReceCajas.caj_Pcod, dbo.clientes.cli_nomb
FROM         dbo.detapedcaja RIGHT OUTER JOIN
                      dbo.clientes INNER JOIN
                      dbo.detarece ON dbo.clientes.cli_rut = dbo.detarece.drec_rutcli INNER JOIN
                      dbo.DetaReceCajas ON dbo.detarece.drec_codi = dbo.DetaReceCajas.caj_Pcod LEFT OUTER JOIN
                      dbo.DetaPredCajas RIGHT OUTER JOIN
                      dbo.VIEW_DETATESPA_CONFOLIO ON dbo.DetaPredCajas.dpre_npallet = dbo.VIEW_DETATESPA_CONFOLIO.ddes_codi ON 
                      dbo.DetaReceCajas.caj_cod = dbo.DetaPredCajas.dpre_caja ON dbo.detapedcaja.dpc_numpal = dbo.DetaReceCajas.caj_Pcod AND 
                      dbo.detapedcaja.dpc_codcaja = dbo.DetaReceCajas.caj_cod

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES01]
AS
SELECT        dbo.AndenesReg.Folio, dbo.AndenesReg.cliente, dbo.clientes.cli_nomb, dbo.zCheckList.Cl_RutCli, dbo.choferes.cho_nombre, dbo.AndenesReg.Anden
FROM            dbo.choferes INNER JOIN
                         dbo.zCheckList ON dbo.choferes.cho_rut = dbo.zCheckList.Cl_chorut RIGHT OUTER JOIN
                         dbo.AndenesReg ON dbo.zCheckList.Cl_fol = dbo.AndenesReg.Folio LEFT OUTER JOIN
                         dbo.clientes ON dbo.AndenesReg.cliente = dbo.clientes.cli_rut
GROUP BY dbo.AndenesReg.Folio, dbo.AndenesReg.cliente, dbo.clientes.cli_nomb, dbo.zCheckList.Cl_RutCli, dbo.choferes.cho_nombre, dbo.AndenesReg.Anden

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES_APERTURA]
AS
SELECT        dbo.VG_ANDENES01.Folio, dbo.VG_ANDENES01.cliente, dbo.VG_ANDENES01.Cl_RutCli, dbo.VG_ANDENES01.cli_nomb, dbo.VG_ANDENES01.cho_nombre, 
                         dbo.VG_ANDENES01.Anden, dbo.AndenesReg.Folio AS Expr1, dbo.AndenesReg.tip_mov, dbo.AndenesReg.fec_reg, dbo.AndenesReg.usr_reg
FROM            dbo.VG_ANDENES01 INNER JOIN
                         dbo.AndenesReg ON dbo.VG_ANDENES01.Folio = dbo.AndenesReg.Folio
GROUP BY dbo.VG_ANDENES01.Folio, dbo.VG_ANDENES01.cliente, dbo.VG_ANDENES01.Cl_RutCli, dbo.VG_ANDENES01.cli_nomb, dbo.VG_ANDENES01.cho_nombre, 
                         dbo.VG_ANDENES01.Anden, dbo.AndenesReg.Folio, dbo.AndenesReg.tip_mov, dbo.AndenesReg.fec_reg, dbo.AndenesReg.usr_reg
HAVING        (dbo.AndenesReg.tip_mov = N'APERTURA')

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES_CIERRE]
AS
SELECT        dbo.VG_ANDENES01.Folio, dbo.VG_ANDENES01.cliente, dbo.VG_ANDENES01.cli_nomb, dbo.VG_ANDENES01.Cl_RutCli, dbo.VG_ANDENES01.cho_nombre, 
                         dbo.VG_ANDENES01.Anden, dbo.AndenesReg.tip_mov, dbo.AndenesReg.fec_reg, dbo.AndenesReg.usr_reg2
FROM            dbo.VG_ANDENES01 INNER JOIN
                         dbo.AndenesReg ON dbo.VG_ANDENES01.Folio = dbo.AndenesReg.Folio
WHERE        (dbo.AndenesReg.tip_mov = N'CIERRE')

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES_FIN]
AS
SELECT        dbo.VG_ANDENES01.Folio, dbo.VG_ANDENES01.cliente, dbo.VG_ANDENES01.cli_nomb, dbo.VG_ANDENES01.Cl_RutCli, dbo.VG_ANDENES01.cho_nombre, 
                         dbo.VG_ANDENES01.Anden, dbo.VG_ANDENES_APERTURA.tip_mov, dbo.VG_ANDENES_APERTURA.fec_reg, dbo.VG_ANDENES_APERTURA.usr_reg, 
                         dbo.VG_ANDENES_CIERRE.tip_mov AS mov_cie, dbo.VG_ANDENES_CIERRE.fec_reg AS fec_cie, dbo.VG_ANDENES_CIERRE.usr_reg2
FROM            dbo.VG_ANDENES01 LEFT OUTER JOIN
                         dbo.VG_ANDENES_CIERRE ON dbo.VG_ANDENES01.Folio = dbo.VG_ANDENES_CIERRE.Folio LEFT OUTER JOIN
                         dbo.VG_ANDENES_APERTURA ON dbo.VG_ANDENES01.Folio = dbo.VG_ANDENES_APERTURA.Folio
GROUP BY dbo.VG_ANDENES01.Folio, dbo.VG_ANDENES01.cliente, dbo.VG_ANDENES01.cli_nomb, dbo.VG_ANDENES01.Cl_RutCli, dbo.VG_ANDENES01.cho_nombre, 
                         dbo.VG_ANDENES01.Anden, dbo.VG_ANDENES_APERTURA.tip_mov, dbo.VG_ANDENES_APERTURA.fec_reg, dbo.VG_ANDENES_APERTURA.usr_reg, 
                         dbo.VG_ANDENES_CIERRE.tip_mov, dbo.VG_ANDENES_CIERRE.fec_reg, dbo.VG_ANDENES_CIERRE.usr_reg2

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES_FIN_FIN]
AS
SELECT        Folio, cliente, cli_nomb, Cl_RutCli, cho_nombre, Anden, tip_mov, fec_reg, usr_reg, fec_cie, mov_cie, usr_reg2, DATEDIFF(Minute, fec_reg, fec_cie) AS diff
FROM            dbo.VG_ANDENES_FIN

GO

GO

GO
CREATE VIEW [dbo].[VG_ANDENES_FIN_FIN2]
AS
SELECT        Folio, cliente, cli_nomb, Cl_RutCli, cho_nombre, Anden, tip_mov, fec_reg, usr_reg, fec_cie, mov_cie, usr_reg2, diff
FROM            dbo.VG_ANDENES_FIN_FIN

GO

GO

GO
CREATE VIEW [dbo].[VG_MOVPALLET_LAST]
AS
SELECT        dbo.Pedidos_detalle.pedido, dbo.Pedidos_detalle.pallet, dbo.Pedidos_detalle.posicion, dbo.Pedidos_ficha.Orden, MAX(CONVERT(datetime, 
                         SUBSTRING(dbo.movpallet.mov_fecha, 9, 2) + SUBSTRING(dbo.movpallet.mov_fecha, 5, 4) + SUBSTRING(dbo.movpallet.mov_fecha, 1, 4))) AS Ultimo_Mov, 
                         dbo.movpallet.mov_tipo
FROM            dbo.Pedidos_detalle INNER JOIN
                         dbo.movpallet ON dbo.Pedidos_detalle.pallet = dbo.movpallet.mov_folio INNER JOIN
                         dbo.Pedidos_ficha ON dbo.Pedidos_detalle.pedido = dbo.Pedidos_ficha.pedido
GROUP BY dbo.Pedidos_detalle.pedido, dbo.Pedidos_detalle.pallet, dbo.Pedidos_detalle.posicion, dbo.Pedidos_ficha.Orden, dbo.movpallet.mov_tipo
HAVING        (dbo.Pedidos_ficha.Orden = 2312) AND (dbo.movpallet.mov_tipo = N'RR')

GO

GO

GO
CREATE VIEW [dbo].[VG_ULTIMO_MOVPALLET]
AS
SELECT        dbo.VG_MOVPALLET_LAST.pedido, dbo.VG_MOVPALLET_LAST.pallet, dbo.VG_MOVPALLET_LAST.posicion, dbo.VG_MOVPALLET_LAST.Orden, 
                         dbo.VG_MOVPALLET_LAST.Ultimo_Mov, dbo.VG_MOVPALLET_LAST.mov_tipo, dbo.movpallet.mov_hora
FROM            dbo.VG_MOVPALLET_LAST INNER JOIN
                         dbo.movpallet ON dbo.VG_MOVPALLET_LAST.pallet = dbo.movpallet.mov_folio AND dbo.VG_MOVPALLET_LAST.Ultimo_Mov = CONVERT(datetime, 
                         SUBSTRING(dbo.movpallet.mov_fecha, 9, 2) + SUBSTRING(dbo.movpallet.mov_fecha, 5, 4) + SUBSTRING(dbo.movpallet.mov_fecha, 1, 4)) AND 
                         dbo.VG_MOVPALLET_LAST.mov_tipo = dbo.movpallet.mov_tipo
GROUP BY dbo.VG_MOVPALLET_LAST.pedido, dbo.VG_MOVPALLET_LAST.pallet, dbo.VG_MOVPALLET_LAST.posicion, dbo.VG_MOVPALLET_LAST.Orden, 
                         dbo.VG_MOVPALLET_LAST.Ultimo_Mov, dbo.VG_MOVPALLET_LAST.mov_tipo, dbo.movpallet.mov_hora, dbo.movpallet.mov_tipo

GO

GO

GO
CREATE VIEW [dbo].[Qry_LOG_RECEPCION]
AS
SELECT     dbo.log_recepcion.log_id, dbo.log_recepcion.log_Nrecepcion, dbo.log_recepcion.log_fecha_hora, dbo.log_recepcion.log_usuario, 
                      dbo.log_recepcion.log_usergestion, dbo.usuario.descri, 
                      CASE WHEN LOG_TIPO = 'M' THEN 'MODIFICACIONES' ELSE 'RECEPCIONES' END AS TIPOMOV
FROM         dbo.log_recepcion INNER JOIN
                      dbo.usuario ON dbo.log_recepcion.log_usergestion = dbo.usuario.personal

GO

GO

GO
CREATE VIEW [dbo].[Qry_Log_Recepcion_Detalle]
AS
SELECT     dbo.Qry_LOG_RECEPCION.log_id, dbo.Qry_LOG_RECEPCION.log_Nrecepcion, dbo.Qry_LOG_RECEPCION.log_fecha_hora, 
                      dbo.Qry_LOG_RECEPCION.log_usuario, dbo.Qry_LOG_RECEPCION.log_usergestion, dbo.Qry_LOG_RECEPCION.descri, 
                      dbo.Qry_LOG_RECEPCION.TIPOMOV, dbo.clientes.cli_nomb, dbo.clientes.cli_rut
FROM         dbo.fichrece INNER JOIN
                      dbo.Qry_LOG_RECEPCION ON dbo.fichrece.frec_codi = dbo.Qry_LOG_RECEPCION.log_Nrecepcion INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETARECE_SALDO]
AS
SELECT detarece.drec_fecrec AS fecha, 
    maeprod.mae_codi AS codigo, maeprod.mae_clirut AS rut, 
    maeprod.mae_tipenv AS tipoenv, 
    SUM(detarece.drec_unidades) AS unidades_a, 
    SUM(detarece.drec_peso) AS peso_a, 
    SUM(detarece.drec_pallet) AS pallet_a
FROM detarece INNER JOIN
    maeprod ON 
    detarece.drec_codpro = maeprod.mae_codi
WHERE (detarece.drec_codvig = 0)
GROUP BY maeprod.mae_clirut, maeprod.mae_codi, 
    detarece.drec_fecrec, maeprod.mae_tipenv

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETADESPA_SALDO]
AS
SELECT detadespa.ddes_fecha AS fecha, 
    maeprod.mae_codi AS codigo, maeprod.mae_clirut AS rut, 
    maeprod.mae_tipenv AS tipoenv, 
    SUM(detadespa.ddes_unidades) AS unidades_b, 
    SUM(detadespa.ddes_peso) AS peso_b, 
    SUM(detadespa.ddes_pallet) AS pallet_b
FROM detadespa INNER JOIN
    maeprod ON 
    detadespa.ddes_codpro = maeprod.mae_codi
WHERE (detadespa.ddes_codvig = 0)
GROUP BY maeprod.mae_clirut, maeprod.mae_codi, 
    detadespa.ddes_fecha, maeprod.mae_tipenv

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[INF_DET_NUM_PROD]
AS
(SELECT fecha, codigo, rut, tipoenv, SUM(unidades_b) 
     AS unidades_b, SUM(peso_b) AS peso_b, SUM(pallet_b) 
     AS pallet_b, 0 AS unidades_a, 0 AS peso_a, 
     0 AS pallet_a
FROM INF_DIA_PROD_DETADESPA_SALDO AS b
GROUP BY codigo, rut, tipoenv, b.fecha)
UNION ALL
(SELECT fecha, codigo, rut, tipoenv, 0, 0, 0, SUM(unidades_a) 
     AS unidades, SUM(peso_a) AS peso, SUM(pallet_a) 
     AS pallet
FROM INF_DIA_PROD_DETArece_SALDO AS a
GROUP BY codigo, rut, tipoenv, a.fecha)

GO

GO

GO
CREATE VIEW [dbo].[web_estado_0]
AS
SELECT     caj_Pcod, caj_cod, caj_ped, NULL AS dpc_codped, NULL AS ddes_codpred, NULL AS FOLIO
FROM         dbo.DetaReceCajas
GROUP BY caj_Pcod, caj_cod, caj_ped
HAVING      (caj_ped = 0)

GO

GO

GO
CREATE VIEW [dbo].[web_estado_1]
AS
SELECT     dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.DetaReceCajas.caj_ped, dbo.detapedcaja.dpc_codped, NULL AS Expr3, NULL AS Expr2
FROM         dbo.DetaReceCajas LEFT OUTER JOIN
                      dbo.detapedcaja ON dbo.DetaReceCajas.caj_Pcod = dbo.detapedcaja.dpc_numpal AND dbo.DetaReceCajas.caj_cod = dbo.detapedcaja.dpc_codcaja
WHERE     (dbo.DetaReceCajas.caj_ped = 1)

GO

GO

GO
CREATE VIEW [dbo].[WEB_INFOPALLET]
AS
SELECT * from web_estado_0
union
SELECT * from web_estado_1
union
SELECT * from web_estado_3

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETARECE_INGRESO]
AS
SELECT LEFT(detarece.drec_codi, 7) AS cod, 
    detarece.drec_fecrec AS fecha, maeprod.mae_codi AS codigo, 
    maeprod.mae_clirut AS rut, maeprod.mae_tipenv AS tipoenv, 
    SUM(detarece.drec_unidades) AS unidades_a, 
    SUM(detarece.drec_peso) AS peso_a, 
    SUM(detarece.drec_pallet) AS pallet_a
FROM detarece INNER JOIN
    maeprod ON 
    detarece.drec_codpro = maeprod.mae_codi
WHERE (detarece.drec_codvig = 0)
GROUP BY maeprod.mae_clirut, maeprod.mae_codi, 
    detarece.drec_fecrec, maeprod.mae_tipenv, 
    LEFT(detarece.drec_codi, 7)

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETADESPA_EGRESO]
AS
SELECT LEFT(detadespa.ddes_codi, 7) AS cod, 
    detadespa.ddes_fecha AS fecha, 
    maeprod.mae_codi AS codigo, maeprod.mae_clirut AS rut, 
    maeprod.mae_tipenv AS tipoenv, 
    SUM(detadespa.ddes_unidades) AS unidades_b, 
    SUM(detadespa.ddes_peso) AS peso_b, 
    SUM(detadespa.ddes_pallet) AS pallet_b
FROM detadespa INNER JOIN
    maeprod ON 
    detadespa.ddes_codpro = maeprod.mae_codi
WHERE (detadespa.ddes_codvig = 0)
GROUP BY maeprod.mae_clirut, maeprod.mae_codi, 
    detadespa.ddes_fecha, maeprod.mae_tipenv, 
    LEFT(detadespa.ddes_codi, 7)

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[AA]
AS
(select 'SALDO' AS TIPO,'0' AS COD,'0' AS FECHA,codigo,rut,tipoenv,sum(unidades_b) as uni_b,sum(peso_b) as peso_b,sum(unidades_a) as uni_a,sum(peso_a) as peso_a,0   AS UNI2_A           ,0  AS PESO2_A   ,0 AS UNI2_B ,0 AS PESO2_B
from INF_DET_NUM_PROD 
where  fecha<'2004/07/27' and CODIGO='9000002' group by rut,codigo,tipoenv  

union all

select 
'INGRESO' AS TIPO,cod   AS COD  ,fecha AS FECHA  ,codigo,rut,tipoenv,0  AS uni_b           ,0     as peso_b      ,0     uni_a                  ,0    peso_a                 ,unidades_a   AS UNI2_A  ,peso_a AS PESO2_A ,0,0   
from INF_DIA_PROD_DETARECE_INGRESO 
where  fecha>='2004/07/27' and fecha<='2004/07/28' and CODIGO='9000002'

union all

select  
'EGRESO'AS TIPO  ,cod AS COD   , fecha AS FECHA,codigo,rut,tipoenv,0     as uni_b         ,0         as peso_b  ,0          uni_a            ,0    peso_a                 ,0           UNI2_A   ,0  AS PESO2_A    ,    unidades_b AS UNI2_B , peso_b   AS PESO2_B                              
from INF_DIA_PROD_DETADESPA_EGRESO
where
codigo = '9000002' AND fecha >= '2004/07/27' And fecha <= '2004/07/28' 
)



GO

GO

GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETARECE_SALDO_contratos]
AS
SELECT     dbo.detarece.drec_fecrec AS fecha, dbo.maeprod.mae_codi AS codigo, dbo.maeprod.mae_clirut AS rut, dbo.maeprod.mae_tipenv AS tipoenv, 
                      SUM(dbo.detarece.drec_unidades) AS unidades_a, SUM(dbo.detarece.drec_peso) AS peso_a, SUM(dbo.detarece.drec_pallet) AS pallet_a, 
                      dbo.detarece.drec_contcli AS contrato
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.detarece.drec_codvig = 0)
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_codi, dbo.detarece.drec_fecrec, dbo.maeprod.mae_tipenv, dbo.detarece.drec_contcli

GO

GO

GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETADESPA_SALDO_contratos]
AS
SELECT     dbo.detadespa.ddes_fecha AS fecha, dbo.maeprod.mae_codi AS codigo, dbo.maeprod.mae_clirut AS rut, dbo.maeprod.mae_tipenv AS tipoenv, 
                      SUM(dbo.detadespa.ddes_unidades) AS unidades_b, SUM(dbo.detadespa.ddes_peso) AS peso_b, SUM(dbo.detadespa.ddes_pallet) AS pallet_b, 
                      dbo.detadespa.ddes_contcli AS contrato
FROM         dbo.detadespa INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.detadespa.ddes_codvig = 0)
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_codi, dbo.detadespa.ddes_fecha, dbo.maeprod.mae_tipenv, dbo.detadespa.ddes_contcli

GO

GO

GO
CREATE VIEW [dbo].[INF_DET_NUM_PROD_contratos]
AS
(SELECT     fecha, codigo, rut, tipoenv, contrato, SUM(unidades_b) AS unidades_b, SUM(peso_b) AS peso_b, SUM(pallet_b) AS pallet_b, 0 AS unidades_a, 
                        0 AS peso_a, 0 AS pallet_a
 FROM         INF_DIA_PROD_DETADESPA_SALDO_contratos AS b
 GROUP BY codigo, rut, tipoenv, contrato, b.fecha)
UNION ALL
(SELECT     fecha, codigo, rut, tipoenv, contrato, 0, 0, 0, SUM(unidades_a) AS unidades, SUM(peso_a) AS peso, SUM(pallet_a) AS pallet
 FROM         INF_DIA_PROD_DETArece_SALDO_contratos AS a
 GROUP BY codigo, rut, tipoenv, contrato, a.fecha)

GO

GO

GO
CREATE VIEW [dbo].[VW_TIEMPOS_ATENCION_RECEPCIONES]
AS
SELECT        dbo.zCheckList.Cl_fol AS FOLIO_INGRESO, dbo.zCheckList.Cl_fec AS FECHA_INGRESO, dbo.clientes.cli_nomb AS CLIENTE, CONVERT(varchar(8), 
                         dbo.zCheckList.Cl_Lleg, 108) AS HORA_LLEGADA, CONVERT(varchar(8), dbo.zCheckList.Cl_ing, 108) AS HORA_INGRESO, CONVERT(varchar(8), 
                         dbo.AndenesReg.fec_reg, 108) AS HORA_APERTURA, CONVERT(varchar(8), dbo.zCheckList.Cl_Des, 108) AS HORA_DESPACHO, dbo.clientes.cli_rut AS RUT_CLIENTE,
                          dbo.fichrece.frec_totsopo AS SOPORTANTES, dbo.fichrece.frec_codi AS FOLIO_RECEPCION, dbo.fichrece.frec_tipdesc AS DESCARGA
FROM            dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.fichrece INNER JOIN
                         dbo.AndenesReg ON dbo.fichrece.frec_rutcli = dbo.AndenesReg.cliente AND dbo.fichrece.frec_clfol = dbo.AndenesReg.Folio ON 
                         dbo.zCheckList.Cl_fol = dbo.fichrece.frec_clfol
WHERE        (dbo.AndenesReg.tip_mov = 'APERTURA')

GO

GO

GO
CREATE VIEW [dbo].[VW_HORADES]
AS
SELECT        SUM(CAST(CONVERT(DATETIME, CAST(HORA_DESPACHO AS time)) AS FLOAT)) / COUNT(HORA_DESPACHO) AS HORADES
FROM            dbo.VW_TIEMPOS_ATENCION_RECEPCIONES

GO

GO

GO
CREATE VIEW [dbo].[VG_DETADESPA_AGRUPADO]
AS
SELECT        SUBSTRING(ddes_codi, 0, 8) AS codi_des, ddes_rutcli, SUM(ddes_unidades) AS unidades, SUM(ddes_peso) AS kilos, COUNT(SUBSTRING(ddes_codi, 0, 8)) 
                         AS pallet
FROM            dbo.detadespa
GROUP BY SUBSTRING(ddes_codi, 0, 8), ddes_rutcli

GO

GO

GO
CREATE VIEW [dbo].[VG_CUADRATURA_DESPA]
AS
SELECT        dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_rutcli, dbo.fichdespa.fdes_totunidad, dbo.fichdespa.fdes_totpeso, dbo.VG_DETADESPA_AGRUPADO.unidades, 
                         dbo.VG_DETADESPA_AGRUPADO.kilos, dbo.fichdespa.fdes_totunidad - dbo.VG_DETADESPA_AGRUPADO.unidades AS dif, dbo.fichdespa.fdes_codpred, 
                         dbo.VG_DETADESPA_AGRUPADO.pallet
FROM            dbo.fichdespa INNER JOIN
                         dbo.VG_DETADESPA_AGRUPADO ON dbo.fichdespa.fdes_codi = dbo.VG_DETADESPA_AGRUPADO.codi_des

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWebok]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.PedidosWebok.Ped_Numero, 23) AS Ped_numero, dbo.PedidosWebok.Ped_RutCliente, 
                      SUM(dbo.PedidosWebok.Ped_Cantidad) AS Ped_cantidad, dbo.PedidosWebok.ped_fechahora, SUM(dbo.PedidosWebok.Ped_Kilos) AS Ped_kilos, 
                      dbo.clientes.cli_nomb AS Ped_cliente, '01' + dbo.pedidowebrelacionrut.Rutcorto + SUBSTRING(dbo.PedidosWebok.Ped_Numero, 10, 14) AS ean128, 
                      dbo.PedidosWebok.Ped_destino
FROM         dbo.PedidosWebok INNER JOIN
                      dbo.clientes ON dbo.PedidosWebok.Ped_RutCliente = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.pedidowebrelacionrut ON dbo.clientes.cli_rut = dbo.pedidowebrelacionrut.Rut
GROUP BY LEFT(dbo.PedidosWebok.Ped_Numero, 23), dbo.PedidosWebok.Ped_RutCliente, dbo.PedidosWebok.ped_fechahora, dbo.clientes.cli_nomb, 
                      dbo.pedidowebrelacionrut.Rutcorto, '01' + dbo.pedidowebrelacionrut.Rutcorto + SUBSTRING(dbo.PedidosWebok.Ped_Numero, 10, 14), 
                      dbo.PedidosWebok.Ped_destino
ORDER BY LEFT(dbo.PedidosWebok.Ped_Numero, 23) DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_TRACKEADOS]
AS
SELECT     SUBSTRING(TRACK_PREDESPACHO, 1, 19) AS TRACK_PEDIDO, SUM(TRACK_CAJA) AS TRACK_TOTALCAJAS
FROM         dbo.TRACKEOCAJAS
GROUP BY SUBSTRING(TRACK_PREDESPACHO, 1, 19)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_COMPARA_TRACKEADOS]
AS
SELECT     dbo.Qry_PedidosWebok.Ped_numero, dbo.Qry_PedidosWebok.Ped_cantidad, dbo.Qry_PedidosWebok.Ped_cliente, 
                      dbo.QRY_PEDIDOSWEBOK_TRACKEADOS.TRACK_TOTALCAJAS, SUBSTRING(dbo.Qry_PedidosWebok.ped_fechahora, 7, 4) 
                      + '/' + SUBSTRING(dbo.Qry_PedidosWebok.ped_fechahora, 4, 2) + '/' + SUBSTRING(dbo.Qry_PedidosWebok.ped_fechahora, 1, 2) AS PED_FECHA, 
                      dbo.Qry_PedidosWebok.Ped_RutCliente, dbo.Qry_PedidosWebok.ean128, dbo.Qry_PedidosWebok.Ped_destino
FROM         dbo.Qry_PedidosWebok LEFT OUTER JOIN
                      dbo.QRY_PEDIDOSWEBOK_TRACKEADOS ON dbo.Qry_PedidosWebok.ean128 = dbo.QRY_PEDIDOSWEBOK_TRACKEADOS.TRACK_PEDIDO

GO

GO

GO
CREATE VIEW [dbo].[VG_TOTAL_DESPACHADO_CLIENTES]
AS
SELECT        dbo.clientes.cli_nomb, dbo.clientes.cli_rut, SUM(dbo.VG_CUADRATURA_DESPA.pallet) AS DES_PALLET, SUM(dbo.VG_CUADRATURA_DESPA.fdes_totunidad) 
                         AS DES_CAJ
FROM            dbo.VG_CUADRATURA_DESPA INNER JOIN
                         dbo.clientes ON dbo.VG_CUADRATURA_DESPA.fdes_rutcli = dbo.clientes.cli_rut
GROUP BY dbo.clientes.cli_nomb, dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_DespachoWeb]
AS
SELECT     TOP 100 PERCENT LEFT(ddes_codi, 7) AS ficha, ddes_codrece AS CodRece, MAX(ddes_fecha) AS fechaDesp, SUM(ddes_pallet) AS pallet, 
                      SUM(ddes_unidades) AS unidades, SUM(ddes_peso) AS peso, ddes_rutcli AS RutDesp, CAST(ddes_camara AS smallint) AS Camara
FROM         dbo.detadespa
WHERE     (ddes_codvig = 0)
GROUP BY ddes_codrece, ddes_rutcli, LEFT(ddes_codi, 7), ddes_camara

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb111]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codi AS Codigo, ISNULL(dbo.detarece.drec_rutcli, 0) AS Rut, dbo.detarece.drec_contcli AS Contrato, 
                      dbo.detarece.drec_fecrec AS Fecha, CAST(SUBSTRING(dbo.detarece.drec_fecrec, 1, 4) + SUBSTRING(dbo.detarece.drec_fecrec, 6, 2) AS numeric) 
                      AS GrupFec, dbo.detarece.drec_codvig AS VigenteRece, dbo.Qry_DespachoWeb.CodRece, dbo.Qry_DespachoWeb.unidades, 
                      dbo.Qry_DespachoWeb.peso, dbo.Qry_DespachoWeb.RutDesp, dbo.Qry_DespachoWeb.fechaDesp, dbo.Qry_DespachoWeb.pallet, 
                      dbo.Qry_DespachoWeb.ficha, dbo.Qry_DespachoWeb.Camara
FROM         dbo.detarece RIGHT OUTER JOIN
                      dbo.Qry_DespachoWeb ON dbo.detarece.drec_codi = dbo.Qry_DespachoWeb.CodRece
GROUP BY dbo.detarece.drec_codi, dbo.detarece.drec_rutcli, dbo.detarece.drec_contcli, dbo.detarece.drec_fecrec, dbo.detarece.drec_codvig, 
                      dbo.Qry_DespachoWeb.CodRece, dbo.Qry_DespachoWeb.unidades, dbo.Qry_DespachoWeb.peso, dbo.Qry_DespachoWeb.RutDesp, 
                      dbo.Qry_DespachoWeb.fechaDesp, dbo.Qry_DespachoWeb.pallet, dbo.Qry_DespachoWeb.ficha, dbo.Qry_DespachoWeb.Camara
HAVING      (dbo.detarece.drec_codvig = N'0')

GO

GO

GO
CREATE VIEW [dbo].[qry_maeprod]
AS
SELECT     *
FROM         dbo.maeprod
WHERE     (mae_codvig = 0)

GO

GO

GO
CREATE VIEW [dbo].[qry_cajastrackeadas_dun14_ARIZTIA_TodasANT]
AS
SELECT     TOP 100 PERCENT dbo.TRACKEOCAJAS.TRACK_CAJACLIENTE AS CAJACLIENTE, LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) AS PALLET, 
                      dbo.qry_maeprod.mae_dun14 AS DUN14, dbo.TRACKEOCAJAS.TRACK_CAJA AS UNIDAD, dbo.TRACKEOCAJAS.TRACK_CODCAJA AS CODIGOBARRA, 
                      dbo.qry_maeprod.mae_descr AS PRODUCTO, dbo.qry_maeprod.mae_clirut AS RUTCLIENTE, 
                      dbo.TRACKEOCAJAS.TRACK_PREDESPACHO AS PEDIDO
FROM         dbo.TRACKEOCAJAS LEFT OUTER JOIN
                      dbo.qry_maeprod ON dbo.TRACKEOCAJAS.TRACK_DUN14 = dbo.qry_maeprod.mae_dun14
WHERE     (dbo.qry_maeprod.mae_codvig <> '1')

GO

GO

GO
CREATE VIEW [dbo].[qry_cajastrackeadas_dun14_ARIZTIA_Todas1]
AS
SELECT     TOP 100 PERCENT dbo.TRACKEOCAJAS.TRACK_CAJACLIENTE AS CAJACLIENTE, LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) AS PALLET, 
                      dbo.qry_maeprod.mae_dun14 AS DUN14, dbo.TRACKEOCAJAS.TRACK_CAJA AS UNIDAD, dbo.TRACKEOCAJAS.TRACK_CODCAJA AS CODIGOBARRA, 
                      dbo.qry_maeprod.mae_descr AS PRODUCTO, dbo.detarece.drec_rutcli AS RUTCLIENTE, dbo.TRACKEOCAJAS.TRACK_PREDESPACHO AS PEDIDO
FROM         dbo.TRACKEOCAJAS LEFT OUTER JOIN
                      dbo.detarece ON LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) = dbo.detarece.drec_codi LEFT OUTER JOIN
                      dbo.qry_maeprod ON dbo.TRACKEOCAJAS.TRACK_DUN14 = dbo.qry_maeprod.mae_dun14 AND 
                      dbo.detarece.drec_rutcli = dbo.qry_maeprod.mae_clirut
WHERE     (dbo.TRACKEOCAJAS.TRACK_PREDESPACHO LIKE '%180854263')

GO

GO

GO
CREATE VIEW [dbo].[qry_cajastrackeadas_dun14_ARIZTIA_Todas]
AS
SELECT     TOP 100 PERCENT dbo.TRACKEOCAJAS.TRACK_CAJACLIENTE AS CAJACLIENTE, LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) AS PALLET, 
                      dbo.qry_maeprod.mae_dun14 AS DUN14, dbo.TRACKEOCAJAS.TRACK_CAJA AS UNIDAD, dbo.TRACKEOCAJAS.TRACK_CODCAJA AS CODIGOBARRA, 
                      dbo.qry_maeprod.mae_descr AS PRODUCTO, dbo.qry_maeprod.mae_clirut AS RUTCLIENTE, 
                      dbo.TRACKEOCAJAS.TRACK_PREDESPACHO AS PEDIDO
FROM         dbo.detarece INNER JOIN
                      dbo.qry_maeprod ON dbo.detarece.drec_codpro = dbo.qry_maeprod.mae_codi RIGHT OUTER JOIN
                      dbo.TRACKEOCAJAS ON dbo.detarece.drec_codi = LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9)
WHERE     (dbo.qry_maeprod.mae_codvig <> '1')

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWebok_Guia_P]
AS
SELECT     TOP 100 PERCENT rutclien AS cliente, frec_guiades AS guiacliente, FECREC AS fecha, LEFT(FRIGORI, 7) AS recepcion, COUNT(FRIGORI) AS tot_pallet, 
                      SUM(peso) AS tot_peso, SUM(cantidad) AS tot_unidades, drec_contcli AS contrato
FROM         dbo.QRY_SOPORTANTES_V42
WHERE     (racd_pedido = '1') AND (racd_estadopallet = '0')
GROUP BY rutclien, LEFT(FRIGORI, 7), frec_guiades, FECREC, drec_contcli
ORDER BY rutclien, frec_guiades DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWebok_Guia]
AS
SELECT     TOP 100 PERCENT dbo.QRY_SOPORTANTES_V42.rutclien AS cliente, dbo.QRY_SOPORTANTES_V42.frec_guiades AS guiacliente, 
                      dbo.QRY_SOPORTANTES_V42.FECREC AS fecha, LEFT(dbo.QRY_SOPORTANTES_V42.FRIGORI, 7) AS recepcion, 
                      COUNT(dbo.QRY_SOPORTANTES_V42.FRIGORI) AS tot_pallet, SUM(dbo.QRY_SOPORTANTES_V42.peso) AS tot_peso, 
                      SUM(dbo.QRY_SOPORTANTES_V42.cantidad) AS tot_unidades, dbo.QRY_SOPORTANTES_V42.drec_contcli AS contrato, 
                      dbo.Qry_PedidosWebok_Guia_P.tot_pallet AS PalletS, dbo.Qry_PedidosWebok_Guia_P.tot_peso AS PesoS, 
                      dbo.Qry_PedidosWebok_Guia_P.tot_unidades AS UnidadesS
FROM         dbo.QRY_SOPORTANTES_V42 LEFT OUTER JOIN
                      dbo.Qry_PedidosWebok_Guia_P ON LEFT(dbo.QRY_SOPORTANTES_V42.FRIGORI, 7) = dbo.Qry_PedidosWebok_Guia_P.recepcion
WHERE     (dbo.QRY_SOPORTANTES_V42.racd_estadopallet = '0')
GROUP BY dbo.QRY_SOPORTANTES_V42.rutclien, LEFT(dbo.QRY_SOPORTANTES_V42.FRIGORI, 7), dbo.QRY_SOPORTANTES_V42.frec_guiades, 
                      dbo.QRY_SOPORTANTES_V42.FECREC, dbo.QRY_SOPORTANTES_V42.drec_contcli, dbo.Qry_PedidosWebok_Guia_P.tot_pallet, 
                      dbo.Qry_PedidosWebok_Guia_P.tot_peso, dbo.Qry_PedidosWebok_Guia_P.tot_unidades
ORDER BY dbo.QRY_SOPORTANTES_V42.rutclien, dbo.QRY_SOPORTANTES_V42.frec_guiades DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWebok_Guia2]
AS
SELECT     TOP 100 PERCENT rutclien AS cliente, frec_guiades AS guiacliente, FECREC AS fecha, LEFT(FRIGORI, 7) AS recepcion, COUNT(FRIGORI) AS tot_pallet, 
                      SUM(peso) AS tot_peso, SUM(cantidad) AS tot_unidades, drec_contcli AS contrato
FROM         dbo.QRY_SOPORTANTES_V42
WHERE     (racd_estadopallet = '0')
GROUP BY rutclien, LEFT(FRIGORI, 7), frec_guiades, FECREC, drec_contcli, racd_estadopallet
ORDER BY rutclien, frec_guiades DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWebok_Guia22]
AS
SELECT     TOP 100 PERCENT rutclien AS cliente, frec_guiades AS guiacliente, FECREC AS fecha, LEFT(FRIGORI, 7) AS recepcion, COUNT(FRIGORI) AS tot_pallet, 
                      SUM(peso) AS tot_peso, SUM(cantidad) AS tot_unidades, drec_contcli AS contrato, SUM(racd_solicitado) AS Tot_solicitado
FROM         dbo.QRY_SOPORTANTES_V42
WHERE     (racd_estadopallet = '0') AND (racd_pedido <> 1)
GROUP BY rutclien, LEFT(FRIGORI, 7), frec_guiades, FECREC, drec_contcli
ORDER BY rutclien, frec_guiades DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWebok_Guia23]
AS
SELECT     TOP 100 PERCENT rutclien AS cliente, frec_guiades AS guiacliente, FECREC AS fecha, LEFT(FRIGORI, 7) AS recepcion, COUNT(FRIGORI) AS tot_pallet, 
                      SUM(peso) AS tot_peso, SUM(cantidad) AS tot_unidades, drec_contcli AS contrato, SUM(racd_solicitado) AS Tot_solicitado, SUM(CONVERT(int, 
                      racd_pedido)) AS palletsolicitados
FROM         dbo.QRY_SOPORTANTES_V42
WHERE     (racd_estadopallet = '0') AND (racd_ca <> '99')
GROUP BY rutclien, LEFT(FRIGORI, 7), frec_guiades, FECREC, drec_contcli
ORDER BY rutclien, frec_guiades DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_FactDiasTunel]
AS
SELECT DISTINCT 
                      dbo.detarece.drec_codi AS Codigo, dbo.contrato.cont_codi AS Cotrato, dbo.contrato.cont_diacont AS Dias, DATEADD(day, dbo.contrato.cont_diacont, 
                      CONVERT(datetime, dbo.detarece.drec_fecrec, 120)) AS FechaDiasGracia
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.contrato ON dbo.detarece.drec_contcli = dbo.contrato.cont_codi COLLATE SQL_Latin1_General_CP1_CI_AS

GO

GO

GO
CREATE VIEW [dbo].[Qry_DetaReceServicio24]
AS
SELECT     dbo.detarece.drec_fecrec AS Fecha, dbo.detarece.drec_unidades AS Unidades, dbo.detarece.drec_peso AS Peso, dbo.detarece.drec_pallet AS Pallet, 
                      dbo.detarece.drec_codvig AS Vigente, dbo.detarece.drec_rutcli AS Rut, dbo.detarece.drec_codi, ISNULL(dbo.detarece.drec_RecepTunel, 0) 
                      AS TipoRecepcion, dbo.detarece.drec_contcli AS Contrato, DATEADD(day, ISNULL(dbo.Qry_FactDiasTunel.Dias, 0), CONVERT(datetime, 
                      dbo.detarece.drec_fecrec, 120)) AS FechaDiasGracia, dbo.Qry_FactDiasTunel.Dias
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.Qry_FactDiasTunel ON dbo.detarece.drec_codi = dbo.Qry_FactDiasTunel.Codigo

GO

GO

GO
CREATE VIEW [dbo].[Qry_DespachoWeb39]
AS
SELECT     *, LEFT(ddes_codi, 7) AS Cod_Desp, CAST(SUBSTRING(ddes_fecha, 1, 4) + SUBSTRING(ddes_fecha, 6, 2) AS numeric) AS GrupFec
FROM         dbo.detadespa

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb39]
AS
SELECT     dbo.Qry_DespachoWeb39.ddes_fecha AS FechaDespacho, dbo.Qry_DespachoWeb39.ddes_rutcli AS Rut, 
                      dbo.Qry_DespachoWeb39.ddes_contcli AS Contrato, dbo.Qry_DespachoWeb39.ddes_unidades AS Unidades, 
                      dbo.Qry_DespachoWeb39.ddes_peso AS Peso, dbo.Qry_DespachoWeb39.ddes_pallet AS Pallet, dbo.cincuenta.cincuenta, 
                      dbo.cincuenta.fecha AS FechaCincuenta, dbo.Qry_DespachoWeb39.ddes_codi AS Despachos, dbo.Qry_DespachoWeb39.ddes_codrece AS Recepcion, 
                      dbo.Qry_DespachoWeb39.GrupFec, dbo.cincuenta.carga
FROM         dbo.cincuenta RIGHT OUTER JOIN
                      dbo.Qry_DespachoWeb39 ON dbo.cincuenta.despacho = dbo.Qry_DespachoWeb39.Cod_Desp

GO

GO

GO
CREATE VIEW [dbo].[manuel]
AS
SELECT     *
FROM         dbo.QRY_PEDIDOSWEBOK_COMPARA_TRACKEADOS
WHERE     (Ped_RutCliente = '825570004' OR
                      Ped_RutCliente = '836148002') AND (PED_FECHA BETWEEN '2010/10/12' AND '2010/10/22')

GO

GO

GO
CREATE VIEW [dbo].[QRY_ESTADISTICA_TRACKEO_ARIZTIA]
AS
SELECT     TOP 100 PERCENT *
FROM         dbo.QRY_PEDIDOSWEBOK_COMPARA_TRACKEADOS
WHERE     (Ped_RutCliente = '825570004' OR
                      Ped_RutCliente = '836148002') AND (PED_FECHA BETWEEN '2010/11/14' AND '2010/11/26')
ORDER BY Ped_cliente

GO

GO

GO
CREATE VIEW [dbo].[Qry_Contrato_Hist]
AS
SELECT     TOP 100 PERCENT *, CAST(cont_GrupFec AS VARCHAR(10)) AS GrupFec
FROM         dbo.contrato_hist
ORDER BY cont_rutclie_hist, cont_codi_hist, cont_GrupFec DESC


GO

GO

GO
CREATE VIEW [dbo].[Qry_DetaReceGrupFecWeb]
AS
SELECT     dbo.detarece.*, CAST(SUBSTRING(drec_fecrec, 1, 4) + SUBSTRING(drec_fecrec, 6, 2) AS varchar) AS GrupFec
FROM         dbo.detarece


GO

GO

GO
CREATE VIEW [dbo].[Qry_FactDiasTunelWeb]
AS
SELECT     drec_codi AS Codigo, drec_contcli AS Contrato, drec_fecrec, drec_unidades, drec_peso, drec_codvig, drec_pallet, ISNULL(drec_RecepTunel, 0) 
                      AS drec_RecepTunel, drec_rutcli,
                          (SELECT     TOP 1 isnull(y.cont_diacont_hist, 0)
                            FROM          Qry_Contrato_Hist y
                            WHERE      cast(isnull(x.GrupFec, 0) AS numeric) >= cast(isnull(y.GrupFec, 0) AS numeric) AND 
                                                   x.drec_contcli = y.cont_codi_hist COLLATE SQL_Latin1_General_CP1_CI_AS AND 
                                                   x.drec_rutcli = y.cont_rutclie_hist COLLATE SQL_Latin1_General_CP1_CI_AS) AS Dias, GrupFec
FROM         dbo.Qry_DetaReceGrupFecWeb x


GO

GO

GO
CREATE VIEW [dbo].[Qry_DetaReceServicioWEb24]
AS
SELECT     drec_unidades AS Unidades, drec_peso AS Peso, drec_pallet AS Pallet, drec_codvig AS Vigente, drec_rutcli AS Rut, Codigo, ISNULL(drec_RecepTunel, 
                      0) AS TipoRecepcion, Contrato, DATEADD(day, ISNULL(Dias, 0), CONVERT(datetime, drec_fecrec, 120)) AS FechaDiasGracia, drec_fecrec
FROM         dbo.Qry_FactDiasTunelWeb



GO

GO

GO
CREATE VIEW [dbo].[vwebstockdeta]
AS
SELECT mae_codi AS codprod,mae_codcli AS codclie,mae_descr AS glosaprod,tenv_descr,tsop_descr as soportante,
tsop_codi as codsop,
drec_codi AS fprecisa,drec_sopocli AS fcliente,
racd_fecpro ,drec_fecrec AS frecep,rackdeta.fechavencimiento,drec_codsag,
racd_unidades AS unidades,racd_peso AS Kilos,
racd_ca as camara,racd_ba as banda,racd_co as columna,racd_pi as piso,racd_ni as nivel,
racd_estado as estado,mae_clirut as rutclie,drec_contcli as contrato,cli_nomb as nomclie
FROM rackdeta LEFT JOIN (maeprod  INNER JOIN tipoenv on mae_tipenv=tenv_codi 
INNER JOIN clientes ON cli_rut=mae_clirut) 
ON racd_codpro=mae_codi  
INNER JOIN (detarece INNER JOIN tiposopo ON drec_codsopo=convert(int,tsop_codi)) ON racd_codi=drec_codi;

GO

GO

GO
CREATE VIEW [dbo].[vwebinfsopo]
AS
SELECT 
   CASE 
      WHEN  tenv_descr LIKE '%TOTE%' THEN sum(1) 
      ELSE 0
   END as TOTE,
   CASE 
      WHEN  tenv_descr LIKE '%TAMB%' THEN sum(1) 
      ELSE 0
   END as TAMBORES,
   CASE 
      WHEN  ((tenv_descr NOT LIKE '%TOTE%') OR (tenv_descr LIKE '%TAMB%')) THEN sum(1) 
      ELSE 0
   END as PALLETS,
   nomclie, sum(kilos) AS kilos,
sum(unidades) as envases,
   CASE 
      WHEN  tenv_descr LIKE '%TOTE%' THEN 'totes'
      WHEN  tenv_descr LIKE '%TAMB%' THEN 'Tsmbores'
      WHEN  ((tenv_descr NOT LIKE '%TOTE%') OR (tenv_descr LIKE '%TAMB%')) THEN 'Pallets'
   END as tpoenv
FROM vwebstockdeta WHERE  rutclie<>'116095327' AND Kilos  is NOT null
GROUP BY nomclie,tenv_descr;
GO

GO

GO
CREATE VIEW [dbo].[vg_cant]
AS
SELECT        COUNT(racd_codi) AS cant, racd_ca, racd_ba, racd_co
FROM            dbo.rackdeta
GROUP BY racd_ca, racd_ba, racd_co

GO

GO

GO
CREATE VIEW [dbo].[VG_CUENTAPALLETS2]
AS
SELECT        dbo.vg_cant.cant AS cantidad, dbo.vg_cant.racd_ca AS camara, dbo.vg_cant.racd_ba AS banda, dbo.vg_cant.racd_co AS columna, 
                         dbo.CamaraMantenedor.Cordenada, dbo.CamaraMantenedor.NombreCamara
FROM            dbo.vg_cant INNER JOIN
                         dbo.CamaraMantenedor ON dbo.vg_cant.racd_ca = dbo.CamaraMantenedor.Camara AND dbo.vg_cant.racd_ba = dbo.CamaraMantenedor.Banda AND 
                         dbo.vg_cant.racd_co = dbo.CamaraMantenedor.Columna
GROUP BY dbo.vg_cant.cant, dbo.vg_cant.racd_ca, dbo.vg_cant.racd_ba, dbo.vg_cant.racd_co, dbo.CamaraMantenedor.Cordenada, dbo.CamaraMantenedor.NombreCamara

GO

GO

GO
CREATE VIEW [dbo].[VG_CUADRATURA_TOTAL_REC_DES]
AS
SELECT        dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].cli_nomb, dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].cli_rut, dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].REC_PALL, 
                         dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].REC_CAJ, dbo.VG_TOTAL_DESPACHADO_CLIENTES.DES_PALLET, dbo.VG_TOTAL_DESPACHADO_CLIENTES.DES_CAJ, 
                         dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].REC_PALL - dbo.VG_TOTAL_DESPACHADO_CLIENTES.DES_PALLET AS STOCK_PALLET, 
                         dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].REC_CAJ - dbo.VG_TOTAL_DESPACHADO_CLIENTES.DES_CAJ AS STOCK_CAJ
FROM            dbo.[VG_TOTAL RECEPCIONADO_CLIENTES] INNER JOIN
                         dbo.VG_TOTAL_DESPACHADO_CLIENTES ON dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].cli_nomb = dbo.VG_TOTAL_DESPACHADO_CLIENTES.cli_nomb AND 
                         dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].cli_rut = dbo.VG_TOTAL_DESPACHADO_CLIENTES.cli_rut
WHERE        (dbo.[VG_TOTAL RECEPCIONADO_CLIENTES].REC_PALL - dbo.VG_TOTAL_DESPACHADO_CLIENTES.DES_PALLET > 0)

GO

GO

GO
CREATE VIEW [dbo].[VG_CONTROL_PREDESPACHOS]
AS
SELECT        dbo.VG_CUADRATURA_TOTAL_REC_DES.cli_rut, dbo.VG_CUADRATURA_TOTAL_REC_DES.cli_nomb, dbo.fichpred.fpre_codi, dbo.fichpred.fpre_fecdes, 
                         DATEDIFF(day, CONVERT(date, dbo.fichpred.fpre_fecdes), CONVERT(date, GETDATE())) AS DIF
FROM            dbo.VG_CUADRATURA_TOTAL_REC_DES INNER JOIN
                         dbo.fichpred ON dbo.VG_CUADRATURA_TOTAL_REC_DES.cli_rut = dbo.fichpred.fpre_rutcli
WHERE        (dbo.fichpred.fpre_gdespa = N'0') AND (dbo.fichpred.fpre_codvig = N'0')

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Cargas_Detalle]
AS
SELECT     TOP 100 PERCENT dbo.fichdespa.fdes_rutcli, dbo.detadespa.ddes_contcli, dbo.fichdespa.fdes_tipcarga, dbo.fichdespa.fdes_fecha, 
                      dbo.fichdespa.fdes_codi, SUM(dbo.detadespa.ddes_pallet) AS pallet, SUM(dbo.detadespa.ddes_unidades) AS unidades, 
                      SUM(dbo.detadespa.ddes_peso) AS peso
FROM         dbo.fichdespa INNER JOIN
                      dbo.detadespa ON dbo.fichdespa.fdes_codi = LEFT(dbo.detadespa.ddes_codi, 7)
WHERE     (dbo.fichdespa.fdes_origen <> '65') AND (dbo.fichdespa.fdes_origen <> '99') AND (dbo.fichdespa.fdes_origen <> '97') AND 
                      (dbo.detadespa.ddes_codvig = '0') AND (dbo.fichdespa.fdes_codvig = '0')
GROUP BY dbo.fichdespa.fdes_rutcli, dbo.detadespa.ddes_contcli, dbo.fichdespa.fdes_tipcarga, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_codi
ORDER BY dbo.detadespa.ddes_contcli, dbo.fichdespa.fdes_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Cargas_Resumen]
AS
SELECT     fdes_rutcli, ddes_contcli, fdes_tipcarga, SUM(pallet) AS TotPal, SUM(unidades) AS TotUni, SUM(peso) AS TotPes, fdes_fecha
FROM         dbo.Qry_Facturacion_Cargas_Detalle
GROUP BY fdes_rutcli, ddes_contcli, fdes_tipcarga, fdes_fecha

GO

GO

GO
CREATE VIEW [dbo].[vg_calcrack]
AS
SELECT        racd_ca, racd_ba, racd_co, racd_pi
FROM            dbo.rackdeta

GO

GO

GO
CREATE VIEW [dbo].[vg_pr]
AS
SELECT        racd_ca, racd_ba, racd_co
FROM            dbo.vg_calcrack

GO

GO

GO
CREATE VIEW [dbo].[QRY_LOG_RECEPCION_DETALLE_MAS]
AS
SELECT     TOP 100 PERCENT dbo.Qry_Log_Recepcion_Detalle.log_id, dbo.Qry_Log_Recepcion_Detalle.log_Nrecepcion, 
                      dbo.Qry_Log_Recepcion_Detalle.log_fecha_hora, dbo.Qry_Log_Recepcion_Detalle.log_usuario, dbo.Qry_Log_Recepcion_Detalle.log_usergestion, 
                      dbo.Qry_Log_Recepcion_Detalle.descri, dbo.Qry_Log_Recepcion_Detalle.TIPOMOV, dbo.Qry_Log_Recepcion_Detalle.cli_nomb, 
                      dbo.Qry_Log_Recepcion_Detalle.cli_rut, dbo.fichrece.frec_fecrec, dbo.fichrece.frec_RecepTunel
FROM         dbo.Qry_Log_Recepcion_Detalle INNER JOIN
                      dbo.fichrece ON dbo.Qry_Log_Recepcion_Detalle.log_Nrecepcion = dbo.fichrece.frec_codi
WHERE     (dbo.Qry_Log_Recepcion_Detalle.cli_nomb LIKE 'walmart%') AND (dbo.Qry_Log_Recepcion_Detalle.TIPOMOV = 'modificaciones')
ORDER BY dbo.fichrece.frec_fecrec DESC

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[vDetaDespa]
AS
SELECT     ddes_codi, SUBSTRING(ddes_codi, 1, LEN(ddes_codi) - 2) AS ddes_codigo, SUBSTRING(ddes_codi, LEN(ddes_codi) - 1, 2) AS ddes_Linea, 
                      ddes_codpro, ddes_codsopo, ddes_sopocli, ddes_unidades, ddes_peso, ddes_fecprod, ddes_fecha, ddes_rutcli, ddes_contcli, ddes_camara, 
                      ddes_codpred, ddes_almacen, ddes_codrece, ddes_codvig, ddes_pallet
FROM         dbo.detadespa
WHERE     (ddes_camara = N'02')



GO

GO

GO

CREATE VIEW [dbo].[vDetalleDespaSlot]
AS
SELECT     dbo.fichdespa.fdes_codi, dbo.vDetaDespa.ddes_rutcli, dbo.vDetaDespa.ddes_contcli, dbo.vDetaDespa.ddes_codi, dbo.vDetaDespa.ddes_codigo, 
                      dbo.vDetaDespa.ddes_Linea, dbo.vDetaDespa.ddes_unidades, dbo.vDetaDespa.ddes_peso, dbo.vDetaDespa.ddes_pallet, 
                      dbo.vDetaDespa.ddes_fecprod, dbo.vDetaDespa.ddes_fecha, dbo.vDetaDespa.ddes_camara
FROM         dbo.fichdespa INNER JOIN
                      dbo.vDetaDespa ON dbo.fichdespa.fdes_codi = dbo.vDetaDespa.ddes_codigo
WHERE     (dbo.fichdespa.fdes_codvig = N'0')


GO

GO

GO
CREATE VIEW [dbo].[VG_POSICIONES_LIBRES]
AS
SELECT        dbo.Rack_Altura.rack_altura AS ALTURA, dbo.Rack_Altura.rack_ca, dbo.Rack_Altura.rack_ba, dbo.Rack_Altura.rack_co, dbo.Rack_Altura.rack_pi, 
                         dbo.Rack_Altura.Bloqueo
FROM            dbo.Rack_Altura LEFT OUTER JOIN
                         dbo.rackdeta ON dbo.Rack_Altura.rack_ca = dbo.rackdeta.racd_ca AND dbo.Rack_Altura.rack_ba = dbo.rackdeta.racd_ba AND 
                         dbo.Rack_Altura.rack_co = dbo.rackdeta.racd_co AND dbo.Rack_Altura.rack_pi = dbo.rackdeta.racd_pi
WHERE        (dbo.rackdeta.racd_codi IS NULL)

GO

GO

GO
CREATE VIEW [dbo].[VG_ALTURA_CAMARAS]
AS
SELECT        ALTURA, COUNT(ALTURA) AS CANTIDAD, rack_ca AS CAMARA
FROM            dbo.VG_POSICIONES_LIBRES
GROUP BY ALTURA, rack_ca
HAVING        (COUNT(ALTURA) > 1)

GO

GO

GO
CREATE VIEW [dbo].[VG_POSICIONES]
AS
SELECT        rack_ca AS CA, rack_ba AS BA, rack_co AS CO, rack_pi AS PI, Bloqueo AS BLOQUEO, ALTURA
FROM            dbo.VG_POSICIONES_LIBRES

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[vDetaRece]
AS
SELECT     drec_codi, SUBSTRING(drec_codi, 1, LEN(drec_codi) - 2) AS drec_codigo, SUBSTRING(drec_codi, LEN(drec_codi) - 1, 2) AS drec_Linea, drec_codpro, 
                      drec_origen, drec_codsopo, drec_sopocli, drec_unidades, drec_fecrec, drec_peso, drec_rutcli, drec_contcli, drec_fecprod, drec_camara, drec_banda, 
                      drec_colum, drec_piso, drec_nivel, drec_almacen, drec_dcaja, drec_tunel, drec_codvig, drec_pallet, drec_codrel, drec_nrosopo, drec_slot, 
                      drec_codsag, drec_dtgracia
FROM         dbo.detarece
WHERE     ( drec_camara = N'19')




GO

GO

GO

CREATE VIEW [dbo].[vDetalleRecepSlot]
AS
SELECT     dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_contcli, dbo.vDetaRece.drec_codi, dbo.vDetaRece.drec_codigo, 
                      dbo.vDetaRece.drec_Linea, dbo.vDetaRece.drec_pallet, dbo.vDetaRece.drec_unidades, dbo.vDetaRece.drec_peso, dbo.vDetaRece.drec_slot, 
                      dbo.vDetaRece.drec_fecrec, dbo.vDetaRece.drec_fecprod
FROM         dbo.fichrece INNER JOIN
                      dbo.vDetaRece ON dbo.fichrece.frec_codi = dbo.vDetaRece.drec_codigo
WHERE     (dbo.fichrece.frec_codvig = N'0')


GO

GO

GO
CREATE VIEW [dbo].[QRY_INF_FACTURASWEB]
AS
SELECT     TOP 100 PERCENT dbo.FACTURASWEB.FACT_ID, dbo.FACTURASWEB.FACT_NUMERO, dbo.FACTURASWEB.FACT_RUTCLI, 
                      dbo.clientes.cli_nomb AS FACT_NOMCLI, dbo.FACTURASWEB.FACT_NOMARCHIVO, dbo.FACTURASWEB.FACT_FECHA, 
                      dbo.FACTURASWEB.FACT_GLOSA, dbo.FACTURASWEB.FACT_TIPODOCUMENTO, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, 
                      dbo.FACTURASWEB.FACT_FECHA, 105)), 111) AS FACT_FECHAEMISION
FROM         dbo.FACTURASWEB INNER JOIN
                      dbo.clientes ON dbo.FACTURASWEB.FACT_RUTCLI = dbo.clientes.cli_rut
ORDER BY CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.FACTURASWEB.FACT_FECHA, 105)), 111) DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_FACTURASWEB]
AS
SELECT     FACT_NUMERO, FACT_RUTCLI, FACT_NOMCLI, FACT_FECHA, FACT_GLOSA, FACT_ID, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, 
                      FACT_FECHA, 105)), 111) AS FECHAEMISION, FACT_NOMARCHIVO
FROM         dbo.QRY_INF_FACTURASWEB
GROUP BY FACT_NUMERO, FACT_RUTCLI, FACT_NOMCLI, FACT_FECHA, FACT_GLOSA, FACT_ID, FACT_NOMARCHIVO

GO

GO

GO
CREATE VIEW [dbo].[VW_PEDIDO_GUIA]
AS
SELECT        TOP (100) PERCENT dbo.vwestadopedguia.frec_guiades, dbo.vwestadopedguia.frec_codi, dbo.vwestadopedguia.frec_fecrec, dbo.vwestadopedguia.frec_rutcli, 
                         SUM(dbo.vwestadopedguia.unidades) AS ncajas, SUM(dbo.vwestadopedguia.Soportantes) AS pallets, SUM(dbo.vwestadopedguia.cpedidas) AS cajasped, 
                         SUM(dbo.vwestadopedguia.cajassel) AS cajassel, SUM(dbo.vwestadopedguia.FREC_TOTPESO) AS totpeso, COUNT(dbo.pedidoguias.pguia_nguia) AS seleccionado, 
                         ISNULL(dbo.pedidoguias.pguia_estado, 0) AS estadoguia, dbo.vwestadopedguia.frec_contcli,
                             (SELECT        COUNT(*) AS Expr1
                               FROM            dbo.tuneles
                               WHERE        (dbo.vwestadopedguia.frec_codi = frec_guia) AND (temp_salida IS NOT NULL)) AS Expr1, DATEDIFF(hh,
                             (SELECT        MAX(fechora_salida) AS Expr1
                               FROM            dbo.tuneles AS tuneles_2
                               WHERE        (frec_guia = dbo.vwestadopedguia.frec_codi)), GETDATE()) AS diff,
                             (SELECT DISTINCT cli_hrs_homog
                               FROM            dbo.clientes
                               WHERE        (cli_rut = '591854208')) AS hrs_homog,
                             (SELECT DISTINCT cli_hrs_homog
                               FROM            dbo.clientes AS clientes_1
                               WHERE        (cli_rut = '591854208')) - DATEDIFF(hh,
                             (SELECT        MAX(fechora_salida) AS Expr1
                               FROM            dbo.tuneles AS tuneles_1
                               WHERE        (frec_guia = dbo.vwestadopedguia.frec_codi)), GETDATE()) AS restante
FROM            dbo.vwestadopedguia LEFT OUTER JOIN
                         dbo.pedidoguias ON dbo.pedidoguias.pguia_nguia = dbo.vwestadopedguia.frec_codi AND dbo.pedidoguias.pguia_rutclie = dbo.vwestadopedguia.frec_rutcli
WHERE        (dbo.vwestadopedguia.racd_estado <> 2)
GROUP BY dbo.vwestadopedguia.frec_guiades, dbo.vwestadopedguia.frec_fecrec, dbo.vwestadopedguia.frec_rutcli, dbo.vwestadopedguia.frec_codi, 
                         dbo.vwestadopedguia.frec_contcli, dbo.pedidoguias.pguia_estado
ORDER BY dbo.vwestadopedguia.frec_fecrec

GO

GO

GO
CREATE VIEW [dbo].[qry_despacho_11_CONTRATO]
AS
SELECT     TOP 100 PERCENT dbo.fichdespa.fdes_fecha AS FECHEGRE, dbo.fichdespa.fdes_hora AS HORAEGRE, dbo.fichdespa.fdes_codi AS GUIAEGRE, 
                      dbo.origen.ori_descr AS DESCORDE, dbo.fichdespa.fdes_rutcli AS RUTCLIEN, dbo.fichdespa.fdes_GuiaCliente, 
                      dbo.qry_detadespa_detalle_cajas_resumen.tot_cajas, dbo.fichdespa.fdes_destino, dbo.detarece.drec_contcli AS CONTRATO
FROM         dbo.fichdespa INNER JOIN
                      dbo.detadespa ON dbo.fichdespa.fdes_codi = LEFT(dbo.detadespa.ddes_codi, 7) INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi LEFT OUTER JOIN
                      dbo.qry_detadespa_detalle_cajas_resumen ON dbo.fichdespa.fdes_codi = dbo.qry_detadespa_detalle_cajas_resumen.despacho LEFT OUTER JOIN
                      dbo.origen ON dbo.fichdespa.fdes_origen = dbo.origen.ori_codi
WHERE     (dbo.fichdespa.fdes_codvig <> 1)
GROUP BY dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_hora, dbo.fichdespa.fdes_codi, dbo.origen.ori_descr, dbo.fichdespa.fdes_rutcli, 
                      dbo.fichdespa.fdes_GuiaCliente, dbo.qry_detadespa_detalle_cajas_resumen.tot_cajas, dbo.fichdespa.fdes_destino, dbo.detarece.drec_contcli
ORDER BY dbo.fichdespa.fdes_fecha DESC, dbo.fichdespa.fdes_hora DESC

GO

GO

GO
CREATE VIEW [dbo].[RGP_Stock_Rece_Desp]
as
SELECT cli_nomb as cliente,drec_codi as CodPrecisa,drec_codpro as CodProd,drec_sopocli as sopocli,drec_unidades as unidades,
drec_peso as peso,drec_fecrec as fecha,drec_rutcli as rutcli,drec_pallet as pallet,drec_codvig as codvig,1 as rece,
CASE 
      WHEN  tenv_descr LIKE '%TOTE%' THEN 'tote'
      WHEN  tenv_descr LIKE '%TAMB%' THEN 'Tambor'
      WHEN  ((tenv_descr NOT LIKE '%TOTE%') OR (tenv_descr LIKE '%TAMB%')) THEN 'Pallets'
END AS Envase
FROM detarece 
INNER JOIN clientes ON drec_rutcli=cli_rut
INNER JOIN (maeprod  INNER JOIN tipoenv on mae_tipenv=tenv_codi) ON drec_codpro=mae_codi
WHERE drec_codvig=0 and drec_rutcli<>'116095327' 
Union
SELECT cli_nomb as cliente,ddes_codi as CodPrecisa,ddes_codpro as CodProd,ddes_sopocli as sopocli,ddes_unidades as unidades,
ddes_peso as peso ,ddes_fecha as fecha,ddes_rutcli as rutcli,ddes_pallet as pallet,ddes_codvig as codvig,0 as rece,
CASE 
      WHEN  tenv_descr LIKE '%TOTE%' THEN 'tote'
      WHEN  tenv_descr LIKE '%TAMB%' THEN 'Tambor'
      WHEN  ((tenv_descr NOT LIKE '%TOTE%') OR (tenv_descr LIKE '%TAMB%')) THEN 'Pallets'
END AS Envase
FROM detadespa  
INNER JOIN clientes ON ddes_rutcli=cli_rut
INNER JOIN (maeprod  INNER JOIN tipoenv on mae_tipenv=tenv_codi) ON ddes_codpro=mae_codi
WHERE ddes_codvig=0 and ddes_rutcli<>'116095327' 
GO

GO

GO
CREATE VIEW [dbo].[RGP_INFORME]
AS
SELECT rutcli,cliente,envase,fecha,
sum(CASE WHEN  rece=1 then pallet END) as recepcion,
sum(CASE WHEN  rece=1 then unidades END) as unidrec,
sum(CASE WHEN  rece=1 then peso END) as pesorec,
isnull(sum(CASE WHEN  rece=0 then isnull(pallet,0) END),0) as Despacho,
isnull(sum(CASE WHEN  rece=0 then isnull(unidades,0) END),0)  as uniddesp,
isnull(sum(CASE WHEN  rece=0 then isnull(peso,0) END),0)  as pesodes
FROM RGP_Stock_Rece_Desp 
GROUP BY fecha,rutcli,cliente,envase
GO

GO

GO
CREATE VIEW [dbo].[RGP_INFORME2]
AS
SELECT cliente,
CASE 
      WHEN  envase = 'pallets' THEN SUM(Recepcion) - sum(despacho) 
      ELSE 0
   END as PALLETS,
   CASE 
      WHEN  envase = 'tote' THEN SUM(Recepcion) - sum(despacho) 
      ELSE 0
   END as TOTE,
   CASE 
      WHEN  envase = 'tambor' THEN SUM(Recepcion) - sum(despacho) 
      ELSE 0
   END as TAMBORES,SUM(unidrec) - sum(uniddesp)  as unidades,
   SUM(pesorec) - sum(pesodes)  as peso
FROM  RGP_INFORME
GROUP BY cliente,envase
HAVING  SUM(recepcion) -  SUM (despacho)<>0
GO

GO

GO
CREATE VIEW [dbo].[qry_trackeoCajas_detalle]
AS
SELECT     dbo.detarece.drec_rutcli AS cliente, LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) AS pallet, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, 
                      dbo.TRACKEOCAJAS.TRACK_FECHAHORA, 105)), 111) AS Fecha, dbo.detarece.drec_contcli AS CONTRATO
FROM         dbo.TRACKEOCAJAS INNER JOIN
                      dbo.detarece ON LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) = dbo.detarece.drec_codi
WHERE     (LEFT(dbo.detarece.drec_codi, 7) <= '0020001')

GO

GO

GO
CREATE VIEW [dbo].[qry_trackeocajas_resumen_pallet]
AS
SELECT     TOP 100 PERCENT cliente, pallet, Fecha, COUNT(pallet) AS cajas, CONTRATO
FROM         dbo.qry_trackeoCajas_detalle
GROUP BY cliente, pallet, Fecha, CONTRATO
ORDER BY Fecha

GO

GO

GO
 CREATE VIEW [dbo].[GvwContFinal2]
 AS
 SELECT frec_codi, frec_rutcli, frec_contenedor, cont_codi, cont_descr, cli_nomb, CASE WHEN BLOQ='0' THEN 0 ELSE 1 END AS BLOQ, isnull(fcon_petiq,0) AS ETIQ, 
 isnull(fcon_prev,0) AS REV,SUMRECE,SUMDESPA
 FROM GvwContFinal
 INNER JOIN fichrece  ON frec_codi=RECE 
 INNER JOIN contrato ON frec_contcli=cont_codi 
 INNER JOIN clientes ON cli_rut=frec_rutcli   
 LEFT JOIN fichcont ON fcon_cont=frec_contenedor
GO

GO

GO

CREATE VIEW [dbo].[_A]
AS
SELECT MAX(Caj_Pcod)as pallet , caj_cod FROM DetaReceCajas INNER JOIN detarece ON drec_codi=caj_pcod INNER JOIN rackdeta ON racd_codi=drec_codi WHERE (caj_cod='1201500620028' OR caj_cod='1201500620031' OR caj_cod='1201500620033' OR caj_cod='1201500620044' OR caj_cod='1201500620038' OR caj_cod='1201500620039' OR caj_cod='1201500620011' OR caj_cod='1201500620040' OR caj_cod='1201500620012' OR caj_cod='1201500620016' OR caj_cod='1201500620064' OR caj_cod='1201500620029' OR caj_cod='1201500620030' OR caj_cod='1201500620063' OR caj_cod='1201500620037' OR caj_cod='1201500620035' OR caj_cod='1201501013144' OR caj_cod='1201501015409' OR caj_cod='1201501012307' OR caj_cod='1201501013846' OR caj_cod='1201501012126' OR caj_cod='1201501013143' OR caj_cod='1201501012318' OR caj_cod='1201501013864' OR caj_cod='1201501013847' OR caj_cod='1201501013851' OR caj_cod='1201501013873' OR caj_cod='1201501013852' OR caj_cod='1201501013141' OR caj_cod='1201501012317' OR caj_cod='1201501013856' OR caj_cod='1201501013848' OR caj_cod='1201501013845' OR caj_cod='1201501012128' OR caj_cod='1201501012309' OR caj_cod='1201501012305' OR caj_cod='1201501012124' OR caj_cod='1201501012306' OR caj_cod='1201501012311' OR caj_cod='1201501012129' OR caj_cod='1201501021205' OR caj_cod='1201501012314' OR caj_cod='1201501021193' OR caj_cod='1201501013871' OR caj_cod='1201501015408' OR caj_cod='1201501022092' OR caj_cod='1201501012125' OR caj_cod='1201501013139' OR caj_cod='1201501013130' OR caj_cod='1201501013854' OR caj_cod='1201501015352' OR caj_cod='1201501013866' OR caj_cod='1201501013138' OR caj_cod='1201501013136' OR caj_cod='1201501013853' OR caj_cod='1201501013135' OR caj_cod='1201501012316' OR caj_cod='1201501013137' OR caj_cod='1201501016913' OR caj_cod='1201501015354' OR caj_cod='1201501013860' OR caj_cod='1201501013128' OR caj_cod='1201501015353' OR caj_cod='1201501013874' OR caj_cod='1201501013132' OR caj_cod='1201501013146' OR caj_cod='1201501013145' OR caj_cod='1201501012308' OR caj_cod='1201501013857' OR caj_cod='1201501012322' OR caj_cod='1201501012320' OR caj_cod='1201501012132' OR caj_cod='1201501013134' OR caj_cod='1201501013859' OR caj_cod='1201501013863' OR caj_cod='1201501013858' OR caj_cod='1201501013131' OR caj_cod='1201501013129' OR caj_cod='1201501012319' OR caj_cod='1201501013855' OR caj_cod='1201501013133' OR caj_cod='1201501013862' OR caj_cod='1201501012313' OR caj_cod='1201501012315' OR caj_cod='1201501012312' OR caj_cod='1201501012304' OR caj_cod='1201501012133' OR caj_cod='1201501012310' OR caj_cod='1201501012127' OR caj_cod='1201501012321' OR caj_cod='1201501012323' OR caj_cod='1201501012131' OR caj_cod='1201501012130' OR caj_cod='1201501013127' OR caj_cod='1201501015351' OR caj_cod='1201501013865' OR caj_cod='1201501019331' OR caj_cod='1201501019328' OR caj_cod='1201501019327' OR caj_cod='1201501019287' OR caj_cod='1201501019284' OR caj_cod='1201501017885' OR caj_cod='1201501017893' OR caj_cod='1201501017882' OR caj_cod='1201501017902' OR caj_cod='1201501017899' OR caj_cod='1201501017870' OR caj_cod='1201501022800' OR caj_cod='1201501017895' OR caj_cod='1201501017896' OR caj_cod='1201501017877' OR caj_cod='1201501022819' OR caj_cod='1201501019324' OR caj_cod='1201501019300' OR caj_cod='1201501019299' OR caj_cod='1201501019336' OR caj_cod='1201501017883' OR caj_cod='1201501017890' OR caj_cod='1201501017904' OR caj_cod='1201501017868' OR caj_cod='1201501019332' OR caj_cod='1201501017866' OR caj_cod='1201501019338' OR caj_cod='1201501017867' OR caj_cod='1201501019325' OR caj_cod='1201501019337' OR caj_cod='1201501018006' OR caj_cod='1201501017900' OR caj_cod='1201501017888' OR caj_cod='1201501017886' OR caj_cod='1201501017903' OR caj_cod='1201501017085' OR caj_cod='1201501017881' OR caj_cod='1201501017086' OR caj_cod='1201501017887' OR caj_cod='1201501017889' OR caj_cod='1201501019282' OR caj_cod='1201501019552' OR caj_cod='1201501019295' OR caj_cod='1201501019339' OR caj_cod='1201501019333' OR caj_cod='1201501019335' OR caj_cod='1201501019322' OR caj_cod='1201501019283' OR caj_cod='1201501019323' OR caj_cod='1201501019285' OR caj_cod='1201501019330' OR caj_cod='1201501017891' OR caj_cod='1201501018007' OR caj_cod='1201501017880' OR caj_cod='1201501017876' OR caj_cod='1201501017892' OR caj_cod='1201501019288' OR caj_cod='1201501019281' OR caj_cod='1201501019297' OR caj_cod='1201501019296' OR caj_cod='1201501019298' OR caj_cod='1201501019320' OR caj_cod='1201501018008' OR caj_cod='1201501019326' OR caj_cod='1201501019329' OR caj_cod='1201501017875' OR caj_cod='1201501017905' OR caj_cod='1201501017869' OR caj_cod='1201501017901' OR caj_cod='1201501017878' OR caj_cod='1201501017879' OR caj_cod='1201501019286' OR caj_cod='1201501017873' OR caj_cod='1201501017898' OR caj_cod='1201501017872' OR caj_cod='1201501017871' OR caj_cod='1201501017874' OR caj_cod='1201501017894' OR caj_cod='1201501019277' OR caj_cod='1201501017884' OR caj_cod='1201501102932' OR caj_cod='1201501103052' OR caj_cod='1201501102935' OR caj_cod='1201501102924' OR caj_cod='1201501102936' OR caj_cod='1201501102925' OR caj_cod='1201501103113' OR caj_cod='1201501101290' OR caj_cod='1201501102691' OR caj_cod='1201501102014' OR caj_cod='1201501108256' OR caj_cod='1201501101291' OR caj_cod='1201501102017' OR caj_cod='1201501108260' OR caj_cod='1201501108259' OR caj_cod='1201501102018' OR caj_cod='1201501108261' OR caj_cod='1201501108211' OR caj_cod='1201501108200' OR caj_cod='1201501102016' OR caj_cod='1201501102010' OR caj_cod='1201501101283' OR caj_cod='1201501101292' OR caj_cod='1201501108438' OR caj_cod='1201501102011' OR caj_cod='1201501102687' OR caj_cod='1201501103053' OR caj_cod='1201501102931' OR caj_cod='1201501103112' OR caj_cod='1201501102933' OR caj_cod='1201501102686' OR caj_cod='1201501103054' OR caj_cod='1201501102929' OR caj_cod='1201501101289' OR caj_cod='1201501102928' OR caj_cod='1201501102688' OR caj_cod='1201501102934' OR caj_cod='1201501103343' OR caj_cod='1201501103336' OR caj_cod='1201501102930' OR caj_cod='1201501103331' OR caj_cod='1201501103048' OR caj_cod='1201501103344' OR caj_cod='1201501103337' OR caj_cod='1201501102921' OR caj_cod='1201501103111' OR caj_cod='1201501103046' OR caj_cod='1201501103338' OR caj_cod='1201501101282' OR caj_cod='1201501101287' OR caj_cod='1201501102009' OR caj_cod='1201501101284' OR caj_cod='1201501108440' OR caj_cod='1201501102690' OR caj_cod='1201501102015' OR caj_cod='1201501101288' OR caj_cod='1201501103335' OR caj_cod='1201501103109' OR caj_cod='1201501103051' OR caj_cod='1201501103045' OR caj_cod='1201501102926' OR caj_cod='1201501103110' OR caj_cod='1201501103339' OR caj_cod='1201501103330' OR caj_cod='1201501102923' OR caj_cod='1201501102922' OR caj_cod='1201501102013' OR caj_cod='1201501102689' OR caj_cod='1201501101279' OR caj_cod='1201501101286' OR caj_cod='1201501102692' OR caj_cod='1201501101278' OR caj_cod='1201501101280' OR caj_cod='1201501102012' OR caj_cod='1201501101281' OR caj_cod='1201501101285' OR caj_cod='1201501101277' OR caj_cod='1201501102164' OR caj_cod='1201501108460' OR caj_cod='1201501102927' OR caj_cod='1201500673929' OR caj_cod='1201500673942' OR caj_cod='1201500673689' OR caj_cod='1201500673709' OR caj_cod='1201500673911' OR caj_cod='1201500673919' OR caj_cod='1201500673920' OR caj_cod='1201500673704' OR caj_cod='1201500673663' OR caj_cod='1201500673926' OR caj_cod='1201500673940' OR caj_cod='1201500673943' OR caj_cod='1201500673930' OR caj_cod='1201500673939' OR caj_cod='1201500673935' OR caj_cod='1201500673690' OR caj_cod='1201500673917' OR caj_cod='1201500673688' OR caj_cod='1201500673936' OR caj_cod='1201500671659' OR caj_cod='1201500673938' OR caj_cod='1201500673937' OR caj_cod='1201500673925' OR caj_cod='1201500673927' OR caj_cod='1201500673908' OR caj_cod='1201500673906' OR caj_cod='1201500673905' OR caj_cod='1201500673912' OR caj_cod='1201500673913' OR caj_cod='1201500673910' OR caj_cod='1201500673907' OR caj_cod='1201500673710' OR caj_cod='1201500673944' OR caj_cod='1201500673941' OR caj_cod='1201500626705' OR caj_cod='1201500626701' OR caj_cod='1201500626713' OR caj_cod='1201500626716' OR caj_cod='1201500627358' OR caj_cod='1201500627359' OR caj_cod='1201500561765' OR caj_cod='1201500627092' OR caj_cod='1201500627340' OR caj_cod='1201500627344' OR caj_cod='1201500627337' OR caj_cod='1201500627330' OR caj_cod='1201500627333' OR caj_cod='1201500627101' OR caj_cod='1201500627336' OR caj_cod='1201500627188' OR caj_cod='1201500627189' OR caj_cod='1201500627186' OR caj_cod='1201500626704' OR caj_cod='1201500626692' OR caj_cod='1201500626696' OR caj_cod='1201500627332' OR caj_cod='1201500627190' OR caj_cod='1201500627334' OR caj_cod='1201500626691' OR caj_cod='1201500627096' OR caj_cod='1201500626695' OR caj_cod='1201500627350' OR caj_cod='1201500627341' OR caj_cod='1201500627187' OR caj_cod='1201500626703' OR caj_cod='1201500561764' OR caj_cod='1201500561767' OR caj_cod='1201500559116' OR caj_cod='1201500627342' OR caj_cod='1201500627191' OR caj_cod='1201500627094' OR caj_cod='1201500627338' OR caj_cod='1201500559114' OR caj_cod='1201500626706' OR caj_cod='1201500627354' OR caj_cod='1201500559109' OR caj_cod='1201500561763' OR caj_cod='1201500627351' OR caj_cod='1201500627356' OR caj_cod='1201500559115' OR caj_cod='1201500627353' OR caj_cod='1201500627335' OR caj_cod='1201500561774' OR caj_cod='1201500627339' OR caj_cod='1201500559110' OR caj_cod='1201500559107' OR caj_cod='1201500559104' OR caj_cod='1201500627182' OR caj_cod='1201500626371' OR caj_cod='1201500626218' OR caj_cod='1201500626467' OR caj_cod='1201500626717' OR caj_cod='1201500626386' OR caj_cod='1201500626362' OR caj_cod='1201500626382' OR caj_cod='1201500626216' OR caj_cod='1201500625971' OR caj_cod='1201500625978' OR caj_cod='1201500625977' OR caj_cod='1201500626698' OR caj_cod='1201500626389' OR caj_cod='1201500626700' OR caj_cod='1201500626709' OR caj_cod='1201500626374' OR caj_cod='1201500626699' OR caj_cod='1201500626373' OR caj_cod='1201500626807' OR caj_cod='1201500626381' OR caj_cod='1201500626377' OR caj_cod='1201500626217' OR caj_cod='1201500626466' OR caj_cod='1201500626203' OR caj_cod='1201500626364' OR caj_cod='1201500626210' OR caj_cod='1201500626368' OR caj_cod='1201500626202' OR caj_cod='1201500626461' OR caj_cod='1201500626366' OR caj_cod='1201500626370' OR caj_cod='1201500626367' OR caj_cod='1201500626369' OR caj_cod='1201500626204' OR caj_cod='1201500626208' OR caj_cod='1201500626207' OR caj_cod='1201500626206' OR caj_cod='1201500626205' OR caj_cod='1201500626710' OR caj_cod='1201500627098' OR caj_cod='1201500626697' OR caj_cod='1201500627099' OR caj_cod='1201500626387' OR caj_cod='1201500626360' OR caj_cod='1201500626802' OR caj_cod='1201500626694' OR caj_cod='1201500626798' OR caj_cod='1201500626363' OR caj_cod='1201500626800' OR caj_cod='1201500626718' OR caj_cod='1201500626804' OR caj_cod='1201500626465' OR caj_cod='1201500626463' OR caj_cod='1201500626799' OR caj_cod='1201500626714' OR caj_cod='1201500626200' OR caj_cod='1201500627100' OR caj_cod='1201500627097' OR caj_cod='1201500627183' OR caj_cod='1201500627349' OR caj_cod='1201500626806' OR caj_cod='1201500627185' OR caj_cod='1201500626801' OR caj_cod='1201500626805' OR caj_cod='1201500626693' OR caj_cod='1201500626711' OR caj_cod='1201500626712' OR caj_cod='1201500626219' OR caj_cod='1201500626464' OR caj_cod='1201500626803' OR caj_cod='1201500626372' OR caj_cod='1201500626384' OR caj_cod='1201500626376' OR caj_cod='1201500626215' OR caj_cod='1201500626462' OR caj_cod='1201500626213' OR caj_cod='1201500626388' OR caj_cod='1201500626385' OR caj_cod='1201500626383' OR caj_cod='1201500626201' OR caj_cod='1201500626378' OR caj_cod='1201500625979' OR caj_cod='1201500626379' OR caj_cod='1201500626689' OR caj_cod='1201500617043' OR caj_cod='1201500617032' OR caj_cod='1201500622755' OR caj_cod='1201500622756' OR caj_cod='1201500677801' OR caj_cod='1201500677815' OR caj_cod='1201500677793' OR caj_cod='1201500672140' OR caj_cod='1201500672135' OR caj_cod='1201500672136' OR caj_cod='1201500672137' OR caj_cod='1201500672120' OR caj_cod='1201500672152' OR caj_cod='1201500671664' OR caj_cod='1201500672148' OR caj_cod='1201500672128' OR caj_cod='1201500672144' OR caj_cod='1201500671650' OR caj_cod='1201500672138' OR caj_cod='1201500671643' OR caj_cod='1201500671636' OR caj_cod='1201500677823' OR caj_cod='1201500679617' OR caj_cod='1201500677822' OR caj_cod='1201500679614' OR caj_cod='1201500679605' OR caj_cod='1201500677790' OR caj_cod='1201500677791' OR caj_cod='1201500672118' OR caj_cod='1201500677797' OR caj_cod='1201500677795' OR caj_cod='1201500672151' OR caj_cod='1201500672147' OR caj_cod='1201500672115' OR caj_cod='1201500672121' OR caj_cod='1201500677794' OR caj_cod='1201500672116' OR caj_cod='1201500672153' OR caj_cod='1201500672122' OR caj_cod='1201500672149' OR caj_cod='1201500677814' OR caj_cod='1201500680165' OR caj_cod='1201500677817' OR caj_cod='1201500677826' OR caj_cod='1201500679607' OR caj_cod='1201500679616' OR caj_cod='1201500677819' OR caj_cod='1201500677827' OR caj_cod='1201500677816' OR caj_cod='1201500677808' OR caj_cod='1201500677800' OR caj_cod='1201500672119' OR caj_cod='1201500672117' OR caj_cod='1201500677821' OR caj_cod='1201500677792' OR caj_cod='1201500677820' OR caj_cod='1201500679615' OR caj_cod='1201500677824' OR caj_cod='1201500677825' OR caj_cod='1201500677807' OR caj_cod='1201500677805' OR caj_cod='1201500677806' OR caj_cod='1201500677802' OR caj_cod='1201500679538' OR caj_cod='1201500677828' OR caj_cod='1201500677799' OR caj_cod='1201500672145' OR caj_cod='1201500672146' OR caj_cod='1201500677796' OR caj_cod='1201500672154' OR caj_cod='1201500672141' OR caj_cod='1201500671644' OR caj_cod='1201500677798' OR caj_cod='1201500672127' OR caj_cod='1201500672150' OR caj_cod='1201500677829' OR caj_cod='1201500677804' OR caj_cod='1201500677803' OR caj_cod='1201500672139' OR caj_cod='1201500658731' OR caj_cod='1201500658732' OR caj_cod='1201500658503' OR caj_cod='1201500658840' OR caj_cod='1201500658501' OR caj_cod='1201500658730' OR caj_cod='1201500658496' OR caj_cod='1201500658495' OR caj_cod='1201500658478' OR caj_cod='1201500658456' OR caj_cod='1201500658425' OR caj_cod='1201500658485' OR caj_cod='1201500658488' OR caj_cod='1201500658494' OR caj_cod='1201500658460' OR caj_cod='1201500658462' OR caj_cod='1201500658435' OR caj_cod='1201500658461' OR caj_cod='1201500658846' OR caj_cod='1201500658717' OR caj_cod='1201500660937' OR caj_cod='1201500660927' OR caj_cod='1201500661047' OR caj_cod='1201500658475' OR caj_cod='1201500658735' OR caj_cod='1201500658483' OR caj_cod='1201500658455' OR caj_cod='1201500658481' OR caj_cod='1201500658843' OR caj_cod='1201500658838' OR caj_cod='1201500658841' OR caj_cod='1201500658837' OR caj_cod='1201500658722' OR caj_cod='1201500658482' OR caj_cod='1201500658736' OR caj_cod='1201500658842' OR caj_cod='1201500658426' OR caj_cod='1201500658486' OR caj_cod='1201500658477' OR caj_cod='1201500658719' OR caj_cod='1201500658480' OR caj_cod='1201500658479' OR caj_cod='1201500658484' OR caj_cod='1201500658458' OR caj_cod='1201500658487' OR caj_cod='1201500661106' OR caj_cod='1201500661101' OR caj_cod='1201500660935' OR caj_cod='1201500661048' OR caj_cod='1201500660950' OR caj_cod='1201500660941' OR caj_cod='1201500660944' OR caj_cod='1201500658728' OR caj_cod='1201500658500' OR caj_cod='1201500658729' OR caj_cod='1201500658492' OR caj_cod='1201500658498' OR caj_cod='1201500658839' OR caj_cod='1201500658502' OR caj_cod='1201500658476' OR caj_cod='1201500658721' OR caj_cod='1201500658718' OR caj_cod='1201500658720' OR caj_cod='1201500661040' OR caj_cod='1201500661041' OR caj_cod='1201500660947' OR caj_cod='1201500660928' OR caj_cod='1201500658844' OR caj_cod='1201500658726' OR caj_cod='1201500658723' OR caj_cod='1201500658845' OR caj_cod='1201500661039' OR caj_cod='1201500658733' OR caj_cod='1201500658734' OR caj_cod='1201500658464' OR caj_cod='1201500658428' OR caj_cod='1201500658491' OR caj_cod='1201500559117' OR caj_cod='1201500559118' OR caj_cod='1201500561762' OR caj_cod='1201500627093' OR caj_cod='1201500627343' OR caj_cod='1201500561781' OR caj_cod='1201500694071' OR caj_cod='1201500694074' OR caj_cod='1201500693963' OR caj_cod='1201500693119' OR caj_cod='1201500693118' OR caj_cod='1201500693121' OR caj_cod='1201500693120' OR caj_cod='1201500694065' OR caj_cod='1201500694542' OR caj_cod='1201500694068' OR caj_cod='1201500693962' OR caj_cod='1201500694069' OR caj_cod='1201500696642' OR caj_cod='1201500696882' OR caj_cod='1201500693957' OR caj_cod='1201500693117' OR caj_cod='1201500696881' OR caj_cod='1201500696886' OR caj_cod='1201500696643' OR caj_cod='1201500693954' OR caj_cod='1201500694067' OR caj_cod='1201500693956' OR caj_cod='1201500693959' OR caj_cod='1201500696883' OR caj_cod='1201500696879' OR caj_cod='1201500693114' OR caj_cod='1201500694064' OR caj_cod='1201500694070' OR caj_cod='1201500693961' OR caj_cod='1201500693955' OR caj_cod='1201500693107' OR caj_cod='1201500693958' OR caj_cod='1201500693115' OR caj_cod='1201500693116' OR caj_cod='1201500693113' OR caj_cod='1201500696873' OR caj_cod='1201500696874' OR caj_cod='1201500696871' OR caj_cod='1201500696870' OR caj_cod='1201500696887' OR caj_cod='1201500696880' OR caj_cod='1201500696885' OR caj_cod='1201500696641' OR caj_cod='1201500696888' OR caj_cod='1201500696884' OR caj_cod='1201500693953' OR caj_cod='1201500693950' OR caj_cod='1201500694056' OR caj_cod='1201500694685' OR caj_cod='1201500694061' OR caj_cod='1201500694053' OR caj_cod='1201500694059' OR caj_cod='1201500693108' OR caj_cod='1201500696875' OR caj_cod='1201500696877' OR caj_cod='1201500693105' OR caj_cod='1201500694058' OR caj_cod='1201500693110' OR caj_cod='1201500693106' OR caj_cod='1201500693104' OR caj_cod='1201500694062' OR caj_cod='1201500693123' OR caj_cod='1201500693109' OR caj_cod='1201500693112' OR caj_cod='1201500696878' OR caj_cod='1201500696645' OR caj_cod='1201500696872' OR caj_cod='1201500696626' OR caj_cod='1201500696876' OR caj_cod='1201500693111' OR caj_cod='1201500696868' OR caj_cod='1201500696627' OR caj_cod='1201500693949' OR caj_cod='1201500694057' OR caj_cod='1201500694073' OR caj_cod='1201500694072' OR caj_cod='1201500693967' OR caj_cod='1201500694686' OR caj_cod='1201500693966' OR caj_cod='1201500693948' OR caj_cod='1201500693965' OR caj_cod='1201500693964' OR caj_cod='1201500693960' OR caj_cod='1201500694541' OR caj_cod='1201500694066' OR caj_cod='1201500693122' OR caj_cod='1201500694060' OR caj_cod='1201500694063' OR caj_cod='1201500693952' OR caj_cod='1201500693951' OR caj_cod='1201500561777' OR caj_cod='1201500627095' OR caj_cod='1201500561778' OR caj_cod='1201500561776' OR caj_cod='1201500626715' OR caj_cod='1201500626708' OR caj_cod='1201500626707' OR caj_cod='1201500626702' OR caj_cod='1201500561780' OR caj_cod='1201500559111' OR caj_cod='1201500561779' OR caj_cod='1201500559103' OR caj_cod='1201500627352' OR caj_cod='1201500561766' OR caj_cod='1201500627357' OR caj_cod='1201500627331' OR caj_cod='1201500627184' OR caj_cod='1201500627355' OR caj_cod='1201500627346' OR caj_cod='1201500626690' OR caj_cod='1201500627348' OR caj_cod='1201500627347' OR caj_cod='1201500561768' OR caj_cod='1201500627345' OR caj_cod='1201500559106' OR caj_cod='1201500622769' OR caj_cod='1201500617052' OR caj_cod='1201500622757' OR caj_cod='1201500622762' OR caj_cod='1201500550149' OR caj_cod='1201500550164' OR caj_cod='1201500550167' OR caj_cod='1201500550150' OR caj_cod='1201500550156' OR caj_cod='1201500550155' OR caj_cod='1201500550189' OR caj_cod='1201500550142' OR caj_cod='1201500550035' OR caj_cod='1201500550094' OR caj_cod='1201500550048' OR caj_cod='1201500550036' OR caj_cod='1201500550087' OR caj_cod='1201500553654' OR caj_cod='1201500553646' OR caj_cod='1201500550084' OR caj_cod='1201500550058' OR caj_cod='1201500553513' OR caj_cod='1201500550145' OR caj_cod='1201500550147' OR caj_cod='1201500550140' OR caj_cod='1201500550063' OR caj_cod='1201500550042' OR caj_cod='1201500550144' OR caj_cod='1201500550168' OR caj_cod='1201500550061' OR caj_cod='1201500550096' OR caj_cod='1201500550034' OR caj_cod='1201500550029' OR caj_cod='1201500550100' OR caj_cod='1201500550024' OR caj_cod='1201500550099' OR caj_cod='1201500550143' OR caj_cod='1201500550163' OR caj_cod='1201500550139' OR caj_cod='1201500550040' OR caj_cod='1201500550062' OR caj_cod='1201500550027' OR caj_cod='1201500553490' OR caj_cod='1201500550028' OR caj_cod='1201500550039' OR caj_cod='1201500550026' OR caj_cod='1201500550038' OR caj_cod='1201500550049' OR caj_cod='1201500550033' OR caj_cod='1201500550146' OR caj_cod='1201500550162' OR caj_cod='1201500550166' OR caj_cod='1201500550101' OR caj_cod='1201500550032' OR caj_cod='1201500550054' OR caj_cod='1201500550095' OR caj_cod='1201500550030' OR caj_cod='1201500550160' OR caj_cod='1201500550102' OR caj_cod='1201500550090' OR caj_cod='1201500550157' OR caj_cod='1201500550041' OR caj_cod='1201500550031' OR caj_cod='1201500550098' OR caj_cod='1201500550097' OR caj_cod='1201500550047' OR caj_cod='1201500550148' OR caj_cod='1201500550154' OR caj_cod='1201500550165' OR caj_cod='1201500550152' OR caj_cod='1201500550044' OR caj_cod='1201500550153' OR caj_cod='1201500550059' OR caj_cod='1201500550161' OR caj_cod='1201500550159' OR caj_cod='1201500550045' OR caj_cod='1201500550046' OR caj_cod='1201500550151' OR caj_cod='1201500550089' OR caj_cod='1201500550103' OR caj_cod='1201500550141' OR caj_cod='1201500550092' OR caj_cod='1201500550057' OR caj_cod='1201500553652' OR caj_cod='1201500550088' OR caj_cod='1201500550091' OR caj_cod='1201500550158' OR caj_cod='1201500550043' OR caj_cod='1201500550051' OR caj_cod='1201500550050' OR caj_cod='1201500550086' OR caj_cod='1201500550093' OR caj_cod='1201500550055' OR caj_cod='1201500550085' OR caj_cod='1201500588153' OR caj_cod='1201500587965' OR caj_cod='1201500587369' OR caj_cod='1201500588156' OR caj_cod='1201500588066' OR caj_cod='1201500519299' OR caj_cod='1201500587368' OR caj_cod='1201500587968' OR caj_cod='1201500585966' OR caj_cod='1201500588180' OR caj_cod='1201500587957' OR caj_cod='1201500588178' OR caj_cod='1201500516038' OR caj_cod='1201500516039' OR caj_cod='1201500517999' OR caj_cod='1201500587970' OR caj_cod='1201500588144' OR caj_cod='1201500588177' OR caj_cod='1201500588054' OR caj_cod='1201500588142' OR caj_cod='1201500588051' OR caj_cod='1201500587967' OR caj_cod='1201500587961' OR caj_cod='1201500585965' OR caj_cod='1201500588068' OR caj_cod='1201500587969' OR caj_cod='1201500587960' OR caj_cod='1201500587958' OR caj_cod='1201500587966' OR caj_cod='1201500588069' OR caj_cod='1201500588141' OR caj_cod='1201500588158' OR caj_cod='1201500588053' OR caj_cod='1201500588055' OR caj_cod='1201500517388' OR caj_cod='1201500516024' OR caj_cod='1201500585967' OR caj_cod='1201500517389' OR caj_cod='1201500516041' OR caj_cod='1201500516031' OR caj_cod='1201500588152' OR caj_cod='1201500588050' OR caj_cod='1201500588062' OR caj_cod='1201500588064' OR caj_cod='1201500588148' OR caj_cod='1201500587964' OR caj_cod='1201500588149' OR caj_cod='1201500588155' OR caj_cod='1201500587954' OR caj_cod='1201500588060' OR caj_cod='1201500588070' OR caj_cod='1201500588157' OR caj_cod='1201500588154' OR caj_cod='1201500587956' OR caj_cod='1201500587371' OR caj_cod='1201500587963' OR caj_cod='1201500588065' OR caj_cod='1201500587951' OR caj_cod='1201500588179' OR caj_cod='1201500587370' OR caj_cod='1201500588063' OR caj_cod='1201500516036' OR caj_cod='1201500587952' OR caj_cod='1201500588071' OR caj_cod='1201500588143' OR caj_cod='1201500588147' OR caj_cod='1201500588171' OR caj_cod='1201500588151' OR caj_cod='1201500588058' OR caj_cod='1201500588145' OR caj_cod='1201500588169' OR caj_cod='1201500588168' OR caj_cod='1201500587953' OR caj_cod='1201500588067' OR caj_cod='1201500587962' OR caj_cod='1201500588056' OR caj_cod='1201500587959' OR caj_cod='1201500588052' OR caj_cod='1201500588057' OR caj_cod='1201500587955' OR caj_cod='1201500583885' OR caj_cod='1201500583900' OR caj_cod='1201500583856' OR caj_cod='1201500583876' OR caj_cod='1201500558725' OR caj_cod='1201500583874' OR caj_cod='1201500558730' OR caj_cod='1201500558752' OR caj_cod='1201500558739' OR caj_cod='1201500558740' OR caj_cod='1201500558738' OR caj_cod='1201500558737' OR caj_cod='1201500558441' OR caj_cod='1201500558735' OR caj_cod='1201500558446' OR caj_cod='1201500558734' OR caj_cod='1201500558438' OR caj_cod='1201500558440' OR caj_cod='1201500583864' OR caj_cod='1201500583883' OR caj_cod='1201500584338' OR caj_cod='1201500583873' OR caj_cod='1201500583882' OR caj_cod='1201500584336' OR caj_cod='1201500583881' OR caj_cod='1201500583859' OR caj_cod='1201500558743' OR caj_cod='1201500558751' OR caj_cod='1201500583879' OR caj_cod='1201500583861' OR caj_cod='1201500583905' OR caj_cod='1201500583877' OR caj_cod='1201500583880' OR caj_cod='1201500583904' OR caj_cod='1201500583857' OR caj_cod='1201500558747' OR caj_cod='1201500558750' OR caj_cod='1201500558744' OR caj_cod='1201500558428' OR caj_cod='1201500558427' OR caj_cod='1201500558741' OR caj_cod='1201500558746' OR caj_cod='1201500558742' OR caj_cod='1201500558436' OR caj_cod='1201500558429' OR caj_cod='1201500583908' OR caj_cod='1201500583867' OR caj_cod='1201500583893' OR caj_cod='1201500583898' OR caj_cod='1201500583860' OR caj_cod='1201500583872' OR caj_cod='1201500558448' OR caj_cod='1201500558447' OR caj_cod='1201500569395' OR caj_cod='1201500569373' OR caj_cod='1201500588172' OR caj_cod='1201500569388' OR caj_cod='1201500569401' OR caj_cod='1201500569377' OR caj_cod='1201500569392' OR caj_cod='1201500569394' OR caj_cod='1201500588059' OR caj_cod='1201500588173' OR caj_cod='1201500588170' OR caj_cod='1201500588061' OR caj_cod='1201500558433' OR caj_cod='1201500558437' OR caj_cod='1201500558290' OR caj_cod='1201500558431' OR caj_cod='1201500558434' OR caj_cod='1201500558430' OR caj_cod='1201500558454' OR caj_cod='1201500569670' OR caj_cod='1201500569390' OR caj_cod='1201500569380' OR caj_cod='1201500569385' OR caj_cod='1201500569399' OR caj_cod='1201500569381' OR caj_cod='1201500569384' OR caj_cod='1201500558291' OR caj_cod='1201500569382' OR caj_cod='1201500569386' OR caj_cod='1201500569393' OR caj_cod='1201500569376' OR caj_cod='1201500588146' OR caj_cod='1201500588175' OR caj_cod='1201500588176' OR caj_cod='1201500558432' OR caj_cod='1201500558426' OR caj_cod='1201500558444' OR caj_cod='1201500558443' OR caj_cod='1201500558451' OR caj_cod='1201500558435' OR caj_cod='1201500558455' OR caj_cod='1201500558289' OR caj_cod='1201500569398' OR caj_cod='1201500569396' OR caj_cod='1201500569404' OR caj_cod='1201500569378' OR caj_cod='1201500569374' OR caj_cod='1201500569389' OR caj_cod='1201500569379' OR caj_cod='1201500569375' OR caj_cod='1201500558445' OR caj_cod='1201500569408' OR caj_cod='1201500558292' OR caj_cod='1201500558293' OR caj_cod='1201500558452' OR caj_cod='1201500558453' OR caj_cod='1201500558450' OR caj_cod='1201500569397' OR caj_cod='1201500558449' OR caj_cod='1201500569403' OR caj_cod='1201500569405' OR caj_cod='1201500569402' OR caj_cod='1201500569391' OR caj_cod='1201500588150' OR caj_cod='1201500569407' OR caj_cod='1201500588174' OR caj_cod='1201500569400' OR caj_cod='1201500569383' OR caj_cod='1201500569387' OR caj_cod='1201500569406' OR caj_cod='1201500583868' OR caj_cod='1201500583863' OR caj_cod='1201500583889' OR caj_cod='1201500583896' OR caj_cod='1201500583895' OR caj_cod='1201500583906' OR caj_cod='1201500583862' OR caj_cod='1201500583858' OR caj_cod='1201500558748' OR caj_cod='1201500558745' OR caj_cod='1201500558749' OR caj_cod='1201500558732' OR caj_cod='1201500583892' OR caj_cod='1201500584341' OR caj_cod='1201500584340' OR caj_cod='1201500583897' OR caj_cod='1201500583884' OR caj_cod='1201500583886' OR caj_cod='1201500583907' OR caj_cod='1201500583894' OR caj_cod='1201500583899' OR caj_cod='1201500584339' OR caj_cod='1201500583887' OR caj_cod='1201500583891' OR caj_cod='1201500583878' OR caj_cod='1201500558729' OR caj_cod='1201500558728' OR caj_cod='1201500558442' OR caj_cod='1201500558439' OR caj_cod='1201500583890' OR caj_cod='1201500558733' OR caj_cod='1201500558736' OR caj_cod='1201500558731' OR caj_cod='1201500558724' OR caj_cod='1201500583875' OR caj_cod='1201500583888' OR caj_cod='1201500558753' OR caj_cod='1201500558726' OR caj_cod='1201500558727' OR caj_cod='1201500585995' OR caj_cod='1201500585982' OR caj_cod='1201500586013' OR caj_cod='1201500586564' OR caj_cod='1201500585989' OR caj_cod='1201500585984' OR caj_cod='1201500585985' OR caj_cod='1201500585427' OR caj_cod='1201500586017' OR caj_cod='1201500586011' OR caj_cod='1201500585998' OR caj_cod='1201500586019' OR caj_cod='1201500586015' OR caj_cod='1201500586016' OR caj_cod='1201500585971' OR caj_cod='1201500585431' OR caj_cod='1201500586007' OR caj_cod='1201500586003' OR caj_cod='1201500586572' OR caj_cod='1201500586004' OR caj_cod='1201500586006' OR caj_cod='1201500586008' OR caj_cod='1201500586009' OR caj_cod='1201500585421' OR caj_cod='1201500586563' OR caj_cod='1201500586010' OR caj_cod='1201500585423' OR caj_cod='1201500585994' OR caj_cod='1201500586001' OR caj_cod='1201500586024' OR caj_cod='1201500586565' OR caj_cod='1201500586012' OR caj_cod='1201500586014' OR caj_cod='1201500586018' OR caj_cod='1201500585418' OR caj_cod='1201500585419' OR caj_cod='1201500585434' OR caj_cod='1201500585435' OR caj_cod='1201500585424' OR caj_cod='1201500585999' OR caj_cod='1201500586020' OR caj_cod='1201500585420' OR caj_cod='1201500586562' OR caj_cod='1201500586574' OR caj_cod='1201500586566' OR caj_cod='1201500585974' OR caj_cod='1201500585992' OR caj_cod='1201500586005' OR caj_cod='1201500585988' OR caj_cod='1201500585997' OR caj_cod='1201500585968' OR caj_cod='1201500586002' OR caj_cod='1201500585416' OR caj_cod='1201500586000' OR caj_cod='1201500585422' OR caj_cod='1201500586569' OR caj_cod='1201500585990' OR caj_cod='1201500585425' OR caj_cod='1201500585977' OR caj_cod='1201500585987' OR caj_cod='1201500586570' OR caj_cod='1201500585993' OR caj_cod='1201500585975' OR caj_cod='1201500585986' OR caj_cod='1201500585983' OR caj_cod='1201500586573' OR caj_cod='1201500586568' OR caj_cod='1201500585976' OR caj_cod='1201500586567' OR caj_cod='1201500585991' OR caj_cod='1201500586023' OR caj_cod='1201500585979' OR caj_cod='1201500585429' OR caj_cod='1201500585972' OR caj_cod='1201500585980' OR caj_cod='1201500585428' OR caj_cod='1201500585981' OR caj_cod='1201500585973' OR caj_cod='1201500586022' OR caj_cod='1201500585969' OR caj_cod='1201500585978' OR caj_cod='1201500585970' OR caj_cod='1201500585426' OR caj_cod='1201500586021' OR caj_cod='1201500578571' OR caj_cod='1201500578469' OR caj_cod='1201500578478' OR caj_cod='1201500578568' OR caj_cod='1201500578221' OR caj_cod='1201500578567' OR caj_cod='1201500578485' OR caj_cod='1201500578564' OR caj_cod='1201500578476' OR caj_cod='1201500578484' OR caj_cod='1201500578565' OR caj_cod='1201500578229' OR caj_cod='1201500578479' OR caj_cod='1201500586571' OR caj_cod='1201500578214' OR caj_cod='1201500578473' OR caj_cod='1201500578475' OR caj_cod='1201500578481' OR caj_cod='1201500578215' OR caj_cod='1201500578480' OR caj_cod='1201500585996' OR caj_cod='1201500566997' OR caj_cod='1201500578566' OR caj_cod='1201500566992' OR caj_cod='1201500566991' OR caj_cod='1201500567530' OR caj_cod='1201500578213' OR caj_cod='1201500578223' OR caj_cod='1201500578569' OR caj_cod='1201500578217' OR caj_cod='1201500578474' OR caj_cod='1201500578572' OR caj_cod='1201500578468' OR caj_cod='1201500578483' OR caj_cod='1201500578482' OR caj_cod='1201500578470' OR caj_cod='1201500578472' OR caj_cod='1201500578570' OR caj_cod='1201500578226' OR caj_cod='1201500578573' OR caj_cod='1201500578228' OR caj_cod='1201500578216' OR caj_cod='1201500578467' OR caj_cod='1201500578471' OR caj_cod='1201500578218' OR caj_cod='1201500578225' OR caj_cod='1201500578219' OR caj_cod='1201500578224' OR caj_cod='1201500578222' OR caj_cod='1201500578220' OR caj_cod='1201500578466' OR caj_cod='1201500576641' OR caj_cod='1201500576628' OR caj_cod='1201500576626' OR caj_cod='1201500576624' OR caj_cod='1201500576622' OR caj_cod='1201500576632' OR caj_cod='1201500576637' OR caj_cod='1201500576627' OR caj_cod='1201500576636' OR caj_cod='1201500576634' OR caj_cod='1201500576618' OR caj_cod='1201500576629' OR caj_cod='1201500576625' OR caj_cod='1201500576643' OR caj_cod='1201500576621' OR caj_cod='1201500576630' OR caj_cod='1201500585417' OR caj_cod='1201500576646' OR caj_cod='1201500576642' OR caj_cod='1201500576623' OR caj_cod='1201500585430' OR caj_cod='1201500585432' OR caj_cod='1201500585433' OR caj_cod='1201500576633' OR caj_cod='1201500576639' OR caj_cod='1201500576644' OR caj_cod='1201500576645' OR caj_cod='1201500576647' OR caj_cod='1201500576631' OR caj_cod='1201500576638' OR caj_cod='1201500576635' OR caj_cod='1201500576640' OR caj_cod='1201500567533' OR caj_cod='1201500567536' OR caj_cod='1201500566989' OR caj_cod='1201500567548' OR caj_cod='1201500567687' OR caj_cod='1201500567539' OR caj_cod='1201500567701' OR caj_cod='1201500567557' OR caj_cod='1201500567698' OR caj_cod='1201500567551' OR caj_cod='1201500567554' OR caj_cod='1201500567703' OR caj_cod='1201500567555' OR caj_cod='1201500567529' OR caj_cod='1201500566990' OR caj_cod='1201500567528' OR caj_cod='1201500567556' OR caj_cod='1201500567688' OR caj_cod='1201500567689' OR caj_cod='1201500578227' OR caj_cod='1201500567549' OR caj_cod='1201500567542' OR caj_cod='1201500578477' OR caj_cod='1201500567693' OR caj_cod='1201500567692' OR caj_cod='1201500566994' OR caj_cod='1201500567546' OR caj_cod='1201500567694' OR caj_cod='1201500567544' OR caj_cod='1201500567545' OR caj_cod='1201500566995' OR caj_cod='1201500566998' OR caj_cod='1201500566996' OR caj_cod='1201500567690' OR caj_cod='1201500567547' OR caj_cod='1201500567552' OR caj_cod='1201500567553' OR caj_cod='1201500567697' OR caj_cod='1201500567695' OR caj_cod='1201500567538' OR caj_cod='1201500567599' OR caj_cod='1201500567696' OR caj_cod='1201500567543' OR caj_cod='1201500567704' OR caj_cod='1201500567691' OR caj_cod='1201500567700' OR caj_cod='1201500567540' OR caj_cod='1201500567534' OR caj_cod='1201500566993' OR caj_cod='1201500567550' OR caj_cod='1201500567531' OR caj_cod='1201500567535' OR caj_cod='1201500567537' OR caj_cod='1201500567699' OR caj_cod='1201500567685' OR caj_cod='1201500567541' OR caj_cod='1201500567686' OR caj_cod='1201500567702' OR caj_cod='1201500628353' OR caj_cod='1201500628529' OR caj_cod='1201500628341' OR caj_cod='1201500628332' OR caj_cod='1201500628343' OR caj_cod='1201500628358' OR caj_cod='1201500628348' OR caj_cod='1201500630782' OR caj_cod='1201500630781' OR caj_cod='1201500630784' OR caj_cod='1201500630740' OR caj_cod='1201500630587' OR caj_cod='1201500630742' OR caj_cod='1201500630745' OR caj_cod='1201500630788' OR caj_cod='1201500628336' OR caj_cod='1201500628427' OR caj_cod='1201500628339' OR caj_cod='1201500628344' OR caj_cod='1201500628342' OR caj_cod='1201500628356' OR caj_cod='1201500628333' OR caj_cod='1201500630776' OR caj_cod='1201500630772' OR caj_cod='1201500630775' OR caj_cod='1201500630778' OR caj_cod='1201500630771' OR caj_cod='1201500630777' OR caj_cod='1201500630739' OR caj_cod='1201500630743' OR caj_cod='1201500630779' OR caj_cod='1201500630785' OR caj_cod='1201500630783' OR caj_cod='1201500630744' OR caj_cod='1201500630780' OR caj_cod='1201500628338' OR caj_cod='1201500628498' OR caj_cod='1201500628347' OR caj_cod='1201500628428' OR caj_cod='1201500628346' OR caj_cod='1201500628357' OR caj_cod='1201500628331' OR caj_cod='1201500630770' OR caj_cod='1201500630769' OR caj_cod='1201500630774' OR caj_cod='1201500630741' OR caj_cod='1201500630796' OR caj_cod='1201500630735' OR caj_cod='1201500628354' OR caj_cod='1201500628429' OR caj_cod='1201500628345' OR caj_cod='1201500628500' OR caj_cod='1201500628351' OR caj_cod='1201500628349' OR caj_cod='1201500628340' OR caj_cod='1201500628352' OR caj_cod='1201500628355' OR caj_cod='1201500628350' OR caj_cod='1201500630792' OR caj_cod='1201500630773' OR caj_cod='1201500630795' OR caj_cod='1201500630794' OR caj_cod='1201500630791' OR caj_cod='1201500630793' OR caj_cod='1201500630734' OR caj_cod='1201500630738' OR caj_cod='1201500630586' OR caj_cod='1201500608864' OR caj_cod='1201500608846' OR caj_cod='1201500608826' OR caj_cod='1201500608845' OR caj_cod='1201500608868' OR caj_cod='1201500608866' OR caj_cod='1201500608843' OR caj_cod='1201500608838' OR caj_cod='1201500608836' OR caj_cod='1201500608640' OR caj_cod='1201500608828' OR caj_cod='1201500608624' OR caj_cod='1201500608636' OR caj_cod='1201500608632' OR caj_cod='1201500608623' OR caj_cod='1201500608627' OR caj_cod='1201500608825' OR caj_cod='1201500608870' OR caj_cod='1201500608871' OR caj_cod='1201500608869' OR caj_cod='1201500608819' OR caj_cod='1201500608867' OR caj_cod='1201500608823' OR caj_cod='1201500608626' OR caj_cod='1201500608832' OR caj_cod='1201500608633' OR caj_cod='1201500608641' OR caj_cod='1201500608831' OR caj_cod='1201500608822' OR caj_cod='1201500608833' OR caj_cod='1201500608821' OR caj_cod='1201500608628' OR caj_cod='1201500608629' OR caj_cod='1201500608634' OR caj_cod='1201500608635' OR caj_cod='1201500608829' OR caj_cod='1201500608631' OR caj_cod='1201500608637' OR caj_cod='1201500608630' OR caj_cod='1201500608818' OR caj_cod='1201500608820' OR caj_cod='1201500608827' OR caj_cod='1201500608824' OR caj_cod='1201500608862' OR caj_cod='1201500608612' OR caj_cod='1201500608840' OR caj_cod='1201500608616' OR caj_cod='1201500608834' OR caj_cod='1201500608622' OR caj_cod='1201500636090' OR caj_cod='1201500608865' OR caj_cod='1201500608847' OR caj_cod='1201500608863' OR caj_cod='1201500608842' OR caj_cod='1201500608839' OR caj_cod='1201500608844' OR caj_cod='1201500608841' OR caj_cod='1201500608835' OR caj_cod='1201500608830' OR caj_cod='1201500608837' OR caj_cod='1201500608618' OR caj_cod='1201500608613' OR caj_cod='1201500608638' OR caj_cod='1201500608620' OR caj_cod='1201500608617' OR caj_cod='1201500629304' OR caj_cod='1201500636640' OR caj_cod='1201500636665' OR caj_cod='1201500636346' OR caj_cod='1201500636661' OR caj_cod='1201500636347' OR caj_cod='1201500636638' OR caj_cod='1201500636667' OR caj_cod='1201500636361' OR caj_cod='1201500636360' OR caj_cod='1201500636352' OR caj_cod='1201500636345' OR caj_cod='1201500636662' OR caj_cod='1201500636354' OR caj_cod='1201500636095' OR caj_cod='1201500636353' OR caj_cod='1201500636101' OR caj_cod='1201500636099' OR caj_cod='1201500636660' OR caj_cod='1201500636385' OR caj_cod='1201500636656' OR caj_cod='1201500636648' OR caj_cod='1201500636384' OR caj_cod='1201500636653' OR caj_cod='1201500636386' OR caj_cod='1201500636654' OR caj_cod='1201500636350' OR caj_cod='1201500636362' OR caj_cod='1201500636664' OR caj_cod='1201500636363' OR caj_cod='1201500636388' OR caj_cod='1201500636390' OR caj_cod='1201500636389' OR caj_cod='1201500636655' OR caj_cod='1201500636349' OR caj_cod='1201500636098' OR caj_cod='1201500636093' OR caj_cod='1201500636096' OR caj_cod='1201500636351' OR caj_cod='1201500636348' OR caj_cod='1201500636100' OR caj_cod='1201500636094' OR caj_cod='1201500636097' OR caj_cod='1201500636403' OR caj_cod='1201500636652' OR caj_cod='1201500636657' OR caj_cod='1201500636658' OR caj_cod='1201500636659' OR caj_cod='1201500636400' OR caj_cod='1201500636387' OR caj_cod='1201500636402' OR caj_cod='1201500636393' OR caj_cod='1201500636663' OR caj_cod='1201500636666' OR caj_cod='1201500636359' OR caj_cod='1201500636392' OR caj_cod='1201500636355' OR caj_cod='1201500636108' OR caj_cod='1201500636356' OR caj_cod='1201500636091' OR caj_cod='1201500636092' OR caj_cod='1201500629395' OR caj_cod='1201500636651' OR caj_cod='1201500636649' OR caj_cod='1201500636644' OR caj_cod='1201500636641' OR caj_cod='1201500636401' OR caj_cod='1201500636642' OR caj_cod='1201500636639' OR caj_cod='1201500636647' OR caj_cod='1201500636397' OR caj_cod='1201500636398' OR caj_cod='1201500636395' OR caj_cod='1201500636396' OR caj_cod='1201500636399' OR caj_cod='1201500636364' OR caj_cod='1201500636643' OR caj_cod='1201500636357' OR caj_cod='1201500636391' OR caj_cod='1201500636394' OR caj_cod='1201500636104' OR caj_cod='1201500636107' OR caj_cod='1201500636358' OR caj_cod='1201500636109' OR caj_cod='1201500636106' OR caj_cod='1201500636105' OR caj_cod='1201500636102' OR caj_cod='1201500636103' OR caj_cod='1201500637454' OR caj_cod='1201500637493' OR caj_cod='1201500637455' OR caj_cod='1201500637472' OR caj_cod='1201500637465' OR caj_cod='1201500637466' OR caj_cod='1201500637489' OR caj_cod='1201500637259' OR caj_cod='1201500637241' OR caj_cod='1201500637237' OR caj_cod='1201500637471' OR caj_cod='1201500637480' OR caj_cod='1201500637459' OR caj_cod='1201500637468' OR caj_cod='1201500637238' OR caj_cod='1201500637469' OR caj_cod='1201500637254' OR caj_cod='1201500637458' OR caj_cod='1201500637240' OR caj_cod='1201500637239' OR caj_cod='1201500637485' OR caj_cod='1201500637487' OR caj_cod='1201500637456' OR caj_cod='1201500637486' OR caj_cod='1201500637482' OR caj_cod='1201500637261' OR caj_cod='1201500637256' OR caj_cod='1201500637462' OR caj_cod='1201500637258' OR caj_cod='1201500637460' OR caj_cod='1201500637461' OR caj_cod='1201500637481' OR caj_cod='1201500637264' OR caj_cod='1201500644791' OR caj_cod='1201500637252' OR caj_cod='1201500637490' OR caj_cod='1201500637484' OR caj_cod='1201500637491' OR caj_cod='1201500637253' OR caj_cod='1201500644955' OR caj_cod='1201500637483' OR caj_cod='1201500637249' OR caj_cod='1201500637262' OR caj_cod='1201500637247' OR caj_cod='1201500637477' OR caj_cod='1201500644932' OR caj_cod='1201500637263' OR caj_cod='1201500637479' OR caj_cod='1201500637473' OR caj_cod='1201500637260' OR caj_cod='1201500637248' OR caj_cod='1201500637474' OR caj_cod='1201500637470' OR caj_cod='1201500637257' OR caj_cod='1201500637488' OR caj_cod='1201500637457' OR caj_cod='1201500637478' OR caj_cod='1201500637476' OR caj_cod='1201500637475' OR caj_cod='1201500637463' OR caj_cod='1201500637467' OR caj_cod='1201500643110' OR caj_cod='1201500643104' OR caj_cod='1201500643173' OR caj_cod='1201500643094' OR caj_cod='1201500643111' OR caj_cod='1201500643007' OR caj_cod='1201500642992' OR caj_cod='1201500643032' OR caj_cod='1201500643107' OR caj_cod='1201500643108' OR caj_cod='1201500642990' OR caj_cod='1201500642999' OR caj_cod='1201500643014' OR caj_cod='1201500642989' OR caj_cod='1201500642448' OR caj_cod='1201500642434' OR caj_cod='1201500642443' OR caj_cod='1201500642433' OR caj_cod='1201500643175' OR caj_cod='1201500643182' OR caj_cod='1201500643099' OR caj_cod='1201500643176' OR caj_cod='1201500642994' OR caj_cod='1201500643181' OR caj_cod='1201500643097' OR caj_cod='1201500643033' OR caj_cod='1201500643035' OR caj_cod='1201500643036' OR caj_cod='1201500643098' OR caj_cod='1201500643093' OR caj_cod='1201500643031' OR caj_cod='1201500643005' OR caj_cod='1201500643028' OR caj_cod='1201500643023' OR caj_cod='1201500643015' OR caj_cod='1201500643022' OR caj_cod='1201500643024' OR caj_cod='1201500643026' OR caj_cod='1201500643027' OR caj_cod='1201500642988' OR caj_cod='1201500643029' OR caj_cod='1201500643016' OR caj_cod='1201500643025' OR caj_cod='1201500643030' OR caj_cod='1201500643020' OR caj_cod='1201500643179' OR caj_cod='1201500643174' OR caj_cod='1201500642615' OR caj_cod='1201500643120' OR caj_cod='1201500643106' OR caj_cod='1201500642995' OR caj_cod='1201500643100' OR caj_cod='1201500643117' OR caj_cod='1201500643034' OR caj_cod='1201500643177' OR caj_cod='1201500643037' OR caj_cod='1201500642993' OR caj_cod='1201500642996' OR caj_cod='1201500643021' OR caj_cod='1201500642997' OR caj_cod='1201500643012' OR caj_cod='1201500643011' OR caj_cod='1201500643018' OR caj_cod='1201500642613' OR caj_cod='1201500642601' OR caj_cod='1201500642614' OR caj_cod='1201500643109' OR caj_cod='1201500643105' OR caj_cod='1201500643118' OR caj_cod='1201500643122' OR caj_cod='1201500643103' OR caj_cod='1201500643113' OR caj_cod='1201500643114' OR caj_cod='1201500643096' OR caj_cod='1201500643008' OR caj_cod='1201500643102' OR caj_cod='1201500643095' OR caj_cod='1201500643121' OR caj_cod='1201500643101' OR caj_cod='1201500643112' OR caj_cod='1201500643010' OR caj_cod='1201500643001' OR caj_cod='1201500642991' OR caj_cod='1201500643004' OR caj_cod='1201500643006' OR caj_cod='1201500643002' OR caj_cod='1201500642452' OR caj_cod='1201500642454' OR caj_cod='1201500643017' OR caj_cod='1201500643009' OR caj_cod='1201500642819' OR caj_cod='1201500642821' OR caj_cod='1201500642820' OR caj_cod='1201500642630' OR caj_cod='1201500642611' OR caj_cod='1201500642612' OR caj_cod='1201500642822' OR caj_cod='1201500642726' OR caj_cod='1201500639778' OR caj_cod='1201500642635' OR caj_cod='1201500642824' OR caj_cod='1201500642629' OR caj_cod='1201500642632' OR caj_cod='1201500642605' OR caj_cod='1201500642610' OR caj_cod='1201500642727' OR caj_cod='1201500642624' OR caj_cod='1201500642622' OR caj_cod='1201500642618' OR caj_cod='1201500642738' OR caj_cod='1201500642628' OR caj_cod='1201500639780' OR caj_cod='1201500639757' OR caj_cod='1201500642823' OR caj_cod='1201500642780' OR caj_cod='1201500642731' OR caj_cod='1201500642626' OR caj_cod='1201500642816' OR caj_cod='1201500642817' OR caj_cod='1201500639779' OR caj_cod='1201500642818' OR caj_cod='1201500642627' OR caj_cod='1201500642634' OR caj_cod='1201500642619' OR caj_cod='1201500642620' OR caj_cod='1201500642623' OR caj_cod='1201500642608' OR caj_cod='1201500639758' OR caj_cod='1201500642625' OR caj_cod='1201500642638' OR caj_cod='1201500642794' OR caj_cod='1201500642733' OR caj_cod='1201500642637' OR caj_cod='1201500642636' OR caj_cod='1201500639773' OR caj_cod='1201500642786' OR caj_cod='1201500642725' OR caj_cod='1201500642729' OR caj_cod='1201500639766' OR caj_cod='1201500642609' OR caj_cod='1201500642722' OR caj_cod='1201500642719' OR caj_cod='1201500642724' OR caj_cod='1201500642720' OR caj_cod='1201500642603' OR caj_cod='1201500639765' OR caj_cod='1201500642607' OR caj_cod='1201500642782' OR caj_cod='1201500642736' OR caj_cod='1201500642730' OR caj_cod='1201500642734' OR caj_cod='1201500639761' OR caj_cod='1201500643119' OR caj_cod='1201500642599' OR caj_cod='1201500642606' OR caj_cod='1201500643115' OR caj_cod='1201500642728' OR caj_cod='1201500639764' OR caj_cod='1201500639770' OR caj_cod='1201500642602' OR caj_cod='1201500639762' OR caj_cod='1201500639763' OR caj_cod='1201500642781' OR caj_cod='1201500642735' OR caj_cod='1201500642815' OR caj_cod='1201500639776' OR caj_cod='1201500639777' OR caj_cod='1201500639772' OR caj_cod='1201500642723' OR caj_cod='1201500642604' OR caj_cod='1201500642631' OR caj_cod='1201500642721' OR caj_cod='1201500642633' OR caj_cod='1201500642621' OR caj_cod='1201500643116' OR caj_cod='1201500642616' OR caj_cod='1201500642600' OR caj_cod='1201500642617' OR caj_cod='1201500643180' OR caj_cod='1201500643178' OR caj_cod='1201500637242' OR caj_cod='1201500637464' OR caj_cod='1201500644931' OR caj_cod='1201500637244' OR caj_cod='1201500637251' OR caj_cod='1201500637245' OR caj_cod='1201500644956' OR caj_cod='1201500637250' OR caj_cod='1201500644787' OR caj_cod='1201500639941' OR caj_cod='1201500639968' OR caj_cod='1201500639903' OR caj_cod='1201500639906' OR caj_cod='1201500639767' OR caj_cod='1201500639892' OR caj_cod='1201500639894' OR caj_cod='1201500639890' OR caj_cod='1201500639896' OR caj_cod='1201500639784' OR caj_cod='1201500639786' OR caj_cod='1201500639783' OR caj_cod='1201500642788' OR caj_cod='1201500642791' OR caj_cod='1201500642790' OR caj_cod='1201500642789' OR caj_cod='1201500642737' OR caj_cod='1201500642796' OR caj_cod='1201500639907' OR caj_cod='1201500639953' OR caj_cod='1201500639954' OR caj_cod='1201500639952' OR caj_cod='1201500639961' OR caj_cod='1201500639938' OR caj_cod='1201500639955' OR caj_cod='1201500639947' OR caj_cod='1201500639759' OR caj_cod='1201500639931' OR caj_cod='1201500639959' OR caj_cod='1201500639898' OR caj_cod='1201500639951' OR caj_cod='1201500639902' OR caj_cod='1201500639967' OR caj_cod='1201500639958' OR caj_cod='1201500639957' OR caj_cod='1201500639901' OR caj_cod='1201500639900' OR caj_cod='1201500639785' OR caj_cod='1201500639782' OR caj_cod='1201500642793' OR caj_cod='1201500642792' OR caj_cod='1201500642825' OR caj_cod='1201500642797' OR caj_cod='1201500642787' OR caj_cod='1201500642732' OR caj_cod='1201500639930' OR caj_cod='1201500639964' OR caj_cod='1201500639966' OR caj_cod='1201500639969' OR caj_cod='1201500642826' OR caj_cod='1201500639942' OR caj_cod='1201500639962' OR caj_cod='1201500639960' OR caj_cod='1201500639943' OR caj_cod='1201500639937' OR caj_cod='1201500639936' OR caj_cod='1201500639904' OR caj_cod='1201500639946' OR caj_cod='1201500639956' OR caj_cod='1201500639760' OR caj_cod='1201500639897' OR caj_cod='1201500639781' OR caj_cod='1201500639899' OR caj_cod='1201500639934' OR caj_cod='1201500639935' OR caj_cod='1201500639965' OR caj_cod='1201500639940' OR caj_cod='1201500639933' OR caj_cod='1201500639948' OR caj_cod='1201500639949' OR caj_cod='1201500639889' OR caj_cod='1201500639932' OR caj_cod='1201500639970' OR caj_cod='1201500639939' OR caj_cod='1201500639774' OR caj_cod='1201500639945' OR caj_cod='1201500639769' OR caj_cod='1201500639944' OR caj_cod='1201500642783' OR caj_cod='1201500639775' OR caj_cod='1201500639895' OR caj_cod='1201500639905' OR caj_cod='1201500639893' OR caj_cod='1201500642784' OR caj_cod='1201500642785' OR caj_cod='1201500639768' OR caj_cod='1201500639950' OR caj_cod='1201500639891' OR caj_cod='1201500639771' OR caj_cod='1201500642795' OR caj_cod='1201500640237' OR caj_cod='1201500640508' OR caj_cod='1201500640497' OR caj_cod='1201500640496' OR caj_cod='1201500640500' OR caj_cod='1201500640228' OR caj_cod='1201500640495' OR caj_cod='1201500640743' OR caj_cod='1201500640471' OR caj_cod='1201500606689' OR caj_cod='1201500640486' OR caj_cod='1201500640490' OR caj_cod='1201500606675' OR caj_cod='1201500606560' OR caj_cod='1201500606671' OR caj_cod='1201500606670' OR caj_cod='1201500606562' OR caj_cod='1201500606684' OR caj_cod='1201500640489' OR caj_cod='1201500643457' OR caj_cod='1201500640235' OR caj_cod='1201500643443' OR caj_cod='1201500640485' OR caj_cod='1201500640478' OR caj_cod='1201500640479' OR caj_cod='1201500640493' OR caj_cod='1201500640475' OR caj_cod='1201500606551' OR caj_cod='1201500640241' OR caj_cod='1201500640466' OR caj_cod='1201500606686' OR caj_cod='1201500640473' OR caj_cod='1201500640470' OR caj_cod='1201500640465' OR caj_cod='1201500640239' OR caj_cod='1201500606685' OR caj_cod='1201500640494' OR caj_cod='1201500641218' OR caj_cod='1201500606683' OR caj_cod='1201500606682' OR caj_cod='1201500606558' OR caj_cod='1201500640472' OR caj_cod='1201500640488' OR caj_cod='1201500606557' OR caj_cod='1201500606681' OR caj_cod='1201500643455' OR caj_cod='1201500640468' OR caj_cod='1201500640499' OR caj_cod='1201500640504' OR caj_cod='1201500640233' OR caj_cod='1201500640481' OR caj_cod='1201500640469' OR caj_cod='1201500640234' OR caj_cod='1201500640503' OR caj_cod='1201500640513' OR caj_cod='1201500640510' OR caj_cod='1201500640236' OR caj_cod='1201500640238' OR caj_cod='1201500640480' OR caj_cod='1201500640240' OR caj_cod='1201500640474' OR caj_cod='1201500640476' OR caj_cod='1201500640487' OR caj_cod='1201500640227' OR caj_cod='1201500643441' OR caj_cod='1201500640505' OR caj_cod='1201500640226' OR caj_cod='1201500640230' OR caj_cod='1201500640507' OR caj_cod='1201500640483' OR caj_cod='1201500643485' OR caj_cod='1201500640231' OR caj_cod='1201500640501' OR caj_cod='1201500640502' OR caj_cod='1201500640482' OR caj_cod='1201500640506' OR caj_cod='1201500640745' OR caj_cod='1201500606673' OR caj_cod='1201500606674' OR caj_cod='1201500640744' OR caj_cod='1201500640484' OR caj_cod='1201500606561' OR caj_cod='1201500640229' OR caj_cod='1201500640498' OR caj_cod='1201500640225' OR caj_cod='1201500640746' OR caj_cod='1201500640492' OR caj_cod='1201500640491' OR caj_cod='1201500640232' OR caj_cod='1201500643642' OR caj_cod='1201500643670' OR caj_cod='1201500643656' OR caj_cod='1201500643668' OR caj_cod='1201500643438' OR caj_cod='1201500643647' OR caj_cod='1201500643494' OR caj_cod='1201500643460' OR caj_cod='1201500643473' OR caj_cod='1201500643454' OR caj_cod='1201500643458' OR caj_cod='1201500643459' OR caj_cod='1201500643489' OR caj_cod='1201500640509' OR caj_cod='1201500640514' OR caj_cod='1201500643472' OR caj_cod='1201500643444' OR caj_cod='1201500643649' OR caj_cod='1201500643465' OR caj_cod='1201500643655' OR caj_cod='1201500641974' OR caj_cod='1201500643462' OR caj_cod='1201500641973' OR caj_cod='1201500641990' OR caj_cod='1201500643658' OR caj_cod='1201500643468' OR caj_cod='1201500643464' OR caj_cod='1201500643474' OR caj_cod='1201500643651' OR caj_cod='1201500643660' OR caj_cod='1201500643467' OR caj_cod='1201500643477' OR caj_cod='1201500643461' OR caj_cod='1201500643661' OR caj_cod='1201500643654' OR caj_cod='1201500643484' OR caj_cod='1201500643448' OR caj_cod='1201500643456' OR caj_cod='1201500643452' OR caj_cod='1201500643453' OR caj_cod='1201500640512' OR caj_cod='1201500643469' OR caj_cod='1201500643447' OR caj_cod='1201500640467' OR caj_cod='1201500640477' OR caj_cod='1201500643659' OR caj_cod='1201500643666' OR caj_cod='1201500641988' OR caj_cod='1201500643463' OR caj_cod='1201500643664' OR caj_cod='1201500643657' OR caj_cod='1201500643667' OR caj_cod='1201500643478' OR caj_cod='1201500643476' OR caj_cod='1201500643440' OR caj_cod='1201500643437' OR caj_cod='1201500643653' OR caj_cod='1201500643450' OR caj_cod='1201500643650' OR caj_cod='1201500643449' OR caj_cod='1201500643451' OR caj_cod='1201500643652' OR caj_cod='1201500643483' OR caj_cod='1201500643669' OR caj_cod='1201500643495' OR caj_cod='1201500643640' OR caj_cod='1201500643665' OR caj_cod='1201500643648' OR caj_cod='1201500643643' OR caj_cod='1201500643475' OR caj_cod='1201500643644' OR caj_cod='1201500643641' OR caj_cod='1201500643662' OR caj_cod='1201500643646' OR caj_cod='1201500643466' OR caj_cod='1201500643439' OR caj_cod='1201500643487' OR caj_cod='1201500643471' OR caj_cod='1201500643486' OR caj_cod='1201500643492' OR caj_cod='1201500643445' OR caj_cod='1201500643491' OR caj_cod='1201500643493' OR caj_cod='1201500643446' OR caj_cod='1201500643436' OR caj_cod='1201500643482' OR caj_cod='1201500643490' OR caj_cod='1201500643442' OR caj_cod='1201500643488' OR caj_cod='1201500643470' OR caj_cod='1201500640933' OR caj_cod='1201500640939' OR caj_cod='1201500640938' OR caj_cod='1201500640936' OR caj_cod='1201500641202' OR caj_cod='1201500640961' OR caj_cod='1201500640971' OR caj_cod='1201500640935' OR caj_cod='1201500640963' OR caj_cod='1201500640955' OR caj_cod='1201500640966' OR caj_cod='1201500640954' OR caj_cod='1201500640763' OR caj_cod='1201500640762' OR caj_cod='1201500640758' OR caj_cod='1201500640747' OR caj_cod='1201500640764' OR caj_cod='1201500640759' OR caj_cod='1201500640957' OR caj_cod='1201500641196' OR caj_cod='1201500640942' OR caj_cod='1201500640958' OR caj_cod='1201500641215' OR caj_cod='1201500641191' OR caj_cod='1201500641214' OR caj_cod='1201500641193' OR caj_cod='1201500640965' OR caj_cod='1201500640962' OR caj_cod='1201500640953' OR caj_cod='1201500641199' OR caj_cod='1201500640749' OR caj_cod='1201500640945' OR caj_cod='1201500640951' OR caj_cod='1201500641200' OR caj_cod='1201500640959' OR caj_cod='1201500640964' OR caj_cod='1201500640748' OR caj_cod='1201500640952' OR caj_cod='1201500640750' OR caj_cod='1201500640757' OR caj_cod='1201500640765' OR caj_cod='1201500640751' OR caj_cod='1201500640752' OR caj_cod='1201500640766' OR caj_cod='1201500640753' OR caj_cod='1201500641206' OR caj_cod='1201500641197' OR caj_cod='1201500641194' OR caj_cod='1201500640511' OR caj_cod='1201500641213' OR caj_cod='1201500640950' OR caj_cod='1201500641212' OR caj_cod='1201500641198' OR caj_cod='1201500640949' OR caj_cod='1201500641220' OR caj_cod='1201500640948' OR caj_cod='1201500640943' OR caj_cod='1201500640960' OR caj_cod='1201500641201' OR caj_cod='1201500641211' OR caj_cod='1201500641192' OR caj_cod='1201500640944' OR caj_cod='1201500640956' OR caj_cod='1201500641195' OR caj_cod='1201500641217' OR caj_cod='1201500641205' OR caj_cod='1201500641204' OR caj_cod='1201500641210' OR caj_cod='1201500641219' OR caj_cod='1201500641207' OR caj_cod='1201500640941' OR caj_cod='1201500641208' OR caj_cod='1201500641216' OR caj_cod='1201500640947' OR caj_cod='1201500640937' OR caj_cod='1201500640967' OR caj_cod='1201500640946' OR caj_cod='1201500640934' OR caj_cod='1201500641203' OR caj_cod='1201500640970' OR caj_cod='1201500640760' OR caj_cod='1201500640761' OR caj_cod='1201500640968' OR caj_cod='1201500641209' OR caj_cod='1201500640940' OR caj_cod='1201500640755' OR caj_cod='1201500640756' OR caj_cod='1201500640969' OR caj_cod='1201500640932' OR caj_cod='1201500641971' OR caj_cod='1201500641962' OR caj_cod='1201500641986' OR caj_cod='1201500641985' OR caj_cod='1201500641993' OR caj_cod='1201500641980' OR caj_cod='1201500641955' OR caj_cod='1201500641954' OR caj_cod='1201500643645' OR caj_cod='1201500641952' OR caj_cod='1201500641987' OR caj_cod='1201500641953' OR caj_cod='1201500641984' OR caj_cod='1201500641983' OR caj_cod='1201500632927' OR caj_cod='1201500641981' OR caj_cod='1201500641989' OR caj_cod='1201500641965' OR caj_cod='1201500643663' OR caj_cod='1201500641972' OR caj_cod='1201500641977' OR caj_cod='1201500643639' OR caj_cod='1201500641978' OR caj_cod='1201500641991' OR caj_cod='1201500643632' OR caj_cod='1201500632928' OR caj_cod='1201500641979' OR caj_cod='1201500641959' OR caj_cod='1201500641964' OR caj_cod='1201500641975' OR caj_cod='1201500641976' OR caj_cod='1201500641982' OR caj_cod='1201500641969' OR caj_cod='1201500632934' OR caj_cod='1201500632932' OR caj_cod='1201500641970' OR caj_cod='1201500641958' OR caj_cod='1201500641967' OR caj_cod='1201500641994' OR caj_cod='1201500641961' OR caj_cod='1201500641995' OR caj_cod='1201500641966' OR caj_cod='1201500641960' OR caj_cod='1201500641957' OR caj_cod='1201500641968' OR caj_cod='1201500641963' OR caj_cod='1201500641956' OR caj_cod='1201500641992' OR caj_cod='1201500638429' OR caj_cod='1201500638201' OR caj_cod='1201500638415' OR caj_cod='1201500638414' OR caj_cod='1201500638193' OR caj_cod='1201500638194' OR caj_cod='1201500638412' OR caj_cod='1201500638416' OR caj_cod='1201500638195' OR caj_cod='1201500639630' OR caj_cod='1201500639481' OR caj_cod='1201500639610' OR caj_cod='1201500638200' OR caj_cod='1201500638198' OR caj_cod='1201500638430' OR caj_cod='1201500638423' OR caj_cod='1201500638411' OR caj_cod='1201500638422' OR caj_cod='1201500638419' OR caj_cod='1201500638420' OR caj_cod='1201500638199' OR caj_cod='1201500638417' OR caj_cod='1201500638197' OR caj_cod='1201500638204' OR caj_cod='1201500638428' OR caj_cod='1201500638424' OR caj_cod='1201500638208' OR caj_cod='1201500638205' OR caj_cod='1201500638410' OR caj_cod='1201500638421' OR caj_cod='1201500638206' OR caj_cod='1201500638207' OR caj_cod='1201500638202' OR caj_cod='1201500638203' OR caj_cod='1201500639631' OR caj_cod='1201500639626' OR caj_cod='1201500658493' OR caj_cod='1201500658724' OR caj_cod='1201500658429' OR caj_cod='1201500658463' OR caj_cod='1201500658490' OR caj_cod='1201500658489' OR caj_cod='1201500658430' OR caj_cod='1201500658725' OR caj_cod='1201500658504' OR caj_cod='1201500658727' OR caj_cod='1201500658457' OR caj_cod='1201500658497' OR caj_cod='1201500658499' OR caj_cod='1201500661557' OR caj_cod='1201500661568' OR caj_cod='1201500661559' OR caj_cod='1201500661555' OR caj_cod='1201500661265' OR caj_cod='1201500661262' OR caj_cod='1201500661247' OR caj_cod='1201500661570' OR caj_cod='1201500661576' OR caj_cod='1201500661575' OR caj_cod='1201500661093' OR caj_cod='1201500661090' OR caj_cod='1201500661091' OR caj_cod='1201500661095' OR caj_cod='1201500661096' OR caj_cod='1201500661092' OR caj_cod='1201500661550' OR caj_cod='1201500661099' OR caj_cod='1201500661244' OR caj_cod='1201500661552' OR caj_cod='1201500661250' OR caj_cod='1201500661565' OR caj_cod='1201500661253' OR caj_cod='1201500661100' OR caj_cod='1201500661246' OR caj_cod='1201500661104' OR caj_cod='1201500661103' OR caj_cod='1201500661549' OR caj_cod='1201500661569' OR caj_cod='1201500661240' OR caj_cod='1201500661269' OR caj_cod='1201500661264' OR caj_cod='1201500661242' OR caj_cod='1201500661243' OR caj_cod='1201500661097' OR caj_cod='1201500660949' OR caj_cod='1201500661268' OR caj_cod='1201500661102' OR caj_cod='1201500661098' OR caj_cod='1201500661105' OR caj_cod='1201500661551' OR caj_cod='1201500661564' OR caj_cod='1201500661562' OR caj_cod='1201500661572' OR caj_cod='1201500661248' OR caj_cod='1201500661256' OR caj_cod='1201500661567' OR caj_cod='1201500661556' OR caj_cod='1201500661561' OR caj_cod='1201500661573' OR caj_cod='1201500661548' OR caj_cod='1201500661574' OR caj_cod='1201500661571' OR caj_cod='1201500661252' OR caj_cod='1201500661251' OR caj_cod='1201500661553' OR caj_cod='1201500661554' OR caj_cod='1201500661249' OR caj_cod='1201500661255' OR caj_cod='1201500661260' OR caj_cod='1201500661261' OR caj_cod='1201500661563' OR caj_cod='1201500661577' OR caj_cod='1201500661566' OR caj_cod='1201500661560' OR caj_cod='1201500661107' OR caj_cod='1201500661094' OR caj_cod='1201500661263' OR caj_cod='1201500660946' OR caj_cod='1201500661558' OR caj_cod='1201500661245' OR caj_cod='1201500661266' OR caj_cod='1201500661267' OR caj_cod='1201500661259' OR caj_cod='1201500661089' OR caj_cod='1201500661108' OR caj_cod='1201500661258' OR caj_cod='1201500661241' OR caj_cod='1201500661254' OR caj_cod='1201500661257' OR caj_cod='1201500666716' OR caj_cod='1201500666717' OR caj_cod='1201500666711' OR caj_cod='1201500666732' OR caj_cod='1201500666718' OR caj_cod='1201500666725' OR caj_cod='1201500666736' OR caj_cod='1201500666733' OR caj_cod='1201500666731' OR caj_cod='1201500666726' OR caj_cod='1201500668829' OR caj_cod='1201500668833' OR caj_cod='1201500668834' OR caj_cod='1201500666921' OR caj_cod='1201500666919' OR caj_cod='1201500666915' OR caj_cod='1201500666722' OR caj_cod='1201500666917' OR caj_cod='1201500666730' OR caj_cod='1201500666729' OR caj_cod='1201500666734' OR caj_cod='1201500666712' OR caj_cod='1201500666922' OR caj_cod='1201500666918' OR caj_cod='1201500668839' OR caj_cod='1201500666912' OR caj_cod='1201500668821' OR caj_cod='1201500666929' OR caj_cod='1201500666715' OR caj_cod='1201500666735' OR caj_cod='1201500666910' OR caj_cod='1201500668832' OR caj_cod='1201500668836' OR caj_cod='1201500668838' OR caj_cod='1201500668835' OR caj_cod='1201500666916' OR caj_cod='1201500666723' OR caj_cod='1201500666720' OR caj_cod='1201500666710' OR caj_cod='1201500666721' OR caj_cod='1201500666724' OR caj_cod='1201500666727' OR caj_cod='1201500666719' OR caj_cod='1201500666728' OR caj_cod='1201500668826' OR caj_cod='1201500668820' OR caj_cod='1201500668837' OR caj_cod='1201500668823' OR caj_cod='1201500666927' OR caj_cod='1201500666914' OR caj_cod='1201500666911' OR caj_cod='1201500666928' OR caj_cod='1201500666913' OR caj_cod='1201500668825' OR caj_cod='1201500668824' OR caj_cod='1201500666923' OR caj_cod='1201500668822' OR caj_cod='1201500668827' OR caj_cod='1201500666737' OR caj_cod='1201500666739' OR caj_cod='1201500666714' OR caj_cod='1201500666924' OR caj_cod='1201500666738' OR caj_cod='1201500666713' OR caj_cod='1201500666920' OR caj_cod='1201500668831' OR caj_cod='1201500666926' OR caj_cod='1201500668830' OR caj_cod='1201500666925' OR caj_cod='1201500668828' OR caj_cod='1201500642449' OR caj_cod='1201500642444' OR caj_cod='1201500642459' OR caj_cod='1201500642446' OR caj_cod='1201500642455' OR caj_cod='1201500642460' OR caj_cod='1201500641875' OR caj_cod='1201500641874' OR caj_cod='1201500641843' OR caj_cod='1201500641872' OR caj_cod='1201500641891' OR caj_cod='1201500641858' OR caj_cod='1201500641842' OR caj_cod='1201500641850' OR caj_cod='1201500641846' OR caj_cod='1201500642431' OR caj_cod='1201500642442' OR caj_cod='1201500641864' OR caj_cod='1201500642447' OR caj_cod='1201500641866' OR caj_cod='1201500641878' OR caj_cod='1201500642437' OR caj_cod='1201500641865' OR caj_cod='1201500641877' OR caj_cod='1201500641879' OR caj_cod='1201500641888' OR caj_cod='1201500641890' OR caj_cod='1201500641871' OR caj_cod='1201500641868' OR caj_cod='1201500641886' OR caj_cod='1201500641880' OR caj_cod='1201500641887' OR caj_cod='1201500641859' OR caj_cod='1201500641884' OR caj_cod='1201500642439' OR caj_cod='1201500641889' OR caj_cod='1201500641860' OR caj_cod='1201500641873' OR caj_cod='1201500641881' OR caj_cod='1201500642468' OR caj_cod='1201500642462' OR caj_cod='1201500641856' OR caj_cod='1201500642440' OR caj_cod='1201500642467' OR caj_cod='1201500642466' OR caj_cod='1201500641876' OR caj_cod='1201500642456' OR caj_cod='1201500642441' OR caj_cod='1201500641851' OR caj_cod='1201500641854' OR caj_cod='1201500641863' OR caj_cod='1201500641867' OR caj_cod='1201500641882' OR caj_cod='1201500641849' OR caj_cod='1201500641869' OR caj_cod='1201500641870' OR caj_cod='1201500643000' OR caj_cod='1201500642445' OR caj_cod='1201500643013') AND caj_ped='0' GROUP BY caj_cod

GO

GO

GO

CREATE VIEW [dbo].[a] As
SELECT drec_codi, SUM(drec_pallet) UNO, SUM(drec_unidades) DOS, SUM(drec_peso)TRES, 
isnull(SUM(ddes_pallet),0) CUATRO, isnull(ddes_unidades,0) CINCO, isnull(ddes_peso,0) SEIS, isnull(racd_unidades,0) SIETE, isnull(racd_peso,0) OCHO
FROM detarece LEFT JOIN detadespa ON drec_codi=ddes_codrece  LEFT JOIN rackdeta ON racd_codi=drec_codi  WHERE drec_rutcli<>'116095327' AND drec_codvig=0
GROUP BY drec_codi, drec_unidades, drec_peso, ddes_unidades, ddes_peso,  racd_unidades, racd_peso, drec_rutcli 
HAVING isnull(racd_unidades,0)<>drec_unidades
GO

GO

GO
CREATE VIEW [dbo].[AAAA]
AS
SELECT drec_codi, drec_rutcli, drec_pallet, drec_unidades, drec_peso, ddes_codi, isnull(SUM(ddes_pallet),0) AS PALLET, isnull(SUM(ddes_unidades),0) AS CAJA, isnull(SUM(ddes_peso),0) AS PESO 
FROM detarece LEFT JOIN detadespa ON drec_codi=ddes_codrece WHERE drec_codvig='0'
GROUP BY drec_codi, ddes_codi, drec_pallet, drec_unidades, drec_peso, drec_rutcli

GO

GO

GO

CREATE VIEW [dbo].[BORRAR1]
AS
SELECT Caj_Pcod, CASE WHEN caj_ped=0 THEN SUM(1) END as ped, racd_unidades FROM rackdeta  INNER JOIN DetaReceCajas ON racd_codi=Caj_Pcod  
GROUP BY Caj_Pcod, caj_ped, racd_unidades 
GO

GO

GO
CREATE VIEW [dbo].[clientes_vista]
AS
SELECT        dbo.clientes.cli_nomb, dbo.clientes.CLI_CRYD, dbo.fichrece.frec_codi
FROM            dbo.clientes INNER JOIN
                         dbo.fichrece ON dbo.clientes.cli_rut = dbo.fichrece.frec_rutcli

GO

GO

GO
CREATE VIEW [dbo].[consulta alifrut rece]
AS
SELECT     LEFT(dbo.detarece.drec_codi, 7) AS Expr1
FROM         dbo.tipoenv INNER JOIN
                      dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi ON dbo.tipoenv.tenv_codi = dbo.maeprod.mae_tipenv
WHERE     (dbo.detarece.drec_rutcli = '965579109') AND (LEFT(dbo.tipoenv.tenv_descr, 4) = 'BINS')
GROUP BY LEFT(dbo.detarece.drec_codi, 7)

GO

GO

GO
CREATE VIEW [dbo].[consulta de alifrut]
AS
SELECT     LEFT(dbo.detadespa.ddes_codi, 7) AS Expr1
FROM         dbo.detadespa INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE     (dbo.detadespa.ddes_rutcli = '965579109') AND (LEFT(dbo.tipoenv.tenv_descr, 4) = 'BINS')
GROUP BY LEFT(dbo.detadespa.ddes_codi, 7)

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[DespachoArlavan] as
select fichdespa.fdes_tipcarga, ddes_fecha, maeprod.mae_descr, detadespa.ddes_codpro, sum(detadespa.ddes_peso) as toneladas, sum(detadespa.ddes_pallet)as Pallets
from detadespa inner join fichdespa on fichdespa.fdes_codi=left(detadespa.ddes_codrece,7)
              inner join maeprod on maeprod.mae_codi=detadespa.ddes_codpro  
where ddes_codpro in ('8000342','8000343','8000346','8000367','8000387','8000391','8000399','8000402','8000413','8000422','8000436','8000433')
	 and ddes_fecha between '2004/04/01' and '2005/08/31'
group by fichdespa.fdes_tipcarga, ddes_fecha, maeprod.mae_descr, detadespa.ddes_codpro
--order by fichdespa.fdes_tipcarga, ddes_fecha, maeprod.mae_descr, detadespa.ddes_codpro

GO

GO

GO
CREATE VIEW [dbo].[detarececajasped]
AS
SELECT        dbo.DetaReceCajas.caj_Pcod AS dpc_numpal, dbo.DetaReceCajas.caj_cod AS dpc_codcaja, dbo.DetaReceCajas.caj_codenca, dbo.DetaReceCajas.caj_Est, 
                         dbo.DetaReceCajas.caj_TipError, dbo.DetaReceCajas.caj_ped, dbo.DetaReceCajas.caj_fecha, dbo.DetaReceCajas.caj_Calidad, dbo.DetaReceCajas.caj_Calibre, 
                         dbo.DetaReceCajas.caj_felab, dbo.DetaReceCajas.caj_fvenc, dbo.DetaReceCajas.caj_unid, dbo.DetaReceCajas.caj_Kg, dbo.DetaReceCajas.caj_libras, 
                         dbo.DetaReceCajas.caj_producto, dbo.DetaReceCajas.caj_Id, dbo.DetaReceCajas.caj_lote, dbo.DetaReceCajas.caj_maquilador, 
                         dbo.Pedidos_ficha.Orden AS dpc_codped, dbo.detarece.drec_codpro AS mae_codi2
FROM            dbo.Pedidos_detalle INNER JOIN
                         dbo.DetaReceCajas ON dbo.Pedidos_detalle.pallet = dbo.DetaReceCajas.caj_Pcod INNER JOIN
                         dbo.Pedidos_ficha ON dbo.Pedidos_detalle.pedido = dbo.Pedidos_ficha.pedido LEFT OUTER JOIN
                         dbo.detarece ON dbo.DetaReceCajas.caj_Pcod = dbo.detarece.drec_codi

GO

GO

GO
CREATE VIEW [dbo].[detarrececajasweb]
AS
SELECT     dbo.DetareceCajas.drec_codi, dbo.DetareceCajas.drec_codcaja, dbo.maeprod.mae_codi, dbo.maeprod.mae_descr, dbo.DetareceCajas.drec_codsopo, 
                      dbo.DetareceCajas.drec_origen, dbo.DetareceCajas.drec_sopocli, dbo.DetareceCajas.drec_unidades, dbo.DetareceCajas.drec_peso, 
                      dbo.DetareceCajas.drec_fecrec, dbo.DetareceCajas.drec_rutcli, dbo.DetareceCajas.drec_contcli, dbo.DetareceCajas.drec_rutproductor, 
                      dbo.DetareceCajas.drec_fecprod, dbo.DetareceCajas.drec_camara, dbo.DetareceCajas.drec_banda, dbo.DetareceCajas.drec_colum, 
                      dbo.DetareceCajas.drec_piso, dbo.DetareceCajas.drec_nivel, dbo.maeprod.mae_codcli, dbo.tipoenv.tenv_descr, 
                      dbo.DetareceCajas.Caja AS CAJACLIENTE
FROM         dbo.maeprod INNER JOIN
                      dbo.DetareceCajas ON dbo.maeprod.mae_codi = dbo.DetareceCajas.drec_codpro INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.rackdeta ON LEFT(dbo.DetareceCajas.drec_codi, 9) = dbo.rackdeta.racd_codi
WHERE     (dbo.DetareceCajas.drec_codvig = 0)

GO

GO

GO
CREATE VIEW [dbo].[dorca]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codi, dbo.detadespa.ddes_codi
FROM         dbo.detadespa INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
WHERE     (LEFT(dbo.detarece.drec_codi, 7) = 34884)
ORDER BY dbo.detarece.drec_codi

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[dos_det]
as
select drec_rutcli as rut,drec_codpro as codigo,(drec_pallet) as palet,(drec_unidades) as unidades,(drec_peso) as peso,* from detarece as a,maeprod as b where a.drec_codvig = '0' and b.mae_codi=a.drec_codpro 

GO

GO

GO
CREATE VIEW [dbo].[Fac_Capturadatos]
AS
SELECT        dbo.detarece.drec_unica, dbo.detarece.drec_codi, dbo.detarece.drec_codcaja, dbo.detarece.drec_codpro, dbo.detarece.drec_origen, dbo.detarece.drec_codsopo, 
                         dbo.detarece.drec_sopocli, dbo.detarece.drec_unidades, dbo.detarece.drec_peso, dbo.detarece.drec_fecrec, dbo.detarece.drec_rutcli, 
                         dbo.detarece.drec_rutproductor, dbo.detarece.drec_contcli, dbo.detarece.drec_fecprod, dbo.detarece.drec_camara, dbo.detarece.drec_banda, 
                         dbo.detarece.drec_colum, dbo.detarece.drec_piso, dbo.detarece.drec_nivel, dbo.detarece.drec_almacen, dbo.detarece.drec_dcaja, dbo.detarece.drec_tunel, 
                         dbo.detarece.drec_codvig, dbo.detarece.drec_pallet, dbo.detarece.drec_codrel, dbo.detarece.drec_nrosopo, dbo.detarece.drec_slot, dbo.detarece.drec_dtgracia, 
                         dbo.detarece.drec_codsag, dbo.detarece.drec_tipo, dbo.detarece.FechaVencimiento, dbo.detarece.LoteCliente, dbo.detarece.drec_temp, dbo.detarece.drec_TS, 
                         dbo.detarece.drec_TM, dbo.detarece.drec_TI, dbo.detarece.drec_RecepTunel, dbo.detarece.drec_ProcTunel, dbo.detarece.drec_TS_Tunel, 
                         dbo.detarece.drec_TM_Tunel, dbo.detarece.drec_TI_Tunel, dbo.detarece.drec_codper, dbo.detarece.drec_hora, dbo.detarece.drec_FecHomo, 
                         dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, dbo.detarece.drec_estado, dbo.detarece.drec_etiqueta, dbo.detarece.drec_valor, 
                         dbo.detarece.drec_moncodi, dbo.detarece.drec_medcodi, dbo.detarece.drec_proceso, dbo.detarece.drec_palletCC, dbo.detarece.frec_codi, dbo.detarece.drec_desc, 
                         dbo.detarece.frec_codi1, dbo.detarece.drec_arriendo, dbo.detarece.drec_rev, fr.frec_unica, fr.frec_codi AS Expr1, fr.frec_rutcli, fr.frec_rutproductor, fr.frec_contcli, 
                         fr.frec_horalleg, fr.frec_horarec, fr.frec_horater, fr.frec_turnrec, fr.frec_fecproc, fr.frec_fecrec, fr.frec_fecter, fr.frec_guiades, fr.frec_tipentr, fr.frec_totsopo, 
                         fr.frec_totunidad, fr.frec_totpeso, fr.frec_temppro, fr.frec_rutcond, fr.frec_observ, fr.frec_tipdesc, fr.frec_codienca, fr.frec_origen, fr.frec_codvig, fr.frec_radio, 
                         fr.frec_tipo, fr.frec_RecepTunel, fr.frec_AspectoSanitario, fr.frec_CondGeneral, fr.frec_procedencia, fr.frec_paso, fr.frec_antecamara, fr.frec_numSello, 
                         fr.frec_termografo, fr.frec_tiporecepcion, fr.frec_observ2, fr.frec_tipoalmacenamiento, fr.frec_contenedor, fr.frec_patente, fr.frec_almac, fr.frec_empresa, fr.frec_olores, 
                         fr.frec_higiene, fr.frec_estiba, fr.frec_daado, fr.frec_TS, fr.frec_TM, fr.frec_TI, fr.frec_clfol, fr.frec_Enviada, fr.frec_tablet, fr.frec_traq, fr.frec_emis, 
                         fr.frec_packinglist
FROM            dbo.detarece INNER JOIN
                         dbo.fichrece AS fr ON LEFT(dbo.detarece.drec_codi, 7) = fr.frec_codi
WHERE        (fr.frec_origen = '25' OR
                         fr.frec_origen = '20') AND (dbo.detarece.drec_codvig = '0')

GO

GO

GO
CREATE VIEW [dbo].[FAC_PICKING]
AS
SELECT        dbo.detadespa.ddes_unica, dbo.detadespa.ddes_codi, dbo.detadespa.ddes_codpro, dbo.detadespa.ddes_codsopo, dbo.detadespa.ddes_sopocli, 
                         dbo.detadespa.ddes_unidades, dbo.detadespa.ddes_peso, dbo.detadespa.ddes_fecprod, dbo.detadespa.ddes_rutcli, dbo.detadespa.ddes_contcli, 
                         dbo.detadespa.ddes_camara, dbo.detadespa.ddes_almacen, dbo.detadespa.ddes_codpred, dbo.detadespa.ddes_codrece, dbo.detadespa.ddes_codvig, 
                         dbo.detadespa.ddes_pallet, dbo.detadespa.ddes_pedido, dbo.fichdespa.fdes_unica, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_rutcli, 
                         dbo.fichdespa.fdes_horalleg, dbo.fichdespa.fdes_hora, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_codpred, dbo.fichdespa.fdes_totsopo, 
                         dbo.fichdespa.fdes_totunidad, dbo.fichdespa.fdes_totpeso, dbo.fichdespa.fdes_rutcond, dbo.fichdespa.fdes_patente, dbo.fichdespa.fdes_transporte, 
                         dbo.fichdespa.fdes_contenedor, dbo.fichdespa.fdes_carro, dbo.fichdespa.fdes_sello, dbo.fichdespa.fdes_horometro, dbo.fichdespa.fdes_observ, 
                         dbo.fichdespa.fdes_tipcarga, dbo.fichdespa.fdes_codienca, dbo.fichdespa.fdes_codvig, dbo.fichdespa.fdes_origen, dbo.fichdespa.fdes_arte, 
                         dbo.fichdespa.fdes_tipo, dbo.fichdespa.fdes_GuiaCliente, dbo.fichdespa.fdes_tempdespacho, dbo.fichdespa.fdes_ordenembarque, dbo.fichdespa.fdes_destino, 
                         dbo.fichdespa.fdes_clfol, dbo.fichdespa.fdes_enviada, dbo.fichdespa.fdes_emis, dbo.detadespa.ddes_fecha
FROM            dbo.detadespa INNER JOIN
                         dbo.fichdespa ON dbo.fichdespa.fdes_codi = LEFT(dbo.detadespa.ddes_codi, 7)
WHERE        (dbo.detadespa.ddes_pallet = 0) AND (dbo.fichdespa.fdes_origen = '10')

GO

GO

GO
CREATE VIEW [dbo].[FAC_TrackeoSAL]
AS
SELECT        dbo.detadespa.ddes_unica, dbo.detadespa.ddes_codi, dbo.detadespa.ddes_codpro, dbo.detadespa.ddes_codsopo, dbo.detadespa.ddes_sopocli, 
                         dbo.detadespa.ddes_unidades, dbo.detadespa.ddes_peso, dbo.detadespa.ddes_fecprod, dbo.detadespa.ddes_fecha, dbo.detadespa.ddes_rutcli, 
                         dbo.detadespa.ddes_contcli, dbo.detadespa.ddes_camara, dbo.detadespa.ddes_almacen, dbo.detadespa.ddes_codpred, dbo.detadespa.ddes_codrece, 
                         dbo.detadespa.ddes_codvig, dbo.detadespa.ddes_pallet, dbo.detadespa.ddes_pedido, dbo.fichdespa.fdes_unica, dbo.fichdespa.fdes_codi, 
                         dbo.fichdespa.fdes_rutcli, dbo.fichdespa.fdes_horalleg, dbo.fichdespa.fdes_hora, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_codpred, 
                         dbo.fichdespa.fdes_totsopo, dbo.fichdespa.fdes_totunidad, dbo.fichdespa.fdes_totpeso, dbo.fichdespa.fdes_rutcond, dbo.fichdespa.fdes_patente, 
                         dbo.fichdespa.fdes_transporte, dbo.fichdespa.fdes_contenedor, dbo.fichdespa.fdes_carro, dbo.fichdespa.fdes_sello, dbo.fichdespa.fdes_horometro, 
                         dbo.fichdespa.fdes_observ, dbo.fichdespa.fdes_tipcarga, dbo.fichdespa.fdes_codienca, dbo.fichdespa.fdes_codvig, dbo.fichdespa.fdes_origen, 
                         dbo.fichdespa.fdes_arte, dbo.fichdespa.fdes_tipo, dbo.fichdespa.fdes_GuiaCliente, dbo.fichdespa.fdes_tempdespacho, dbo.fichdespa.fdes_ordenembarque, 
                         dbo.fichdespa.fdes_destino, dbo.fichdespa.fdes_clfol, dbo.fichdespa.fdes_enviada, dbo.fichdespa.fdes_emis
FROM            dbo.detadespa INNER JOIN
                         dbo.fichdespa ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.fichdespa.fdes_codi
WHERE        (dbo.fichdespa.fdes_origen = '10' OR
                         dbo.fichdespa.fdes_origen = '20')

GO

GO

GO
CREATE VIEW [dbo].[Fact_DIFF_DIAS]
AS
SELECT        dbo.detarece.drec_rutcli, dbo.detarece.drec_codi, dbo.detarece.drec_fecrec, dbo.detadespa.ddes_fecha, DATEDIFF(day, CONVERT(datetime, 
                         dbo.detarece.drec_fecrec, 120), CONVERT(datetime, dbo.detadespa.ddes_fecha, 120)) AS difere, dbo.detadespa.ddes_contcli AS cont_codi, 
                         dbo.fichrece.frec_rutcond
FROM            dbo.detarece INNER JOIN
                         dbo.detadespa ON dbo.detarece.drec_codi = dbo.detadespa.ddes_codrece INNER JOIN
                         dbo.fichdespa ON dbo.detadespa.ddes_codpred = dbo.fichdespa.fdes_codpred INNER JOIN
                         dbo.fichrece ON dbo.detarece.frec_codi1 = dbo.fichrece.frec_codi
WHERE        (dbo.fichdespa.fdes_origen = N'10') AND (dbo.fichrece.frec_rutcond <> N'000000035') AND (dbo.detarece.drec_RecepTunel = 1)

GO

GO

GO
CREATE VIEW [dbo].[GVW_CAJASREPETIDAS]
AS
SELECT  Caj_cod as caja  FROM DetaReceCajas WHERE Caj_fecha>'30-10-2014 12:45:07.370' GROUP BY Caj_cod HAVING COUNT(*)>1
GO

GO

GO
CREATE VIEW [dbo].[GvwContFinalDetalle]
AS
SELECT detacont.*, mae_descr, drec_sopocli, drec_fecrec, drec_unidades, drec_peso, 
CASE  
WHEN dcon_este=0 THEN 'NO'
WHEN dcon_este=1 THEN 'SI'
END AS Etiquetado,
CASE  
WHEN dcon_estr=0 THEN 'NO'
WHEN dcon_estr=1 THEN 'SI'
END AS Revision,
CASE  
WHEN (SELECT isnull(racd_estado,0) FROM rackdeta WHERE racd_codi=dcon_folio)= 5 THEN 'SI'
ELSE 'NO'
END AS Bloqueado,
CASE  
WHEN (SELECT COUNT(racd_estado) FROM rackdeta WHERE racd_codi=dcon_folio)= 0 THEN 'NO'
ELSE 'SI'
END AS Vigente
FROM detacont INNER JOIN detarece ON drec_codi=dcon_folio INNER JOIN maeprod ON mae_codi=drec_codpro
GO

GO

GO
CREATE VIEW [dbo].[GvwDetalleVas] as
SELECT   *
FROM         dbo.FacVas INNER JOIN
                      dbo.FacVasDeta ON dbo.FacVas.Vas_cod = dbo.FacVasDeta.Dvas_VasCod LEFT OUTER JOIN
                      dbo.ContratosDetalle ON dbo.ContratosDetalle.Dcon_ServCod = dbo.FacVasDeta.Dvas_ServCod AND 
                      dbo.ContratosDetalle.Dcon_Codigo = dbo.FacVas.Vas_Cont INNER JOIN
                      dbo.monedas ON dbo.monedas.mon_codi = dbo.ContratosDetalle.Dcon_Moneda INNER JOIN
                      dbo.medidas ON dbo.medidas.med_codi = dbo.ContratosDetalle.Dcon_Medida INNER JOIN
                      dbo.FacServicios ON dbo.ContratosDetalle.Dcon_ServCod = dbo.FacServicios.Serv_Cod
GO

GO

GO
CREATE VIEW [dbo].[GvwFactEncab]
AS
SELECT Vas_fecha AS Fecha, vas_cont as Cont, Vas_Clirut AS Cliente , Dvas_ServCod AS SCod, 
Dvas_Unid AS Unid, Dvas_Cajas AS Caj, Dvas_Kilos AS Kil, Dvas_ValUni, Dvas_ValTot, Vas_seccion,
(SELECT Dcon_Valor FROM ContratosDetalle WHERE Dcon_Codigo=vas_cont AND Dcon_ServCod=Dvas_ServCod) AS tarifa
FROM FacVas 
INNER JOIN FacVasDeta ON Dvas_VasCod=Vas_cod 
INNER JOIN FacServicios ON Serv_Cod=Dvas_ServCod 
GO

GO

GO
CREATE VIEW [dbo].[GvwFactINOUT]
as
SELECT     frec_codi CODIGO, frec_contcli CONTRATO, frec_fecrec AS FECHA, SUM(frec_totsopo) SOPO, SUM(frec_totunidad) UNI, SUM(frec_totpeso) PES, 
                      CASE WHEN frec_origen = '90' THEN 0 ELSE SUM(frec_totsopo) END SOPO_SC, CASE WHEN frec_origen = '90' THEN 0 ELSE SUM(frec_totunidad) END UNI_SC, 
                      CASE WHEN frec_origen = '90' THEN 0 ELSE SUM(frec_totpeso) END PES_SC, CASE WHEN frec_RecepTunel = '1' THEN 0 ELSE SUM(frec_totsopo) END SOPO_TUN, 
                      CASE WHEN frec_RecepTunel = '1' THEN 0 ELSE SUM(frec_totunidad) END UNI_TUN, CASE WHEN frec_RecepTunel = '1' THEN 0 ELSE SUM(frec_totpeso) 
                      END PES_TUN, '003' AS TIPO, frec_tipdesc AS CAR_DESC, frec_origen as ORIGEN
FROM         fichrece
GROUP BY frec_codi, frec_origen, frec_fecrec, frec_contcli, frec_tipdesc, frec_RecepTunel, frec_origen
UNION ALL
SELECT     fdes_codi CODIGO, ddes_contcli CONTRATO, fdes_fecha, COUNT(*) SOPO, SUM(ddes_unidades) UNI, SUM(ddes_peso) PES, 
                      CASE WHEN fdes_origen = '90' THEN 0 ELSE SUM(ddes_pallet) END SOPO_SC, CASE WHEN fdes_origen = '90' THEN 0 ELSE SUM(ddes_unidades) END UNI_SC, 
                      CASE WHEN fdes_origen = '90' THEN 0 ELSE SUM(ddes_peso) END PES_SC, 0, 0, 0, '002' AS TIPO, fdes_tipcarga, fdes_origen
FROM         fichdespa INNER JOIN
                      detadespa ON LEFT(ddes_codi, 7) = fdes_codi
GROUP BY fdes_codi, ddes_contcli, fdes_origen, fdes_fecha, fdes_tipcarga, fdes_origen


GO

GO

GO
CREATE VIEW [dbo].[GvwSeleccionCajas] AS
SELECT dpc_numpal numpal, dpc_codped npedido, COUNT (DISTINCT scaj_codcaja)AS cant 
FROM detapedcaja LEFT JOIN TMP_SELECCIONCAJAS ON dpc_codcaja=scaj_codcaja 
GROUP BY dpc_numpal, dpc_codped

GO

GO

GO
CREATE VIEW [dbo].[GvwTrazProd]
AS
SELECT drec_codpro producto, ori_descr origen, drec_fecrec fecha, COUNT(*)UNIE, SUM(drec_unidades)ENVE, SUM(drec_peso)KGE,0 UNIS,0 ENVS,0 KGS, 'EN' TIPO 
FROM detarece INNER JOIN fichrece fr ON LEFT(drec_codi,7)=fr.frec_codi INNER JOIN origen ON ori_codi=frec_origen GROUP BY drec_codpro, drec_fecrec, ori_descr
UNION ALL
SELECT ddes_codpro, ori_descr, ddes_fecha,0,0,0, SUM(ddes_pallet), SUM(ddes_unidades), SUM(ddes_peso) , 'SA' TIPO 
FROM detadespa INNER JOIN fichdespa on LEFT(ddes_codi,7)=fdes_codi INNER JOIN origen on ori_codi=fdes_origen 
GROUP BY ddes_codpro, ddes_fecha, ori_descr

GO

GO

GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETADESPA_EGRESO_contratos]
AS
SELECT     LEFT(dbo.detadespa.ddes_codi, 7) AS cod, dbo.detadespa.ddes_fecha AS fecha, dbo.maeprod.mae_codi AS codigo, dbo.maeprod.mae_clirut AS rut, 
                      dbo.maeprod.mae_tipenv AS tipoenv, SUM(dbo.detadespa.ddes_unidades) AS unidades_b, SUM(dbo.detadespa.ddes_peso) AS peso_b, 
                      SUM(dbo.detadespa.ddes_pallet) AS pallet_b, dbo.detadespa.ddes_contcli AS contrato
FROM         dbo.detadespa INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.detadespa.ddes_codvig = 0)
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_codi, dbo.detadespa.ddes_fecha, dbo.maeprod.mae_tipenv, LEFT(dbo.detadespa.ddes_codi, 7), 
                      dbo.detadespa.ddes_contcli

GO

GO

GO
CREATE VIEW [dbo].[INF_DIA_PROD_DETARECE_INGRESO_contratos]
AS
SELECT     LEFT(dbo.detarece.drec_codi, 7) AS cod, dbo.detarece.drec_fecrec AS fecha, dbo.maeprod.mae_codi AS codigo, dbo.maeprod.mae_clirut AS rut, 
                      dbo.maeprod.mae_tipenv AS tipoenv, SUM(dbo.detarece.drec_unidades) AS unidades_a, SUM(dbo.detarece.drec_peso) AS peso_a, 
                      SUM(dbo.detarece.drec_pallet) AS pallet_a, dbo.detarece.drec_contcli AS contrato
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.detarece.drec_codvig = 0)
GROUP BY dbo.maeprod.mae_clirut, dbo.maeprod.mae_codi, dbo.detarece.drec_fecrec, dbo.maeprod.mae_tipenv, LEFT(dbo.detarece.drec_codi, 7), 
                      dbo.detarece.drec_contcli

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[infinv_det] as
select
racd_codpro as codigo,
racd_codi as codigo_2,
drec_rutcli as rut,
(drec_pallet)as palet ,
(racd_unidades) as unidades ,
(racd_peso) as peso ,*
from 
rackdeta, detarece 
where 
rackdeta.racd_codi = detarece.drec_codi  


GO

GO

GO
CREATE VIEW [dbo].[Pedidos_webok_Revision_liberacion]
AS
SELECT     LEFT(dbo.PedidosWebok.Ped_Numero, 23) AS ped_numero, dbo.PedidosWebok.ped_fechahora, SUM(dbo.PedidosWebok.Ped_Cantidad) AS Expr1, 
                      dbo.rackdeta.racd_solicitado, dbo.rackdeta.racd_unidades
FROM         dbo.PedidosWebok INNER JOIN
                      dbo.rackdeta ON dbo.PedidosWebok.Ped_Folio_Icestar = dbo.rackdeta.racd_codi
WHERE     (LEFT(dbo.PedidosWebok.Ped_Numero, 23) = '82557000420100518180740')
GROUP BY LEFT(dbo.PedidosWebok.Ped_Numero, 23), dbo.PedidosWebok.Ped_Folio_Icestar, dbo.PedidosWebok.ped_fechahora, dbo.rackdeta.racd_solicitado, 
                      dbo.rackdeta.racd_unidades

GO

GO

GO
CREATE VIEW [dbo].[PF_PedidosMensualClientes]
AS
SELECT     pf.Orden, dbo.clientes.cli_rut, dbo.clientes.cli_nomb, CONVERT(datetime, CONVERT(date, LEFT(pf.pedido, 4) + '-' + RIGHT(LEFT(pf.pedido, 6), 2) 
                      + '-' + RIGHT(LEFT(pf.pedido, 8), 2)) + CAST(CONVERT(time, RIGHT(LEFT(pf.pedido, 10), 2) + ':' + RIGHT(LEFT(pf.pedido, 12), 2) + ':00:000') AS DATETIME)) AS FECHA, 
                      ISNULL
                          ((SELECT     COUNT(*) AS Expr1
                              WHERE     (CONVERT(integer, DATEDIFF(MINUTE, CONVERT(datetime, CONVERT(date, LEFT(pf.pedido, 4) + '-' + RIGHT(LEFT(pf.pedido, 6), 2) 
                                                    + '-' + RIGHT(LEFT(pf.pedido, 8), 2)) + CAST(CONVERT(time, RIGHT(LEFT(pf.pedido, 10), 2) + ':' + RIGHT(LEFT(pf.pedido, 12), 2) + ':00:000') AS DATETIME)),
                                                     pf.fechaTermino) / 60) = 0)), 0) AS CERO, ISNULL
                          ((SELECT     SUM(1) AS Expr1
                              WHERE     (CONVERT(integer, DATEDIFF(MINUTE, CONVERT(datetime, CONVERT(date, LEFT(pf.pedido, 4) + '-' + RIGHT(LEFT(pf.pedido, 6), 2) 
                                                    + '-' + RIGHT(LEFT(pf.pedido, 8), 2)) + CAST(CONVERT(time, RIGHT(LEFT(pf.pedido, 10), 2) + ':' + RIGHT(LEFT(pf.pedido, 12), 2) + ':00:000') AS DATETIME)),
                                                     pf.fechaTermino) / 60) = 1)), 0) AS MASUNO, ISNULL
                          ((SELECT     SUM(1) AS Expr1
                              WHERE     (CONVERT(integer, DATEDIFF(MINUTE, CONVERT(datetime, CONVERT(date, LEFT(pf.pedido, 4) + '-' + RIGHT(LEFT(pf.pedido, 6), 2) 
                                                    + '-' + RIGHT(LEFT(pf.pedido, 8), 2)) + CAST(CONVERT(time, RIGHT(LEFT(pf.pedido, 10), 2) + ':' + RIGHT(LEFT(pf.pedido, 12), 2) + ':00:000') AS DATETIME)),
                                                     pf.fechaTermino) / 60) = 2)), 0) AS MASDOS, ISNULL
                          ((SELECT     SUM(1) AS Expr1
                              WHERE     (CONVERT(integer, DATEDIFF(MINUTE, CONVERT(datetime, CONVERT(date, LEFT(pf.pedido, 4) + '-' + RIGHT(LEFT(pf.pedido, 6), 2) 
                                                    + '-' + RIGHT(LEFT(pf.pedido, 8), 2)) + CAST(CONVERT(time, RIGHT(LEFT(pf.pedido, 10), 2) + ':' + RIGHT(LEFT(pf.pedido, 12), 2) + ':00:000') AS DATETIME)),
                                                     pf.fechaTermino) / 60) = 3)), 0) AS MASTRES
FROM         dbo.Pedidos_ficha AS pf INNER JOIN
                      dbo.Pedidos_detalle AS pd ON pf.pedido = pd.pedido INNER JOIN
                      dbo.clientes ON RIGHT(pf.pedido, 9) = dbo.clientes.cli_rut
WHERE     (pf.fecha >= CONVERT(date, DATEADD(day, - 30, GETDATE()))) AND (pf.fecha <= CONVERT(date, GETDATE())) AND (pf.Orden > 170) AND (pf.cliente <> '116095327')
GROUP BY dbo.clientes.cli_nomb, pf.pedido, pf.fechaTermino, dbo.clientes.cli_rut, pf.Orden

GO

GO

GO
CREATE VIEW [dbo].[PROCESO_BOLSA_SALDO]
AS
SELECT        dbo.detarecbolsa.pallet, SUM(dbo.detarecbolsa.kilosbol) AS KILOS, COUNT(dbo.detarecbolsa.codbolsa) AS BOLSAS, dbo.clientes.cli_nomb AS CLIENTE, 
                         dbo.detarece.drec_fecprod AS ELA, dbo.detarece.FechaVencimiento AS VEN
FROM            dbo.detarecbolsa INNER JOIN
                         dbo.fichrece ON dbo.detarecbolsa.codrece = dbo.fichrece.frec_codi INNER JOIN
                         dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.detarece ON dbo.detarecbolsa.pallet = dbo.detarece.drec_codi
GROUP BY dbo.detarecbolsa.pallet, dbo.clientes.cli_nomb, dbo.detarece.drec_fecprod, dbo.detarece.FechaVencimiento

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE VIEW [dbo].[ProductosPorCliente] as
SELECT clientes.cli_rut as [Rut Cliente], clientes.cli_nomb as [Nombre Cliente],  
	maeprod.mae_codi as [Codigo Producto], maeprod.mae_descr as [Nombre Producto] 
FROM maeprod inner join clientes on clientes.cli_rut=maeprod.mae_clirut
/*ORDER BY clientes.cli_nomb*/

GO

GO

GO
CREATE VIEW [dbo].[Q]
AS
SELECT     LEFT(dbo.movpallet.mov_folio, 7) AS RECEPCION, dbo.movpallet.mov_ba AS TUNEL, dbo.movpallet.mov_fecha AS FECHA, 
                      COUNT(dbo.movpallet.mov_folio) AS pallet
FROM         dbo.movpallet INNER JOIN
                      dbo.detarece ON dbo.movpallet.mov_folio = dbo.detarece.drec_codi INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE     (dbo.movpallet.mov_RecepTunel = 8) AND (dbo.movpallet.mov_fecha + ' ' + dbo.movpallet.mov_hora >= '2010/02/12 00:01') AND 
                      (dbo.movpallet.mov_fecha + ' ' + dbo.movpallet.mov_hora <= '2010/02/12 23:59') AND (dbo.movpallet.mov_ca = '99')
GROUP BY LEFT(dbo.movpallet.mov_folio, 7), dbo.movpallet.mov_ba, dbo.movpallet.mov_fecha

GO

GO

GO
CREATE VIEW [dbo].[qry_alumnos]
AS
SELECT     dbo.Alumnos.*, dbo.AlumnosNotas.Nota1 AS nota1, dbo.AlumnosNotas.Nota2 AS nota2, dbo.AlumnosNotas.Nota3 AS nota3
FROM         dbo.Alumnos INNER JOIN
                      dbo.AlumnosNotas ON dbo.Alumnos.Rut = dbo.AlumnosNotas.Rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_Bins]
AS
SELECT     TOP 100 PERCENT COUNT(dbo.clientes.cli_rut) AS Expr1, dbo.clientes.cli_nomb, dbo.clientes.cli_rut
FROM         dbo.tipoenv RIGHT OUTER JOIN
                      dbo.detarece LEFT OUTER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut ON dbo.tipoenv.tenv_codi = dbo.maeprod.mae_tipenv
GROUP BY dbo.clientes.cli_nomb, dbo.detarece.drec_codi, dbo.maeprod.mae_codi, dbo.tipoenv.tenv_descr, dbo.detarece.drec_almacen, 
                      dbo.clientes.cli_rut
HAVING      (LEFT(dbo.tipoenv.tenv_descr, 4) = N'BINS') AND (dbo.detarece.drec_almacen <> 1)
ORDER BY dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[QRY_CAJAS_DANADAS]
AS
SELECT     TOP 100 PERCENT dbo.CAJAS_DANADAS.*, dbo.detarece.drec_rutcli AS CDAN_RUTCLI, dbo.clientes.cli_nomb AS cdan_nomcli
FROM         dbo.CAJAS_DANADAS INNER JOIN
                      dbo.detarece ON dbo.CAJAS_DANADAS.CDAN_PALLET = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
ORDER BY dbo.detarece.drec_rutcli, dbo.CAJAS_DANADAS.CDAN_PALLET

GO

GO

GO
CREATE VIEW [dbo].[QRY_CAJAS_DAADAS]
AS
SELECT     dbo.fichrece.frec_rutcli AS rut, dbo.clientes.cli_nomb AS cliente, dbo.CAJAS_DANADAS.CDAN_PALLET AS pallet, dbo.CAJAS_DANADAS.CDAN_FECHA AS fecha, 
                      dbo.CAJAS_DANADAS.CDAN_ESTADO AS estado, dbo.CAJAS_DANADAS.CDAN_CAJAS AS cajas
FROM         dbo.detarece INNER JOIN
                      dbo.fichrece ON dbo.detarece.frec_codi = dbo.fichrece.frec_codi INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.CAJAS_DANADAS ON dbo.detarece.drec_codi = dbo.CAJAS_DANADAS.CDAN_PALLET

GO

GO

GO
CREATE VIEW [dbo].[qry_Cajaspackinglist]
AS
SELECT     TOP 100 PERCENT Pack_rutcli + LEFT(Pack_Numero, 7) AS packing, COUNT(Pack_Numero) AS cajas
FROM         dbo.Packing_List
GROUP BY Pack_rutcli + LEFT(Pack_Numero, 7)
ORDER BY Pack_rutcli + LEFT(Pack_Numero, 7) DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_cajastrackeadas_dun14_ARIZTIA]
AS
SELECT     dbo.maeprod.mae_descr, dbo.maeprod.mae_codcli, SUBSTRING(dbo.TRACKEOCAJAS.TRACK_CODCAJA, LEN(dbo.TRACKEOCAJAS.TRACK_CODCAJA) 
                      - 6, LEN(dbo.TRACKEOCAJAS.TRACK_CODCAJA)) AS cajacliente, LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) AS pallet, 
                      dbo.TRACKEOCAJAS.TRACK_PREDESPACHO, dbo.TRACKEOCAJAS.TRACK_CAJA
FROM         dbo.maeprod INNER JOIN
                      dbo.TRACKEOCAJAS ON dbo.maeprod.mae_dun14 = SUBSTRING(dbo.TRACKEOCAJAS.TRACK_CODCAJA, 3, LEN(dbo.maeprod.mae_dun14))
WHERE     (dbo.TRACKEOCAJAS.TRACK_PREDESPACHO = '01015201008111117068') AND (dbo.maeprod.mae_codvig = 0) AND 
                      (dbo.maeprod.mae_clirut = '825570004') AND (dbo.maeprod.mae_estado = 0)

GO

GO

GO
CREATE VIEW [dbo].[qry_choferes]
AS
SELECT     dbo.choferes.cho_rut, dbo.choferes.cho_nombre, dbo.choferes.cho_rutclie AS cho_rutcliente, dbo.clientes.cli_nomb AS cho_nombrecliente, 
                      dbo.choferes.cho_patente, dbo.choferes.cho_patente2, dbo.choferes.cho_rutempresa AS cho_rutempresa, 
                      dbo.choferes.cho_empresa AS cho_nombreempresa, dbo.Transportes.tra_fantasia AS cho_FantasiaEmpresa
FROM         dbo.choferes INNER JOIN
                      dbo.clientes ON dbo.choferes.cho_rutclie = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.Transportes ON dbo.choferes.cho_rutempresa = dbo.Transportes.tra_rut

GO

GO

GO
CREATE VIEW [dbo].[QRY_CLIENTES]
AS
SELECT     dbo.clientes.*, LEFT(cli_rut, 8) AS CODAUX
FROM         dbo.clientes
WHERE     (cli_estado <> 'N')

GO

GO

GO
CREATE VIEW [dbo].[qry_clientes_contratos_servicios_activos]
AS
SELECT     TOP 100 PERCENT dbo.contrato.cont_rutclie, dbo.clientes.cli_nomb, dbo.contrato.cont_codi, dbo.contrato.cont_descr, dbo.contrpara.cpar_servi, 
                      dbo.servicios.ser_descr, dbo.contrpara.cpar_marca, dbo.contrato.cont_estado
FROM         dbo.clientes INNER JOIN
                      dbo.contrato INNER JOIN
                      dbo.contrpara ON dbo.contrato.cont_codi = dbo.contrpara.cpar_contr INNER JOIN
                      dbo.servicios ON dbo.contrpara.cpar_servi = dbo.servicios.ser_codi ON dbo.clientes.cli_rut = dbo.contrato.cont_rutclie
WHERE     (dbo.contrpara.cpar_marca = 1) AND (dbo.clientes.cli_estado = 'A') AND (dbo.contrato.cont_estado = 0)
ORDER BY dbo.clientes.cli_nomb, dbo.contrato.cont_codi, dbo.contrpara.cpar_servi

GO

GO

GO
CREATE VIEW [dbo].[qry_contrato_clientes]
AS
SELECT     TOP 100 PERCENT dbo.contrato.cont_rutclie, dbo.contrato.cont_rutpro, dbo.contrato.cont_codi, dbo.contrato.cont_descr, dbo.contrato.cont_feccont, 
                      dbo.contrato.cont_fecexpi, dbo.contrato.cont_fecproc, dbo.contrato.cont_diafact, dbo.contrato.cont_tempcon, dbo.contrato.cont_tempgra, 
                      dbo.contrato.cont_contrel, dbo.contrato.cont_diacont, dbo.contrato.cont_diagracia, dbo.contrato.cont_tipo, dbo.contrato.cont_pallet, 
                      dbo.contrato.cont_cc, dbo.contrato.cont_tunelG, dbo.contrato.cont_estado
FROM         dbo.clientes INNER JOIN
                      dbo.contrato ON dbo.clientes.cli_rut = dbo.contrato.cont_rutclie
WHERE     (dbo.clientes.cli_estado = 'A') AND (dbo.contrato.cont_estado = '0')
ORDER BY dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[QRY_CONTRATOS_SERVICIOS]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.contrato.cont_codi, dbo.contrato.cont_descr, dbo.contrpara.cpar_servi, 
                      dbo.servicios.ser_descr, dbo.contrpara.cpar_valor, dbo.contrpara.cpar_moneda, dbo.contrpara.cpar_medida, dbo.contrpara.cpar_codvig, 
                      dbo.contrpara.cpar_marca
FROM         dbo.contrato INNER JOIN
                      dbo.clientes ON dbo.contrato.cont_rutclie = dbo.clientes.cli_rut INNER JOIN
                      dbo.contrpara ON dbo.contrato.cont_codi = dbo.contrpara.cpar_contr INNER JOIN
                      dbo.servicios ON dbo.contrpara.cpar_servi = dbo.servicios.ser_codi
WHERE     (dbo.clientes.cli_estado = 'A') AND (dbo.contrpara.cpar_marca = 1) AND (dbo.contrato.cont_estado = '0')
ORDER BY dbo.clientes.cli_nomb, dbo.contrato.cont_codi, dbo.contrpara.cpar_servi

GO

GO

GO
CREATE VIEW [dbo].[QRY_demora_despacho]
AS
SELECT     dbo.clientes.cli_nomb, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_hora, dbo.fichpred.fpre_codi, dbo.fichpred.fpre_fecdes, 
                      dbo.fichpred.fpre_horater
FROM         dbo.fichdespa LEFT OUTER JOIN
                      dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.fichpred ON dbo.fichdespa.fdes_codi = dbo.fichpred.fpre_gdespa

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_despacho_2_cuerpo]
AS
SELECT     dbo.detadespa.ddes_rutcli AS RUTCLIEN, LEFT(dbo.detadespa.ddes_codi, 7) AS GUIAEGRE, dbo.maeprod.mae_descr AS DESCVARI, 
                      dbo.tipoenv.tenv_descr AS DESCENVA, dbo.maeprod.mae_codi AS CODIVARI, dbo.detadespa.ddes_sopocli AS sopoclie, 
                      SUM(dbo.detadespa.ddes_pallet) AS TOTASOPO, SUM(dbo.detadespa.ddes_unidades) AS TOTAENVA, SUM(dbo.detadespa.ddes_peso) 
                      AS TOTAPESO
FROM         dbo.maeprod LEFT OUTER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detadespa ON dbo.maeprod.mae_codi = dbo.detadespa.ddes_codpro LEFT OUTER JOIN
                      dbo.tiposopo ON dbo.detadespa.ddes_codsopo = dbo.tiposopo.tsop_codi
GROUP BY dbo.detadespa.ddes_rutcli, LEFT(dbo.detadespa.ddes_codi, 7), dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.maeprod.mae_codi, 
                      dbo.detadespa.ddes_sopocli


GO

GO

GO
CREATE VIEW [dbo].[QRY_DESPACHO_CORREO]
AS
SELECT     dbo.fichdespa.*, dbo.clientes.cli_nomb AS cliente, dbo.clientes.cli_comuna AS comuna, dbo.ciudad.ciu_descr AS ciudad, 
                      dbo.origen.ori_descr AS origen, dbo.origen.ori_codi AS codorigen, dbo.clientes.cli_direcc AS DIRECCION, dbo.choferes.cho_nombre AS CHOFER, 
                      dbo.clientes.cli_mail AS MAIL1, dbo.clientes.Mail2 AS MAIL2
FROM         dbo.fichdespa INNER JOIN
                      dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.ciudad ON dbo.clientes.cli_ciudad = dbo.ciudad.ciu_codi INNER JOIN
                      dbo.origen ON dbo.fichdespa.fdes_origen = dbo.origen.ori_codi INNER JOIN
                      dbo.choferes ON dbo.fichdespa.fdes_rutcond = dbo.choferes.cho_rut

GO

GO

GO
CREATE VIEW [dbo].[QRY_DESPACHO_CORREO_DETALLE]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.detadespa.ddes_codi, 7) AS GUIADESPACHO, dbo.detadespa.ddes_codrece AS PALLET, 
                      dbo.detadespa.ddes_sopocli AS SOPOCLI, dbo.maeprod.mae_descr AS PRODUCTO, dbo.detadespa.ddes_fecprod AS FECPROD, 
                      dbo.tipoenv.tenv_descr AS ENVASE, dbo.detadespa.ddes_unidades AS UNIDADES, dbo.detadespa.ddes_peso AS PESO, 
                      dbo.detarece.drec_codsag AS SAG
FROM         dbo.detadespa INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
ORDER BY dbo.detadespa.ddes_codrece, dbo.detadespa.ddes_sopocli

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_despacho2]
AS
SELECT     dbo.clientes.cli_nomb AS NOMCLIEN, dbo.clientes.cli_rut AS RUTCLIEN, dbo.fichrece.frec_fecrec AS FECHRECE, 
                      dbo.fichrece.frec_horarec AS HORARECE, dbo.fichrece.frec_codi AS GUIARECE, dbo.fichrece.frec_guiades AS GUIADESP, 
                      dbo.origen.ori_descr AS descorde, dbo.nomiper.nper_nomb AS nombpers, dbo.fichrece.frec_horater AS horaterm, dbo.fichrece.frec_tipdesc, 
                      dbo.fichrece.frec_temppro, dbo.fichrece.frec_turnrec, dbo.choferes.cho_nombre AS NOMBCOND, dbo.choferes.cho_patente AS numpaten, 
                      dbo.choferes.cho_empresa AS emptrans, dbo.choferes.cho_rut AS rutcondu, dbo.fichrece.frec_totsopo AS TOTASOPO, 
                      dbo.fichrece.frec_totunidad AS TOTAENVA, dbo.fichrece.frec_totpeso AS TOTAPESO, dbo.fichrece.frec_observ AS observac
FROM         dbo.fichrece LEFT OUTER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.origen ON dbo.fichrece.frec_origen = dbo.origen.ori_codi LEFT OUTER JOIN
                      dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut LEFT OUTER JOIN
                      dbo.nomiper ON dbo.fichrece.frec_codienca = dbo.nomiper.nper_codi


GO

GO

GO
CREATE VIEW [dbo].[qry_despachodonihue]
AS
SELECT     TOP 100 PERCENT LEFT(ddes_codi, 7) AS despacho
FROM         dbo.detadespa
WHERE     (ddes_contcli = '0002404')
GROUP BY LEFT(ddes_codi, 7)
ORDER BY LEFT(ddes_codi, 7)

GO

GO

GO
CREATE VIEW [dbo].[qry_Despachos_de_clientes]
AS
SELECT     dbo.fichdespa.fdes_codi, dbo.clientes.cli_nomb, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_GuiaCliente, LEFT(dbo.detadespa.ddes_codrece, 7) 
                      AS recepcion, dbo.fichrece.frec_totsopo, dbo.fichrece.frec_guiades
FROM         dbo.fichdespa INNER JOIN
                      dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.detadespa ON dbo.fichdespa.fdes_codi = LEFT(dbo.detadespa.ddes_codi, 7) INNER JOIN
                      dbo.fichrece ON LEFT(dbo.detadespa.ddes_codrece, 7) = dbo.fichrece.frec_codi
WHERE     (dbo.clientes.cli_nomb LIKE '%sanco%')
GROUP BY dbo.fichdespa.fdes_codi, dbo.clientes.cli_nomb, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_GuiaCliente, LEFT(dbo.detadespa.ddes_codrece, 7), 
                      dbo.fichrece.frec_totsopo, dbo.fichrece.frec_guiades

GO

GO

GO
CREATE VIEW [dbo].[qry_detadespa_detalle_cajas]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.detadespa.ddes_codi, 7) AS despacho, dbo.detarece.drec_codpro, dbo.DetareceCajas.drec_codcaja, 
                      dbo.DetareceCajas.drec_codi, dbo.DetareceCajas.drec_peso, dbo.DetareceCajas.drec_unidades, dbo.DetareceCajas.drec_fecprod, 
                      dbo.maeprod.mae_descr, dbo.DetareceCajas.Caja, dbo.maeprod.mae_diasv, dbo.detarece.drec_rutcli
FROM         dbo.detadespa INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi AND dbo.detadespa.ddes_unidades = dbo.detarece.drec_unidades INNER JOIN
                      dbo.DetareceCajas ON dbo.detarece.drec_codi = LEFT(dbo.DetareceCajas.drec_codi, 9) INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
ORDER BY dbo.detadespa.ddes_codi, dbo.DetareceCajas.drec_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_DETADESPA_IGUAL_DETARECE]
AS
SELECT     TOP 100 PERCENT ddes_codrece, SUM(ddes_unidades) AS Unidades, SUM(ddes_peso) AS Peso, SUM(ddes_pallet) AS pallet, ddes_rutcli, 
                      ddes_contcli
FROM         dbo.detadespa
WHERE     (ddes_codvig = 0)
GROUP BY ddes_codrece, ddes_rutcli, ddes_contcli
ORDER BY ddes_contcli DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_detadespa_unidades_despachadas]
AS
SELECT     ddes_codrece, SUM(ddes_unidades) AS Unidades, SUM(ddes_pallet) AS pallet
FROM         dbo.detadespa
WHERE     (ddes_codvig = 0)
GROUP BY ddes_codrece, ddes_pallet

GO

GO

GO
CREATE VIEW [dbo].[Qry_DetaDespaServicio24]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codi AS Codigo, ISNULL(dbo.detarece.drec_RecepTunel, 0) AS RecepTunel, 
                      dbo.detadespa.ddes_fecha AS Fecha, dbo.detadespa.ddes_unidades AS Unidades, dbo.detadespa.ddes_peso AS Peso, 
                      dbo.detadespa.ddes_pallet AS Pallet, dbo.detadespa.ddes_rutcli AS Rut, dbo.detadespa.ddes_contcli AS Contrato, dbo.detadespa.ddes_codi, 
                      dbo.detadespa.ddes_codvig AS Vigente, ISNULL(dbo.detarece.drec_RecepTunel, 0) AS TipoRecepcion
FROM         dbo.detadespa LEFT OUTER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
ORDER BY dbo.detarece.drec_codi

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_detalle_1_desp]
AS
SELECT     dbo.maeprod.mae_descr AS descvari, dbo.tipoenv.tenv_descr AS descenva, SUM(dbo.detadespa.ddes_pallet) AS totasopo, 
                      SUM(dbo.detadespa.ddes_unidades) AS totaenva, SUM(dbo.detadespa.ddes_peso) AS totapeso, LEFT(dbo.detadespa.ddes_codi, 7) AS codicorto, 
                      dbo.maeprod.mae_codi AS codivari
FROM         dbo.detadespa LEFT OUTER JOIN
                      dbo.maeprod LEFT OUTER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi
GROUP BY dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, LEFT(dbo.detadespa.ddes_codi, 7), dbo.maeprod.mae_codi


GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_detalle_1_rece]
AS
SELECT     dbo.maeprod.mae_descr AS descvari, dbo.tipoenv.tenv_descr AS descenva, SUM(dbo.detarece.drec_pallet) AS totasopo, 
                      SUM(dbo.detarece.drec_unidades) AS totaenva, SUM(dbo.detarece.drec_peso) AS totapeso, LEFT(dbo.detarece.drec_codi, 7) AS codicorto, 
                      dbo.maeprod.mae_codi AS codivari, dbo.detarece.drec_codsopo AS codisopo
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
GROUP BY dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, LEFT(dbo.detarece.drec_codi, 7), dbo.maeprod.mae_codi, dbo.detarece.drec_codsopo, 
                      LEFT(dbo.detarece.drec_codi, 7)


GO

GO

GO
CREATE VIEW [dbo].[QRY_DETALLE_GUIADESPACHO]
AS
SELECT     LEFT(dbo.detadespa.ddes_codi, 7) AS guiadespacho, dbo.detadespa.ddes_codpro, SUM(dbo.detadespa.ddes_unidades) AS unidades, 
                      SUM(dbo.detadespa.ddes_peso) AS peso, COUNT(dbo.detadespa.ddes_pallet) AS pallet, dbo.maeprod.mae_descr AS DESCRIPCION, 
                      dbo.detadespa.ddes_rutcli
FROM         dbo.detadespa INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi
GROUP BY LEFT(dbo.detadespa.ddes_codi, 7), dbo.detadespa.ddes_codpro, dbo.maeprod.mae_descr, dbo.detadespa.ddes_rutcli

GO

GO

GO
CREATE VIEW [dbo].[qry_detarececajas_detalle]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codpro, dbo.maeprod.mae_descr, dbo.DetareceCajas.drec_codi, dbo.DetareceCajas.drec_codcaja, 
                      dbo.DetareceCajas.drec_unidades, dbo.DetareceCajas.drec_peso, dbo.DetareceCajas.Caja, dbo.DetareceCajas.drec_fecprod, 
                      dbo.maeprod.mae_diasv, dbo.detarece.drec_rutcli, dbo.detarece.drec_fecrec, LEFT(dbo.detarece.drec_codi, 9) AS racd_codi
FROM         dbo.maeprod INNER JOIN
                      dbo.detarece ON dbo.maeprod.mae_codi = dbo.detarece.drec_codpro RIGHT OUTER JOIN
                      dbo.DetareceCajas ON dbo.detarece.drec_codi = LEFT(dbo.DetareceCajas.drec_codi, 9)
ORDER BY dbo.detarece.drec_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_detarececajas_resumen_pallet]
AS
SELECT     dbo.DetareceCajas.drec_rutcli AS cliente, LEFT(dbo.DetareceCajas.drec_codi, 9) AS pallet, dbo.DetareceCajas.drec_fecrec AS fecha, 
                      COUNT(dbo.DetareceCajas.drec_codi) AS cajas, dbo.detarece.drec_contcli AS CONTRATO
FROM         dbo.DetareceCajas INNER JOIN
                      dbo.detarece ON LEFT(dbo.DetareceCajas.drec_codi, 9) = dbo.detarece.drec_codi
GROUP BY dbo.DetareceCajas.drec_rutcli, LEFT(dbo.DetareceCajas.drec_codi, 9), dbo.DetareceCajas.drec_fecrec, dbo.detarece.drec_contcli

GO

GO

GO
CREATE VIEW [dbo].[QRY_DOCUMENTOS_MES_DESPACHOS_X_FECHAS]
AS
SELECT     TOP 100 PERCENT dbo.fichdespa.fdes_codi AS despacho, dbo.fichdespa.fdes_fecha AS fecha, dbo.clientes.cli_nomb AS cliente
FROM         dbo.fichdespa INNER JOIN
                      dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.fichdespa.fdes_codvig = '0') AND (dbo.fichdespa.fdes_fecha BETWEEN '2013/02/01' AND '2013/02/28')
ORDER BY dbo.clientes.cli_nomb, dbo.fichdespa.fdes_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_DOCUMENTOS_MES_RECEPCIONES_X_FECHAS]
AS
SELECT     TOP 100 PERCENT dbo.fichrece.frec_codi, dbo.fichrece.frec_fecrec, dbo.clientes.cli_nomb
FROM         dbo.fichrece INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.fichrece.frec_codvig = '0') AND (dbo.fichrece.frec_fecrec BETWEEN '2013/02/01' AND '2013/02/28')
ORDER BY dbo.clientes.cli_nomb, dbo.fichrece.frec_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_ESTADO_CLIENTES_BLOQ_RECEPCIONES_DESPACHOS]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_nomb AS CLIENTE, dbo.contrato.cont_codi + ' ' + dbo.contrato.cont_descr AS CONTRATO, 
                      dbo.contrato.CONT_RECEPCIONES AS RECEPCIONES, dbo.contrato.CONT_DESPACHOS AS DESPACHOS
FROM         dbo.contrato INNER JOIN
                      dbo.clientes ON dbo.contrato.cont_rutclie = dbo.clientes.cli_rut
WHERE     (dbo.contrato.CONT_RECEPCIONES = 1) AND (dbo.clientes.cli_estado = 'A') OR
                      (dbo.contrato.CONT_DESPACHOS = 1)

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion]
AS
SELECT     dbo.contrato_hist.cont_unica_hist, dbo.contrato_hist.cont_rutclie_hist, dbo.contrato_hist.cont_codi_hist, dbo.contrato_hist.cont_descr_hist, 
                      dbo.contrato_hist.cont_feccont_hist, dbo.contrato_hist.cont_fecexpi_hist, dbo.contrato_hist.cont_fecproc_hist, dbo.contrato_hist.cont_diafact_hist, 
                      dbo.contrato_hist.cont_tempcon_hist, dbo.contrato_hist.cont_tempgra_hist, dbo.contrato_hist.cont_contrel_hist, dbo.contrato_hist.cont_diacont_hist, 
                      dbo.contrato_hist.cont_diagracia_hist, dbo.contrato_hist.cont_tipo_hist, dbo.contrato_hist.cont_pallet_hist, dbo.contrato_hist.cont_fecha_hist, 
                      dbo.contrato_hist.cont_CodWeb, dbo.contrato_hist.cont_GrupFec, dbo.contrpara_hist.cpar_valor_hist, dbo.contrpara_hist.cpar_moneda_hist, 
                      dbo.servicios.ser_descr, dbo.servicios.ser_codi, dbo.monedas.mon_codi, dbo.monedas.mon_descr, dbo.contrpara_hist.cpar_servi_hist, 
                      dbo.contrpara_hist.cpar_medida_hist, dbo.medidas.med_descr
FROM         dbo.servicios INNER JOIN
                      dbo.contrpara_hist ON dbo.servicios.ser_codi COLLATE Modern_Spanish_CI_AS = dbo.contrpara_hist.cpar_servi_hist INNER JOIN
                      dbo.monedas ON dbo.contrpara_hist.cpar_moneda_hist = dbo.monedas.mon_codi COLLATE Modern_Spanish_CI_AS INNER JOIN
                      dbo.medidas ON CAST(dbo.contrpara_hist.cpar_medida_hist AS int) = CAST(dbo.medidas.med_codi AS int) INNER JOIN
                      dbo.contrato_hist ON dbo.contrpara_hist.cpar_CodWeb = dbo.contrato_hist.cont_CodWeb

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Cincuanta_Detalle]
AS
SELECT     TOP 100 PERCENT dbo.detadespa.ddes_rutcli, dbo.detadespa.ddes_contcli, dbo.detadespa.ddes_fecha, dbo.fichdespa.fdes_tipcarga, 
                      dbo.detadespa.ddes_unidades, dbo.detadespa.ddes_peso, dbo.detadespa.ddes_pallet
FROM         dbo.detadespa INNER JOIN
                      dbo.cincuenta ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.cincuenta.despacho INNER JOIN
                      dbo.fichdespa ON dbo.cincuenta.despacho = dbo.fichdespa.fdes_codi
WHERE     (dbo.cincuenta.cincuenta = 1) AND (dbo.detadespa.ddes_codvig = '0')
ORDER BY dbo.detadespa.ddes_contcli

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Cincuanta_Detalle_INF]
AS
SELECT     TOP 100 PERCENT dbo.detadespa.ddes_rutcli, dbo.detadespa.ddes_contcli AS CONTRATO, dbo.detadespa.ddes_fecha AS FECHA, 
                      dbo.fichdespa.fdes_tipcarga AS TIPOCARGA, dbo.detadespa.ddes_unidades AS UNIDAD, dbo.detadespa.ddes_peso AS PESO, 
                      dbo.detadespa.ddes_pallet AS PALLET, LEFT(dbo.detadespa.ddes_codi, 7) AS GUIADESPA, dbo.detadespa.ddes_codrece AS RECEPCION
FROM         dbo.detadespa INNER JOIN
                      dbo.cincuenta ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.cincuenta.despacho INNER JOIN
                      dbo.fichdespa ON dbo.cincuenta.despacho = dbo.fichdespa.fdes_codi
WHERE     (dbo.cincuenta.cincuenta = 1) AND (dbo.detadespa.ddes_codvig = '0')

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Descargas_Detalle]
AS
SELECT     TOP 100 PERCENT frec_rutcli, frec_contcli, frec_tipdesc, frec_fecrec, frec_guiades, frec_codi, frec_totsopo, frec_totunidad, frec_totpeso
FROM         dbo.fichrece
WHERE     (frec_origen <> '65') AND (frec_origen <> '97') AND (frec_origen <> '99') AND (frec_codvig = '0')
ORDER BY frec_rutcli, frec_contcli, frec_tipdesc, frec_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Despachos_Dia]
AS
SELECT     TOP 100 PERCENT ddes_rutcli, ddes_contcli, ddes_fecha, SUM(ddes_unidades) AS DTotUni, SUM(ddes_peso) AS DTotPes, SUM(ddes_pallet) 
                      AS DTotPal
FROM         dbo.detadespa
WHERE     (ddes_codvig = '0')
GROUP BY ddes_rutcli, ddes_contcli, ddes_fecha
ORDER BY ddes_rutcli, ddes_contcli, ddes_fecha

GO

GO

GO
CREATE VIEW [dbo].[Qry_Facturacion_Recepciones_Dia]
AS
SELECT     TOP 100 PERCENT drec_rutcli, drec_contcli, drec_fecrec, SUM(drec_unidades) AS RTotUni, SUM(drec_peso) AS RTotPes, SUM(drec_pallet) 
                      AS RTotPal
FROM         dbo.detarece
WHERE     (drec_codvig = '0')
GROUP BY drec_rutcli, drec_contcli, drec_fecrec
ORDER BY drec_rutcli, drec_contcli, drec_fecrec

GO

GO

GO
CREATE VIEW [dbo].[QRY_FECHAHORA]
AS
SELECT     CONVERT(VARCHAR(10), GETDATE(), 103) AS FECHA, CONVERT(VARCHAR(5), GETDATE(), 108) AS HORA

GO

GO

GO
CREATE VIEW [dbo].[QRY_INF_CALIDAD]
AS
SELECT     TOP 100 PERCENT dbo.INF_CALIDAD.calidad_id, dbo.INF_CALIDAD.calidad_numero, dbo.INF_CALIDAD.calidad_RUTCLI, 
                      dbo.clientes.cli_nomb AS CALIDAD_NOMCLI, dbo.INF_CALIDAD.calidad_nomarchivo, dbo.INF_CALIDAD.calidad_fecha
FROM         dbo.INF_CALIDAD INNER JOIN
                      dbo.clientes ON dbo.INF_CALIDAD.calidad_RUTCLI = dbo.clientes.cli_rut
ORDER BY dbo.INF_CALIDAD.calidad_numero

GO

GO

GO
CREATE VIEW [dbo].[QRY_INF_PNC]
AS
SELECT     TOP 100 PERCENT dbo.INF_PNC.pnc_id, dbo.INF_PNC.pnc_numero, dbo.INF_PNC.pnc_rutcli, dbo.clientes.cli_nomb AS PNC_NOMCLI, 
                      dbo.INF_PNC.pnc_nomarchivo, dbo.INF_PNC.pnc_fecha
FROM         dbo.INF_PNC INNER JOIN
                      dbo.clientes ON dbo.INF_PNC.pnc_rutcli = dbo.clientes.cli_rut
ORDER BY dbo.INF_PNC.pnc_numero

GO

GO

GO
CREATE VIEW [dbo].[Qry_INF_Reclamos]
AS
SELECT     dbo.Reclamo_Clientes_Detalle.rec_numero, dbo.Reclamo_Clientes_Detalle.rec_rutcli, dbo.clientes.cli_nomb, 
                      dbo.Reclamo_Clientes_Detalle.rec_fecha, dbo.Reclamo_Clientes_Detalle.rec_genrec, dbo.Reclamo_Clientes_Detalle.rec_reclamo, 
                      dbo.Reclamo_Clientes_Detalle.rec_direccion, dbo.Reclamo_Clientes_Detalle.rec_ciudad, dbo.Reclamo_Clientes_Detalle.rec_telefono, 
                      dbo.Reclamo_Clientes_Detalle.rec_email, dbo.Reclamo_Clientes_Detalle.rec_producto, dbo.Reclamo_Clientes_Detalle.rec_elaboracion, 
                      dbo.Reclamo_Clientes_Detalle.REC_ESTADO, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.Reclamo_Clientes_Detalle.rec_fecha, 
                      105)), 111) AS FechaB
FROM         dbo.Reclamo_Clientes_Detalle INNER JOIN
                      dbo.clientes ON dbo.Reclamo_Clientes_Detalle.rec_rutcli = dbo.clientes.cli_rut

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_ingreso_detalle]
AS
SELECT     dbo.maeprod.mae_descr AS descvari, dbo.tipoenv.tenv_descr AS descenva, dbo.detarece.drec_pallet AS totasopo, 
                      dbo.detarece.drec_unidades AS totaenva, dbo.detarece.drec_peso AS totapeso, dbo.detarece.drec_codi, LEFT(dbo.detarece.drec_codi, 7) AS codicorto, 
                      dbo.detarece.drec_codrel AS codivari, dbo.detarece.drec_codsopo AS codisopo
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE     (LEFT(dbo.detarece.drec_codi, 7) = 'gr')


GO

GO

GO
CREATE VIEW [dbo].[QRY_LIBERACION_PALLET_HACCP]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi, dbo.rackdeta.racd_estadopallet
FROM         dbo.PedidosWebok INNER JOIN
                      dbo.rackdeta ON dbo.PedidosWebok.Ped_Folio_Icestar = dbo.rackdeta.racd_codi
WHERE     (LEFT(dbo.PedidosWebok.Ped_Numero, 23) = '83614800220110316171757') AND (dbo.rackdeta.racd_estadopallet = '1')
ORDER BY dbo.rackdeta.racd_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_log_recepciones_modificadas]
AS
SELECT     TOP 100 PERCENT dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_fecrec, dbo.log_recepcion.log_fecha_hora, 
                      dbo.log_recepcion.log_usuario, dbo.log_recepcion.log_usergestion, dbo.log_recepcion.log_tipo, dbo.nomiper.nper_nomb, 
                      dbo.log_recepcion.log_id
FROM         dbo.fichrece INNER JOIN
                      dbo.log_recepcion ON dbo.fichrece.frec_codi = dbo.log_recepcion.log_Nrecepcion INNER JOIN
                      dbo.nomiper ON dbo.log_recepcion.log_usergestion = dbo.nomiper.nper_codi
WHERE     (dbo.fichrece.frec_rutcli = '825570004') AND (dbo.fichrece.frec_fecrec BETWEEN '2012/04/26' AND '2012/05/25') AND (dbo.log_recepcion.log_tipo = 'M')
ORDER BY dbo.log_recepcion.log_id DESC, dbo.fichrece.frec_fecrec DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_lote]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codi, dbo.detadespa.ddes_codi
FROM         dbo.detadespa INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
WHERE     (dbo.detarece.LoteCliente = '2407')
ORDER BY dbo.detarece.drec_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_maeprod_envases]
AS
SELECT     dbo.maeprod.mae_codi AS codpro, dbo.maeprod.mae_descr AS descripcion, dbo.tipoenv.tenv_descr AS envase, 
                      dbo.tipoenv.tenv_codi AS codenvase
FROM         dbo.maeprod INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_MAEPROD_SOLICITUD]
AS
SELECT     TOP 100 PERCENT dbo.MAEPROD_SOLICITUD.ID, dbo.MAEPROD_SOLICITUD.FECHA, dbo.MAEPROD_SOLICITUD.HORA, 
                      dbo.MAEPROD_SOLICITUD.CLIENTE, dbo.clientes.cli_nomb AS CLIENTE_NOMBRE, dbo.MAEPROD_SOLICITUD.FAMILIA, 
                      dbo.famprod.fam_descr AS FAMILIA_NOMBRE, dbo.MAEPROD_SOLICITUD.CODENVASE, dbo.MAEPROD_SOLICITUD.ENVASE, 
                      dbo.MAEPROD_SOLICITUD.CODPROD, dbo.MAEPROD_SOLICITUD.PRODUCTO, dbo.MAEPROD_SOLICITUD.CODCLIENTE, 
                      dbo.MAEPROD_SOLICITUD.ALTO, dbo.MAEPROD_SOLICITUD.ANCHO, dbo.MAEPROD_SOLICITUD.FONDO, dbo.MAEPROD_SOLICITUD.BASE, 
                      dbo.MAEPROD_SOLICITUD.ALTURA, dbo.MAEPROD_SOLICITUD.DUN14, dbo.MAEPROD_SOLICITUD.ESTADO, dbo.MAEPROD_SOLICITUD.USUARIO, 
                      dbo.MAEPROD_SOLICITUD.MAIL, dbo.nomiper.nper_nomb AS USUARIO_NOMBRE, dbo.MAEPROD_SOLICITUD.MAIL1
FROM         dbo.MAEPROD_SOLICITUD INNER JOIN
                      dbo.famprod ON dbo.MAEPROD_SOLICITUD.FAMILIA = LEFT(dbo.famprod.fam_codi, 3) INNER JOIN
                      dbo.clientes ON dbo.MAEPROD_SOLICITUD.CLIENTE = dbo.clientes.cli_rut INNER JOIN
                      dbo.nomiper ON dbo.MAEPROD_SOLICITUD.USUARIO = dbo.nomiper.nper_codi
ORDER BY dbo.MAEPROD_SOLICITUD.ID DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_menu_operaciones]
AS
SELECT     dbo.MENUS_OPERACIONES.NOMBRE, dbo.MENUS_OPERACIONES.FORMULARIO, dbo.MENUS_OPERACIONES.PADRE, 
                      dbo.MENUS_OPERACIONES.NUMERO, dbo.MENUS_OPERACIONES.HOJA, dbo.MENUS_OPERACIONES.GRABAR, 
                      dbo.MENUS_OPERACIONES.PANTALLA, dbo.MENUS_OPERACIONES.ARCHIVO, dbo.MENUS_OPERACIONES.IMPRIMIR, 
                      dbo.PERFIL_USUARIO.NOMBRE_PERFIL, dbo.PERFIL_USUARIO.ESTADO
FROM         dbo.MENUS_OPERACIONES INNER JOIN
                      dbo.PERFIL_USUARIO ON dbo.MENUS_OPERACIONES.FORMULARIO = dbo.PERFIL_USUARIO.FORMULARIO
WHERE     (dbo.PERFIL_USUARIO.ESTADO = 1)

GO

GO

GO
CREATE VIEW [dbo].[qry_menu_operaciones1]
AS
SELECT     dbo.MENUS_OPERACIONES1.NOMBRE, dbo.MENUS_OPERACIONES1.FORMULARIO, dbo.MENUS_OPERACIONES1.PADRE, 
                      dbo.MENUS_OPERACIONES1.NUMERO, dbo.MENUS_OPERACIONES1.HOJA, dbo.MENUS_OPERACIONES1.GRABAR, 
                      dbo.MENUS_OPERACIONES1.PANTALLA, dbo.MENUS_OPERACIONES1.ARCHIVO, dbo.MENUS_OPERACIONES1.IMPRIMIR, 
                      dbo.PERFIL_USUARIO1.NOMBRE_PERFIL, dbo.PERFIL_USUARIO1.ESTADO
FROM         dbo.MENUS_OPERACIONES1 INNER JOIN
                      dbo.PERFIL_USUARIO1 ON dbo.MENUS_OPERACIONES1.FORMULARIO = dbo.PERFIL_USUARIO1.FORMULARIO
WHERE     (dbo.PERFIL_USUARIO1.ESTADO = 1)

GO

GO

GO
CREATE VIEW [dbo].[QRY_MOVCAMION]
AS
SELECT     TOP 100 PERCENT dbo.MovimientoCamion.Fecha1 + ' ' + dbo.MovimientoCamion.Hora1 AS [Fecha Entrada], dbo.clientes.cli_nomb AS [Nombre Cliente], 
                      dbo.P_InfCPendientesMov.TipoMov AS [Tipo Movimiento], dbo.choferes.cho_nombre AS [Nombre Chofer], dbo.MovimientoCamion.Patente, 
                      { fn UCASE(dbo.MovimientoCamion.Producto) } AS Producto, dbo.MovimientoCamion.TIPOCAMION AS [Tipo Camion]
FROM         dbo.choferes INNER JOIN
                      dbo.MovimientoCamion ON dbo.choferes.cho_rut = dbo.MovimientoCamion.Chofer INNER JOIN
                      dbo.clientes ON dbo.MovimientoCamion.Cliente = dbo.clientes.cli_rut INNER JOIN
                      dbo.P_InfCPendientesMov ON dbo.MovimientoCamion.TipoMovimiento = dbo.P_InfCPendientesMov.id
WHERE     (dbo.MovimientoCamion.Accion = 1)
ORDER BY dbo.MovimientoCamion.ID

GO

GO

GO
CREATE VIEW [dbo].[qry_movdecamiones]
AS
SELECT     dbo.MovimientoCamion.ID, dbo.MovimientoCamion.Chofer, dbo.choferes.cho_nombre, dbo.MovimientoCamion.Patente, dbo.MovimientoCamion.Cliente, 
                      dbo.clientes.cli_nomb, dbo.MovimientoCamion.Accion, dbo.MovimientoCamion.Fecha1, dbo.MovimientoCamion.Hora1, dbo.MovimientoCamion.Fecha2, 
                      dbo.MovimientoCamion.Hora2, dbo.MovimientoCamion.Fecha3, dbo.MovimientoCamion.Hora3, dbo.MovimientoCamion.Atiende, 
                      dbo.MovimientoCamion.TipoMovimiento, dbo.MovimientoCamion.DocumentoEntrada, dbo.MovimientoCamion.DocumentoSalida, dbo.MovimientoCamion.Observacion, 
                      dbo.MovimientoCamion.ruttransporte, dbo.MovimientoCamion.RCP, dbo.MovimientoCamion.DocumentoEntrada2, dbo.MovimientoCamion.DocumentoEntrada3, 
                      dbo.MovimientoCamion.DocumentoSalida2, dbo.MovimientoCamion.DocumentoSalida3, dbo.MovimientoCamion.Encargado, dbo.MovimientoCamion.Producto, 
                      dbo.MovimientoCamion.TIPOCAMION, dbo.MovimientoCamion.beepers, dbo.MovimientoCamion.beepers_fh, dbo.P_InfCPendientesMov.TipoMov, DATEDIFF(n, 
                      dbo.MovimientoCamion.Fecha1 + ' ' + dbo.MovimientoCamion.Hora1, dbo.MovimientoCamion.Fecha3 + '  ' + dbo.MovimientoCamion.Hora3) / 60 AS Horas, 
                      dbo.clientes.cli_rut, dbo.choferes.cho_empresa AS empresa, dbo.MovimientoCamion.Fecha1 + ' ' + dbo.MovimientoCamion.Hora1 AS FechaEntrada, 
                      dbo.MovimientoCamion.Fecha2 + ' ' + dbo.MovimientoCamion.Hora2 AS Ingreso, dbo.MovimientoCamion.Fecha3 + ' ' + dbo.MovimientoCamion.Hora3 AS Salida, 
                      DATEDIFF(n, dbo.MovimientoCamion.Fecha1 + ' ' + dbo.MovimientoCamion.Hora1, dbo.MovimientoCamion.Fecha3 + '  ' + dbo.MovimientoCamion.Hora3) 
                      AS Minutos
FROM         dbo.MovimientoCamion INNER JOIN
                      dbo.choferes ON dbo.MovimientoCamion.Chofer = dbo.choferes.cho_rut INNER JOIN
                      dbo.clientes ON dbo.MovimientoCamion.Cliente = dbo.clientes.cli_rut INNER JOIN
                      dbo.P_InfCPendientesMov ON dbo.MovimientoCamion.TipoMovimiento = dbo.P_InfCPendientesMov.id

GO

GO

GO
CREATE VIEW [dbo].[Qry_Movimiento_Camion]
AS
SELECT     TOP 100 PERCENT dbo.MovimientoCamion.ID, dbo.MovimientoCamion.Chofer AS chorut, dbo.choferes.cho_nombre AS chonom, 
                      dbo.MovimientoCamion.EmpresaTransporte AS transporte, dbo.MovimientoCamion.Patente, dbo.MovimientoCamion.Patente2, 
                      dbo.MovimientoCamion.Fecha1 AS fecha, dbo.MovimientoCamion.Hora1 AS hora, dbo.MovimientoCamion.Cliente AS clirut, 
                      dbo.clientes.cli_nomb AS clinom, dbo.NotificacionCliente.Notificacion, dbo.clientes.cli_mail AS mail1, dbo.clientes.Mail2, 
                      dbo.MovimientoCamion.TipoMovimiento
FROM         dbo.MovimientoCamion INNER JOIN
                      dbo.choferes ON dbo.MovimientoCamion.Chofer = dbo.choferes.cho_rut INNER JOIN
                      dbo.clientes ON dbo.MovimientoCamion.Cliente = dbo.clientes.cli_rut INNER JOIN
                      dbo.NotificacionCliente ON dbo.clientes.cli_rut = dbo.NotificacionCliente.Cliente
WHERE     (dbo.NotificacionCliente.Notificacion = '5') AND (dbo.clientes.cli_estado = 'A')
ORDER BY dbo.MovimientoCamion.ID DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_MOVIMIENTOCAMION]
AS
SELECT     dbo.MovimientoCamion.ID, dbo.MovimientoCamion.Chofer, dbo.choferes.cho_nombre, dbo.MovimientoCamion.Patente, 
                      dbo.MovimientoCamion.Cliente, dbo.clientes.cli_nomb, dbo.MovimientoCamion.Accion, dbo.MovimientoCamion.Fecha1, dbo.MovimientoCamion.Hora1, 
                      dbo.MovimientoCamion.Fecha2, dbo.MovimientoCamion.Hora2, dbo.MovimientoCamion.Fecha3, dbo.MovimientoCamion.Hora3, 
                      dbo.MovimientoCamion.Atiende, dbo.MovimientoCamion.TipoMovimiento, dbo.MovimientoCamion.DocumentoEntrada, 
                      dbo.MovimientoCamion.DocumentoSalida, dbo.MovimientoCamion.Observacion, dbo.MovimientoCamion.ruttransporte, dbo.MovimientoCamion.RCP, 
                      dbo.MovimientoCamion.DocumentoEntrada2, dbo.MovimientoCamion.DocumentoEntrada3, dbo.MovimientoCamion.DocumentoSalida2, 
                      dbo.MovimientoCamion.DocumentoSalida3, dbo.MovimientoCamion.Encargado, dbo.MovimientoCamion.Producto, 
                      dbo.MovimientoCamion.TIPOCAMION, dbo.MovimientoCamion.beepers, dbo.MovimientoCamion.beepers_fh
FROM         dbo.MovimientoCamion INNER JOIN
                      dbo.choferes ON dbo.MovimientoCamion.Chofer = dbo.choferes.cho_rut INNER JOIN
                      dbo.clientes ON dbo.MovimientoCamion.Cliente = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[QRY_MOVIMIENTOCAMION_GUIADESPACHO]
AS
SELECT     TOP 100 PERCENT MC.*, dbo.choferes.cho_nombre AS nom_chofer, dbo.clientes.cli_nomb AS NOM_cliente, 
                      dbo.fichdespa.fdes_GuiaCliente AS guiacliente
FROM         dbo.MovimientoCamion MC INNER JOIN
                      dbo.choferes ON dbo.choferes.cho_rut = MC.Chofer INNER JOIN
                      dbo.clientes ON dbo.clientes.cli_rut = MC.Cliente LEFT OUTER JOIN
                      dbo.fichdespa ON MC.DocumentoSalida = dbo.fichdespa.fdes_codi
ORDER BY MC.ID DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_MOVIMIENTOSCAMARA]
AS
SELECT     TOP 100 PERCENT dbo.MOVIMIENTOCAMARAS.MOVC_ID, dbo.MOVIMIENTOCAMARAS.MOVC_FOLIO, dbo.MOVIMIENTOCAMARAS.MOVC_FECHA, 
                      dbo.MOVIMIENTOCAMARAS.MOVC_HORA, dbo.MOVIMIENTOCAMARAS.MOVC_CA, dbo.MOVIMIENTOCAMARAS.MOVC_BA, 
                      dbo.MOVIMIENTOCAMARAS.MOVC_CO, dbo.MOVIMIENTOCAMARAS.MOVC_PI, dbo.MOVIMIENTOCAMARAS.MOVC_NI, 
                      dbo.clientes.cli_rut AS MOVC_RUTCLI, dbo.clientes.cli_nomb AS MOVC_NOMCLI, dbo.ClasificacionMovimiento.Cmov_Descrip AS MOVC_MOVIM, 
                      dbo.detarece.drec_codpro AS MOVC_CODPRO, dbo.maeprod.mae_descr AS MOVC_PRODESC, dbo.detarece.drec_fecrec AS MOVC_FECREC, 
                      dbo.MOVIMIENTOCAMARAS.MOVC_PESO, dbo.detarece.drec_TS AS MOVC_TS, dbo.detarece.drec_TM AS MOVC_TM, 
                      dbo.detarece.drec_TI AS MOVC_TI
FROM         dbo.MOVIMIENTOCAMARAS INNER JOIN
                      dbo.detarece ON dbo.MOVIMIENTOCAMARAS.MOVC_FOLIO = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.ClasificacionMovimiento ON dbo.MOVIMIENTOCAMARAS.MOVC_TIPO = dbo.ClasificacionMovimiento.Cmov_codi INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
ORDER BY dbo.MOVIMIENTOCAMARAS.MOVC_ID

GO

GO

GO
CREATE VIEW [dbo].[QRY_PACKING_LIST]
AS
SELECT     TOP 100 PERCENT dbo.Packing_List.Pack_rutcli, dbo.clientes.cli_nomb, dbo.Packing_List.Pack_Numero, dbo.Packing_List.Pack_Fecha, 
                      dbo.Packing_List.Pack_CodPer, dbo.Packing_List.PacK_CodBarra, dbo.Packing_List.Pack_Batch, dbo.Packing_List.Pack_Caja, 
                      dbo.Packing_List.Pack_Prod, dbo.maeprod.mae_descr, dbo.Packing_List.Pack_unidad, dbo.Packing_List.Pack_kilos, dbo.Packing_List.Pack_kilosop, 
                      dbo.Packing_List.Pack_obs, dbo.Packing_List.Pack_FechaP, dbo.Packing_List.Pack_FechaV, dbo.Packing_List.Pack_Estado
FROM         dbo.Packing_List INNER JOIN
                      dbo.maeprod ON dbo.Packing_List.Pack_Prod = dbo.maeprod.mae_codcli INNER JOIN
                      dbo.clientes ON dbo.Packing_List.Pack_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.Packing_List.pack_primar = '0')

GO

GO

GO
CREATE VIEW [dbo].[QRY_PACKING_LIST_PRIMAR]
AS
SELECT     dbo.Packing_List.Pack_rutcli, dbo.Packing_List.Pack_Numero, dbo.Packing_List.Pack_Fecha, dbo.Packing_List.Pack_CodPer, 
                      dbo.Packing_List.PacK_CodBarra, dbo.Packing_List.Pack_Caja, dbo.Packing_listCliente.pieza AS pack_unidad, 
                      dbo.Packing_listCliente.kilos AS pack_kilos, dbo.Packing_listCliente.fechadesp AS pack_fechad, dbo.Packing_listCliente.orden AS pack_orden, 
                      dbo.Packing_listCliente.NumCajaCliente AS pack_numcajacliente, dbo.Packing_listCliente.Propietario AS pack_propietario, 
                      dbo.Packing_listCliente.LotePrimar AS pack_loteprimar, dbo.Packing_listCliente.LoteCliente AS pack_lotecliente, 
                      dbo.Packing_listCliente.TipoLote AS pack_tipolote, dbo.Packing_listCliente.Productor AS pack_productor, 
                      dbo.Packing_listCliente.CentroCultivo AS pack_centrocultivo, dbo.Packing_listCliente.Especie AS pack_especie, 
                      dbo.Packing_listCliente.ProductoDescr AS mae_descr, dbo.Packing_listCliente.Conservacion AS pack_conservacion, 
                      dbo.Packing_listCliente.CalibreINF AS pack_calibreinf, dbo.Packing_listCliente.CalibreSUP AS pack_calibresup, 
                      dbo.Packing_listCliente.UMCal AS pack_umcal, dbo.Packing_listCliente.EnvasePRIM AS pack_envprim, 
                      dbo.Packing_listCliente.EnvaseSECU AS pack_envsecu, dbo.Packing_listCliente.UMPeso AS pack_umpeso, 
                      dbo.Packing_listCliente.FechaProduccion AS pack_fechap, dbo.Packing_listCliente.Sello AS pack_sello, 
                      dbo.Packing_listCliente.GuiaDespacho AS pack_gdespacho, dbo.Packing_listCliente.Destino AS pack_destino, dbo.Packing_List.Pack_obs, 
                      dbo.Packing_List.Pack_Estado, dbo.Packing_listCliente.fechaelab, dbo.Packing_listCliente.calidad AS pack_calidad
FROM         dbo.Packing_List INNER JOIN
                      dbo.Packing_listCliente ON dbo.Packing_List.Pack_Caja = dbo.Packing_listCliente.caja
WHERE     (dbo.Packing_List.pack_primar = '1')

GO

GO

GO
CREATE VIEW [dbo].[QRY_PACKING_LIST_RESUMEN]
AS
SELECT     TOP 100 PERCENT dbo.Packing_List.Pack_rutcli, dbo.clientes.cli_nomb AS pack_nombcli, LEFT(dbo.Packing_List.Pack_Numero, 7) AS pack_numero, 
                      COUNT(dbo.Packing_List.Pack_Numero) AS pack_cajas, dbo.Packing_List.Pack_Estado
FROM         dbo.Packing_List INNER JOIN
                      dbo.clientes ON dbo.Packing_List.Pack_rutcli = dbo.clientes.cli_rut
GROUP BY dbo.Packing_List.Pack_rutcli, LEFT(dbo.Packing_List.Pack_Numero, 7), dbo.clientes.cli_nomb, dbo.Packing_List.Pack_Estado
ORDER BY LEFT(dbo.Packing_List.Pack_Numero, 7)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_BLOQUEADO_HACCP]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi AS PALLET, dbo.rackdeta.racd_codpro AS PRODUCTO, dbo.maeprod.mae_descr AS DESCRIPCION, 
                      dbo.rackdeta.racd_unidades AS UNIDADES, dbo.rackdeta.racd_peso AS PESO, dbo.clientes.cli_nomb AS Nombre, dbo.clientes.cli_rut AS RUT
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.rackdeta.racd_estadopallet = 1)
ORDER BY dbo.clientes.cli_nomb, dbo.rackdeta.racd_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_BLOQUEADOS]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi AS PALLET, dbo.rackdeta.racd_codpro AS PRODUCTO, dbo.maeprod.mae_descr AS DESCRIPCION, 
                      dbo.rackdeta.racd_unidades AS UNIDADES, dbo.rackdeta.racd_peso AS PESO, dbo.clientes.cli_nomb AS CLIENTE, dbo.clientes.cli_rut AS RUTCLI
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.rackdeta.racd_estadopallet = 1)
ORDER BY dbo.clientes.cli_nomb, dbo.rackdeta.racd_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_pallet_cajasdanadas]
AS
SELECT     dbo.rackdeta.racd_codi AS PALLET, dbo.rackdeta.racd_codpro AS CODPRO, dbo.maeprod.mae_descr AS DESCRIPCION, 
                      dbo.detarece.drec_fecrec AS FECHA, dbo.detarece.drec_rutcli AS RUT, dbo.clientes.cli_nomb AS NOMBRE, 
                      dbo.rackdeta.racd_unidades AS UNIDADES
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_pallet_en_Tunel]
AS
SELECT     dbo.detarece.drec_codi, dbo.detarece.drec_codpro, dbo.detarece.drec_sopocli, dbo.detarece.drec_unidades, dbo.detarece.drec_peso, 
                      dbo.detarece.drec_fecrec, dbo.detarece.drec_rutcli, dbo.detarece.drec_tunel, dbo.detarece.drec_codvig, dbo.detarece.drec_RecepTunel, 
                      dbo.detarece.drec_ProcTunel, dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi
WHERE     (dbo.detarece.drec_ProcTunel = 0) AND (dbo.detarece.drec_tunel >= 1) AND (dbo.detarece.drec_tunel <= 5) AND (dbo.detarece.drec_codvig = 0)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_EN_TUNEL_SADEMA]
AS
SELECT     dbo.rackdeta.racd_codi AS PALLET, dbo.rackdeta.racd_ba AS TUNEL, dbo.detarece.drec_rutcli AS RUT, dbo.clientes.cli_nomb AS CLIENTE, 
                      dbo.detarece.drec_unidades AS UNIDADES, dbo.detarece.drec_peso AS PESO, dbo.rackdeta.racd_codpro AS CODPROD, 
                      dbo.maeprod.mae_descr AS PRODUCTO, dbo.detarece.drec_proceso AS PROCESO
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.rackdeta.racd_ca = '99') AND (dbo.rackdeta.racd_ba >= '01') AND (dbo.rackdeta.racd_ba <= '04')

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_EN_TUNEL_SINPOSICION]
AS
SELECT     dbo.detarece.drec_codi, dbo.detarece.drec_rutcli, dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, 
                      dbo.clientes.cli_nomb
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi AND dbo.detarece.drec_camara <> dbo.rackdeta.racd_ca INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.detarece.drec_RecepTunel <> 1) AND (dbo.detarece.drec_camara = 99) AND (dbo.detarece.drec_fecrec >= '2011/01/01')

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_MOVIDOS]
AS
SELECT     TOP 100 PERCENT dbo.nomiper.nper_codi AS CODIGO, dbo.nomiper.nper_nomb AS NOMBRE, dbo.nomiper.nper_cargo AS CARGO, 
                      COUNT(dbo.movpallet.mov_folio) AS PALLET, dbo.movpallet.mov_fecha AS FECHA
FROM         dbo.nomiper INNER JOIN
                      dbo.movpallet ON dbo.nomiper.nper_codi = dbo.movpallet.mov_codper
GROUP BY dbo.nomiper.nper_codi, dbo.nomiper.nper_nomb, dbo.nomiper.nper_cargo, dbo.movpallet.mov_fecha
ORDER BY dbo.nomiper.nper_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_PICKING_ORIGEN]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi, dbo.PedidosWebok.ped_fechahora, dbo.PedidosWebok.Ped_Numero, 
                      dbo.PedidosWebok.Ped_Folio_Icestar
FROM         dbo.rackdeta INNER JOIN
                      dbo.PedidosWebok ON dbo.rackdeta.racd_codi = dbo.PedidosWebok.Ped_Pallet
WHERE     (dbo.PedidosWebok.Ped_Pallet <= '002000001')
ORDER BY dbo.rackdeta.racd_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLET_VENCIDOS]
AS
SELECT     dbo.maeprod.mae_clirut AS RutClien, dbo.rackdeta.racd_codi AS FRIGORI, dbo.detarece.FechaVencimiento, DATEDIFF(DD, GETDATE(), 
                      dbo.detarece.FechaVencimiento) AS DIAS_VENCIMIENTO, dbo.maeprod.mae_descr AS DESCRIP
FROM         dbo.fichrece INNER JOIN
                      dbo.detarece ON dbo.fichrece.frec_codi = dbo.detarece.frec_codi INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_palletbins_detadespa]
AS
SELECT     dbo.clientes.cli_rut AS Dcli_rut, SUM(dbo.detadespa.ddes_pallet) AS Dpalletbins
FROM         dbo.detadespa INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.clientes ON dbo.detadespa.ddes_rutcli = dbo.clientes.cli_rut AND dbo.detadespa.ddes_codvig = '0' AND dbo.clientes.cli_estado = 'A'
WHERE     (dbo.tipoenv.tenv_descr LIKE 'bins%') AND (dbo.detadespa.ddes_fecha <= '2008/01/22')
GROUP BY dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_palletbins_detarece]
AS
SELECT     dbo.clientes.cli_rut AS Rcli_rut, SUM(dbo.detarece.drec_pallet) AS Rpalletbins
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut AND dbo.detarece.drec_codvig = '0' AND dbo.clientes.cli_estado = 'A'
WHERE     (dbo.tipoenv.tenv_descr LIKE 'bins%') AND (dbo.detarece.drec_fecrec <= '2008/01/22')
GROUP BY dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLETESPERATUNEL]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi, CONVERT(datetime, dbo.fichrece.frec_fecrec, 111) AS frec_fecrec, dbo.fichrece.frec_horater, 
                      dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, dbo.clientes.cli_nomb, 
                      dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.rackdeta.racd_peso, dbo.detarece.drec_tunel, DATEDIFF(hour, CONVERT(datetime, 
                      CONVERT(datetime, dbo.fichrece.frec_fecrec, 111) + ' ' + dbo.fichrece.frec_horater, 105), GETDATE()) AS horas, dbo.detarece.drec_TS, 
                      dbo.detarece.drec_TM, dbo.detarece.drec_TI
FROM         dbo.rackdeta INNER JOIN
                      dbo.fichrece ON LEFT(dbo.rackdeta.racd_codi, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi
WHERE     (dbo.fichrece.frec_RecepTunel = 3) AND (dbo.rackdeta.racd_ca <> 99) AND (dbo.detarece.drec_ProcTunel = 0)
ORDER BY dbo.fichrece.frec_fecrec + ' ' + dbo.fichrece.frec_horater

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLETMOVIDOS]
AS
SELECT     TOP 100 PERCENT dbo.P_Usuario.UsuarioNumero AS CODIGO, dbo.P_Usuario.UsuarioNombre AS NOMBRE, dbo.P_Usuario.UsuarioCargo AS CARGO, 
                      COUNT(dbo.movpallet.mov_folio) AS PALLET, dbo.movpallet.mov_fecha AS FECHA
FROM         dbo.P_Usuario INNER JOIN
                      dbo.movpallet ON dbo.P_Usuario.UsuarioNumero = dbo.movpallet.mov_codper
GROUP BY dbo.P_Usuario.UsuarioNumero, dbo.P_Usuario.UsuarioNombre, dbo.P_Usuario.UsuarioCargo, dbo.movpallet.mov_fecha
ORDER BY CODIGO

GO

GO

GO
CREATE VIEW [dbo].[QRY_PALLETVENCIDOS_FECHAVENCIMIENTO]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.detarece.drec_sopocli, dbo.rackdeta.racd_codi, dbo.rackdeta.racd_codpro, 
                      dbo.maeprod.mae_descr, dbo.rackdeta.racd_correo, dbo.detarece.FechaVencimiento
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.rackdeta.racd_correo < 4)
ORDER BY dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[qry_palletvencidosOK]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.detarece.drec_sopocli, dbo.rackdeta.racd_codi, dbo.rackdeta.racd_codpro, 
                      dbo.maeprod.mae_descr, DATEDIFF(DD, GETDATE(), dbo.detarece.FechaVencimiento) AS DIAS, dbo.rackdeta.racd_correo, 
                      dbo.detarece.FechaVencimiento
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.rackdeta.racd_correo < 4)
ORDER BY dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[qry_pcc11]
AS
SELECT     dbo.clientes.cli_nomb AS CLIENTE, dbo.fichrece.frec_codi AS RECEPCION, dbo.fichrece.frec_totsopo AS TOTALPALLET, dbo.detarece.drec_fecrec AS FECHA, 
                      dbo.fichrece.frec_horarec AS HORA, dbo.fichrece.frec_observ AS OBSERVACION, dbo.P_Usuario.UsuarioNombre AS SUPERVISOR, dbo.fichrece.frec_TS AS TS, 
                      dbo.fichrece.frec_TM AS TM, dbo.fichrece.frec_TI AS TI, dbo.fichrece.frec_RecepTunel AS TIPOALMACENAMIENTO, dbo.fichrece.frec_tiporecepcion AS TIPO
FROM         dbo.fichrece INNER JOIN
                      dbo.detarece ON dbo.fichrece.frec_codi = dbo.detarece.frec_codi INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.P_Usuario ON dbo.fichrece.frec_codienca = dbo.P_Usuario.UsuarioNumero
WHERE     (dbo.fichrece.frec_codvig = N'0')
GROUP BY dbo.clientes.cli_nomb, dbo.P_Usuario.UsuarioNombre, dbo.fichrece.frec_codi, dbo.fichrece.frec_horarec, dbo.fichrece.frec_totsopo, dbo.fichrece.frec_observ, 
                      dbo.fichrece.frec_RecepTunel, dbo.fichrece.frec_TS, dbo.fichrece.frec_TM, dbo.fichrece.frec_TI, dbo.detarece.drec_fecrec, dbo.fichrece.frec_tiporecepcion

GO

GO

GO
CREATE VIEW [dbo].[QRY_PCC2]
AS
SELECT     dbo.PCC2.PCC2_RECEPCION, dbo.PCC2.PCC2_TUNEL, dbo.PCC2.PCC2_FECHA, dbo.PCC2.PCC2_HORA, dbo.PCC2.PCC2_SUPERVISOR, 
                      dbo.movpallet.mov_fecha AS PCC2_FECHAOUT, dbo.movpallet.mov_hora AS PCC2_HORAOUT, dbo.movpallet.mov_TS AS PCC2_TS, 
                      dbo.movpallet.mov_TM AS PCC2_TM, dbo.movpallet.mov_TI AS PCC2_TI, dbo.clientes.cli_nomb AS PCC2_CLIENTE, 
                      dbo.USUARIOS_GLOBAL.NOMBRE AS PCC2_SUPERVISOROUT
FROM         dbo.USUARIOS_GLOBAL INNER JOIN
                      dbo.movpallet ON dbo.USUARIOS_GLOBAL.personal = dbo.movpallet.mov_codper INNER JOIN
                      dbo.PCC2 INNER JOIN
                      dbo.fichrece ON dbo.PCC2.PCC2_RECEPCION = dbo.fichrece.frec_codi INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut ON LEFT(dbo.movpallet.mov_folio, 7) = dbo.PCC2.PCC2_RECEPCION
WHERE     (dbo.movpallet.mov_tipo = 'TU')
GROUP BY dbo.PCC2.PCC2_RECEPCION, dbo.PCC2.PCC2_TUNEL, dbo.PCC2.PCC2_FECHA, dbo.PCC2.PCC2_HORA, dbo.PCC2.PCC2_SUPERVISOR, 
                      dbo.movpallet.mov_fecha, dbo.movpallet.mov_hora, dbo.movpallet.mov_TS, dbo.movpallet.mov_TM, dbo.movpallet.mov_TI, dbo.clientes.cli_nomb, 
                      dbo.USUARIOS_GLOBAL.NOMBRE

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDO_GUIA]
AS
SELECT        dbo.clientes.cli_mail, dbo.clientes.Mail2, dbo.clientes.cli_nomb, dbo.rackdeta.racd_ca AS CA, dbo.rackdeta.racd_ba AS BA, dbo.rackdeta.racd_co AS CO, 
                         dbo.rackdeta.racd_pi AS PI, dbo.rackdeta.racd_ni AS NI, dbo.contrato.cont_descr AS DESCCONT, dbo.pedcaja.pc_ncaja AS TOT_UNIDADES, 
                         dbo.pedcaja.pc_kilos AS TOT_KILOS, dbo.pedcaja.pc_codped AS xnumorden, dbo.rackdeta.racd_codi AS PALLET, dbo.detarece.drec_sopocli AS PALLETCLIENTE, 
                         dbo.maeprod.mae_descr AS DESCRIPCION, dbo.detarece.drec_fecprod AS FECHAPROD, dbo.fichrece.frec_guiades AS GUIA, dbo.pedcaja.pc_rutclie AS RUT, 
                         dbo.detarece.drec_codsag AS RCPSAG, dbo.detarece.FechaVencimiento
FROM            dbo.pedcaja INNER JOIN
                         dbo.rackdeta ON dbo.pedcaja.pc_numpal = dbo.rackdeta.racd_codi INNER JOIN
                         dbo.clientes ON dbo.pedcaja.pc_rutclie = dbo.clientes.cli_rut INNER JOIN
                         dbo.detarece INNER JOIN
                         dbo.contrato ON dbo.detarece.drec_contcli = dbo.contrato.cont_codi INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi ON dbo.detarece.drec_codi = dbo.pedcaja.pc_numpal INNER JOIN
                         dbo.fichrece ON dbo.fichrece.frec_codi = LEFT(dbo.rackdeta.racd_codi, 7)
WHERE        (dbo.pedcaja.pc_estado = 0)

GO

GO

GO
CREATE VIEW [dbo].[Qry_PedidosWeb_ActualizaPallet]
AS
SELECT     dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, 
                      dbo.rackdeta.racd_code, dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, 
                      dbo.rackdeta.racd_pedido_hor
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '79872410K') AND (DATEDIFF(hour, dbo.rackdeta.racd_pedido_fec + ' ' + dbo.rackdeta.racd_pedido_hor, GETDATE()) >= 48) 
                      AND (dbo.rackdeta.racd_pedido = 1)

GO

GO

GO
CREATE VIEW [dbo].[QRY_pedidosWeb_Trackeados_Detalle]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.PedidosWebok.Ped_Numero, 23) AS Ped_numero, dbo.PedidosWebok.Ped_RutCliente, 
                      dbo.PedidosWebok.ped_fechahora, dbo.clientes.cli_nomb AS Ped_cliente, 
                      '01' + dbo.pedidowebrelacionrut.Rutcorto + SUBSTRING(dbo.PedidosWebok.Ped_Numero, 10, 14) AS ean128, dbo.PedidosWebok.Ped_Folio_Icestar, 
                      SUM(dbo.TRACKEOCAJAS.TRACK_CAJA) AS cajastrackeadas, dbo.PedidosWebok.Ped_Cantidad, dbo.PedidosWebok.Ped_Pallet, 
                      dbo.PedidosWebok.Ped_RCP, dbo.PedidosWebok.Ped_Kilos, dbo.PedidosWebok.Ped_Folio_Cliente, dbo.PedidosWebok.Ped_Descripcion, 
                      dbo.PedidosWebok.Ped_Picking
FROM         dbo.PedidosWebok INNER JOIN
                      dbo.clientes ON dbo.PedidosWebok.Ped_RutCliente = dbo.clientes.cli_rut INNER JOIN
                      dbo.pedidowebrelacionrut ON dbo.clientes.cli_rut = dbo.pedidowebrelacionrut.Rut LEFT OUTER JOIN
                      dbo.TRACKEOCAJAS ON '01' + dbo.pedidowebrelacionrut.Rutcorto + SUBSTRING(dbo.PedidosWebok.Ped_Numero, 10, 14) 
                      = SUBSTRING(dbo.TRACKEOCAJAS.TRACK_PREDESPACHO, 1, 19) AND dbo.PedidosWebok.Ped_Pallet = LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9)
GROUP BY LEFT(dbo.PedidosWebok.Ped_Numero, 23), dbo.PedidosWebok.Ped_RutCliente, dbo.PedidosWebok.ped_fechahora, dbo.clientes.cli_nomb, 
                      '01' + dbo.pedidowebrelacionrut.Rutcorto + SUBSTRING(dbo.PedidosWebok.Ped_Numero, 10, 14), dbo.PedidosWebok.Ped_Folio_Icestar, 
                      dbo.PedidosWebok.Ped_Cantidad, dbo.PedidosWebok.Ped_Pallet, dbo.PedidosWebok.Ped_RCP, dbo.PedidosWebok.Ped_Kilos, 
                      dbo.PedidosWebok.Ped_Folio_Cliente, dbo.PedidosWebok.Ped_Descripcion, dbo.PedidosWebok.Ped_Picking

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_DUN14]
AS
SELECT     dbo.PedidosWebok.*, dbo.maeprod.mae_dun14 AS DUN14
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi RIGHT OUTER JOIN
                      dbo.PedidosWebok ON dbo.detarece.drec_codi = dbo.PedidosWebok.Ped_Folio_Icestar

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_HISTORIALPALLET]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.PedidosWebok.Ped_Numero, 23) AS PEDIDO, dbo.PedidosWebok.Ped_Folio_Icestar AS PALLET, 
                      dbo.PedidosWebok.Ped_Folio_Cliente AS PALLET_CLIENTE, dbo.PedidosWebok.Ped_Cantidad AS CANTIDAD, dbo.PedidosWebok.Ped_Kilos AS KILOS,
                       dbo.PedidosWebok.Ped_Descripcion AS PRODUCTO, 
                      dbo.PEDIDOSWEBOK_ANULACION.ped_fecha + ' ' + dbo.PEDIDOSWEBOK_ANULACION.ped_hora AS FECHA_HORA_ANULACION, 
                      dbo.PEDIDOSWEBOK_ANULACION.ped_pc AS PC, { fn UCASE(dbo.usuario.descri) } AS USUARIO
FROM         dbo.clientes INNER JOIN
                      dbo.PedidosWebok ON dbo.clientes.cli_rut = dbo.PedidosWebok.Ped_RutCliente LEFT OUTER JOIN
                      dbo.usuario RIGHT OUTER JOIN
                      dbo.PEDIDOSWEBOK_ANULACION ON dbo.usuario.personal = dbo.PEDIDOSWEBOK_ANULACION.ped_usuario ON 
                      LEFT(dbo.PedidosWebok.Ped_Numero, 23) = dbo.PEDIDOSWEBOK_ANULACION.ped_numero
ORDER BY dbo.PedidosWebok.Ped_Folio_Icestar DESC, dbo.PEDIDOSWEBOK_ANULACION.ped_numero DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_LIBERAR_PALLET]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, dbo.rackdeta.racd_pedido_hor, 
                      dbo.rackdeta.racd_solicitado, dbo.clientes.cli_rut, dbo.clientes.cli_nomb
FROM         dbo.clientes INNER JOIN
                      dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi ON dbo.clientes.cli_rut = dbo.detarece.drec_rutcli
WHERE     (dbo.clientes.cli_nomb LIKE '%SAAM%') AND (dbo.rackdeta.racd_pedido = 1)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_palletBLOQUEADOS]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, 
                      dbo.rackdeta.racd_ni, dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, 
                      dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, dbo.rackdeta.racd_pedido_hor, 
                      dbo.rackdeta.racd_solicitado
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '907030008') AND (dbo.rackdeta.racd_solicitado >= dbo.rackdeta.racd_unidades)
ORDER BY dbo.rackdeta.racd_solicitado DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOSWEBOK_RESUMEN]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.PedidosWebok.Ped_Numero, 23) AS Expr1, dbo.PedidosWebok.ped_fechahora, dbo.clientes.cli_nomb
FROM         dbo.PedidosWebok INNER JOIN
                      dbo.clientes ON dbo.PedidosWebok.Ped_RutCliente = dbo.clientes.cli_rut
WHERE     (YEAR(dbo.PedidosWebok.ped_fechahora) = 2012) AND (MONTH(dbo.PedidosWebok.ped_fechahora) = 12) AND 
                      (DAY(dbo.PedidosWebok.ped_fechahora) = 11)
GROUP BY LEFT(dbo.PedidosWebok.Ped_Numero, 23), dbo.PedidosWebok.ped_fechahora, dbo.clientes.cli_nomb
ORDER BY dbo.PedidosWebok.ped_fechahora DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_pedidowebok_carro]
AS
SELECT     TOP 100 PERCENT dbo.PedidosWebok.Ped_Folio_Icestar, dbo.PedidosWebok.Ped_Folio_Cliente, dbo.detarece.drec_unidades, 
                      dbo.PedidosWebok.Ped_Cantidad, dbo.PedidosWebok.Ped_Kilos, dbo.PedidosWebok.Ped_Descripcion, dbo.PedidosWebok.Ped_RCP, 
                      dbo.rackdeta.racd_ca + '-' + dbo.rackdeta.racd_ba + '-' + dbo.rackdeta.racd_co + '-' + dbo.rackdeta.racd_pi + '-' + dbo.rackdeta.racd_ni AS posicion, 
                      dbo.PedidosWebok.Ped_Picking, dbo.PedidosWebok.Ped_destino, dbo.PedidosWebok.Ped_transporte, 
                      dbo.PedidosWebok.Ped_FechaHoraCarga
FROM         dbo.PedidosWebok INNER JOIN
                      dbo.detarece ON dbo.PedidosWebok.Ped_Folio_Icestar = dbo.detarece.drec_codi INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.PedidosWebok.Ped_Numero LIKE '92048000420121221105432%')
ORDER BY dbo.PedidosWebok.Ped_Numero

GO

GO

GO
CREATE VIEW [dbo].[QRY_PEDIDOWEBOK_INTELIGENTE]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi AS PALLET, dbo.rackdeta.racd_unidades AS UNIDADES, dbo.rackdeta.racd_peso AS KILOS, 
                      RACD_SOLICITADO AS SOLICITADO, 
                      CASE WHEN RACD_SOLICITADO >= 0 THEN RACD_UNIDADES - RACD_SOLICITADO ELSE RACD_UNIDADES END AS STOCK, 
                      dbo.detarece.drec_fecrec AS FECHARECEPCION, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 
                      111) AS FechaVencimiento2, dbo.detarece.drec_contcli AS CONTRATO, dbo.detarece.drec_rutcli AS RUT, dbo.detarece.drec_CODPRO AS CODPRO, 
                      dbo.maeprod.mae_descr AS PRODUCTO, dbo.tipoenv.tenv_descr AS ENVASE, RACD_PEDIDO_FEC AS PEDIDOFECHA, 
                      RACD_PEDIDO_HOR AS PEDIDOHORA, RACD_PEDIDO AS PEDIDO, RACD_ESTADOPALLET AS ESTADOPALLET, CASE WHEN RACD_CA = '99' AND 
                      (RACD_BA >= '01' AND RACD_BA <= '05') THEN '1' ELSE '0' END AS TUNEL, 
                      CASE WHEN RACD_UNIDADES <> DREC_UNIDADES THEN '1' ELSE '0' END AS PUCHOS
FROM         dbo.tipoenv INNER JOIN
                      dbo.maeprod INNER JOIN
                      dbo.detarece ON dbo.maeprod.mae_codi = dbo.detarece.drec_codpro ON dbo.tipoenv.tenv_codi = dbo.maeprod.mae_tipenv RIGHT OUTER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.rackdeta.racd_codi > 2000099)
ORDER BY RACD_SOLICITADO DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_PICKING_Nuevos]
AS
SELECT     TOP 100 PERCENT dbo.detadespa.ddes_codi AS despacho, dbo.detadespa.ddes_fecha AS fecha, dbo.detarece.drec_fecrec AS FECHAR, 
                      dbo.detadespa.ddes_codrece AS pallet_picking, dbo.PedidosWebok.Ped_Folio_Icestar AS pallet, dbo.detadespa.ddes_unidades AS cantidad, 
                      dbo.detadespa.ddes_peso AS peso, dbo.detadespa.ddes_rutcli AS CLIENTE, dbo.detadespa.ddes_contcli AS CONTRATO
FROM         dbo.detadespa INNER JOIN
                      dbo.PedidosWebok ON dbo.detadespa.ddes_codrece = dbo.PedidosWebok.Ped_Pallet INNER JOIN
                      dbo.detarece ON dbo.PedidosWebok.Ped_Folio_Icestar = dbo.detarece.drec_codi
WHERE     (dbo.detadespa.ddes_codrece <= '002000001')
ORDER BY dbo.detadespa.ddes_fecha, dbo.detadespa.ddes_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_PICKING_NUEVOS_RESUMEN]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.detadespa.ddes_codi, 7) AS despacho, dbo.detadespa.ddes_fecha AS fecha, LEFT(dbo.detadespa.ddes_codrece, 7) 
                      AS pallet_picking, LEFT(dbo.PedidosWebok.Ped_Folio_Icestar, 7) AS pallet, SUM(dbo.detadespa.ddes_unidades) AS cantidad, 
                      SUM(dbo.detadespa.ddes_peso) AS peso, dbo.detadespa.ddes_rutcli AS CLIENTE, dbo.detadespa.ddes_contcli AS CONTRATO
FROM         dbo.detadespa INNER JOIN
                      dbo.PedidosWebok ON dbo.detadespa.ddes_codrece = dbo.PedidosWebok.Ped_Pallet INNER JOIN
                      dbo.detarece ON dbo.PedidosWebok.Ped_Folio_Icestar = dbo.detarece.drec_codi
WHERE     (dbo.detadespa.ddes_codrece <= '002000001')
GROUP BY LEFT(dbo.detadespa.ddes_codi, 7), dbo.detadespa.ddes_fecha, dbo.detarece.drec_fecrec, LEFT(dbo.detadespa.ddes_codrece, 7), 
                      LEFT(dbo.PedidosWebok.Ped_Folio_Icestar, 7), dbo.detadespa.ddes_rutcli, dbo.detadespa.ddes_contcli
ORDER BY dbo.detadespa.ddes_fecha, LEFT(dbo.detadespa.ddes_codi, 7)

GO

GO

GO
CREATE VIEW [dbo].[QRY_PNC]
AS
SELECT     dbo.FICHPNC.fpnc_codigo, dbo.FICHPNC.fpnc_fecha, dbo.FICHPNC.fpnc_fechacierre, dbo.FICHPNC.fpnc_rutcli, dbo.clientes.cli_nomb AS fpnc_nomcli, 
                      dbo.FICHPNC.fpnc_persona, dbo.FICHPNC.fpnc_supervisor, dbo.FICHPNC.fpnc_producto, dbo.FICHPNC.fpnc_cantidad, dbo.FICHPNC.fpnc_lugar, 
                      dbo.FICHPNC.fpnc_pallet, dbo.FICHPNC.fpnc_observacion, dbo.FICHPNC.fpnc_accion, dbo.FICHPNC.fpnc_encargado
FROM         dbo.FICHPNC INNER JOIN
                      dbo.clientes ON dbo.FICHPNC.fpnc_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_DESPACHOS_DETALLE]
AS
SELECT     dbo.detadespa.ddes_codi, dbo.detadespa.ddes_codrece, dbo.detadespa.ddes_sopocli, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, 
                      dbo.detadespa.ddes_unidades, dbo.detadespa.ddes_peso, dbo.detarece.drec_codsag, dbo.contrato.cont_codi, dbo.contrato.cont_descr, dbo.detadespa.ddes_pallet, 
                      dbo.detarece.drec_fecprod
FROM         dbo.detadespa INNER JOIN
                      dbo.contrato ON dbo.detadespa.ddes_contcli = dbo.contrato.cont_codi INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
WHERE     (dbo.detadespa.ddes_codvig = '0')

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_DESPACHOS_RESUMEN]
AS
SELECT     TOP (100) PERCENT dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_hora, dbo.fichdespa.fdes_destino, dbo.clientes.cli_rut, 
                      dbo.clientes.cli_nomb, dbo.clientes.cli_direcc, dbo.clientes.cli_comuna, dbo.clientes.cli_ciudad, dbo.fichdespa.fdes_codpred, dbo.choferes.cho_rut, 
                      dbo.choferes.cho_nombre, dbo.choferes.cho_patente, dbo.choferes.cho_patente2, dbo.fichdespa.fdes_contenedor, dbo.fichdespa.fdes_sello, dbo.origen.ori_codi, 
                      dbo.origen.ori_descr, dbo.fichdespa.fdes_tipcarga, dbo.fichdespa.fdes_tempdespacho, dbo.fichdespa.fdes_ordenembarque, 
                      CASE WHEN fdes_tipcarga = '0' THEN 'MECANICA' ELSE 'MANUAL' END AS TIPOCARGA, dbo.ciudad.ciu_descr, dbo.fichdespa.fdes_rutcli, 
                      dbo.fichdespa.fdes_GuiaCliente
FROM         dbo.fichdespa INNER JOIN
                      dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.choferes ON dbo.fichdespa.fdes_rutcond = dbo.choferes.cho_rut INNER JOIN
                      dbo.origen ON dbo.fichdespa.fdes_origen = dbo.origen.ori_codi INNER JOIN
                      dbo.ciudad ON dbo.clientes.cli_ciudad = dbo.ciudad.ciu_codi
WHERE     (dbo.fichdespa.fdes_codvig = '0')
ORDER BY dbo.fichdespa.fdes_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_RECEPCION_DETALLE]
AS
SELECT     dbo.detarece.drec_codi, dbo.detarece.drec_codpro, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.detarece.drec_sopocli, 
                      dbo.detarece.drec_unidades, dbo.detarece.drec_peso, dbo.detarece.drec_fecprod, dbo.detarece.FechaVencimiento,
                      drec_codsag,LoteCliente,drec_temp
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_RECEPCION_FICHA]
AS
SELECT     dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_contcli, dbo.contrato.cont_descr, dbo.fichrece.frec_horarec, dbo.fichrece.frec_horater, 
                      dbo.fichrece.frec_fecrec, dbo.fichrece.frec_guiades, dbo.fichrece.frec_tipentr, dbo.fichrece.frec_totsopo, dbo.fichrece.frec_totunidad, dbo.fichrece.frec_totpeso, 
                      dbo.fichrece.frec_temppro, dbo.fichrece.frec_rutcond, dbo.choferes.cho_nombre, dbo.fichrece.frec_observ, dbo.fichrece.frec_tipdesc, dbo.fichrece.frec_codienca, 
                      usu_nombre, dbo.fichrece.frec_origen, dbo.fichrece.frec_codvig, dbo.fichrece.frec_tipo, dbo.fichrece.frec_RecepTunel, dbo.fichrece.frec_AspectoSanitario, 
                      dbo.fichrece.frec_procedencia, dbo.fichrece.frec_antecamara, dbo.fichrece.frec_numSello, dbo.fichrece.frec_tiporecepcion, dbo.fichrece.frec_observ2, 
                      dbo.clientes.cli_nomb, dbo.choferes.cho_patente, dbo.choferes.cho_empresa, dbo.choferes.cho_rut, dbo.origen.ori_descr,
                      frec_TS,frec_TM,frec_TI
FROM         dbo.fichrece	INNER JOIN dbo.contrato ON dbo.fichrece.frec_contcli = dbo.contrato.cont_codi 
							INNER JOIN dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut 
							INNER JOIN dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut 
							INNER JOIN dbo.usuarios ON dbo.fichrece.frec_codienca = dbo.usuarios.personal 
							INNER JOIN dbo.origen ON dbo.fichrece.frec_origen = dbo.origen.ori_codi
WHERE     fichrece.frec_codvig = '0'
GO

GO

GO
CREATE VIEW [dbo].[QRY_PRECISA_STOCK_RESUMEN_NEW]
AS
SELECT        dbo.detarece.drec_rutcli AS RUTCLIENTE, dbo.detarece.drec_contcli AS CONTRATO, dbo.detarece.drec_codpro AS CODIGO, 
                         dbo.maeprod.mae_codcli AS CODIGOCLIENTE, dbo.maeprod.mae_descr AS DESCRIPCION, COUNT(dbo.rackdeta.racd_codi) AS TOT_PALLET, 
                         SUM(dbo.rackdeta.racd_unidades) AS TOT_UNIDADES, SUM(dbo.rackdeta.racd_peso) AS TOT_KILOS, dbo.maeprod.mae_tipenv, 
                         dbo.tipoenv.tenv_descr AS envase
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE        (dbo.detarece.drec_codvig = '0')
GROUP BY dbo.detarece.drec_rutcli, dbo.detarece.drec_contcli, dbo.detarece.drec_codpro, dbo.maeprod.mae_codcli, dbo.maeprod.mae_descr, dbo.maeprod.mae_tipenv, 
                         dbo.tipoenv.tenv_descr

GO

GO

GO
CREATE VIEW [dbo].[QRY_PREDESPACHO_DETALLE]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.detapred.dpre_codi, 7) AS dpre_codi, dbo.detapred.dpre_codpro, dbo.detapred.dpre_codsopo, dbo.detapred.dpre_sopocli, 
                      SUM(dbo.detapred.dpre_unidades) AS dpre_unidades, SUM(dbo.detapred.dpre_peso) AS dpre_peso, dbo.detapred.dpre_fecdes, 
                      dbo.detapred.dpre_rutcli, dbo.detapred.dpre_contcli, dbo.detapred.dpre_fecprod, dbo.detapred.dpre_camara, dbo.detapred.dpre_banda, 
                      dbo.detapred.dpre_colum, dbo.detapred.dpre_piso, dbo.detapred.dpre_nivel, dbo.detapred.dpre_almacen, dbo.detapred.dpre_dcaja, 
                      dbo.detapred.dpre_folio, dbo.detapred.dpre_activa, dbo.detapred.dpre_radio, dbo.detapred.dpre_track, dbo.detapred.dpre_codvig, 
                      SUM(dbo.detapred.dpre_pallet) AS PALLET, dbo.detapred.dpre_slot, dbo.detapred.dpre_TS, dbo.detapred.dpre_TM, dbo.detapred.dpre_TI, 
                      dbo.detapred.dpre_CodPer, dbo.detapred.dpre_Hora, dbo.detapred.dpre_fecn, dbo.detapred.DPRE_FOLIO_PALLET, 
                      dbo.rackdeta.racd_unidades AS unidades_Stock
FROM         dbo.detapred LEFT OUTER JOIN
                      dbo.rackdeta ON dbo.detapred.dpre_folio = dbo.rackdeta.racd_codi
GROUP BY LEFT(dbo.detapred.dpre_codi, 7), dbo.detapred.dpre_codpro, dbo.detapred.dpre_codsopo, dbo.detapred.dpre_sopocli, dbo.detapred.dpre_fecdes, 
                      dbo.detapred.dpre_rutcli, dbo.detapred.dpre_contcli, dbo.detapred.dpre_fecprod, dbo.detapred.dpre_camara, dbo.detapred.dpre_banda, 
                      dbo.detapred.dpre_colum, dbo.detapred.dpre_piso, dbo.detapred.dpre_nivel, dbo.detapred.dpre_almacen, dbo.detapred.dpre_dcaja, 
                      dbo.detapred.dpre_folio, dbo.detapred.dpre_activa, dbo.detapred.dpre_radio, dbo.detapred.dpre_track, dbo.detapred.dpre_codvig, 
                      dbo.detapred.dpre_slot, dbo.detapred.dpre_TS, dbo.detapred.dpre_TM, dbo.detapred.dpre_TI, dbo.detapred.dpre_CodPer, dbo.detapred.dpre_Hora, 
                      dbo.detapred.dpre_fecn, dbo.detapred.DPRE_FOLIO_PALLET, dbo.rackdeta.racd_unidades
ORDER BY dbo.detapred.dpre_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_predespachos_cliente_temperaturas]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_nomb, dbo.fichpred.fpre_fecdes, dbo.fichpred.fpre_codi, dbo.detapred.dpre_TS, dbo.detapred.dpre_TM, 
                      dbo.detapred.dpre_TI, LEFT(dbo.detadespa.ddes_codi, 7) AS Expr1, dbo.contrato.cont_codi, dbo.contrato.cont_descr
FROM         dbo.clientes INNER JOIN
                      dbo.fichpred ON dbo.clientes.cli_rut = dbo.fichpred.fpre_rutcli INNER JOIN
                      dbo.detapred ON dbo.fichpred.fpre_codi = LEFT(dbo.detapred.dpre_codi, 7) INNER JOIN
                      dbo.detadespa ON dbo.detapred.dpre_codi = dbo.detadespa.ddes_codpred INNER JOIN
                      dbo.contrato ON dbo.detapred.dpre_contcli = dbo.contrato.cont_codi
WHERE     (dbo.fichpred.fpre_fecdes >= '2007/01/01')
GROUP BY dbo.fichpred.fpre_codi, dbo.fichpred.fpre_fecdes, dbo.detapred.dpre_TS, dbo.detapred.dpre_TM, dbo.detapred.dpre_TI, dbo.clientes.cli_nomb, 
                      LEFT(dbo.detadespa.ddes_codi, 7), dbo.contrato.cont_descr, dbo.contrato.cont_codi, dbo.contrato.cont_codi, dbo.contrato.cont_descr
ORDER BY dbo.fichpred.fpre_codi DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_PRODUCCION_SUPERVISORES]
AS
SELECT     TOP 100 PERCENT dbo.fichpred.fpre_codienca, dbo.fichpred.fpre_radio, dbo.nomiper.nper_nomb, COUNT(dbo.fichpred.fpre_radio) AS Pallet
FROM         dbo.fichpred INNER JOIN
                      dbo.nomiper ON dbo.fichpred.fpre_codienca = dbo.nomiper.nper_codi
WHERE     (dbo.fichpred.fpre_fecdes >= '2008/06/01') AND (dbo.fichpred.fpre_fecdes <= '2008/06/05') AND (dbo.fichpred.fpre_codvig = '2')
GROUP BY dbo.fichpred.fpre_codienca, dbo.nomiper.nper_nomb, dbo.fichpred.fpre_radio
ORDER BY dbo.fichpred.fpre_codienca

GO

GO

GO
CREATE VIEW [dbo].[qry_racdeta_Ariztia]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codpro, dbo.maeprod.mae_codcli, dbo.maeprod.mae_descr
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.detarece.drec_rutcli = '825570004') AND (dbo.maeprod.mae_dun14 IS NULL) AND (dbo.maeprod.mae_estado = 0)
GROUP BY dbo.rackdeta.racd_codpro, dbo.maeprod.mae_codcli, dbo.maeprod.mae_descr
ORDER BY dbo.rackdeta.racd_codpro

GO

GO

GO
CREATE VIEW [dbo].[Qry_racdeta_ICB]
AS
SELECT     dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, 
                      dbo.rackdeta.racd_code, dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, 
                      dbo.rackdeta.racd_pedido_hor
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '779656209')

GO

GO

GO
CREATE VIEW [dbo].[qry_racdeta_mermeladas_MEL]
AS
SELECT     COUNT(dbo.rackdeta.racd_codi) AS Expr1
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '783047004')

GO

GO

GO
CREATE VIEW [dbo].[Qry_racdeta_San_Vicente]
AS
SELECT     dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, 
                      dbo.rackdeta.racd_code, dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, 
                      dbo.rackdeta.racd_pedido_hor, dbo.detarece.drec_rutcli
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '784836002')

GO

GO

GO
CREATE VIEW [dbo].[Qry_rackdeta_friosa]
AS
SELECT     dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, 
                      dbo.rackdeta.racd_code, dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, 
                      dbo.rackdeta.racd_pedido_hor
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE     (dbo.detarece.drec_rutcli = '919440007')

GO

GO
SET QUOTED_IDENTIFIER OFF
GO

CREATE VIEW [dbo].[Qry_recepcion_2_cuerpo]
AS
SELECT     dbo.detarece.drec_rutcli AS RUTCLIEN, LEFT(dbo.detarece.drec_codi, 7) AS GUIARECE, dbo.maeprod.mae_descr AS DESCVARI, 
                      dbo.detarece.drec_codsopo AS CODISOPO, dbo.tipoenv.tenv_descr AS DESCENVA, dbo.maeprod.mae_codi AS CODIVARI, 
                      SUM(dbo.detarece.drec_pallet) AS TOTASOPO, SUM(dbo.detarece.drec_unidades) AS TOTAENVA, SUM(dbo.detarece.drec_peso) AS TOTAPESO
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi LEFT OUTER JOIN
                      dbo.tiposopo ON dbo.detarece.drec_codsopo = dbo.tiposopo.tsop_codi
GROUP BY dbo.detarece.drec_rutcli, LEFT(dbo.detarece.drec_codi, 7), dbo.maeprod.mae_descr, dbo.detarece.drec_codsopo, dbo.tipoenv.tenv_descr, 
                      dbo.maeprod.mae_codi




GO

GO

GO
CREATE VIEW [dbo].[Qry_recepcion_3]
AS
SELECT     dbo.clientes.cli_nomb AS NOMCLIEN, dbo.clientes.cli_rut AS RUTCLIEN, dbo.fichrece.frec_fecrec AS FECHRECE, 
                      dbo.fichrece.frec_horarec AS HORARECE, dbo.fichrece.frec_codi AS GUIARECE, dbo.fichrece.frec_guiades AS GUIADESP, 
                      dbo.origen.ori_descr AS descorde, dbo.nomiper.nper_nomb AS nombpers, dbo.fichrece.frec_horater AS horaterm, 
                      dbo.fichrece.frec_tipdesc AS desccade, dbo.fichrece.frec_temppro AS tempprom, dbo.fichrece.frec_turnrec AS turnrece, 
                      dbo.choferes.cho_nombre AS NOMBCOND, dbo.choferes.cho_patente AS numpaten, dbo.choferes.cho_empresa AS emptrans, 
                      dbo.choferes.cho_rut AS rutcondu, dbo.fichrece.frec_totsopo AS totasopo, dbo.fichrece.frec_totunidad AS totaenva, 
                      dbo.fichrece.frec_totpeso AS totapeso, dbo.fichrece.frec_observ AS observac, dbo.fichrece.frec_contcli, dbo.fichrece.frec_termografo, 
                      dbo.fichrece.frec_procedencia, dbo.contrato.cont_descr, dbo.fichrece.frec_numSello, dbo.fichrece.frec_tiporecepcion, dbo.fichrece.frec_RecepTunel, 
                      dbo.fichrece.frec_AspectoSanitario, dbo.fichrece.frec_observ2, dbo.fichrece.frec_CondGeneral, dbo.clientes.cli_mail AS Mail1, dbo.clientes.Mail2
FROM         dbo.fichrece LEFT OUTER JOIN
                      dbo.contrato ON dbo.fichrece.frec_contcli = dbo.contrato.cont_codi LEFT OUTER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.origen ON dbo.fichrece.frec_origen = dbo.origen.ori_codi LEFT OUTER JOIN
                      dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut LEFT OUTER JOIN
                      dbo.nomiper ON dbo.fichrece.frec_codienca = dbo.nomiper.nper_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_RECEPCION_DETALLE]
AS
SELECT     dbo.maeprod.mae_descr AS DESCRIP, dbo.detarece.drec_sopocli AS SOPOCLI, dbo.detarece.drec_fecprod AS FECPRO, 
                      dbo.detarece.drec_fecrec AS FECREC, dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, dbo.detarece.drec_codsag, CONVERT(varchar, 
                      CONVERT(datetime, CONVERT(datetime, dbo.detarece.FechaVencimiento, 105)), 111) AS FechaVencimiento2, dbo.fichrece.frec_guiades, 
                      dbo.fichrece.frec_procedencia, DATEDIFF(DD, GETDATE(), dbo.detarece.FechaVencimiento) AS DIAS_VENCIMIENTO, dbo.detarece.drec_codsopo, 
                      dbo.detarece.drec_valor, dbo.detarece.drec_moncodi, dbo.detarece.drec_medcodi, dbo.detarece.drec_unidades, dbo.detarece.drec_peso, 
                      dbo.detarece.drec_codi, dbo.detarece.drec_codpro, dbo.monedas.mon_descr, dbo.Medidas2.med_descr, dbo.detarece.drec_tunel
FROM         dbo.fichrece INNER JOIN
                      dbo.detarece ON dbo.fichrece.frec_codi = LEFT(dbo.detarece.drec_codi, 7) INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.monedas ON dbo.detarece.drec_moncodi = dbo.monedas.mon_codi INNER JOIN
                      dbo.Medidas2 ON dbo.detarece.drec_medcodi = dbo.Medidas2.med_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_Recepcion_Familias]
AS
SELECT     LEFT(dbo.detarece.drec_codi, 7) AS recepcion, dbo.famprod.fam_descr AS familia
FROM         dbo.detarece INNER JOIN
                      dbo.famprod ON LEFT(dbo.detarece.drec_codpro, 3) = LEFT(dbo.famprod.fam_codi, 3)
GROUP BY LEFT(dbo.detarece.drec_codi, 7), dbo.famprod.fam_descr

GO

GO

GO
CREATE VIEW [dbo].[qry_recepciones_con_tunel]
AS
SELECT     TOP 100 PERCENT dbo.clientes.cli_nomb, LEFT(dbo.detarece.drec_codi, 7) AS recepcion, COUNT(dbo.detarece.drec_codi) AS pallet, 
                      SUM(dbo.detarece.drec_unidades) AS unidades, SUM(dbo.detarece.drec_peso) AS Kilos, dbo.detarece.drec_tunel, AVG(dbo.detarece.drec_TS_Tunel) 
                      AS ts, AVG(dbo.detarece.drec_TM_Tunel) AS tm, AVG(dbo.detarece.drec_TI_Tunel) AS ti
FROM         dbo.detarece INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.detarece.drec_fecrec BETWEEN '2010/05/01' AND '2010/05/31') AND (dbo.detarece.drec_tunel >= 1) AND (dbo.detarece.drec_tunel <= 5) AND 
                      (dbo.detarece.drec_codvig = 0)
GROUP BY dbo.detarece.drec_rutcli, LEFT(dbo.detarece.drec_codi, 7), dbo.detarece.drec_tunel, dbo.clientes.cli_nomb
ORDER BY dbo.detarece.drec_rutcli, LEFT(dbo.detarece.drec_codi, 7), dbo.detarece.drec_tunel

GO

GO

GO
CREATE VIEW [dbo].[QRY_RECEPCIONES_DE_UN_PERIODO]
AS
SELECT     TOP 100 PERCENT frec_codi, frec_rutcli, frec_horarec, frec_horater, frec_fecrec, frec_tipdesc
FROM         dbo.fichrece
WHERE     (frec_fecrec BETWEEN '2010/06/01' AND '2010/06/30') AND (frec_codvig = 0)
ORDER BY frec_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_recepciones_descargas]
AS
SELECT     TOP 100 PERCENT frec_rutcli, frec_contcli, frec_tipdesc, frec_codvig, SUM(frec_totsopo) AS TotPal, SUM(frec_totunidad) AS TotUni, 
                      SUM(ROUND(frec_totpeso, 3)) AS TotPes
FROM         dbo.fichrece
WHERE     (frec_fecrec >= '2012/10/01') AND (frec_fecrec <= '2012/10/31') AND (frec_origen <> '65') AND (frec_origen <> '99') AND (frec_origen <> '97') AND 
                      (frec_rutcli + frec_contcli + frec_tipdesc + frec_codvig = '825570004000290300')
GROUP BY frec_rutcli, frec_contcli, frec_tipdesc, frec_codvig
ORDER BY frec_contcli

GO

GO

GO
CREATE VIEW [dbo].[Qry_Recepciones_MesX]
AS
SELECT     TOP 100 PERCENT frec_codi, frec_rutcli, frec_horarec, frec_horater, frec_fecrec, frec_tipdesc
FROM         dbo.fichrece
WHERE     (frec_fecrec BETWEEN '2010/11/01' AND '2010/11/30')
ORDER BY frec_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_Saldodestadespa]
AS
SELECT     dbo.detadespa.ddes_codi, dbo.detadespa.ddes_unidades, dbo.detadespa.ddes_peso, dbo.detadespa.ddes_almacen, dbo.detadespa.ddes_codvig, 
                      dbo.detadespa.ddes_pallet, dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.maeprod.mae_descr, dbo.maeprod.mae_codi, dbo.tipoenv.tenv_descr, 
                      dbo.detadespa.ddes_fecha
FROM         dbo.clientes INNER JOIN
                      dbo.detadespa ON dbo.clientes.cli_rut = dbo.detadespa.ddes_rutcli INNER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_Saldodetarece]
AS
SELECT     *, dbo.detarece.drec_codi AS Expr1, dbo.detarece.drec_unidades AS Expr2, dbo.detarece.drec_peso AS Expr3, dbo.detarece.drec_rutcli AS Expr4, 
                      dbo.clientes.cli_nomb AS Expr5, dbo.tipoenv.tenv_descr AS Expr6, dbo.maeprod.mae_codi AS Expr7, dbo.maeprod.mae_descr AS Expr8, 
                      dbo.detarece.drec_fecrec AS Expr9
FROM         dbo.tipoenv INNER JOIN
                      dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi ON dbo.tipoenv.tenv_codi = dbo.maeprod.mae_tipenv INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb11]
AS
SELECT     TOP 100 PERCENT drec_codi AS Codigo, ISNULL(drec_rutcli, 0) AS Rut, drec_contcli AS Contrato, drec_fecrec AS Fecha, CAST(SUBSTRING(drec_fecrec, 
                      1, 4) + SUBSTRING(drec_fecrec, 6, 2) AS numeric) AS GrupFec, drec_codvig AS VigenteRece, drec_unidades AS Unidades, drec_pallet AS Pallet
FROM         dbo.detarece
GROUP BY drec_codi, drec_rutcli, drec_contcli, drec_fecrec, drec_codvig, drec_unidades, drec_pallet
HAVING      (drec_codvig = N'0')

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb28]
AS
SELECT     dbo.fichrece.frec_fecrec AS Fecha, dbo.fichrece.frec_codi AS Codigo, SUM(dbo.detarece.drec_unidades) AS Unidades, SUM(dbo.detarece.drec_peso) 
                      AS Peso, SUM(dbo.detarece.drec_pallet) AS Pallet, dbo.fichrece.frec_rutcli AS Rut, dbo.fichrece.frec_tipdesc AS TipoCarga, 
                      dbo.fichrece.frec_codvig AS Vigente, dbo.detarece.drec_contcli AS Contrato, dbo.fichrece.frec_origen AS Origen, 
                      CAST(SUBSTRING(dbo.fichrece.frec_fecrec, 1, 4) + SUBSTRING(dbo.fichrece.frec_fecrec, 6, 2) AS numeric) AS GrupFec
FROM         dbo.detarece RIGHT OUTER JOIN
                      dbo.fichrece ON LEFT(dbo.detarece.drec_codi, 7) = dbo.fichrece.frec_codi
GROUP BY dbo.fichrece.frec_fecrec, dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_tipdesc, dbo.fichrece.frec_codvig, 
                      dbo.detarece.drec_contcli, dbo.fichrece.frec_origen

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb31]
AS
SELECT     TOP 100 PERCENT dbo.fichdespa.fdes_fecha AS Fecha, dbo.fichdespa.fdes_codi AS Codigo, SUM(dbo.detadespa.ddes_unidades) AS Unidades, 
                      SUM(dbo.detadespa.ddes_peso) AS Peso, SUM(dbo.detadespa.ddes_pallet) AS Pallet, dbo.fichdespa.fdes_rutcli AS Rut, 
                      dbo.fichdespa.fdes_tipcarga AS TipoCarga, dbo.fichdespa.fdes_codvig AS Vigente, dbo.detadespa.ddes_contcli AS Contrato, 
                      dbo.fichdespa.fdes_origen AS Origen, CAST(SUBSTRING(dbo.fichdespa.fdes_fecha, 1, 4) + SUBSTRING(dbo.fichdespa.fdes_fecha, 6, 2) AS numeric) 
                      AS GrupFec
FROM         dbo.detadespa RIGHT OUTER JOIN
                      dbo.fichdespa ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.fichdespa.fdes_codi
GROUP BY dbo.fichdespa.fdes_fecha, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_rutcli, dbo.fichdespa.fdes_tipcarga, dbo.fichdespa.fdes_codvig, 
                      dbo.detadespa.ddes_contcli, dbo.fichdespa.fdes_origen
ORDER BY dbo.fichdespa.fdes_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb40]
AS
SELECT     TOP 100 PERCENT hor_rutcli AS Rut, hor_cont AS Contrato, hor_fecha AS Fecha, hor_nrodoc AS Documento, hor_horas AS Horas, 
                      hor_autoriza AS Autorizado, hor_patente AS Patente, CAST(SUBSTRING(hor_fecha, 1, 4) + SUBSTRING(hor_fecha, 6, 2) AS numeric) AS GrupFec
FROM         dbo.habhora

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb70]
AS
SELECT     ftun_codi AS Codigo, ftun_rutcli AS Rut, ftun_contcli AS Contrato, ftun_fecrec AS Fecha, ftun_temppro AS Temperatura, ftun_codvig AS Vigente, 
                      ftun_guiades AS GuiaDespacho, ftun_totunidad AS Unidades, ftun_totsopo AS Soportantes, ftun_totpeso AS Peso, CAST(SUBSTRING(ftun_fecrec, 1, 4) 
                      + SUBSTRING(ftun_fecrec, 6, 2) AS numeric) AS GrupFec
FROM         dbo.fichtunel

GO

GO

GO
CREATE VIEW [dbo].[Qry_ServicioWeb85]
AS
SELECT     TOP 100 PERCENT frec_codi AS Codigo, frec_rutcli AS Rut, frec_contcli AS Contrato, frec_temppro AS Temperatura, frec_totunidad AS Unidades, 
                      frec_totpeso AS Peso, frec_totsopo AS Soportantes, CAST(SUBSTRING(frec_fecrec, 1, 4) + SUBSTRING(frec_fecrec, 6, 2) AS numeric) AS GrupFec, 
                      frec_guiades AS Guia, frec_origen AS Origen, frec_fecrec AS fecha
FROM         dbo.fichrece
ORDER BY frec_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_SOPORTANTES_V4224]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS RutClien, dbo.maeprod.mae_descr AS DESCRIP, dbo.tipoenv.tenv_descr AS ENVASE, 
                      dbo.detarece.drec_sopocli AS SOPCLI_R, dbo.rackdeta.racd_peso AS PESO, dbo.rackdeta.racd_codpro AS CODIGO, 
                      dbo.rackdeta.racd_unidades AS CANTIDAD, dbo.detarece.drec_fecprod AS FECPRO, dbo.rackdeta.racd_codi AS FRIGORI, 
                      dbo.detarece.drec_fecrec AS FECREC, dbo.detarece.drec_camara, dbo.detarece.drec_banda, dbo.detarece.drec_contcli, dbo.detarece.drec_RecepTunel,
                       dbo.detarece.drec_ProcTunel, dbo.detarece.drec_FecHomo, dbo.detarece.drec_HorHomo, dbo.detarece.drec_AutHomo, 
                      dbo.detarece.FechaVencimiento, dbo.detarece.drec_estado, dbo.detarece.drec_codsag, CONVERT(varchar, CONVERT(datetime, CONVERT(datetime, 
                      dbo.detarece.FechaVencimiento, 105)), 111) AS FechaVencimiento2, dbo.fichrece.frec_guiades, dbo.fichrece.frec_procedencia, 
                      dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.CAJAS_DANADAS.CDAN_FECHA, dbo.CAJAS_DANADAS.CDAN_HORA, 
                      dbo.CAJAS_DANADAS.CDAN_CAJAS + ' ' + dbo.CAJAS_DANADAS.CDAN_OBSERVACION AS CDAN_OBSERVACION, 
                      dbo.CAJAS_DANADAS.CDAN_ESTADO, dbo.CAJAS_DANADAS.CDAN_LINK, DATEDIFF([hour], 
                      dbo.rackdeta.racd_pedido_fec + ' ' + dbo.rackdeta.racd_pedido_hor, GETDATE()) AS HORAS_PEDIDO, DATEDIFF(DD, GETDATE(), 
                      dbo.detarece.FechaVencimiento) AS DIAS_VENCIMIENTO, dbo.CAJAS_DANADAS.CDAN_CAJAS, dbo.contrato.cont_descr AS contrato
FROM         dbo.rackdeta INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.detarece.drec_codi, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.contrato ON dbo.detarece.drec_contcli = dbo.contrato.cont_codi LEFT OUTER JOIN
                      dbo.CAJAS_DANADAS ON dbo.rackdeta.racd_codi = dbo.CAJAS_DANADAS.CDAN_PALLET
WHERE     (dbo.rackdeta.racd_peso > 0)

GO

GO

GO
CREATE VIEW [dbo].[Qry_stock_acumulado_pallet_bins_promedio_mes]
AS
SELECT     TOP 100 PERCENT nombre, AVG(pallet) AS TotPallet, AVG(bins) AS TotBins, grupo
FROM         dbo.Stock_Pallet_Cliente
GROUP BY nombre, grupo
ORDER BY nombre

GO

GO

GO
CREATE VIEW [dbo].[QRY_STOCK_CODIGUA]
AS
SELECT     TOP 100 PERCENT dbo.detarece.drec_codi, dbo.detarece.drec_fecrec, dbo.detarece.drec_codpro, dbo.detadespa.ddes_fecha
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.detadespa ON dbo.detarece.drec_rutcli = dbo.detadespa.ddes_rutcli AND dbo.detarece.drec_codi = dbo.detadespa.ddes_codrece
WHERE     (dbo.detarece.drec_rutcli = '774712704') AND (dbo.detarece.drec_fecrec < '2012/02/01')
ORDER BY dbo.detadespa.ddes_fecha

GO

GO

GO
CREATE VIEW [dbo].[Qry_Stock_invertec_seafood_primar]
AS
SELECT     TOP 100 PERCENT batch, codpro, caja, fechaelab, LotePrimar, Propietario, LoteCliente, TipoLote, Productor, CentroCultivo, Especie, ProductoDescr, 
                      Conservacion, CalibreINF, CalibreSUP, EnvasePRIM, UMCal, EnvaseSECU, UMPeso, Sello, FechaProduccion, GuiaDespacho, Destino
FROM         dbo.Packing_listCliente cliente
WHERE     (NOT EXISTS
                          (SELECT     icestar.pack_batch, icestar.pack_caja, icestar.pack_prod
                            FROM          Packing_List AS icestar
                            WHERE      cliente.batch = icestar.pack_batch AND cliente.codpro = icestar.pack_prod AND cliente.caja = icestar.pack_caja))
ORDER BY batch DESC

GO

GO

GO
CREATE VIEW [dbo].[Qry_StockPalletPicking]
AS
SELECT     TOP 100 PERCENT dbo.rackdeta.racd_codi AS palletadespachar, SUBSTRING(dbo.PedidosWebok.Ped_Numero, 1, 23) AS pedido, 
                      dbo.PedidosWebok.Ped_RutCliente AS rutcliente, dbo.clientes.cli_nomb AS nombrecliente, dbo.PedidosWebok.Ped_Folio_Icestar AS palleticestar, 
                      dbo.rackdeta.racd_codpro AS producto, dbo.maeprod.mae_descr
FROM         dbo.rackdeta INNER JOIN
                      dbo.PedidosWebok ON dbo.rackdeta.racd_codi = dbo.PedidosWebok.Ped_Pallet INNER JOIN
                      dbo.clientes ON dbo.PedidosWebok.Ped_RutCliente = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.rackdeta.racd_codi <= '002000099')
ORDER BY dbo.rackdeta.racd_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_TEMPERATURASPROMEDIO_SALIDA_TUNEL]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.movpallet.mov_folio, 7) AS RECEPCION, AVG(dbo.movpallet.mov_TS) AS TS, AVG(dbo.movpallet.mov_TM) AS TM, 
                      AVG(dbo.movpallet.mov_TI) AS TI, dbo.movpallet.mov_fecha AS FECHA_SALIDA, dbo.clientes.cli_nomb AS CLIENTE, 
                      dbo.detarece.drec_tunel AS TUNEL
FROM         dbo.movpallet INNER JOIN
                      dbo.detarece ON dbo.movpallet.mov_folio = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.movpallet.mov_fecha BETWEEN '2010/06/01' AND '2010/06/30') AND (dbo.movpallet.mov_tipo = 'TU') AND (dbo.detarece.drec_codvig = '0')
GROUP BY dbo.clientes.cli_rut, LEFT(dbo.movpallet.mov_folio, 7), dbo.movpallet.mov_fecha, dbo.clientes.cli_nomb, dbo.detarece.drec_tunel
ORDER BY dbo.clientes.cli_rut, LEFT(dbo.movpallet.mov_folio, 7)

GO

GO

GO
CREATE VIEW [dbo].[Qry_TipoRecepcion]
AS
SELECT     TOP 100 PERCENT dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.clientes.cli_nomb, dbo.fichrece.frec_fecrec, dbo.fichrece.frec_guiades, 
                      dbo.fichrece.frec_tiporecepcion, dbo.detarece.drec_codsag, SUM(dbo.detarece.drec_pallet) AS tot_pallet, SUM(dbo.detarece.drec_unidades) 
                      AS tot_unidades, SUM(dbo.detarece.drec_peso) AS tot_peso
FROM         dbo.fichrece INNER JOIN
                      dbo.detarece ON dbo.fichrece.frec_codi = LEFT(dbo.detarece.drec_codi, 7) INNER JOIN
                      dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
WHERE     (dbo.fichrece.frec_tiporecepcion > 0) AND (dbo.fichrece.frec_codvig = '0')
GROUP BY dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_codvig, dbo.fichrece.frec_tiporecepcion, dbo.fichrece.frec_fecrec, 
                      dbo.fichrece.frec_guiades, dbo.clientes.cli_nomb, dbo.fichrece.frec_fecrec, dbo.fichrece.frec_guiades, dbo.fichrece.frec_tiporecepcion, 
                      dbo.detarece.drec_codsag
ORDER BY dbo.fichrece.frec_rutcli, dbo.fichrece.frec_codi

GO

GO

GO
CREATE VIEW [dbo].[qry_tiporecepcion_donihue]
AS
SELECT     TOP 100 PERCENT dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_codvig, dbo.fichrece.frec_tiporecepcion, 
                      dbo.fichrece.frec_fecrec
FROM         dbo.fichrece INNER JOIN
                      dbo.detarece ON dbo.fichrece.frec_codi = LEFT(dbo.detarece.drec_codi, 7)
WHERE     (dbo.fichrece.frec_rutcli = '79872410K') AND (dbo.fichrece.frec_tiporecepcion IS NULL) AND (dbo.fichrece.frec_codvig = '0') AND 
                      (dbo.detarece.drec_codpro = '4000143')
GROUP BY dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_codvig, dbo.fichrece.frec_tiporecepcion, dbo.fichrece.frec_fecrec

GO

GO

GO
CREATE VIEW [dbo].[Qry_TrackeoCajas]
AS
SELECT     dbo.detarece.drec_codi AS TRACK_FOLIO, dbo.detarece.drec_fecrec AS TRACK_FECREC, dbo.detarece.drec_rutcli AS TRACK_RUTCLI, 
                      dbo.TRACKEOCAJAS.TRACK_CODI, dbo.TRACKEOCAJAS.TRACK_CODCAJA, dbo.TRACKEOCAJAS.TRACK_FECHAHORA, 
                      dbo.TRACKEOCAJAS.TRACK_USUARIO, dbo.TRACKEOCAJAS.TRACK_CODVIG, dbo.clientes.cli_nomb AS TRACK_NOMCLI, CONVERT(varchar, 
                      CONVERT(datetime, CONVERT(datetime, dbo.TRACKEOCAJAS.TRACK_FECHAHORA, 105)), 111) AS TRACK_FECHAPERIODO, 
                      dbo.detarece.drec_contcli AS TRACK_CONTRATO, dbo.detarece.drec_sopocli AS TRACK_SOPOCLI
FROM         dbo.detarece INNER JOIN
                      dbo.TRACKEOCAJAS ON dbo.detarece.drec_codi = LEFT(dbo.TRACKEOCAJAS.TRACK_CODI, 9) INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[Qry_TrackeoCajasRecepcion_Resumen]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.DetareceCajas.drec_codi, 9) AS recepcion, dbo.DetareceCajas.drec_rutcli, 
                      dbo.detadespa.ddes_fecha AS fecha_despacho, COUNT(dbo.DetareceCajas.drec_unidades) AS tot_cajas
FROM         dbo.DetareceCajas INNER JOIN
                      dbo.detarece ON LEFT(dbo.DetareceCajas.drec_codi, 9) = dbo.detarece.drec_codi LEFT OUTER JOIN
                      dbo.detadespa ON LEFT(dbo.DetareceCajas.drec_codi, 9) = dbo.detadespa.ddes_codrece
WHERE     (dbo.DetareceCajas.drec_rutcli = '760226033')
GROUP BY LEFT(dbo.DetareceCajas.drec_codi, 9), dbo.DetareceCajas.drec_rutcli, dbo.detadespa.ddes_fecha
ORDER BY dbo.detadespa.ddes_fecha

GO

GO

GO
CREATE VIEW [dbo].[qry_Trazabilidad_Pallet_en_Ubicacion]
AS
SELECT     TOP 12 PERCENT mov_folio, mov_ca, mov_ba, mov_co, mov_pi, mov_ni, mov_fecha
FROM         dbo.movpallet
WHERE     (mov_ca + mov_ba + mov_co + mov_pi = '15071201')
ORDER BY mov_fecha DESC

GO

GO

GO
CREATE VIEW [dbo].[qry_trazabilidad_tunel_pallet_en_proceso]
AS
SELECT     dbo.movpallet.mov_folio, dbo.detarece.drec_proceso
FROM         dbo.movpallet INNER JOIN
                      dbo.detarece ON dbo.movpallet.mov_folio = dbo.detarece.drec_codi
WHERE     (dbo.movpallet.mov_ca = '99') AND (dbo.movpallet.mov_ba = '02') AND (dbo.movpallet.mov_fecha = '2011/09/30') AND 
                      (dbo.detarece.drec_rutcli = '79872410K')

GO

GO

GO
CREATE VIEW [dbo].[QRY_TRAZABILIDAD_TUNEL_TEMP]
AS
SELECT     dbo.detarece.drec_proceso AS PROCESO, AVG(dbo.detarece.drec_TS) AS R_TS, AVG(dbo.detarece.drec_TM) AS R_TM, AVG(dbo.detarece.drec_TI) 
                      AS R_TI, AVG(dbo.detatunel.dtun_TS) AS T_TS, AVG(dbo.detatunel.dtun_TM) AS T_TM, AVG(dbo.detatunel.dtun_TI) AS T_TI
FROM         dbo.detarece LEFT OUTER JOIN
                      dbo.detatunel ON dbo.detarece.drec_codi = dbo.detatunel.dtun_codiPallet
WHERE     (dbo.detarece.drec_proceso <> '')
GROUP BY dbo.detarece.drec_proceso

GO

GO

GO
CREATE VIEW [dbo].[QRY_trazavilidad_acusete]
AS
SELECT     TOP 100 PERCENT mov_folio, COUNT(mov_folio) AS Num_Movimiento, mov_ca
FROM         dbo.movpallet
GROUP BY mov_folio, mov_ca
HAVING      (COUNT(mov_folio) = 1)
ORDER BY COUNT(mov_folio)

GO

GO

GO
CREATE VIEW [dbo].[qry_Tunel_Despacho_Porcesos]
AS
SELECT     TOP 100 PERCENT LEFT(dbo.detadespa.ddes_codi, 7) AS Despacho, LEFT(dbo.detarece.drec_codi, 7) AS Recepcion, dbo.detarece.drec_proceso
FROM         dbo.detadespa INNER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
WHERE     (LEN(dbo.detarece.drec_proceso) > 1)
GROUP BY LEFT(dbo.detadespa.ddes_codi, 7), LEFT(dbo.detarece.drec_codi, 7), dbo.detarece.drec_proceso

GO

GO

GO
CREATE VIEW [dbo].[QRY_TUNEL_HORAS_CONGELADO]
AS
SELECT     dbo.TUNEL_HORAS_CONGELADO.FAMILIA, dbo.famprod.fam_descr, dbo.TUNEL_HORAS_CONGELADO.T1, dbo.TUNEL_HORAS_CONGELADO.T2, 
                      dbo.TUNEL_HORAS_CONGELADO.T3, dbo.TUNEL_HORAS_CONGELADO.T4
FROM         dbo.famprod INNER JOIN
                      dbo.TUNEL_HORAS_CONGELADO ON LEFT(dbo.famprod.fam_codi, 3) = dbo.TUNEL_HORAS_CONGELADO.FAMILIA

GO

GO

GO
CREATE VIEW [dbo].[QRY_TunelEstatico_Doihue]
AS
SELECT     TOP 100 PERCENT dbo.fichtunel.ftun_fecrec, dbo.fichtunel.ftun_guiades, LEFT(dbo.detarece.drec_codi, 7) AS Recepcion, 
                      COUNT(dbo.detarece.drec_pallet) AS Pallet, LEFT(dbo.tipoenv.tenv_descr, 4) AS Envase, SUM(dbo.detarece.drec_peso) AS totalkilos, 
                      dbo.fichtunel.ftun_temppro, dbo.fichtunel.ftun_tempsal, dbo.detarece.drec_contcli
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi INNER JOIN
                      dbo.fichtunel ON LEFT(dbo.detarece.drec_codi, 7) = dbo.fichtunel.ftun_codi
WHERE     (dbo.detarece.drec_rutcli = '79872410k') AND (dbo.detarece.drec_fecrec >= '2009/04/01') AND (dbo.fichtunel.ftun_codvig = '0') AND 
                      (dbo.detarece.drec_fecrec <= '2009/04/30')
GROUP BY LEFT(dbo.detarece.drec_codi, 7), LEFT(dbo.tipoenv.tenv_descr, 4), dbo.detarece.drec_contcli, dbo.fichtunel.ftun_fecrec, dbo.fichtunel.ftun_guiades, 
                      dbo.fichtunel.ftun_temppro, dbo.fichtunel.ftun_tempsal
ORDER BY LEFT(dbo.tipoenv.tenv_descr, 4), LEFT(dbo.detarece.drec_codi, 7)

GO

GO

GO
CREATE VIEW [dbo].[Qry_Ubicacion_Fisica]
AS
SELECT     dbo.rackdeta.racd_codpro AS ubi_codigo, dbo.maeprod.mae_descr AS ubi_descr, dbo.tipoenv.tenv_descr AS ubi_tipo, 
                      dbo.detarece.drec_fecrec AS ubi_fecrec, dbo.detarece.drec_fecprod AS ubi_fecprod, dbo.rackdeta.racd_ca AS ubi_ca, dbo.rackdeta.racd_ba AS ubi_ba, 
                      dbo.rackdeta.racd_co AS ubi_co, dbo.rackdeta.racd_pi AS ubi_pi, dbo.rackdeta.racd_ni AS ubi_ni, dbo.rackdeta.racd_codi AS ubi_frigorifico, 
                      dbo.detarece.drec_sopocli AS ubi_sopocli, dbo.rackdeta.racd_unidades AS ubi_envases, dbo.rackdeta.racd_peso AS ubi_peso, 
                      dbo.detarece.drec_codsag AS ubi_codsag, dbo.detarece.drec_contcli AS ubi_contrato, dbo.detarece.drec_rutcli AS ubi_rutcli
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_Ubicacion_Fisica_Cajas]
AS
SELECT     dbo.rackdeta.racd_codpro AS ubi_codigo, dbo.maeprod.mae_descr AS ubi_descr, dbo.tipoenv.tenv_descr AS ubi_tipo, 
                      dbo.DetareceCajas.drec_fecrec AS ubi_fecrec, dbo.DetareceCajas.drec_fecprod AS ubi_fecprod, dbo.rackdeta.racd_ca AS ubi_ca, 
                      dbo.rackdeta.racd_ba AS ubi_ba, dbo.rackdeta.racd_co AS ubi_co, dbo.rackdeta.racd_pi AS ubi_pi, dbo.rackdeta.racd_ni AS ubi_ni, 
                      dbo.rackdeta.racd_codi AS ubi_frigorifico, dbo.DetareceCajas.drec_sopocli AS ubi_sopocli, dbo.rackdeta.racd_unidades AS ubi_envases, 
                      dbo.rackdeta.racd_peso AS ubi_peso, dbo.DetareceCajas.drec_codsag AS ubi_codsag, dbo.DetareceCajas.drec_contcli AS ubi_contrato, 
                      dbo.DetareceCajas.drec_rutcli AS ubi_rutcli, dbo.DetareceCajas.Caja AS ubi_cajacliente, dbo.DetareceCajas.drec_codi AS ubi_Cajafrigorifico
FROM         dbo.tipoenv INNER JOIN
                      dbo.maeprod ON dbo.tipoenv.tenv_codi = dbo.maeprod.mae_tipenv INNER JOIN
                      dbo.DetareceCajas ON dbo.maeprod.mae_codi = dbo.DetareceCajas.drec_codpro INNER JOIN
                      dbo.rackdeta ON LEFT(dbo.DetareceCajas.drec_codi, 9) = dbo.rackdeta.racd_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_ubicacion_fisica_soportante_4_4]
AS
SELECT     dbo.maeprod.mae_codi, dbo.maeprod.mae_descr, dbo.tipoenv.tenv_descr, dbo.detarece.drec_fecrec, dbo.detarece.drec_fecprod, 
                      dbo.detarece.FechaVencimiento, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                      dbo.detarece.drec_codi, dbo.detarece.drec_sopocli, dbo.detarece.drec_unidades, dbo.detarece.drec_peso, dbo.detarece.drec_codsag
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                      dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE     (dbo.detarece.drec_rutcli = '784852709') AND (dbo.detarece.drec_codvig = '0')

GO

GO

GO
CREATE VIEW [dbo].[Qry_Ubicacion_Fisica2]
AS
SELECT     dbo.rackdeta.racd_codpro AS ubi_codigo, dbo.maeprod.mae_descr AS ubi_descr, dbo.tipoenv.tenv_descr AS ubi_tipo, dbo.detarece.drec_fecrec AS ubi_fecrec, 
                      dbo.detarece.drec_fecprod AS ubi_fecprod, dbo.rackdeta.racd_ca AS ubi_ca, dbo.rackdeta.racd_ba AS ubi_ba, dbo.rackdeta.racd_co AS ubi_co, 
                      dbo.rackdeta.racd_pi AS ubi_pi, dbo.rackdeta.racd_ni AS ubi_ni, dbo.rackdeta.racd_codi AS ubi_frigorifico, dbo.detarece.drec_sopocli AS ubi_sopocli, 
                      dbo.rackdeta.racd_unidades AS ubi_envases, dbo.rackdeta.racd_peso AS ubi_peso, dbo.detarece.drec_codsag AS ubi_codsag, 
                      dbo.detarece.drec_contcli AS ubi_contrato, dbo.detarece.drec_rutcli AS ubi_rutcli, dbo.detarece.FechaVencimiento AS ubi_fecvenc, 
                      dbo.detarece.LoteCliente AS ubi_lote, dbo.rackdeta.LoteCliente
FROM         dbo.detarece INNER JOIN
                      dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi

GO

GO

GO
CREATE VIEW [dbo].[Qry_ver_pallet_despachados_figuran_Racdeta]
AS
SELECT     dbo.detadespa.ddes_codrece, SUM(dbo.detadespa.ddes_unidades) AS unidades, SUM(dbo.detadespa.ddes_peso) AS peso
FROM         dbo.detadespa INNER JOIN
                      dbo.rackdeta ON dbo.detadespa.ddes_codrece = dbo.rackdeta.racd_codi AND dbo.detadespa.ddes_unidades = dbo.rackdeta.racd_unidades AND 
                      dbo.detadespa.ddes_peso = dbo.rackdeta.racd_peso
WHERE     (dbo.detadespa.ddes_codvig = 0) AND (dbo.detadespa.ddes_pallet = 1)
GROUP BY dbo.detadespa.ddes_codrece

GO

GO

GO
CREATE VIEW [dbo].[qry_verificar]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_codi, dbo.maeprod.mae_descr, dbo.maeprod.mae_clirut, dbo.detarece.drec_contcli
FROM         dbo.maeprod INNER JOIN
                      dbo.detarece ON dbo.maeprod.mae_codi = dbo.detarece.drec_codpro
WHERE     (dbo.maeprod.mae_clirut = '825570004') AND (dbo.maeprod.mae_codvig = '0')
GROUP BY dbo.maeprod.mae_codi, dbo.maeprod.mae_descr, dbo.maeprod.mae_clirut, dbo.detarece.drec_contcli
ORDER BY dbo.maeprod.mae_codi

GO

GO

GO
CREATE VIEW [dbo].[QRY_VERIFICAR_PALLET_EN_POSICIONES]
AS
SELECT     TOP 20 PERCENT dbo.movpallet.mov_folio, dbo.movpallet.mov_ca, dbo.movpallet.mov_ba, dbo.movpallet.mov_co, dbo.movpallet.mov_pi, 
                      dbo.movpallet.mov_ni, dbo.movpallet.mov_fecha, dbo.maeprod.mae_codi, dbo.clientes.cli_nomb, dbo.maeprod.mae_descr, 
                      dbo.maeprod.mae_codcli
FROM         dbo.movpallet INNER JOIN
                      dbo.detarece ON dbo.movpallet.mov_folio = dbo.detarece.drec_codi INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi
WHERE     (dbo.movpallet.mov_ca = 15) AND (dbo.clientes.cli_nomb LIKE '%rosario%') AND (dbo.maeprod.mae_descr LIKE '%1020939%')
ORDER BY dbo.movpallet.mov_fecha DESC

GO

GO

GO
CREATE VIEW [dbo].[QRY_VERIFICAR_PEDIDO]
AS
SELECT     dbo.rackdeta.racd_codi, dbo.detarece.drec_rutcli, dbo.rackdeta.racd_pedido, dbo.detarece.drec_unidades
FROM         dbo.rackdeta INNER JOIN
                      dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi

GO

GO

GO
CREATE VIEW [dbo].[QryBins2]
AS
SELECT     TOP 100 PERCENT dbo.maeprod.mae_clirut AS Expr1, dbo.clientes.cli_nomb, dbo.clientes.cli_rut, dbo.detadespa.ddes_codi
FROM         dbo.detadespa LEFT OUTER JOIN
                      dbo.clientes ON dbo.detadespa.ddes_rutcli = dbo.clientes.cli_rut LEFT OUTER JOIN
                      dbo.maeprod ON dbo.detadespa.ddes_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.tipoenv ON dbo.maeprod.mae_tipenv = dbo.tipoenv.tenv_codi
WHERE     (LEFT(dbo.tipoenv.tenv_descr, 4) = N'BINS')
GROUP BY dbo.clientes.cli_nomb, dbo.clientes.cli_rut, dbo.maeprod.mae_clirut, dbo.detadespa.ddes_codi
ORDER BY dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[QryPersonal]
AS
SELECT     nper_codi, nper_rut, nper_nomb
FROM         dbo.nomiper

GO

GO

GO
CREATE VIEW [dbo].[QryTrazabilidadAnexo]
AS
SELECT     dbo.movpallet.mov_folio, dbo.movpallet.mov_fecha, dbo.movpallet.mov_tipo, dbo.movpallet.mov_hora, dbo.movpallet.mov_fecha AS Expr1, 
                      dbo.detadespa.ddes_codrece, dbo.detadespa.ddes_codi, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_hora, dbo.fichdespa.fdes_rutcond, 
                      dbo.fichdespa.fdes_patente, dbo.fichdespa.fdes_transporte, dbo.fichdespa.fdes_sello, dbo.fichrece.frec_rutcond, dbo.choferes.cho_nombre, 
                      dbo.choferes.cho_empresa, dbo.choferes.cho_patente
FROM         dbo.movpallet INNER JOIN
                      dbo.detadespa ON dbo.movpallet.mov_folio = dbo.detadespa.ddes_codrece INNER JOIN
                      dbo.fichdespa ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.fichdespa.fdes_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.movpallet.mov_folio, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut

GO

GO

GO
CREATE VIEW [dbo].[QryTrazabilidadAnexo1]
AS
SELECT     dbo.movpallet.mov_folio, dbo.movpallet.mov_fecha, dbo.movpallet.mov_tipo, dbo.movpallet.mov_hora, dbo.movpallet.mov_fecha AS Expr1, 
                      dbo.detadespa.ddes_codrece, dbo.detadespa.ddes_codi, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_hora, dbo.fichdespa.fdes_rutcond, 
                      dbo.fichdespa.fdes_patente, dbo.fichdespa.fdes_transporte, dbo.fichdespa.fdes_sello, dbo.fichrece.frec_rutcond, dbo.choferes.cho_nombre, 
                      dbo.choferes.cho_empresa, dbo.choferes.cho_patente
FROM         dbo.movpallet INNER JOIN
                      dbo.detadespa ON dbo.movpallet.mov_folio = dbo.detadespa.ddes_codrece INNER JOIN
                      dbo.fichdespa ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.fichdespa.fdes_codi INNER JOIN
                      dbo.fichrece ON LEFT(dbo.movpallet.mov_folio, 7) = dbo.fichrece.frec_codi INNER JOIN
                      dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut

GO

GO

GO
CREATE VIEW [dbo].[Qrytrazabilidadlote1]
AS
SELECT     TOP 100 PERCENT dbo.movpallet.mov_unica, dbo.movpallet.mov_folio, dbo.movpallet.mov_codper, dbo.movpallet.mov_ca, dbo.movpallet.mov_ba, 
                      dbo.movpallet.mov_co, dbo.movpallet.mov_pi, dbo.movpallet.mov_ni, dbo.movpallet.mov_fecha, dbo.movpallet.mov_tipo, dbo.movpallet.mov_hora, 
                      dbo.movpallet.mov_TS, dbo.movpallet.mov_TM, dbo.movpallet.mov_Doc, dbo.movpallet.mov_RecepTunel, dbo.movpallet.mov_TI, 
                      dbo.nomiper.nper_nomb, dbo.ClasificacionMovimiento.Cmov_Descrip, dbo.DestinoPallet.DPal_desc, dbo.movpallet.Mov_Despacho, 
                      dbo.movpallet.Mov_Saldo, dbo.clientes.cli_rut, dbo.clientes.cli_nomb, dbo.movpallet.mov_chorut, dbo.movpallet.mov_docdespa, 
                      dbo.movpallet.mov_chonom, dbo.movpallet.mov_chopat, dbo.movpallet.mov_chotra, dbo.movpallet.mov_anden, dbo.detarece.FechaVencimiento, 
                      dbo.detarece.LoteCliente, dbo.maeprod.mae_descr, dbo.detarece.drec_codpro
FROM         dbo.detarece INNER JOIN
                      dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi LEFT OUTER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut RIGHT OUTER JOIN
                      dbo.movpallet ON dbo.detarece.drec_codi = dbo.movpallet.mov_folio LEFT OUTER JOIN
                      dbo.DestinoPallet ON dbo.movpallet.mov_RecepTunel = dbo.DestinoPallet.DPal_codi LEFT OUTER JOIN
                      dbo.ClasificacionMovimiento ON 
                      dbo.movpallet.mov_tipo = dbo.ClasificacionMovimiento.Cmov_codi COLLATE SQL_Latin1_General_CP1_CI_AS LEFT OUTER JOIN
                      dbo.nomiper ON CAST(dbo.movpallet.mov_codper AS smallint) = CAST(dbo.nomiper.nper_codi AS smallint)
WHERE     (dbo.movpallet.mov_folio = 003511201)

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[RecepcionArlavan] as
select fichrece.frec_tipdesc, fichrece.frec_fecrec, maeprod.mae_descr, detarece.drec_codpro, sum(detarece.drec_peso) as toneladas, sum(detarece.drec_pallet)as Pallets
from detarece inner join fichrece on fichrece.frec_codi=left(detarece.drec_codi,7)
              inner join maeprod on maeprod.mae_codi=detarece.drec_codpro  
where drec_codpro in ('8000342','8000343','8000346','8000367','8000387','8000391','8000399','8000402','8000413','8000422','8000436','8000433')
	 and drec_fecrec between '2004/04/01' and '2005/08/31'
group by fichrece.frec_tipdesc, fichrece.frec_fecrec, maeprod.mae_descr, detarece.drec_codpro
--order by fichrece.frec_fecrec asc, maeprod.mae_descr, fichrece.frec_tipdesc

GO

GO

GO
CREATE VIEW [dbo].[RGP_Traza_cajas]
AS
SELECT DISTINCT mov_fecha,mov_hora,Caj_cod, isnull(convert(varchar,mov_saldo),'') as mov_saldo,
mov_folio,drec_sopocli,mov_ca,mov_ba,mov_co,mov_pi,
mov_ni,Cmov_Descrip,drec_rutcli,isnull(mov_doc,'') as mov_doc,drec_temp,usu_nombre,
Caj_ped,isnull(RACKDETA_ESTADO.DESCRIPCION,'DESPACHADO') as estado,drec_hora,drec_fecrec,
detarece.Fechavencimiento,cli_nomb,mae_descr,
cont_descr,detarece.lotecliente,contrato.cont_codi as contrato,mae_codi as codprod,
frec_patente,frec_empresa,isnull(cho_nombre,'') as Chofer,frec_rutcond as rutchof,mov_tipo,mov_despacho,
mov_ti,mov_TM,mov_TS ,isnull(fdes_GuiaCliente,'-') as nguia,fdes_origen
FROM movpallet
INNER JOIN ClasificacionMovimiento on mov_tipo=Cmov_codi
INNER JOIN (DetaReceCajas INNER JOIN (detarece INNER JOIN 
(fichrece INNER JOIN contrato on fichrece.frec_contcli = contrato.cont_codi LEFT JOIN choferes ON cho_rut=frec_rutcond)
ON fichrece.frec_codi=LEFT(drec_codi,7)) ON drec_codi=Caj_Pcod)ON Caj_Pcod=mov_folio
LEFT JOIN Usuarios ON mov_codper=usu_codigo
LEFT JOIN (rackdeta INNER JOIN RACKDETA_ESTADO ON CODIGO=racd_estado) ON mov_folio=racd_codi
INNER JOIN clientes ON drec_rutcli=cli_rut
INNER JOIN maeprod ON detarece.drec_codpro = mae_codi
LEFT JOIN detadespa ON ddes_codrece = drec_codi
LEFT JOIN fichdespa ON fdes_codi=LEFT(ddes_codrece,7)

GO

GO

GO
CREATE VIEW [dbo].[RGP_Traza_soportantes]
AS
SELECT drec_rutcli as rutcli,drec_codi as sopoprec,drec_sopocli as sopocli,
convert(nvarchar(10),CONVERT(date,mov_fecha,102),103) as fecha,
mov_hora as hora,isnull(mov_doc,'S/D') Dcto,descri as Responsable,Cmov_Descrip as movimiento,
isnull(convert(nvarchar(5),mov_TI),'') as TI,isnull(convert(nvarchar(5),mov_TM),'') as TM,
isnull(convert(nvarchar(5),mov_TS),'') as TS,
isnull(convert(nvarchar(15),round((mov_TI+mov_TM+mov_TS)/3,1)),'') as TP,isnull(mov_ca,'') as CA,
isnull(mov_ba,'') as BA,isnull(mov_co,'') as CO,isnull(convert(nvarchar(5),mov_pi),'') as 'PI',
isnull(convert(nvarchar(5),mov_ni),'') AS NI,drec_unidades,isnull(convert(nvarchar(5),Mov_despacho),'') as MovDespacho,
isnull(convert(nvarchar(5),Mov_Saldo),'') as Saldo,mov_tipo,isnull(drec_temp,0) temp
FROM movpallet 
INNER JOIN detarece ON drec_codi=mov_folio
INNER JOIN ClasificacionMovimiento on mov_tipo=Cmov_codi
LEFT JOIN Usuarios ON convert(int,mov_codper)=convert(int,usu_codigo)
WHERE drec_codvig=0
GO

GO

GO
CREATE VIEW  [dbo].[rgppal] AS
SELECT drec_codi as codsopo,1 soportantes,drec_fecrec as fecharef,drec_rutcli as rutclie,
drec_codpro as codprod,1 as recep,drec_unidades as unidades,drec_peso as kilos
FROM detarece INNER JOIN maeprod on mae_codi=drec_codpro LEFT JOIN origen ON ori_codi=drec_origen 
WHERE drec_codvig=0 
UNION ( 
SELECT  ddes_codrece as codsopo,CASE ddes_pallet WHEN 1 THEN 1 ELSE 0 END 
 as soportantes,ddes_fecha as fecharef,ddes_rutcli as rutclie,
 ddes_codpro as codprod,0 as recep,ddes_unidades as unidades,ddes_peso as kilos
FROM detadespa 
INNER JOIN detarece ON ddes_codrece=drec_codi AND drec_rutcli<>'116095327' AND drec_codvig=0 
INNER JOIN maeprod on mae_codi=ddes_codpro INNER JOIN fichdespa ON fdes_codi=left(ddes_codi,7) 
LEFT JOIN origen ON ori_codi=fdes_origen
WHERE ddes_codvig=0) 
GO

GO

GO
CREATE VIEW [dbo].[seguirmax]
as
SELECT drec_codi as numpallet,isnull(drec_unidades,0) as rec,0 as desp FROM detarece  WHERE drec_codvig=0 and drec_rutcli='789037507' 
UNION
SELECT ddes_codrece as numpallet,0 as rec,isnull(ddes_unidades,0) as desp FROM detadespa WHERE ddes_codvig=0 and ddes_rutcli='789037507'
 
GO

GO

GO
CREATE VIEW [dbo].[TMP_Qry]
as
SELECT dpc_codcaja FROM detapedcaja WHERE dpc_codped='1754' AND dpc_numpal in (SELECT dpre_folio FROM TMPDETAPRED WHERE fpre_codi='0003560') 
UNION ALL
SELECT scaj_codcaja FROM TMP_SELECCIONCAJAS WHERE scaj_codped='1754' AND scaj_codcaja not in ( SELECT dpc_codcaja FROM detapedcaja WHERE dpc_codped='1754' AND dpc_numpal in (SELECT dpre_folio FROM TMPDETAPRED WHERE fpre_codi='0003560') )

GO

GO

GO
CREATE VIEW [dbo].[totales_movimientos]
AS
SELECT     dbo.detadespa.ddes_codrece, dbo.detarece.drec_unidades, dbo.detadespa.ddes_unidades, dbo.detarece.drec_unidades - dbo.detadespa.ddes_unidades AS total, 
                      dbo.detarece.drec_rutcli
FROM         dbo.detadespa RIGHT OUTER JOIN
                      dbo.detarece ON dbo.detadespa.ddes_codrece = dbo.detarece.drec_codi
WHERE     (dbo.detarece.drec_rutcli = N'861005003') AND (dbo.detarece.drec_unidades - dbo.detadespa.ddes_unidades > 0)

GO

GO
SET QUOTED_IDENTIFIER OFF
GO
create view [dbo].[uno_det]
as
select ddes_rutcli as rut , ddes_codpro as codigo ,(ddes_pallet) as palet ,( ddes_unidades) as Unidades,(ddes_peso) as peso,* from detadespa 

GO

GO

GO
CREATE VIEW [dbo].[ver_produccion_proceso]
AS
SELECT     dbo.clientes.cli_nomb, dbo.PRODUCCION_PROCESOS.Turno, dbo.PRODUCCION_PROCESOS.Fecha, dbo.maeprod.mae_descr, 
                      dbo.PRODUCCION_PROCESOS.Calidad, dbo.PRODUCCION_PROCESOS.Valor, dbo.PRODUCCION_PROCESOS.Numero, 
                      dbo.PRODUCCION_PROCESOS.Productor, dbo.PRODUCCION_PROCESOS.Produccion, dbo.PRODUCCION_PROCESOS.Especie, 
                      dbo.PRODUCCION_PROCESOS.Hora_ini, dbo.PRODUCCION_PROCESOS.Hora_Fin
FROM         dbo.clientes INNER JOIN
                      dbo.maeprod INNER JOIN
                      dbo.PRODUCCION_PROCESOS ON dbo.maeprod.mae_codi = dbo.PRODUCCION_PROCESOS.Calidad ON 
                      dbo.clientes.cli_rut = dbo.PRODUCCION_PROCESOS.Productor

GO

GO

GO
CREATE VIEW [dbo].[VG_AYUDASOPCLI]
AS
SELECT        dbo.detarece.drec_sopocli AS sop_cli, dbo.detarece.drec_codi AS pallet, dbo.detarece.drec_rutcli AS rut_cli, dbo.clientes.cli_nomb AS nombre_cli
FROM            dbo.detarece INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[VG_CAMARAS_ALTURAS]
AS
SELECT        dbo.rack.rack_ca, dbo.rack.rack_ba, dbo.rack.rack_co, dbo.rack.rack_pi, dbo.Camaras_Altura.altura
FROM            dbo.Camaras_Altura INNER JOIN
                         dbo.rack ON dbo.Camaras_Altura.camara = dbo.rack.rack_ca AND dbo.Camaras_Altura.columna = dbo.rack.rack_co AND dbo.Camaras_Altura.piso = dbo.rack.rack_pi

GO

GO

GO
CREATE VIEW [dbo].[VG_CONTROL_CAMION_DESPA]
AS
SELECT        dbo.zCheckList.Cl_fol, dbo.zCheckList.Cl_RutCli, dbo.clientes.cli_nomb, dbo.zCheckList.Cl_chorut, dbo.choferes.cho_nombre, dbo.zCheckList.Cl_pate, 
                         dbo.zCheckList.Cl_Lleg, dbo.zCheckList.Cl_Mov, dbo.zMovimientos.Mov_desc, dbo.Usuarios.usu_nombre, dbo.fichdespa.fdes_codi, dbo.zCheckList.Cl_EstPor
FROM            dbo.Usuarios INNER JOIN
                         dbo.fichdespa ON dbo.Usuarios.usu_codigo = dbo.fichdespa.fdes_codienca RIGHT OUTER JOIN
                         dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.choferes ON dbo.zCheckList.Cl_chorut = dbo.choferes.cho_rut INNER JOIN
                         dbo.zMovimientos ON dbo.zCheckList.Cl_Mov = dbo.zMovimientos.mov_codi ON dbo.fichdespa.fdes_clfol = dbo.zCheckList.Cl_fol
WHERE        (dbo.zCheckList.Cl_Mov = 1) OR
                         (dbo.zCheckList.Cl_Mov = 3)

GO

GO

GO
CREATE VIEW [dbo].[VG_CONTROL_CAMION_RECEP]
AS
SELECT        dbo.zCheckList.Cl_fol, dbo.zCheckList.Cl_RutCli, dbo.clientes.cli_nomb, dbo.zCheckList.Cl_chorut, dbo.choferes.cho_nombre, dbo.zCheckList.Cl_pate, 
                         dbo.zCheckList.Cl_Lleg, dbo.fichrece.frec_codi, dbo.zCheckList.Cl_Mov, dbo.zMovimientos.Mov_desc, dbo.Usuarios.usu_nombre, dbo.zCheckList.Cl_EstPor
FROM            dbo.Usuarios INNER JOIN
                         dbo.fichrece ON dbo.Usuarios.usu_codigo = dbo.fichrece.frec_codienca RIGHT OUTER JOIN
                         dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.choferes ON dbo.zCheckList.Cl_chorut = dbo.choferes.cho_rut INNER JOIN
                         dbo.zMovimientos ON dbo.zCheckList.Cl_Mov = dbo.zMovimientos.mov_codi ON dbo.fichrece.frec_clfol = dbo.zCheckList.Cl_fol
WHERE        (dbo.zCheckList.Cl_Mov = 2) OR
                         (dbo.zCheckList.Cl_Mov = 3)

GO

GO

GO
CREATE VIEW [dbo].[VG_CRUCEINF01]
AS
SELECT        dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.detapedcaja.dpc_codped
FROM            dbo.DetaReceCajas INNER JOIN
                         dbo.detapedcaja ON dbo.DetaReceCajas.caj_cod = dbo.detapedcaja.dpc_codcaja

GO

GO

GO
CREATE VIEW [dbo].[VG_CUENTAPALLETS]
AS
SELECT        dbo.CamaraMantenedor.Camara, dbo.CamaraMantenedor.Banda, dbo.CamaraMantenedor.Columna, dbo.CamaraMantenedor.Cordenada, 
                         COUNT(dbo.rackdeta.racd_codi) AS Cantidad
FROM            dbo.CamaraMantenedor INNER JOIN
                         dbo.rackdeta ON dbo.CamaraMantenedor.Camara = dbo.rackdeta.racd_ca AND dbo.CamaraMantenedor.Banda = dbo.rackdeta.racd_ba AND 
                         dbo.CamaraMantenedor.Columna = dbo.rackdeta.racd_co
GROUP BY dbo.CamaraMantenedor.Camara, dbo.CamaraMantenedor.Banda, dbo.CamaraMantenedor.Columna, dbo.CamaraMantenedor.Cordenada

GO

GO

GO
CREATE VIEW [dbo].[VG_DETARECE_SUMAS]
AS
SELECT        COUNT(frec_codi1) AS pallets, SUM(drec_unidades) AS cajas, SUM(drec_peso) AS kilos
FROM            dbo.detarece

GO

GO

GO
CREATE VIEW [dbo].[VG_detaservicios]
AS
SELECT        dbo.Detaservicios.RECEPCION, dbo.Detaservicios.PALLET, dbo.Detaservicios.FILM, dbo.Detaservicios.REPA, dbo.Detaservicios.RETIRO, 
                         dbo.Detaservicios.ETIQUETADO, dbo.Detaservicios.CARGAAPISO, dbo.Detaservicios.DESCARGA, dbo.Detaservicios.OBS, dbo.Detaservicios.EST_FIN, 
                         dbo.Detaservicios.RESPONSABLE, dbo.clientes.cli_nomb, dbo.Usuarios.usu_nombre, dbo.Usuarios.usu_ap
FROM            dbo.Detaservicios INNER JOIN
                         dbo.fichrece ON dbo.Detaservicios.RECEPCION = dbo.fichrece.frec_codi INNER JOIN
                         dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.Usuarios ON dbo.Detaservicios.RESPONSABLE = dbo.Usuarios.usu_codigo

GO

GO

GO
CREATE VIEW [dbo].[vg_diferenciakilos]
AS
SELECT        dbo.detarece.drec_peso, dbo.detarece.drec_codi, dbo.detarece.drec_rutcli, dbo.detarece.drec_codvig, dbo.detarece.drec_codpro, dbo.detadespa.ddes_peso, 
                         dbo.detarece.drec_peso - dbo.detadespa.ddes_peso AS tot, dbo.rackdeta.racd_peso, dbo.detarece.drec_peso - dbo.rackdeta.racd_peso AS ttto
FROM            dbo.detarece INNER JOIN
                         dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi LEFT OUTER JOIN
                         dbo.detadespa ON dbo.detarece.drec_codi = dbo.detadespa.ddes_codrece
WHERE        (dbo.detarece.drec_rutcli = N'801863000') AND (dbo.detarece.drec_codpro = N'6000019') AND (dbo.detarece.drec_peso - dbo.detadespa.ddes_peso IS NULL) AND 
                         (dbo.detarece.drec_peso - dbo.rackdeta.racd_peso < 0)

GO

GO

GO
CREATE VIEW [dbo].[VG_FICHDESPA_CONT]
AS
SELECT        dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_fecha, dbo.clientes.cli_nomb, dbo.choferes.cho_nombre, dbo.choferes.cho_patente, dbo.Usuarios.usu_nombre, 
                         dbo.fichdespa.fdes_clfol
FROM            dbo.fichdespa LEFT OUTER JOIN
                         dbo.choferes ON dbo.fichdespa.fdes_rutcond = dbo.choferes.cho_rut LEFT OUTER JOIN
                         dbo.Usuarios ON dbo.fichdespa.fdes_codienca = dbo.Usuarios.usu_codigo LEFT OUTER JOIN
                         dbo.clientes ON dbo.fichdespa.fdes_rutcli = dbo.clientes.cli_rut
WHERE        (dbo.fichdespa.fdes_clfol = N'')

GO

GO

GO
CREATE VIEW [dbo].[VG_FICHRECE_CONT]
AS
SELECT        dbo.fichrece.frec_codi, dbo.fichrece.frec_fecrec, dbo.clientes.cli_nomb, dbo.choferes.cho_nombre, dbo.choferes.cho_patente, dbo.Usuarios.usu_nombre, 
                         dbo.fichrece.frec_clfol
FROM            dbo.fichrece LEFT OUTER JOIN
                         dbo.choferes ON dbo.fichrece.frec_rutcond = dbo.choferes.cho_rut LEFT OUTER JOIN
                         dbo.Usuarios ON dbo.fichrece.frec_codienca = dbo.Usuarios.usu_codigo LEFT OUTER JOIN
                         dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
WHERE        (dbo.fichrece.frec_clfol = N'')

GO

GO

GO
CREATE VIEW [dbo].[VG_MOVSOPUSU]
AS
SELECT        dbo.movpallet.mov_codper AS Cod_Usuario, dbo.Usuarios.descri AS Usuario, dbo.movpallet.mov_folio AS Pallet, dbo.clientes.cli_nomb AS Cliente, 
                         dbo.movpallet.mov_ca AS Camara, dbo.camaras.cam_descr AS Descripcion, dbo.movpallet.mov_ba AS Banda, dbo.movpallet.mov_co AS Columna, 
                         dbo.movpallet.mov_pi AS Piso, dbo.movpallet.mov_ni AS Nivel, dbo.movpallet.mov_fecha AS Fecha, dbo.movpallet.mov_hora AS Hora, 
                         dbo.movpallet.mov_fecha + ' ' + dbo.movpallet.mov_hora + ':00' AS fechora
FROM            dbo.movpallet INNER JOIN
                         dbo.camaras ON dbo.movpallet.mov_ca = dbo.camaras.cam_codi INNER JOIN
                         dbo.Usuarios ON dbo.movpallet.mov_codper = dbo.Usuarios.usu_codigo INNER JOIN
                         dbo.detarece ON dbo.movpallet.mov_folio = dbo.detarece.drec_codi INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
WHERE        (dbo.movpallet.mov_tipo = 'RR')
GROUP BY dbo.movpallet.mov_codper, dbo.Usuarios.descri, dbo.movpallet.mov_folio, dbo.clientes.cli_nomb, dbo.movpallet.mov_ca, dbo.camaras.cam_descr, 
                         dbo.movpallet.mov_ba, dbo.movpallet.mov_co, dbo.movpallet.mov_pi, dbo.movpallet.mov_ni, dbo.movpallet.mov_fecha, dbo.movpallet.mov_hora

GO

GO

GO
CREATE VIEW [dbo].[VG_PACKINGLIST]
AS
SELECT        dbo.detapedcaja.dpc_codped, dbo.detapedcaja.dpc_numpal, dbo.detapedcaja.dpc_codcaja, dbo.DetaReceCajas.caj_Calidad, dbo.DetaReceCajas.caj_Calibre, 
                         dbo.DetaReceCajas.caj_felab, dbo.DetaReceCajas.caj_fvenc, dbo.DetaReceCajas.caj_unid, dbo.DetaReceCajas.caj_Kg, dbo.DetaReceCajas.caj_lote
FROM            dbo.detapedcaja INNER JOIN
                         dbo.DetaReceCajas ON dbo.detapedcaja.dpc_codcaja = dbo.DetaReceCajas.caj_cod

GO

GO

GO
CREATE VIEW [dbo].[VG_PEDIDODETALLE]
AS
SELECT        dbo.Pedidos_ficha.Orden, dbo.Pedidos_detalle.pallet, dbo.Pedidos_detalle.cajas
FROM            dbo.Pedidos_detalle INNER JOIN
                         dbo.Pedidos_ficha ON dbo.Pedidos_detalle.pedido = dbo.Pedidos_ficha.pedido

GO

GO

GO
CREATE VIEW [dbo].[VG_POSENCAMARA]
AS
SELECT        dbo.rackdeta.racd_codi AS PALLET, dbo.clientes.cli_nomb AS CLIENTE, dbo.rackdeta.racd_ca AS CAMARA, dbo.rackdeta.racd_ba AS BANDA, 
                         dbo.rackdeta.racd_co AS COLUMNA, dbo.rackdeta.racd_pi AS PISO, dbo.rackdeta.racd_ni AS NIVEL, dbo.maeprod.mae_descr AS PRODUCTO, 
                         dbo.rackdeta.racd_unidades AS UNIDADES, dbo.rackdeta.racd_peso AS PESO, dbo.rackdeta.FechaVencimiento AS VENCIMIENTO
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.maeprod ON dbo.rackdeta.racd_codpro = dbo.maeprod.mae_codi
WHERE        (dbo.rackdeta.racd_ca = N'01') OR
                         (dbo.rackdeta.racd_ca = N'02') OR
                         (dbo.rackdeta.racd_ca = N'03') OR
                         (dbo.rackdeta.racd_ca = N'04') OR
                         (dbo.rackdeta.racd_ca = N'05') OR
                         (dbo.rackdeta.racd_ca = N'06')

GO

GO

GO
CREATE VIEW [dbo].[VG_PROYECTORPREPARADOS]
AS
SELECT        TOP (10) dbo.Pedidos_ficha.pedido, dbo.Pedidos_ficha.Orden, dbo.clientes.cli_nomb AS cliente, dbo.Pedidos_ficha.fecha, dbo.Pedidos_ficha.hora, 
                         dbo.Pedidos_ficha.destino AS sopo, dbo.Pedidos_ficha.Encargado
FROM            dbo.Pedidos_ficha INNER JOIN
                         dbo.clientes ON dbo.Pedidos_ficha.cliente = dbo.clientes.cli_rut
WHERE        ((SELECT        COUNT(*) AS Expr1
                            FROM            dbo.Pedidos_detalle
                            WHERE        (est = '1')) > 0) AND (dbo.clientes.cli_rut <> '116095327') AND (dbo.Pedidos_ficha.codvig = 0) AND (dbo.Pedidos_ficha.Orden NOT IN
                             (SELECT        fpre_nped
                               FROM            dbo.fichpred)) AND (DATEADD(day, 2, CONVERT(date, dbo.Pedidos_ficha.fecha, 103)) > CONVERT(date, GETDATE(), 103))
ORDER BY dbo.Pedidos_ficha.Orden DESC

GO

GO

GO
CREATE VIEW [dbo].[vg_rackdetasuma]
AS
SELECT        racd_ca, COUNT(racd_codi) AS suma
FROM            dbo.rackdeta
GROUP BY racd_ca

GO

GO

GO
CREATE VIEW [dbo].[VG_SUMPORTIPO]
AS
SELECT        COUNT(dbo.rackdeta.racd_codi) AS sum, dbo.CamaraMantenedor.Camara, dbo.CamaraMantenedor.TipoPos
FROM            dbo.rackdeta RIGHT OUTER JOIN
                         dbo.CamaraMantenedor ON dbo.rackdeta.racd_ca = dbo.CamaraMantenedor.Camara AND dbo.rackdeta.racd_ba = dbo.CamaraMantenedor.Banda AND 
                         dbo.rackdeta.racd_co = dbo.CamaraMantenedor.Columna
GROUP BY dbo.CamaraMantenedor.Camara, dbo.CamaraMantenedor.TipoPos
HAVING        (dbo.CamaraMantenedor.Camara = N'03')

GO

GO

GO
CREATE VIEW [dbo].[VG_TMPPOS]
AS
SELECT        dbo.TMP_POS.pallet AS PALLET, dbo.TMP_POS.fechareg AS FECHA, dbo.TMP_POS.encargado AS ENCARGADO
FROM            dbo.TMP_POS INNER JOIN
                         dbo.rackdeta ON dbo.TMP_POS.pallet = dbo.rackdeta.racd_codi
WHERE        (dbo.TMP_POS.encargado <> N'ROBERTO SAAVEDRA RIQUELME')

GO

GO

GO
CREATE VIEW [dbo].[VG_TONELADASTUNELES]
AS
SELECT        dbo.fichrece.frec_rutcli AS RUTCLIENTE, dbo.clientes.cli_nomb AS NOMBRECLIENTE, SUM(dbo.fichrece.frec_totsopo) AS SOPORTANTES, 
                         CAST(SUM(dbo.fichrece.frec_totunidad) AS VARCHAR(10)) AS UNIDADES, CAST(SUM(dbo.fichrece.frec_totpeso) AS VARCHAR(10)) AS KILOS, 
                         CAST(SUM(dbo.fichrece.frec_totpeso) / 1000 AS VARCHAR(10)) AS TON
FROM            dbo.fichrece INNER JOIN
                         dbo.clientes ON dbo.fichrece.frec_rutcli = dbo.clientes.cli_rut
WHERE        (dbo.fichrece.frec_RecepTunel = 2)
GROUP BY dbo.fichrece.frec_rutcli, dbo.clientes.cli_nomb, dbo.fichrece.frec_fecrec

GO

GO

GO
CREATE VIEW [dbo].[View_1]
AS
SELECT        COUNT(dbo.detarece.frec_codi1) AS pallets, SUM(dbo.detarece.drec_unidades) AS cajas, SUM(dbo.detarece.drec_peso) AS kilos, dbo.fichrece.frec_codi, 
                         dbo.fichrece.frec_totunidad, dbo.fichrece.frec_totpeso
FROM            dbo.detarece INNER JOIN
                         dbo.fichrece ON dbo.detarece.frec_codi1 = dbo.fichrece.frec_codi
GROUP BY dbo.detarece.frec_codi1, dbo.fichrece.frec_codi, dbo.fichrece.frec_totunidad, dbo.fichrece.frec_totpeso

GO

GO

GO
CREATE VIEW [dbo].[View_3]
AS
SELECT        TOP (100) PERCENT dbo.Pedido_Est.pallet, dbo.Pedido_Est.fecha_reg, dbo.Pedidos_detalle.pedido
FROM            dbo.Pedidos_detalle INNER JOIN
                         dbo.Pedido_Est ON dbo.Pedidos_detalle.pallet = dbo.Pedido_Est.pallet
WHERE        (dbo.Pedidos_detalle.pedido = '20160224163002784836002')
ORDER BY dbo.Pedido_Est.fecha_reg DESC

GO

GO

GO
CREATE VIEW [dbo].[View_4]
AS
SELECT        dbo.rackdeta.racd_unica, dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                         dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, dbo.rackdeta.racd_code, 
                         dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, dbo.rackdeta.racd_pedido_hor, 
                         dbo.rackdeta.racd_fechamov, dbo.rackdeta.racd_horamov, dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.rackdeta.racd_correo, 
                         dbo.rackdeta.racd_picking, dbo.rackdeta.racd_estado, dbo.rackdeta.racd_pred, dbo.clientes.cli_nomb
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut
GROUP BY dbo.rackdeta.racd_unica, dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                         dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, dbo.rackdeta.racd_code, 
                         dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, dbo.rackdeta.racd_pedido_hor, 
                         dbo.rackdeta.racd_fechamov, dbo.rackdeta.racd_horamov, dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.rackdeta.racd_correo, 
                         dbo.rackdeta.racd_picking, dbo.rackdeta.racd_estado, dbo.rackdeta.racd_pred, dbo.clientes.cli_nomb

GO

GO

GO
CREATE VIEW [dbo].[VIEW1]
AS
SELECT     TOP 100 PERCENT ddes_codrece, ddes_codvig, SUM(ddes_pallet) AS pallet, COUNT(ddes_codrece) AS contador
FROM         dbo.detadespa
WHERE     (ddes_rutcli = '79872410K')
GROUP BY ddes_codrece, ddes_codvig
ORDER BY COUNT(ddes_codrece) DESC

GO

GO

GO
CREATE VIEW [dbo].[VIEW1asssaaaa]
AS
SELECT     TOP 100 PERCENT COUNT(rac_codi) AS Expr1, LEFT(rac_codi, 6) AS Expr2
FROM         dbo.rack
WHERE     (rac_camara = 17)
GROUP BY LEFT(rac_codi, 6)
ORDER BY expr2

GO

GO

GO
CREATE VIEW [dbo].[VISTA_NO_PEDIR]
AS
SELECT     dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.DetaReceCajas.caj_codenca, dbo.DetaReceCajas.caj_Est, dbo.DetaReceCajas.caj_TipError, 
                      dbo.DetaReceCajas.caj_ped, dbo.DetaReceCajas.caj_fecha, dbo.DetaReceCajas.caj_Calidad, dbo.DetaReceCajas.caj_Calibre, dbo.DetaReceCajas.caj_felab, 
                      dbo.DetaReceCajas.caj_fvenc, dbo.DetaReceCajas.caj_unid, dbo.DetaReceCajas.caj_Kg, dbo.DetaReceCajas.caj_libras, dbo.DetaReceCajas.caj_producto, 
                      dbo.DetaReceCajas.caj_Id, dbo.DetaReceCajas.caj_lote, dbo.DetaReceCajas.caj_maquilador, dbo.detapedcaja.dpc_estado
FROM         dbo.DetaReceCajas INNER JOIN
                      dbo.rackdeta ON dbo.rackdeta.racd_codi = dbo.DetaReceCajas.caj_Pcod INNER JOIN
                      dbo.detarece ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.detapedcaja ON dbo.DetaReceCajas.caj_cod = dbo.detapedcaja.dpc_codcaja
WHERE     (dbo.DetaReceCajas.caj_ped = 0)

GO

GO

GO
CREATE VIEW [dbo].[vistatrak]
as
SELECT DISTINCT pallet,cajas as Pedidas,caj_cod,isnull(scaj_codcaja,0) cajatraqueada 
FROM pedidos_ficha 
INNER JOIN Pedidos_detalle ON pedidos_ficha.pedido=Pedidos_detalle.pedido
INNER JOIN DetaReceCajas ON Caj_Pcod=pallet
INNER JOIN PEDWEBTMP ON Caj_cod=pwt_codcaja and pwt_codped=1774
LEFT JOIN TMP_SELECCIONCAJAS ON scaj_codcaja=pwt_codcaja
WHERE orden = 1774

GO

GO

GO
CREATE VIEW [dbo].[VMOBILE_CLIENTES]
AS
SELECT     dbo.detarece.drec_codi, dbo.detarece.drec_rutcli, dbo.clientes.cli_nomb
FROM         dbo.detarece INNER JOIN
                      dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[VW_ANDENES]
AS
SELECT        TOP (100) PERCENT dbo.Pedidos_ficha.Orden AS ORDEN, dbo.AndenesReg.fec_reg AS FECHA, dbo.AndenesReg.tip_mov AS MOVIMIENTO
FROM            dbo.Pedidos_ficha INNER JOIN
                         dbo.fichpred ON dbo.Pedidos_ficha.Orden = dbo.fichpred.fpre_nped INNER JOIN
                         dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.fichdespa ON dbo.zCheckList.Cl_fol = dbo.fichdespa.fdes_clfol INNER JOIN
                         dbo.AndenesReg ON dbo.fichdespa.fdes_clfol = dbo.AndenesReg.Folio ON dbo.fichpred.fpre_codi = dbo.fichdespa.fdes_codpred
ORDER BY ORDEN DESC

GO

GO

GO
CREATE VIEW [dbo].[VW_ANDENES_RECE]
AS
SELECT        dbo.zCheckList.Cl_fol AS FOLIO, dbo.AndenesReg.fec_reg AS FECHA, dbo.AndenesReg.tip_mov AS MOVIMIENTO
FROM            dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.fichrece ON dbo.zCheckList.Cl_fol = dbo.fichrece.frec_clfol INNER JOIN
                         dbo.AndenesReg ON dbo.fichrece.frec_clfol = dbo.AndenesReg.Folio

GO

GO

GO
CREATE VIEW [dbo].[VW_CONTRATOS_WEB]
AS
SELECT        dbo.clientes.cli_nomb, dbo.contratos_web.con_rut, dbo.contratos_web.con_pdf, dbo.contratos_web.con_excel, dbo.contratos_web.con_imagen, 
                         dbo.contratos_web.con_estado
FROM            dbo.contratos_web INNER JOIN
                         dbo.clientes ON dbo.contratos_web.con_rut = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[VW_DATOS_SINIESTRO]
AS
SELECT        dbo.detarece.drec_sopocli AS PALLET_CLIENTE, dbo.detarece.drec_codi AS PALLET_PRECISA, dbo.maeprod.mae_descr AS DESCRIPCION_PRODUCTO, 
                         dbo.rackdeta.racd_unidades AS UNIDADES, ROUND(dbo.detarece.drec_peso / dbo.detarece.drec_unidades, 5) AS KILOS_UNIDAD, 
                         ROUND(dbo.detarece.drec_peso / dbo.detarece.drec_unidades * dbo.rackdeta.racd_unidades, 5) AS TOTAL_KILOS, dbo.detarece.drec_fecrec AS FECHA_RECEPCION, 
                         dbo.detarece.frec_codi1 AS GUIA_RECEPCION, dbo.clientes.cli_rut AS RUT_CLIENTE, dbo.clientes.cli_nomb AS NOMBRE_CLIENTE
FROM            dbo.detarece INNER JOIN
                         dbo.clientes ON dbo.detarece.drec_rutcli = dbo.clientes.cli_rut INNER JOIN
                         dbo.maeprod ON dbo.detarece.drec_codpro = dbo.maeprod.mae_codi INNER JOIN
                         dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi
WHERE        (dbo.clientes.cli_nomb <> '0')

GO

GO

GO
CREATE VIEW [dbo].[VW_Detarececajas]
AS
SELECT Caj_Pcod, Caj_cod, caj_codenca, Caj_Est, Caj_TipError, caj_ped, Caj_fecha, Caj_Calidad, Caj_Calibre, Caj_felab, Caj_fvenc, Caj_unid, Caj_Kg, Caj_libras, Caj_producto, Caj_Id, caj_lote, caj_maquilador FROM DetaReceCajas
UNION ALL
SELECT Caj_Pcod, Caj_cod, caj_codenca, Caj_Est, Caj_TipError, caj_ped, Caj_fecha, Caj_Calidad, Caj_Calibre, Caj_felab, Caj_fvenc, Caj_unid, Caj_Kg, Caj_libras, Caj_producto, Caj_Id, caj_lote, caj_maquilador FROM DetarececajasHistorial
GO

GO

GO
CREATE VIEW [dbo].[VW_EMAILS_CLIENTES]
AS
SELECT        cli_nomb AS CLIENTES, REPLACE(REPLACE(cli_mail + ',' + Mail2 + ',' + CLI_CRYD + ',' + CLI_PVENC + ',' + cli_contactos, ',', ';'), ';;', '') AS EMAILS
FROM            dbo.clientes
WHERE        (cli_mail + ',' + Mail2 + ',' + CLI_CRYD + ',' + CLI_PVENC + ',' + cli_contactos <> '') AND 
                         (cli_mail + ',' + Mail2 + ',' + CLI_CRYD + ',' + CLI_PVENC + ',' + cli_contactos LIKE '%@%')

GO

GO

GO
CREATE VIEW [dbo].[VW_FACTURAS]
AS
SELECT        PRECISA_BD.dbo.Facturacion.Fact_Codigo, PRECISA_BD.dbo.Facturacion.Fact_Clirut, PRECISA_BD.dbo.Facturacion.fact_contrato, CONVERT(varchar(10), 
                         PRECISA_BD.dbo.Facturacion.fact_fecini, 103) AS fact_fecini, CONVERT(varchar(10), PRECISA_BD.dbo.Facturacion.fact_fecter, 103) AS fact_fecter, 
                         PRECISA_BD.dbo.Facturacion.fact_neto, PRECISA_BD.dbo.Facturacion.fact_iva, PRECISA_BD.dbo.Facturacion.fact_total, dbo.clientes.cli_unica, dbo.clientes.cli_rut, 
                         dbo.clientes.cli_nomb, dbo.clientes.cli_direcc, dbo.clientes.cli_comuna, dbo.clientes.cli_ciudad, dbo.clientes.cli_fono, dbo.clientes.cli_fax, dbo.clientes.cli_feccre, 
                         dbo.clientes.cli_estado, dbo.clientes.cli_rubro, dbo.clientes.cli_mail, dbo.clientes.Mail2, dbo.clientes.CLI_CRYD, dbo.clientes.CLI_VENC, dbo.clientes.CLI_PVENC, 
                         dbo.clientes.cli_envio, dbo.clientes.cli_diaenv, dbo.clientes.cli_validarfecvenc, dbo.clientes.cli_picking, dbo.clientes.cli_ItemGuia, dbo.clientes.cli_recepciones, 
                         dbo.clientes.cli_despachos, dbo.clientes.cli_facturabloqueo, dbo.clientes.cli_dia, dbo.clientes.cli_codvig, dbo.clientes.cli_estadopedcaja, 
                         PRECISA_BD.dbo.Contratos.Cont_id, PRECISA_BD.dbo.Contratos.Cont_clirut, PRECISA_BD.dbo.Contratos.Cont_codigo, PRECISA_BD.dbo.Contratos.Cont_codigo2, 
                         PRECISA_BD.dbo.Contratos.Cont_nombre, PRECISA_BD.dbo.Contratos.Cont_codigo2 AS Expr1, PRECISA_BD.dbo.Contratos.Cont_Observacion, 
                         PRECISA_BD.dbo.Contratos.cont_custodia, PRECISA_BD.dbo.Contratos.cont_arriendo, PRECISA_BD.dbo.Contratos.cont_pallet, 
                         PRECISA_BD.dbo.Contratos.cont_kilos, PRECISA_BD.dbo.Contratos.cont_fechainicio, PRECISA_BD.dbo.Contratos.cont_CobCod, 
                         PRECISA_BD.dbo.Contratos.Cont_Gracia, PRECISA_BD.dbo.Facturacion.fact_dcto
FROM            PRECISA_BD.dbo.Facturacion INNER JOIN
                         PRECISA_BD.dbo.ClientesActivos AS CA INNER JOIN
                         dbo.clientes ON CA.Cli_rut COLLATE DATABASE_DEFAULT = dbo.clientes.cli_rut COLLATE DATABASE_DEFAULT OR 
                         CA.Cli_Rut2 COLLATE DATABASE_DEFAULT = dbo.clientes.cli_rut COLLATE DATABASE_DEFAULT ON 
                         PRECISA_BD.dbo.Facturacion.Fact_Clirut COLLATE DATABASE_DEFAULT = CA.Cli_rut INNER JOIN
                         PRECISA_BD.dbo.Contratos ON PRECISA_BD.dbo.Facturacion.fact_contrato = PRECISA_BD.dbo.Contratos.Cont_codigo

GO

GO

GO
CREATE VIEW [dbo].[VW_GUIA_SALIDA]
AS
SELECT        dbo.fichpred.fpre_gdespa, dbo.detapedcaja.dpc_numpal, dbo.detapedcaja.dpc_codcaja
FROM            dbo.detapedcaja INNER JOIN
                         dbo.fichpred ON dbo.detapedcaja.dpc_codped = dbo.fichpred.fpre_nped INNER JOIN
                         dbo.fichdespa ON dbo.fichpred.fpre_gdespa = dbo.fichdespa.fdes_codi

GO

GO

GO
CREATE VIEW [dbo].[VW_GUIAS_ENTRADA]
AS
SELECT        TOP (100) PERCENT dbo.fichrece.frec_unica, dbo.fichrece.frec_codi, dbo.fichrece.frec_rutcli, dbo.fichrece.frec_rutproductor, dbo.fichrece.frec_contcli, 
                         dbo.fichrece.frec_horalleg, dbo.fichrece.frec_horarec, dbo.fichrece.frec_horater, dbo.fichrece.frec_turnrec, dbo.fichrece.frec_fecproc, CONVERT(varchar(10), 
                         CAST(dbo.fichrece.frec_fecrec AS date), 103) AS frec_fecrec, dbo.fichrece.frec_fecter, dbo.fichrece.frec_guiades, dbo.fichrece.frec_tipentr, dbo.fichrece.frec_totsopo, 
                         dbo.fichrece.frec_totunidad, dbo.fichrece.frec_totpeso, dbo.fichrece.frec_temppro, dbo.fichrece.frec_rutcond, dbo.fichrece.frec_observ, dbo.fichrece.frec_tipdesc, 
                         dbo.fichrece.frec_codienca, dbo.fichrece.frec_origen, dbo.fichrece.frec_codvig, dbo.fichrece.frec_radio, dbo.fichrece.frec_tipo, dbo.fichrece.frec_RecepTunel, 
                         dbo.fichrece.frec_AspectoSanitario, dbo.fichrece.frec_CondGeneral, dbo.fichrece.frec_procedencia, dbo.fichrece.frec_paso, dbo.fichrece.frec_antecamara, 
                         dbo.fichrece.frec_numSello, dbo.fichrece.frec_termografo, dbo.fichrece.frec_tiporecepcion, dbo.fichrece.frec_observ2, dbo.fichrece.frec_tipoalmacenamiento, 
                         dbo.fichrece.frec_contenedor, dbo.fichrece.frec_patente, dbo.fichrece.frec_almac, dbo.fichrece.frec_empresa, dbo.fichrece.frec_olores, dbo.fichrece.frec_higiene, 
                         dbo.fichrece.frec_estiba, dbo.fichrece.frec_daado, dbo.fichrece.frec_TS, dbo.fichrece.frec_TM, dbo.fichrece.frec_TI, dbo.fichrece.frec_clfol, 
                         dbo.fichrece.frec_Enviada, dbo.fichrece.frec_tablet, dbo.fichrece.frec_traq, dbo.fichrece.frec_emis, dbo.fichrece.frec_packinglist, dbo.fichrece.frec_ntunel, 
                         dbo.fichrece.frec_modificado, dbo.origen.ori_unica, dbo.origen.ori_codi, dbo.origen.ori_descr, dbo.fichrece.frec_fecrec AS frec_fecrec1
FROM            dbo.fichrece INNER JOIN
                         dbo.origen ON dbo.origen.ori_codi = dbo.fichrece.frec_origen
WHERE        (dbo.fichrece.frec_codvig = '0')
ORDER BY frec_fecrec1 DESC

GO

GO

GO
CREATE VIEW [dbo].[VW_GUIAS_SALIDAS]
AS
SELECT DISTINCT 
                         TOP (100) PERCENT CONVERT(varchar(10), CAST(dbo.fichdespa.fdes_fecha AS date), 103) AS fdes_fecha, dbo.fichdespa.fdes_codi, dbo.fichdespa.fdes_GuiaCliente, 
                         dbo.fichdespa.fdes_totsopo, dbo.fichdespa.fdes_totunidad, dbo.fichdespa.fdes_totpeso, dbo.origen.ori_descr, dbo.fichdespa.fdes_rutcli, dbo.detadespa.ddes_contcli,
                          dbo.fichdespa.fdes_fecha AS fdes_fecha1
FROM            dbo.fichdespa INNER JOIN
                         dbo.detadespa ON LEFT(dbo.detadespa.ddes_codi, 7) = dbo.fichdespa.fdes_codi INNER JOIN
                         dbo.origen ON dbo.origen.ori_codi = dbo.fichdespa.fdes_origen
WHERE        (dbo.fichdespa.fdes_codvig = '0')
ORDER BY fdes_fecha1 DESC

GO

GO

GO
CREATE VIEW [dbo].[VW_LLAMADOS_DIARIOS]
AS
SELECT        dbo.llamados_diarios.CODIGO_LLAMADAS, dbo.llamados_diarios.FECHA, dbo.llamados_diarios.CODIGO_FICHA, dbo.llamados_diarios.CONTACTO, 
                         dbo.llamados_diarios.CARGO, dbo.llamados_diarios.TELEFONO, dbo.llamados_diarios.OBSERVACION, dbo.ficha_clientes.NOMBRE_CLIENTE, 
                         dbo.llamados_diarios.ESTADO
FROM            dbo.llamados_diarios INNER JOIN
                         dbo.ficha_clientes ON dbo.llamados_diarios.CODIGO_FICHA = dbo.ficha_clientes.CODIGO

GO

GO

GO
CREATE VIEW [dbo].[VW_PEDIDO_LOTE]
AS
SELECT        TOP (100) PERCENT LTRIM(RTRIM(dbo.rackdeta.LoteCliente)) AS LoteCliente, SUM(dbo.rackdeta.racd_unidades) AS racd_unidades, SUM(dbo.rackdeta.racd_peso) 
                         AS racd_peso, dbo.detarece.drec_rutcli, dbo.detarece.drec_fecrec, COUNT(dbo.rackdeta.racd_codi) AS racd_soportantes, dbo.detarece.drec_contcli
FROM            dbo.rackdeta INNER JOIN
                         dbo.detarece ON dbo.rackdeta.racd_codi = dbo.detarece.drec_codi
GROUP BY dbo.rackdeta.LoteCliente, dbo.detarece.drec_rutcli, dbo.detarece.drec_fecrec, dbo.detarece.drec_contcli, LTRIM(RTRIM(dbo.rackdeta.LoteCliente))
HAVING        (dbo.rackdeta.LoteCliente <> '')
ORDER BY LoteCliente

GO

GO

GO
CREATE VIEW [dbo].[VW_PESAJE_CAJAS]
AS
SELECT        dbo.fichrece.frec_codi AS GUIA, SUM(CAST(REPLACE(Etiquetado.dbo.t_etiquetas.PesoEtiqueta, ',', '.') AS FLOAT)) AS PESO, COUNT(dbo.fichrece.frec_codi) 
                         AS CAJA
FROM            dbo.DetaReceCajas INNER JOIN
                         dbo.detarece ON dbo.DetaReceCajas.caj_Pcod = dbo.detarece.drec_codi INNER JOIN
                         dbo.fichrece ON dbo.detarece.frec_codi1 = dbo.fichrece.frec_codi INNER JOIN
                         Etiquetado.dbo.t_etiquetas ON dbo.DetaReceCajas.caj_cod = Etiquetado.dbo.t_etiquetas.EtiquetaCompleta COLLATE SQL_Latin1_General_CP1_CI_AS
GROUP BY dbo.fichrece.frec_codi

GO

GO

GO
CREATE VIEW [dbo].[VW_RACKDETA_RUT]
AS
SELECT        dbo.fichrece.frec_rutcli, dbo.rackdeta.racd_codi, dbo.rackdeta.racd_ca, dbo.rackdeta.racd_ba, dbo.rackdeta.racd_co, dbo.rackdeta.racd_pi, dbo.rackdeta.racd_ni, 
                         dbo.rackdeta.racd_codpro, dbo.rackdeta.racd_unidades, dbo.rackdeta.racd_peso, dbo.rackdeta.racd_fecpro, dbo.rackdeta.racd_core, dbo.rackdeta.racd_code, 
                         dbo.rackdeta.FechaVencimiento, dbo.rackdeta.LoteCliente, dbo.rackdeta.racd_pedido, dbo.rackdeta.racd_pedido_fec, dbo.rackdeta.racd_pedido_hor, 
                         dbo.rackdeta.racd_fechamov, dbo.rackdeta.racd_horamov, dbo.rackdeta.racd_estadopallet, dbo.rackdeta.racd_solicitado, dbo.rackdeta.racd_correo, 
                         dbo.rackdeta.racd_picking, dbo.rackdeta.racd_estado, dbo.rackdeta.racd_pred, dbo.rackdeta.racd_pedi, dbo.rackdeta.racd_sini
FROM            dbo.detarece INNER JOIN
                         dbo.rackdeta ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                         dbo.fichrece ON dbo.detarece.frec_codi1 = dbo.fichrece.frec_codi

GO

GO

GO
CREATE VIEW [dbo].[VW_RADIO_MOVIMIENTOS]
AS
SELECT        TOP (100) PERCENT dbo.movpallet.mov_fecha, dbo.movpallet.mov_tipo, dbo.movpallet.mov_hora, dbo.Usuarios.usu_rut, dbo.Usuarios.usu_nombre, 
                         dbo.camaras.cam_descr, dbo.movpallet.mov_ba, dbo.movpallet.mov_co, dbo.movpallet.mov_pi, dbo.movpallet.mov_ni, dbo.movpallet.mov_folio, 
                         dbo.movpallet.mov_codper
FROM            dbo.movpallet INNER JOIN
                         dbo.Usuarios ON dbo.movpallet.mov_codper = dbo.Usuarios.usu_codigo INNER JOIN
                         dbo.camaras ON dbo.movpallet.mov_ca = dbo.camaras.cam_codi
ORDER BY dbo.Usuarios.usu_nombre DESC

GO

GO

GO
CREATE VIEW [dbo].[VW_RECLAMOS]
AS
SELECT        dbo.reclamos.CODIGO, dbo.reclamos.NOMBRE, dbo.reclamos.EMAIL, dbo.reclamos.COMENTARIO, CONVERT(char(10), dbo.reclamos.FECHA_INGRESO, 103) 
                         AS FECHA_INGRESO, CONVERT(char(10), dbo.reclamos.FECHA_APERTURA, 103) AS FECHA_APERTURA, CONVERT(char(10), dbo.reclamos.FECHA_CIERRE, 103) 
                         AS FECHA_CIERRE, dbo.reclamos.ARCHIVO, dbo.reclamos.ESTADO_PROCESO, dbo.reclamos.ESTADO_ACTUALIZACION, dbo.reclamos.ESTADO, 
                         dbo.reclamos.RUTCLIENTE, dbo.reclamos.USUARIO, dbo.clientes.cli_nomb AS NOMBRE_CLIENTE
FROM            dbo.reclamos INNER JOIN
                         dbo.clientes ON dbo.reclamos.RUTCLIENTE = dbo.clientes.cli_rut

GO

GO

GO
CREATE VIEW [dbo].[VW_RECLAMOS_MENSAJES]
AS
SELECT        CODIGO, CODIGO_RECLAMO, USUARIO, TIPO, MENSAJE, CONVERT(char(10), FECHA_INGRESO, 103) AS FECHA_INGRESO, RIGHT(CONVERT(DATETIME, 
                         FECHA_INGRESO, 108), 8) AS HORA_INGRESO, ESTADO
FROM            dbo.reclamos_mensajes

GO

GO

GO
CREATE VIEW [dbo].[VW_RECORDATORIO]
AS
SELECT        dbo.recordatorios.CODIGO_RECORDATORIO, dbo.recordatorios.TITULO_REC, dbo.recordatorios.FECHA_REC, dbo.recordatorios.HORA_REC, 
                         dbo.recordatorios.DESCRIPCION_REC, dbo.recordatorios.USUARIO_INGRESO, dbo.recordatorios.FECHA_INGRESO, dbo.recordatorios.USUARIO_MODIFICO, 
                         dbo.recordatorios.FECHA_MODIFICACION, dbo.recordatorios.ESTADO_REC, dbo.ficha_clientes.NOMBRE_CLIENTE
FROM            dbo.ficha_clientes INNER JOIN
                         dbo.recordatorios ON dbo.ficha_clientes.CODIGO = dbo.recordatorios.CODIGO_FICHA

GO

GO

GO
CREATE VIEW [dbo].[VW_TIEMPOS_ATENCION_DESPACHO]
AS
SELECT        dbo.Pedidos_ficha.Orden, dbo.zCheckList.Cl_fec AS FECHA_PEDIDO, dbo.clientes.cli_nomb AS CLIENTE, CONVERT(varchar(8), dbo.zCheckList.Cl_Lleg, 108) 
                         AS HORA_LLEGADA, CONVERT(varchar(8), dbo.zCheckList.Cl_ing, 108) AS HORA_INGRESO, dbo.Pedidos_ficha.hora AS HORA_PEDIDO, CONVERT(varchar(8), 
                         dbo.AndenesReg.fec_reg, 108) AS HORA_APERTURA, CONVERT(varchar(8), dbo.zCheckList.Cl_Des, 108) AS HORA_DESPACHO, 
                         dbo.fichdespa.fdes_observ AS OBSERVACION, dbo.zCheckList.Cl_fol AS FOLIO_INGRESO, dbo.clientes.cli_rut AS RUT_CLIENTE, 
                         dbo.fichdespa.fdes_totsopo AS SOPORTANTES, dbo.fichdespa.fdes_codi AS FOLIO_DESPACHO, dbo.fichdespa.fdes_tipcarga AS CARGA
FROM            dbo.Pedidos_ficha INNER JOIN
                         dbo.fichpred ON dbo.Pedidos_ficha.Orden = dbo.fichpred.fpre_nped INNER JOIN
                         dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.fichdespa ON dbo.zCheckList.Cl_fol = dbo.fichdespa.fdes_clfol INNER JOIN
                         dbo.AndenesReg ON dbo.fichdespa.fdes_clfol = dbo.AndenesReg.Folio ON dbo.fichpred.fpre_codi = dbo.fichdespa.fdes_codpred
WHERE        (dbo.AndenesReg.tip_mov = 'APERTURA')

GO

GO

GO
CREATE VIEW [dbo].[VW_TIEMPOS_ATENCION_DESPACHO_CIERRE]
AS
SELECT        dbo.Pedidos_ficha.Orden AS ORDEN, CONVERT(varchar(8), dbo.AndenesReg.fec_reg, 108) AS HORA_CIERRE
FROM            dbo.Pedidos_ficha INNER JOIN
                         dbo.fichpred ON dbo.Pedidos_ficha.Orden = dbo.fichpred.fpre_nped INNER JOIN
                         dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.fichdespa ON dbo.zCheckList.Cl_fol = dbo.fichdespa.fdes_clfol INNER JOIN
                         dbo.AndenesReg ON dbo.fichdespa.fdes_clfol = dbo.AndenesReg.Folio ON dbo.fichpred.fpre_codi = dbo.fichdespa.fdes_codpred
WHERE        (dbo.AndenesReg.tip_mov = 'CIERRE')

GO

GO

GO
CREATE VIEW [dbo].[VW_TIEMPOS_ATENCION_RECEPCION_CIERRE]
AS
SELECT        dbo.AndenesReg.Folio AS FOLIO, CONVERT(varchar(8), dbo.AndenesReg.fec_reg, 108) AS HORA_CIERRE
FROM            dbo.zCheckList INNER JOIN
                         dbo.clientes ON dbo.zCheckList.Cl_RutCli = dbo.clientes.cli_rut INNER JOIN
                         dbo.fichrece ON dbo.zCheckList.Cl_fol = dbo.fichrece.frec_clfol INNER JOIN
                         dbo.AndenesReg ON dbo.fichrece.frec_clfol = dbo.AndenesReg.Folio
WHERE        (dbo.AndenesReg.tip_mov = 'CIERRE')

GO

GO

GO
CREATE VIEW [dbo].[VW_VAS_FACTURA]
AS
SELECT        dbo.FacVas.Vas_Clirut, dbo.FacVas.Vas_Cont, dbo.FacVas.Vas_guia, dbo.FacVas.Vas_Dcto, dbo.FacVas.Vas_fecha, dbo.FacVasDeta.Dvas_ServCod, 
                         dbo.FacVasDeta.Dvas_Est, dbo.FacVasDeta.Dvas_Unid, dbo.FacVasDeta.Dvas_Cajas, dbo.FacVasDeta.Dvas_Kilos, dbo.FacServicios.Serv_Nom
FROM            dbo.FacVas INNER JOIN
                         dbo.FacVasDeta ON dbo.FacVas.Vas_cod = dbo.FacVasDeta.Dvas_VasCod INNER JOIN
                         dbo.FacServicios ON dbo.FacVasDeta.Dvas_ServCod = dbo.FacServicios.Serv_Cod

GO

GO

GO
CREATE VIEW [dbo].[vwcanttraqueo]
AS
SELECT caj_pcod,SUM(1) unidades FROM DetaReceCajas GROUP by caj_pcod 
GO

GO

GO
CREATE VIEW [dbo].[vwebclieconstock]
AS
	SELECT cli_nomb as nombre,cli_rut as codclie
	FROM rackdeta INNER JOIN (maeprod INNER JOIN clientes on mae_clirut=cli_rut) on  racd_codpro=mae_codi
	GROUP BY cli_nomb,cli_rut;
GO

GO

GO
CREATE VIEW [dbo].[vwebcontrato]
AS
	SELECT cont_codi as codcontrato, cont_descr as glosa,
	cont_feccont as fcontrato,cont_fecexpi as fexpiracion,
	cont_diafact as dfact,cont_rutclie as rutclie
	FROM contrato;	
GO

GO

GO
CREATE VIEW [dbo].[vwebproductos]
AS
SELECT mae_descr as producto,mae_codi as codprod,
mae_clirut as rutclie,mae_codcli as codclie,mae_codvig as vigencia
 FROM maeprod INNER JOIN rackdeta on mae_codi=racd_codpro
 GROUP BY mae_descr,mae_codi,mae_clirut ,mae_codcli ,mae_codvig;
GO

GO

GO
CREATE VIEW [dbo].[vwebusuarios]
AS
	SELECT estado,rutclie,pass, webusuarios.pedido,pedidoe, fechahora,tipo,cli_nomb as cliente
FROM webusuarios INNER JOIN clientes ON cli_rut=rutclie;
GO

GO

GO
CREATE VIEW [dbo].[WEB_CONSULTACLIENTE]
AS
SELECT     dbo.DetaReceCajas.caj_Pcod, dbo.DetaReceCajas.caj_cod, dbo.detarece.drec_rutcli, dbo.clientes.cli_nomb
FROM         dbo.DetaReceCajas INNER JOIN
                      dbo.rackdeta ON dbo.rackdeta.racd_codi = dbo.DetaReceCajas.caj_Pcod INNER JOIN
                      dbo.detarece ON dbo.detarece.drec_codi = dbo.rackdeta.racd_codi INNER JOIN
                      dbo.clientes ON dbo.clientes.cli_rut = dbo.detarece.drec_rutcli

GO
ALTER TABLE [dbo].[correlat_saltoTMP] ADD  CONSTRAINT [DF_correlat_saltoTMP_tmps_unica]  DEFAULT (newid()) FOR [tmps_unica]
GO
ALTER TABLE [dbo].[detarececajasrespaldo] ADD  CONSTRAINT [DF_detarececajasrespaldo_caj_ped]  DEFAULT ((0)) FOR [caj_ped]
GO
ALTER TABLE [dbo].[detarececajasrespaldo] ADD  CONSTRAINT [DF_detarececajasrespaldo_caj_fecha]  DEFAULT (getdate()) FOR [caj_fecha]
GO
ALTER TABLE [dbo].[detcaja] ADD  CONSTRAINT [DF_detcaja_detc_unica]  DEFAULT (newid()) FOR [detc_unica]
GO
ALTER TABLE [dbo].[facturacion] ADD  CONSTRAINT [DF_facturacion_fac_unica]  DEFAULT (newid()) FOR [fac_unica]
GO
ALTER TABLE [dbo].[PedidosWebok] ADD  CONSTRAINT [DF_PedidosWebok_Ped_Tipo]  DEFAULT (0) FOR [Ped_Tipo]
GO
ALTER TABLE [dbo].[PedidosWebok] ADD  CONSTRAINT [DF_PedidosWebok_Ped_Picking]  DEFAULT (N' ') FOR [Ped_Picking]
GO
ALTER TABLE [dbo].[PedidosWebok] ADD  CONSTRAINT [DF_PedidosWebok_Ped_ok]  DEFAULT ('0') FOR [Ped_ok]
GO
ALTER TABLE [dbo].[PEDIDOSWEBOK_ANULACION] ADD  CONSTRAINT [DF_PEDIDOSWEBOK_ANULACION_ped_estado]  DEFAULT ('0') FOR [ped_estado]
GO
ALTER TABLE [dbo].[picking] ADD  CONSTRAINT [DF_picking_CANTIDAD]  DEFAULT (0) FOR [CANTIDAD]
GO
ALTER TABLE [dbo].[picking] ADD  CONSTRAINT [DF_picking_PESO]  DEFAULT (0) FOR [PESO]
GO
ALTER TABLE [dbo].[picking] ADD  CONSTRAINT [DF_picking_PALLET]  DEFAULT (0) FOR [PALLET]
GO
ALTER TABLE [dbo].[pisodeta] ADD  CONSTRAINT [DF_pisodeta_pisd_unica]  DEFAULT (newid()) FOR [pisd_unica]
GO
ALTER TABLE [dbo].[preferen] ADD  CONSTRAINT [DF_preferen_pref_unica]  DEFAULT (newid()) FOR [pref_unica]
GO
ALTER TABLE [dbo].[procesos_estaticos] ADD  CONSTRAINT [DF_procesos_estaticos_estado]  DEFAULT (0) FOR [estado]
GO
ALTER TABLE [dbo].[procesos_puchos_temporal] ADD  CONSTRAINT [DF_procesos_puchos_temporal_peso]  DEFAULT (0) FOR [peso]
GO
ALTER TABLE [dbo].[rutaprod] ADD  CONSTRAINT [DF_rutaprod_rutp_unica]  DEFAULT (newid()) FOR [rutp_unica]
GO
ALTER TABLE [dbo].[servicios_detalledespacho] ADD  CONSTRAINT [DF_servicios_detalledespacho_estado]  DEFAULT (0) FOR [estado]
GO
ALTER TABLE [dbo].[servicios_detallerecepcion] ADD  CONSTRAINT [DF_servicios_detallerecepcion_estado]  DEFAULT (0) FOR [estado]
GO
ALTER TABLE [dbo].[servicios_fichaDespacho] ADD  CONSTRAINT [DF_servicios_fichaDespacho_estado]  DEFAULT (0) FOR [estado]
GO
ALTER TABLE [dbo].[servicios_ficharecepcion] ADD  CONSTRAINT [DF_servicios_ficharecepcion_estado]  DEFAULT (0) FOR [estado]
GO
ALTER TABLE [dbo].[slotdeta] ADD  CONSTRAINT [DF_slotdeta_slod_unica]  DEFAULT (newid()) FOR [slod_unica]
GO
ALTER TABLE [dbo].[Stockini] ADD  CONSTRAINT [DF_Stockini_sto_unica]  DEFAULT (newid()) FOR [sto_unica]
GO
ALTER TABLE [dbo].[TMP_PRN_ETQ] ADD  CONSTRAINT [DF_TMP_PRN_ETQ_prn]  DEFAULT ((1)) FOR [prn]
GO
ALTER TABLE [dbo].[TMP_PRN_ETQ] ADD  CONSTRAINT [DF_TMP_PRN_ETQ_temp]  DEFAULT ((0)) FOR [temp]
GO
ALTER TABLE [dbo].[TMPDETAPRED] ADD  CONSTRAINT [DF_TMPDETAPRED_dpre_Ptr_1]  DEFAULT ((0)) FOR [dpre_Ptr]
GO
ALTER TABLE [dbo].[TMPDETAPRED] ADD  CONSTRAINT [DF_TMPDETAPRED_dpre_Pick_1]  DEFAULT ((0)) FOR [dpre_Pick]
GO
ALTER TABLE [dbo].[TMPDETAPRED] ADD  CONSTRAINT [DF_TMPDETAPRED_dpre_ActUni]  DEFAULT ((0)) FOR [dpre_ActUni]
GO
ALTER TABLE [dbo].[TMPDETAPRED] ADD  CONSTRAINT [DF_TMPDETAPRED_dpre_TotUni]  DEFAULT ((0)) FOR [dpre_TotUni]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_codpro]  DEFAULT ('') FOR [drec_codpro]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_origen]  DEFAULT ('') FOR [drec_origen]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_codsopo]  DEFAULT ('') FOR [drec_codsopo]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_sopocli]  DEFAULT ('') FOR [drec_sopocli]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_unidades]  DEFAULT ((0)) FOR [drec_unidades]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_peso]  DEFAULT ((0)) FOR [drec_peso]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_fecrec]  DEFAULT ('') FOR [drec_fecrec]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_rutcli]  DEFAULT ('') FOR [drec_rutcli]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF__TMPDETARE__drec___78B3EFCA]  DEFAULT ('') FOR [drec_rutproductor]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_contcli]  DEFAULT (N'''') FOR [drec_contcli]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_fecprod]  DEFAULT ('') FOR [drec_fecprod]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_camara]  DEFAULT ('') FOR [drec_camara]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_banda]  DEFAULT ('') FOR [drec_banda]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_colum]  DEFAULT ('') FOR [drec_colum]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_piso]  DEFAULT ('') FOR [drec_piso]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_nivel]  DEFAULT ('') FOR [drec_nivel]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_almacen]  DEFAULT ((0)) FOR [drec_almacen]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_dcaja]  DEFAULT ((0)) FOR [drec_dcaja]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_tunel]  DEFAULT ((0)) FOR [drec_tunel]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_codvig]  DEFAULT ('') FOR [drec_codvig]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_codrel]  DEFAULT ('') FOR [drec_codrel]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_nrosopo]  DEFAULT ((0)) FOR [drec_nrosopo]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_slot]  DEFAULT ('') FOR [drec_slot]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_dtgracia]  DEFAULT ('') FOR [drec_dtgracia]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_codsag]  DEFAULT ('') FOR [drec_codsag]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF__TMPDETARE__drec___79A81403]  DEFAULT ((0)) FOR [drec_tipo]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_FechaVencimiento]  DEFAULT ('') FOR [FechaVencimiento]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_LoteCliente]  DEFAULT ('') FOR [LoteCliente]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_codper]  DEFAULT ('') FOR [drec_codper]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_hora]  DEFAULT ('') FOR [drec_hora]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_FecHomo]  DEFAULT ('') FOR [drec_FecHomo]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_HorHomo]  DEFAULT ('') FOR [drec_HorHomo]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_estado]  DEFAULT ('') FOR [drec_estado]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_ocup]  DEFAULT ((0)) FOR [drec_ocup]
GO
ALTER TABLE [dbo].[TMPDETARECE] ADD  CONSTRAINT [DF_TMPDETARECE_drec_arriendo]  DEFAULT ((0)) FOR [drec_arriendo]
GO
ALTER TABLE [dbo].[TMPDETCAJAS] ADD  CONSTRAINT [DF_TMPDETCAJAS_detc_fprod]  DEFAULT ('') FOR [detc_fprod]
GO
ALTER TABLE [dbo].[TMPDETCAJAS] ADD  CONSTRAINT [DF_TMPDETCAJAS_detc_fvenc]  DEFAULT ('') FOR [detc_fvenc]
GO
ALTER TABLE [dbo].[TMPDETCAJAS] ADD  CONSTRAINT [DF_TMPDETCAJAS_detc_cantidad]  DEFAULT ('') FOR [detc_cantidad]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_rutcli]  DEFAULT ('') FOR [frec_rutcli]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_rutproductor]  DEFAULT ('') FOR [frec_rutproductor]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_contcli]  DEFAULT ('') FOR [frec_contcli]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_horalleg]  DEFAULT ('') FOR [frec_horalleg]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_horarec]  DEFAULT ('') FOR [frec_horarec]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_horater]  DEFAULT ('') FOR [frec_horater]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_turnrec]  DEFAULT ('') FOR [frec_turnrec]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_fecproc]  DEFAULT ('') FOR [frec_fecproc]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_fecrec]  DEFAULT ('') FOR [frec_fecrec]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_guiades]  DEFAULT ('') FOR [frec_guiades]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_tipentr]  DEFAULT ('') FOR [frec_tipentr]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_totsopo]  DEFAULT ((0)) FOR [frec_totsopo]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_totunidad]  DEFAULT ((0)) FOR [frec_totunidad]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_totpeso]  DEFAULT ((0)) FOR [frec_totpeso]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_rutcond]  DEFAULT ('') FOR [frec_rutcond]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_observ]  DEFAULT ('') FOR [frec_observ]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_tipdesc]  DEFAULT ('') FOR [frec_tipdesc]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_codienca]  DEFAULT ('') FOR [frec_codienca]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_origen]  DEFAULT ('') FOR [frec_origen]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_codvig]  DEFAULT ('') FOR [frec_codvig]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_radio]  DEFAULT ('') FOR [frec_radio]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF__TMPFICHRE__frec___76CBA758]  DEFAULT ((0)) FOR [frec_tipo]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_AspectoSanitario]  DEFAULT ('') FOR [frec_AspectoSanitario]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_procedencia]  DEFAULT ('') FOR [frec_procedencia]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_Estado]  DEFAULT ((0)) FOR [Est_Codi]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_FecCre]  DEFAULT (getdate()) FOR [frec_FecCre]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_UsuCre_1]  DEFAULT ('') FOR [frec_UsuCre]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_FecMod_1]  DEFAULT (getdate()) FOR [frec_FecMod]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_abierto]  DEFAULT ((0)) FOR [frec_abierto]
GO
ALTER TABLE [dbo].[TMPFICHRECE] ADD  CONSTRAINT [DF_TMPFICHRECE_frec_tablet]  DEFAULT ((0)) FOR [frec_tablet]
GO
ALTER TABLE [dbo].[TRACKEOCAJAS] ADD  CONSTRAINT [DF_TRACKEOCAJAS_TRACK_CAJA]  DEFAULT (1) FOR [TRACK_CAJA]
GO
ALTER TABLE [dbo].[xrelacion] ADD  CONSTRAINT [DF_xrelacion_unica]  DEFAULT (newid()) FOR [unica]
GO
ALTER TABLE [dbo].[yrelacion] ADD  CONSTRAINT [DF_yrelacion_yunica]  DEFAULT (newid()) FOR [yunica]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_clientes] FOREIGN KEY([cont_rutclie])
REFERENCES [dbo].[clientes] ([cli_rut])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_clientes]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_P_EstadoContrato] FOREIGN KEY([cont_estado])
REFERENCES [dbo].[P_EstadoContrato] ([econt_codi])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_P_EstadoContrato]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_P_EstadoFacturacion] FOREIGN KEY([cont_bloqfac])
REFERENCES [dbo].[P_EstadoFacturacion] ([tfac_codi])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_P_EstadoFacturacion]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_P_EstadoIngreso1] FOREIGN KEY([cont_BloqImp])
REFERENCES [dbo].[P_EstadoIngreso] ([eing_codi])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_P_EstadoIngreso1]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_P_TipoLectura1] FOREIGN KEY([cont_lectura])
REFERENCES [dbo].[P_TipoLectura] ([tlec_codi])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_P_TipoLectura1]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_P_TipoNumerales] FOREIGN KEY([cont_TipAlmc])
REFERENCES [dbo].[P_TipoNumerales] ([tnum_codi])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_P_TipoNumerales]
GO
ALTER TABLE [dbo].[contrato]  WITH CHECK ADD  CONSTRAINT [FK_contrato_P_TipoSeguros] FOREIGN KEY([cont_tipseg])
REFERENCES [dbo].[P_TipoSeguros] ([tseg_codi])
GO
ALTER TABLE [dbo].[contrato] CHECK CONSTRAINT [FK_contrato_P_TipoSeguros]
GO
ALTER TABLE [dbo].[ContratosDetalle]  WITH CHECK ADD  CONSTRAINT [FK_ContratosDetalle_contrato] FOREIGN KEY([Dcon_Codigo])
REFERENCES [dbo].[contrato] ([cont_codi])
GO
ALTER TABLE [dbo].[ContratosDetalle] CHECK CONSTRAINT [FK_ContratosDetalle_contrato]
GO
ALTER TABLE [dbo].[ContratosDetalle]  WITH CHECK ADD  CONSTRAINT [FK_ContratosDetalle_FacServicios] FOREIGN KEY([Dcon_ServCod])
REFERENCES [dbo].[FacServicios] ([Serv_Cod])
GO
ALTER TABLE [dbo].[ContratosDetalle] CHECK CONSTRAINT [FK_ContratosDetalle_FacServicios]
GO
ALTER TABLE [dbo].[ContratosDetalle]  WITH CHECK ADD  CONSTRAINT [FK_ContratosDetalle_medidas] FOREIGN KEY([Dcon_Medida])
REFERENCES [dbo].[medidas] ([med_codi])
GO
ALTER TABLE [dbo].[ContratosDetalle] CHECK CONSTRAINT [FK_ContratosDetalle_medidas]
GO
ALTER TABLE [dbo].[ContratosDetalle]  WITH CHECK ADD  CONSTRAINT [FK_ContratosDetalle_monedas] FOREIGN KEY([Dcon_Moneda])
REFERENCES [dbo].[monedas] ([mon_codi])
GO
ALTER TABLE [dbo].[ContratosDetalle] CHECK CONSTRAINT [FK_ContratosDetalle_monedas]
GO
ALTER TABLE [dbo].[ContratosHorarios]  WITH CHECK ADD  CONSTRAINT [FK_ContratosHorarios_contrato] FOREIGN KEY([Hor_ContCod])
REFERENCES [dbo].[contrato] ([cont_codi])
GO
ALTER TABLE [dbo].[ContratosHorarios] CHECK CONSTRAINT [FK_ContratosHorarios_contrato]
GO
ALTER TABLE [dbo].[CotizacionesDetalle]  WITH CHECK ADD  CONSTRAINT [FK_CotizacionesDetalle_Cotizaciones] FOREIGN KEY([Dcot_Codigo])
REFERENCES [dbo].[Cotizaciones] ([coti_codi])
GO
ALTER TABLE [dbo].[CotizacionesDetalle] CHECK CONSTRAINT [FK_CotizacionesDetalle_Cotizaciones]
GO
ALTER TABLE [dbo].[CotizacionesDetalle]  WITH CHECK ADD  CONSTRAINT [FK_CotizacionesDetalle_FacServicios] FOREIGN KEY([Dcot_ServCod])
REFERENCES [dbo].[FacServicios] ([Serv_Cod])
GO
ALTER TABLE [dbo].[CotizacionesDetalle] CHECK CONSTRAINT [FK_CotizacionesDetalle_FacServicios]
GO
ALTER TABLE [dbo].[CotizacionesDetalleEscalas]  WITH CHECK ADD  CONSTRAINT [FK_CotizacionesDetalleEscalas_Cotizaciones] FOREIGN KEY([esc_coti])
REFERENCES [dbo].[Cotizaciones] ([coti_codi])
GO
ALTER TABLE [dbo].[CotizacionesDetalleEscalas] CHECK CONSTRAINT [FK_CotizacionesDetalleEscalas_Cotizaciones]
GO
ALTER TABLE [dbo].[CotizacionesDetalleEscalas]  WITH CHECK ADD  CONSTRAINT [FK_CotizacionesDetalleEscalas_FacServicios] FOREIGN KEY([esc_serser])
REFERENCES [dbo].[FacServicios] ([Serv_Cod])
GO
ALTER TABLE [dbo].[CotizacionesDetalleEscalas] CHECK CONSTRAINT [FK_CotizacionesDetalleEscalas_FacServicios]
GO
ALTER TABLE [dbo].[CotizacionesHorarios]  WITH CHECK ADD  CONSTRAINT [FK_CotizacionesHorarios_Cotizaciones] FOREIGN KEY([Hor_CotiCod])
REFERENCES [dbo].[Cotizaciones] ([coti_codi])
GO
ALTER TABLE [dbo].[CotizacionesHorarios] CHECK CONSTRAINT [FK_CotizacionesHorarios_Cotizaciones]
GO
ALTER TABLE [dbo].[escala]  WITH CHECK ADD  CONSTRAINT [FK_escala_contrato] FOREIGN KEY([esc_contr])
REFERENCES [dbo].[contrato] ([cont_codi])
GO
ALTER TABLE [dbo].[escala] CHECK CONSTRAINT [FK_escala_contrato]
GO
ALTER TABLE [dbo].[escala]  WITH CHECK ADD  CONSTRAINT [FK_escala_FacServicios] FOREIGN KEY([esc_servi])
REFERENCES [dbo].[FacServicios] ([Serv_Cod])
GO
ALTER TABLE [dbo].[escala] CHECK CONSTRAINT [FK_escala_FacServicios]
GO
ALTER TABLE [dbo].[FacServicios]  WITH CHECK ADD  CONSTRAINT [FK_FacServicios_medidas] FOREIGN KEY([Serv_MedPred])
REFERENCES [dbo].[medidas] ([med_codi])
GO
ALTER TABLE [dbo].[FacServicios] CHECK CONSTRAINT [FK_FacServicios_medidas]
GO
ALTER TABLE [dbo].[FacServicios]  WITH CHECK ADD  CONSTRAINT [FK_FacServicios_monedas] FOREIGN KEY([Serv_MonPred])
REFERENCES [dbo].[monedas] ([mon_codi])
GO
ALTER TABLE [dbo].[FacServicios] CHECK CONSTRAINT [FK_FacServicios_monedas]
GO
ALTER TABLE [dbo].[TMPDETSERVICIOS]  WITH CHECK ADD  CONSTRAINT [FK_TMPDETSERV_MINTUNEL_TMPCABSERV_MINTUNEL] FOREIGN KEY([IDENT], [CONTRATO])
REFERENCES [dbo].[TMPCABSERVICIOS] ([IDENT], [CONTRATO])
GO
ALTER TABLE [dbo].[TMPDETSERVICIOS] CHECK CONSTRAINT [FK_TMPDETSERV_MINTUNEL_TMPCABSERV_MINTUNEL]
GO
ALTER TABLE [dbo].[TMPFICHRECE]  WITH NOCHECK ADD  CONSTRAINT [FK_TMPFICHRECE_TMPCHOFERES] FOREIGN KEY([frec_codi])
REFERENCES [dbo].[TMPCHOFERES] ([frec_codi])
GO
ALTER TABLE [dbo].[TMPFICHRECE] NOCHECK CONSTRAINT [FK_TMPFICHRECE_TMPCHOFERES]
GO
ALTER TABLE [dbo].[TMPFICHRECE]  WITH CHECK ADD  CONSTRAINT [FK_TMPFICHRECE_TMPESTADOS] FOREIGN KEY([Est_Codi])
REFERENCES [dbo].[TMPESTADOS] ([Est_Codi])
GO
ALTER TABLE [dbo].[TMPFICHRECE] CHECK CONSTRAINT [FK_TMPFICHRECE_TMPESTADOS]
GO


INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'efa7ebd9-3af1-4aef-b262-e85dbf71d59f', N'006', N'GUIA RECEPCION', 1, 9999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'e402196e-b192-4fea-9645-66e3ca3f54ca', N'007', N'GUIA PRE DESPACHO', 1, 9999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'408c66bb-032c-485a-9390-46ac85704d6a', N'008', N'GUIA DESPACHO 26564', 1, 9999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'00153d30-2de0-439f-ac45-ebf84663b69d', N'009', N'GUIA MOVIMIENTO INTERNO', 1, 9999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'5a124b25-8856-44ba-b77a-4b8dbdb1724e', N'001', N'OTROS', 1, 10, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'1bc04fc9-93e3-43cc-9c7c-0758c7cef5ab', N'005', N'GUIA RECEPCION PICKING', 1, 20000, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'3c68d82f-7dbb-49e6-ab26-8fadc1f3758a', N'010', N'PROCESOS', 0, 9999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'5faecabf-508a-4606-88e2-813518087e77', N'099', N'CREAR USUARIOS', 1, 999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'5210dce7-2363-455e-af7e-0685e78ae042', N'100', N'CHECK LIST', 1, 9999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'c663fc2e-48d0-43f7-84fe-dd6808e7ea23', N'002', N'CATEGORIA DE PERFILES', 1, 999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'79277c0d-d314-4b26-9dca-6fa1a7422370', N'003', N'SUB - CATEGORIAS DE PERFILES', 1, 999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'e91d7844-0604-4393-b9c1-303332f748e5', N'004', N'INGRESO DE USUARIOS', 1, 999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'0655f887-018b-43be-acdd-43e2b148eba2', N'011', N'SERVICIOS (FACTURACION)', 1, 999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'1f393d06-f80c-4885-9fae-db9cfce0ca58', N'012', N'COBROS VAS ', 1, 999999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'26215137-1288-43be-8197-3fe79cbbf347', N'013', N'PROCESO -  DESBLOQUEO INPORTACIONES', 1, 9999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'b14eec7a-9503-42c1-9aeb-7822323a5a71', N'014', N'PROCESO - ETIQUETADO', 1, 99999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'4ad75e7e-62f9-47fa-b3fc-15411f1d1a8a', N'015', N'CORRELATIVO CAJAS S/LEER', 1, 99999, 1, 0)
INSERT [dbo].[correlat] ([cor_unica], [cor_codi], [cor_descr], [cor_correini], [cor_correfin], [cor_correact], [cor_codact]) VALUES (N'02059285-367f-46ec-a7e7-f9cb33e99ca8', N'016', N'MANTENEDOR DE COTIZACIONES', 1, 10000, 1, 0)
INSERT [dbo].[documento] ([doc_unica], [doc_codi], [doc_descr]) VALUES (N'958b7852-91b0-476b-860a-e61c38f91abf', N'06', N'GUIA RECEPCION')
INSERT [dbo].[documento] ([doc_unica], [doc_codi], [doc_descr]) VALUES (N'646047e1-c7b8-4f76-aa79-06668e201fbb', N'07', N'GUIA PRE DESPACHO')
INSERT [dbo].[documento] ([doc_unica], [doc_codi], [doc_descr]) VALUES (N'0b4309b9-8471-4422-a36f-5f887424c952', N'08', N'GUIA DESPACHO')
INSERT [dbo].[documento] ([doc_unica], [doc_codi], [doc_descr]) VALUES (N'342094e1-7252-4384-8e19-53359ef4b985', N'09', N'GUIA MOVIMIENTO INTERNO')
INSERT [dbo].[documento] ([doc_unica], [doc_codi], [doc_descr]) VALUES (N'ba0de0c3-6a36-4e61-8540-dc8b3104b23b', N'01', N'OTROS')
SET IDENTITY_INSERT [dbo].[informes] ON 

INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (1, N'Informe de Recepcin, Despacho y ChekList', N'Externo', N'Habilitado', N'')
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (3, N'Informe de Documentos Emitidos', N'Interno', N'Habilitado', N'')
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (4, N'Informe de Pedidos WEB', N'Externo', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (5, N'Informe de  Vencidos', N'Externo', N'Habilitado', N'')
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (7, N'Informe de Pedidos Pre.', N'Externo', N'Habilitado', N'')
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (10, N'Informe de Posiciones en Camara', N'Interno', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (11, N'Informe semanal de Preparacin de Pedidos', N'Interno', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (12, N'Informe de Pedidor por Horas', N'Interno', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (13, N'Informe de Movimiento de Soportantes por Usuario', N'Interno', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (14, N'Informe de Procesos Sin Finalizar', N'Interno', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (15, N'Informe de Servicios Extraordinarios', N'Interno', N'Habilitado', NULL)
INSERT [dbo].[informes] ([inf_cod], [inf_nom], [inf_emp], [inf_est], [inf_copia]) VALUES (16, N'Informe de Temperaturas Osaka', N'Interno', N'Habilitado', N'')
SET IDENTITY_INSERT [dbo].[informes] OFF
INSERT [dbo].[Mae_Bodega] ([Cod_Bodega], [Des_Bodega], [Tipo], [Dir_Bodega], [Rut_Bodega], [Razon_Social], [contacto]) VALUES (N'1', N'PRECISA FROZEN STORAGE & SERVICES LTDA', N'FRIGORIFICO', N'LONG. SUR 95.5', CAST(774486305 AS Numeric(18, 0)), N'PRECISA FROZEN STORAGE & SERVICES LTDA', NULL)
INSERT [dbo].[Mae_Bodega] ([Cod_Bodega], [Des_Bodega], [Tipo], [Dir_Bodega], [Rut_Bodega], [Razon_Social], [contacto]) VALUES (N'0', N'ADMIN', N'FRIGORIFICO', N' ', CAST(111111111 AS Numeric(18, 0)), NULL, NULL)
INSERT [dbo].[Mae_Bodega] ([Cod_Bodega], [Des_Bodega], [Tipo], [Dir_Bodega], [Rut_Bodega], [Razon_Social], [contacto]) VALUES (N'2', N'CENTRO 2', N'FRIGORIFICO', N'LOG SUR ', CAST(0 AS Numeric(18, 0)), NULL, NULL)
INSERT [dbo].[medidas] ([med_codi], [med_descr]) VALUES (N'001', N'SOPORTANTES')
INSERT [dbo].[medidas] ([med_codi], [med_descr]) VALUES (N'002', N'ENVASES')
INSERT [dbo].[medidas] ([med_codi], [med_descr]) VALUES (N'003', N'TONELADAS')
INSERT [dbo].[medidas] ([med_codi], [med_descr]) VALUES (N'004', N'HORAS')
INSERT [dbo].[medidas] ([med_codi], [med_descr]) VALUES (N'005', N'COBRO MENSUAL')
INSERT [dbo].[medidas] ([med_codi], [med_descr]) VALUES (N'006', N'UNIDAD')
INSERT [dbo].[Medidas2] ([med_unica], [med_codi], [med_descr]) VALUES (N'33845faa-5f84-4cb5-9489-7ee384b83720', N'001', N'KILOS')
INSERT [dbo].[Medidas2] ([med_unica], [med_codi], [med_descr]) VALUES (N'6065ffb8-503c-4d1c-8d9e-23e81c481bb0', N'002', N'SOPORTANTES')
INSERT [dbo].[Medidas2] ([med_unica], [med_codi], [med_descr]) VALUES (N'9c012f83-8b0e-4c0c-b17c-b50aa5adfcd6', N'003', N'ENVASES')
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Archivo', 1, 0, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cambio de Usuario', 2, 1, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Salir', 3, 1, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Parmetros', 4, 0, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Maestros', 5, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes', 6, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Familias', 7, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Productos', 8, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envases', 9, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Soporte', 10, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cmaras', 11, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Medidas', 12, 5, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Parmetros', 13, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Choferes', 14, 13, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo Documentos', 15, 13, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Correlativos', 16, 13, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Origen Documentos', 17, 13, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cajas Daadas', 21, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimiento', 23, 0, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcion', 24, 23, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcin de Guias', 25, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin', 27, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin Pendientes', 28, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Habilitacin y Horas Extras', 29, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin Pallet de Tnel', 30, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin  Pallet Homogenizacin', 31, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envio De Correo a Sadema (Tnel)', 32, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Solicitud de Creacin de Cdigo', 33, 24, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Despacho', 34, 23, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tracking Despacho', 35, 34, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Gua de Despacho', 36, 34, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tomar Temperatura Pre-Despacho', 37, 34, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin', 38, 23, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin de Documentos', 39, 38, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Anula Documentos', 40, 38, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Fecha de Vencimiento', 41, 38, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Bloquea Pallet HACCP', 42, 38, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura', 43, 38, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturas WEB', 104, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stocks', 45, 44, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Seguro Cliente', 46, 45, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Acumulado Cliente', 47, 45, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ubicacin Fisica de Soportantes', 48, 45, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Documentos', 49, 44, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Recepcin', 50, 49, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pre Despacho', 51, 49, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Despacho', 52, 49, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tnel', 53, 44, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Tneles', 54, 53, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura Salida Tnel', 55, 53, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Eventos Por Tnel', 56, 53, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pallet Espera Tnel', 57, 53, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad', 58, 44, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Pallets', 59, 58, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad Folio Cliente', 60, 58, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Tnel', 61, 58, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturacin', 62, 44, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Horas Extras', 63, 62, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Diferencias Temperatura', 64, 62, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estadsticas', 65, 44, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Camin en Planta', 66, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Desde la Recepcin', 67, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Pallet en Antecamara', 68, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 1', 69, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 2 Mov. Pallets ', 70, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Carga y Descarga', 71, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Vencido', 72, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Cmara', 73, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Posiciones de Cmaras', 74, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Folio Pallet', 75, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Documentos Emitidos', 76, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Produccin Despacho', 77, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes Pendientes Por Ingresar', 78, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo de Recepcin', 79, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Recepcin Segn Origen', 80, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Numeral Da Por Producto', 81, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Trackeo Cajas', 82, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Pedidos', 83, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimientos en Cmara', 84, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe PCC1', 85, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Reclamos de Clientes', 86, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Inf. Cajas Daadas', 87, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Bloqueados por HACCP', 88, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Informe de Calidad', 103, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estantera ', 90, 89, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Rack', 91, 90, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Piso', 92, 90, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pallet', 93, 89, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta PrePedido', 94, 89, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pedido', 95, 89, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Tnel', 96, 89, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso PNC', 102, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Usuario', 98, 97, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Men', 99, 97, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Perfil', 100, 97, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Salida Segn Origen', 106, 65, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Clientes', 105, 4, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Guas de Recepcin', 106, 39, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Guas de Despacho', 107, 39, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Actualizar Temporales', 108, 39, 1)
GO
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberar Posicin Rack', 109, 39, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cambiar Folio Cliente', 110, 39, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Gua de Recepcin', 111, 40, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Preparacin de Gua', 112, 40, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pedido', 113, 40, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informes', 44, 0, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiquetas', 89, 0, 1)
INSERT [dbo].[Menu_Gestion] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Utilitarios', 97, 0, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Familias                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Productos                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Envase                                  ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Soporte                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Cmaras                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Medidas                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contratos                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Choferes                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Rack                                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Slot                                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Origen Documento                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Cdigo Barra                            ', N'Ingreso Formatos                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Parmetros                              ', N'Cdigo Barra                            ', N'Ingreso Producto Relacin               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Recepcin                               ', N'Recepcin de Guas                      ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Recepcin                               ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Preparacin Guas de despacho           ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Pre Guas despacho (Web)                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Lista Pre Despacho (Radio F.)           ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Activacin Gua de  Despacho            ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Tracking Despacho                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Gua de Despacho                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Gua Movimiento Interno                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Despacho                                ', N'Gua de Despacho F.Nuevo                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Guas de Recepcin                      ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Guas de Despacho                       ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Reubicacin de Pallet                   ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Actualiza Temporales                    ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Libera Posicin en Rack                 ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Cambio Variadad G.Recepcin             ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Cambio Folio Cliente                    ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Gua Recepcin                          ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Preparacin de Guia                    ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Gua Despacho                           ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Gua Despacho F.Nuevo                   ', 1, 1, 1, 1)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Consultas Stock                         ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Stock Acumulado Clientes                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Consulta Cmaras                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Posiciones en Cmaras                   ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Informes de Tuneles                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Informe de Productividad                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Informe Toma Inventario                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Informe Carga y Descarga                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes Operacionales                  ', N'Informe Cmara                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Ubicacin Fsica de Sortantes           ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Numeral Da por Producto                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Resumen Inventario Clientes             ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Informe Gua Recepcin                  ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Imprime Etiquetas Gua Recepcin        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Informe Pre Despacho                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Informe Gua Despacho                   ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Detalle Recepcin segn Origen          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Infome Packing List                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Diferencial Temperatura                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Consulta Folio Pallet                   ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Informe Documentos Emitidos             ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Produccin Despacho                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Informes                                ', N'Informes de Control                     ', N'Trasabilidad de Pallets                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Etiquetas                               ', N'Estantera                              ', N'Etiquetas Rack                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Etiquetas                               ', N'Estantera                              ', N'Etiquetas Piso                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Etiquetas                               ', N'Estantera                              ', N'Etiquetas Slot                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Etiquetas                               ', N'Etiqueta Pallet                         ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[MenuGestion] ([Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (N'Utilitarios                             ', N'Nuevo Usuario                           ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
SET IDENTITY_INSERT [dbo].[Menus] ON 

INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (359, N'Factura   ', N'050', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (360, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (361, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (362, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (363, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (364, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (365, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (366, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (367, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (368, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (369, N'Factura   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (370, N'Factura   ', N'050', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (371, N'Factura   ', N'050', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (372, N'Factura   ', N'050', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (373, N'Factura   ', N'050', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (374, N'Factura   ', N'050', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1397, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1407, N'Factura   ', N'999', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (19, N'Gestion   ', N'050', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (20, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Consulta Cmaras                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (21, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (22, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Familias                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (23, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Productos                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (24, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Envase                                  ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (25, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Soporte                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (26, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Cmaras                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (27, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Medidas                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (28, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contratos                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (29, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (30, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (31, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Choferes                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (32, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Rack                                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (33, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Slot                                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (34, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (35, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (36, N'Gestion   ', N'050', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Origen Documento                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (37, N'Gestion   ', N'050', N'Parmetros                              ', N'Cdigo Barra                            ', N'Ingreso Formatos                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (38, N'Gestion   ', N'050', N'Parmetros                              ', N'Cdigo Barra                            ', N'Ingreso Producto Relacin               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (39, N'Gestion   ', N'050', N'Movimientos                             ', N'Recepcin                               ', N'Recepcin de Guas                      ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (40, N'Gestion   ', N'050', N'Movimientos                             ', N'Recepcin                               ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (41, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Preparacin Guas de despacho           ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (42, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Pre Guas despacho (Web)                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (43, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Lista Pre Despacho (Radio F.)           ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (44, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Activacin Gua de  Despacho            ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (45, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Tracking Despacho                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (46, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Gua de Despacho                        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (47, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Gua Movimiento Interno                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (48, N'Gestion   ', N'050', N'Movimientos                             ', N'Despacho                                ', N'Gua de Despacho F.Nuevo                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (49, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Guas de Recepcin                      ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (50, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Guas de Despacho                       ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (51, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Reubicacin de Pallet                   ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (52, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Actualiza Temporales                    ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (53, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Libera Posicin en Rack                 ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (54, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Cambio Variadad G.Recepcin             ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (55, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Mantencin de Documentos                ', N'Cambio Folio Cliente                    ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (56, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Gua Recepcin                          ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (57, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Preparacin de Guia                    ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (58, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Gua Despacho                           ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (59, N'Gestion   ', N'050', N'Movimientos                             ', N'Mantencin                              ', N'Anula Documentos                        ', N'Gua Despacho F.Nuevo                   ', 1, 1, 1, 1)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (60, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Consultas Stock                         ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (61, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Stock Acumulado Clientes                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (62, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Posiciones en Cmaras                   ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (63, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Informes de Tuneles                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (64, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Informe de Productividad                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (65, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Informe Toma Inventario                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (66, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Informe Carga y Descarga                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (67, N'Gestion   ', N'050', N'Informes                                ', N'Informes Operacionales                  ', N'Informe Cmara                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (68, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Ubicacin Fsica de Sortantes           ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (69, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Numeral Da por Producto                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (70, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Resumen Inventario Clientes             ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (71, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Informe Gua Recepcin                  ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (72, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Imprime Etiquetas Gua Recepcin        ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (73, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Informe Pre Despacho                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (74, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Informe Gua Despacho                   ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (75, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Detalle Recepcin segn Origen          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (76, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Infome Packing List                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (77, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Diferencial Temperatura                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (78, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Consulta Folio Pallet                   ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (79, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Informe Documentos Emitidos             ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (80, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Produccin Despacho                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (81, N'Gestion   ', N'050', N'Informes                                ', N'Informes de Control                     ', N'Trasabilidad de Pallets                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (82, N'Gestion   ', N'050', N'Etiquetas                               ', N'Estantera                              ', N'Etiquetas Rack                          ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (83, N'Gestion   ', N'050', N'Etiquetas                               ', N'Estantera                              ', N'Etiquetas Piso                          ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (84, N'Gestion   ', N'050', N'Etiquetas                               ', N'Estantera                              ', N'Etiquetas Slot                          ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (85, N'Gestion   ', N'050', N'Etiquetas                               ', N'Etiqueta Pallet                         ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (86, N'Gestion   ', N'050', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (87, N'Gestion   ', N'050', N'Utilitarios                             ', N'Nuevo Usuario                           ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (375, N'Factura   ', N'050', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1082, N'Factura   ', N'020', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1083, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (900, N'Factura   ', N'090', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1084, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1085, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1086, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1087, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1088, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1089, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (656, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (658, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
GO
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (660, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (662, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (664, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (685, N'Factura   ', N'101', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1090, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1091, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1092, N'Factura   ', N'020', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1093, N'Factura   ', N'020', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1094, N'Factura   ', N'020', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1095, N'Factura   ', N'020', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1096, N'Factura   ', N'020', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1097, N'Factura   ', N'020', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1098, N'Factura   ', N'020', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1099, N'Factura   ', N'020', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1280, N'Factura   ', N'936', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1281, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1282, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1283, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1284, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1285, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1286, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1287, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1288, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1289, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1396, N'Factura   ', N'999', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1398, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1399, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1403, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1406, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1408, N'Factura   ', N'999', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1409, N'Factura   ', N'999', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1411, N'Factura   ', N'999', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1413, N'Factura   ', N'999', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1414, N'Factura   ', N'999', N'Parmetros                              ', N'Bloquear guias por facturacion          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1416, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1417, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1420, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1421, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1424, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1425, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (376, N'Factura   ', N'050', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1290, N'Factura   ', N'936', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1046, N'Factura   ', N'099', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1047, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1048, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1049, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1050, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1051, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1052, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1053, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1054, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1291, N'Factura   ', N'936', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1292, N'Factura   ', N'936', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (938, N'Factura   ', N'777', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1055, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1056, N'Factura   ', N'099', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1057, N'Factura   ', N'099', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1058, N'Factura   ', N'099', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1059, N'Factura   ', N'099', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1060, N'Factura   ', N'099', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1061, N'Factura   ', N'099', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1062, N'Factura   ', N'099', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1063, N'Factura   ', N'099', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (939, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (940, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (941, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (942, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (943, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (944, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (945, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (946, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (947, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (948, N'Factura   ', N'777', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (949, N'Factura   ', N'777', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (950, N'Factura   ', N'777', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (951, N'Factura   ', N'777', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (952, N'Factura   ', N'777', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (902, N'Factura   ', N'010', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (903, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (884, N'Factura   ', N'090', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (885, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (886, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (887, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (888, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (889, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (890, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (891, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (892, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (893, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (894, N'Factura   ', N'090', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (895, N'Factura   ', N'090', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (896, N'Factura   ', N'090', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (897, N'Factura   ', N'090', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (898, N'Factura   ', N'090', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (899, N'Factura   ', N'090', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (449, N'Factura   ', N'110', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (450, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (451, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (452, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (453, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 1, 1, 1, 0)
GO
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (454, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (455, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (456, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (457, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (458, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (459, N'Factura   ', N'110', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (460, N'Factura   ', N'110', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (461, N'Factura   ', N'110', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (462, N'Factura   ', N'110', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (463, N'Factura   ', N'110', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (464, N'Factura   ', N'110', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (465, N'Factura   ', N'110', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (466, N'Factura   ', N'110', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (954, N'Factura   ', N'777', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1293, N'Factura   ', N'936', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1294, N'Factura   ', N'936', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1295, N'Factura   ', N'936', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1296, N'Factura   ', N'936', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1297, N'Factura   ', N'936', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1154, N'Factura   ', N'780', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1155, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1156, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (655, N'Factura   ', N'101', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (657, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (659, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (661, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (663, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (665, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (666, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (667, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (668, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (669, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (670, N'Factura   ', N'101', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (671, N'Factura   ', N'101', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (672, N'Factura   ', N'101', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (673, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (674, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (675, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (676, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (677, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (678, N'Factura   ', N'101', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (679, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (680, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (681, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (682, N'Factura   ', N'101', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (683, N'Factura   ', N'101', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (684, N'Factura   ', N'101', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1157, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1158, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1159, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1160, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1161, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1162, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1163, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (848, N'Factura   ', N'100', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (849, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (850, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (851, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (852, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (853, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (854, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (855, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (856, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (857, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (858, N'Factura   ', N'100', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (859, N'Factura   ', N'100', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (860, N'Factura   ', N'100', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (861, N'Factura   ', N'100', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (862, N'Factura   ', N'100', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (863, N'Factura   ', N'100', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (864, N'Factura   ', N'100', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (865, N'Factura   ', N'100', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (904, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (905, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (906, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (907, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (908, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (909, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (910, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (911, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (912, N'Factura   ', N'010', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (913, N'Factura   ', N'010', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (914, N'Factura   ', N'010', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (915, N'Factura   ', N'010', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (916, N'Factura   ', N'010', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (917, N'Factura   ', N'010', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (918, N'Factura   ', N'010', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (919, N'Factura   ', N'010', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (901, N'Factura   ', N'090', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1377, N'Factura   ', N'015', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (953, N'Factura   ', N'777', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (955, N'Factura   ', N'777', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1378, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1379, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1380, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1381, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1382, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1383, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1208, N'Factura   ', N'781', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1209, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 0, 0, 0, 0)
GO
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1210, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1211, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1212, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1213, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1214, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1215, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1216, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1217, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1218, N'Factura   ', N'781', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1219, N'Factura   ', N'781', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1220, N'Factura   ', N'781', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1221, N'Factura   ', N'781', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1222, N'Factura   ', N'781', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1223, N'Factura   ', N'781', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1224, N'Factura   ', N'781', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1225, N'Factura   ', N'781', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1384, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1385, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1386, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1387, N'Factura   ', N'015', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1388, N'Factura   ', N'015', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1389, N'Factura   ', N'015', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1390, N'Factura   ', N'015', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1391, N'Factura   ', N'015', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1392, N'Factura   ', N'015', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1393, N'Factura   ', N'015', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1394, N'Factura   ', N'015', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1395, N'Factura   ', N'015', N'Parmetros                              ', N'Bloquear guias por facturacion          ', N'*                                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1401, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1298, N'Factura   ', N'050', N'Parmetros                              ', N'Bloquear guias por facturacion          ', N'*                                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1299, N'Factura   ', N'110', N'Parmetros                              ', N'Bloquear guias por facturacion          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1358, N'Factura   ', N'016', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1359, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1360, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1361, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1362, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1363, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1364, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1365, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1366, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1367, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1368, N'Factura   ', N'016', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1369, N'Factura   ', N'016', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1370, N'Factura   ', N'016', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1371, N'Factura   ', N'016', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1372, N'Factura   ', N'016', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1373, N'Factura   ', N'016', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1374, N'Factura   ', N'016', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1375, N'Factura   ', N'016', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1376, N'Factura   ', N'016', N'Parmetros                              ', N'Bloquear guias por facturacion          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1164, N'Factura   ', N'780', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1165, N'Factura   ', N'780', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1166, N'Factura   ', N'780', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1167, N'Factura   ', N'780', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1168, N'Factura   ', N'780', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1169, N'Factura   ', N'780', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1170, N'Factura   ', N'780', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1171, N'Factura   ', N'780', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1244, N'Factura   ', N'   ', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1245, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Clientes                                ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1246, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Maestros                     ', N'Contactos                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1247, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1248, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1249, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Ciudades                                ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1250, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1251, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1252, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1253, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1254, N'Factura   ', N'   ', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Mantencin IPC                          ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1255, N'Factura   ', N'   ', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1256, N'Factura   ', N'   ', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1257, N'Factura   ', N'   ', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1258, N'Factura   ', N'   ', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1259, N'Factura   ', N'   ', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1260, N'Factura   ', N'   ', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1261, N'Factura   ', N'   ', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1400, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1402, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Documentos                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1404, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1405, N'Factura   ', N'999', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Servicios                               ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1410, N'Factura   ', N'999', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1412, N'Factura   ', N'999', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 1, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1415, N'Factura   ', N'027', N'Archivos                                ', N'Salir                                   ', N'*                                       ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1418, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'N.Personal                              ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1419, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Monedas                                 ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1422, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Correlativos                            ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1423, N'Factura   ', N'027', N'Parmetros                              ', N'Ingreso de Parmetros                   ', N'Orgen Documentos                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1426, N'Factura   ', N'027', N'Movimientos                             ', N'Proceso                                 ', N'Ingreso Habilitacin y Horas Extras     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1427, N'Factura   ', N'027', N'Movimientos                             ', N'Proceso                                 ', N'Estada de Productos                    ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1428, N'Factura   ', N'027', N'Movimientos                             ', N'Proceso                                 ', N'Reajuste de Tarifas                     ', N'*                                       ', 1, 1, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1429, N'Factura   ', N'027', N'Movimientos                             ', N'Proceso                                 ', N'Proceso Facturacin                     ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1430, N'Factura   ', N'027', N'Movimientos                             ', N'Informes                                ', N'Consulta Facturacin                    ', N'*                                       ', 1, 1, 1, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1431, N'Factura   ', N'027', N'Utilitarios                             ', N'Cambio Password                         ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1432, N'Factura   ', N'027', N'Utilitarios                             ', N'Crear Usuarios                          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
INSERT [dbo].[Menus] ([id], [Aplicacion], [Personal], [Menu1], [Menu2], [Menu3], [Menu4], [Acceso1], [Acceso2], [Acceso3], [Acceso4]) VALUES (1433, N'Factura   ', N'027', N'Parmetros                              ', N'Bloquear guias por facturacion          ', N'*                                       ', N'*                                       ', 0, 0, 0, 0)
SET IDENTITY_INSERT [dbo].[Menus] OFF
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'14', N'REGIN DE LOS ROS')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'13', N'REGIN METROPOLITANA')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'12', N'REGIN DE MAGALLANES Y LA ANTRTICA CHILENA')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'11', N'REGIN DE AYSN DEL GENERAL CARLOS IBAEZ DEL CAMPO')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'10', N'REGIN DE LOS LAGOS')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'9', N'REGIN DE LA ARAUCANA')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'8', N'REGIN DEL BO BO')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'7', N'REGIN DEL MAULE')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'6', N'REGIN DEL LIBERTADOR GENERAL BERNARDO O HIGGINS')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'5', N'REGIN DE VALPARASO')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'4', N'REGIN DE COQUIMBO')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'3', N'REGIN DE ATACAMA')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'2', N'REGIN DE ANTOFAGASTA')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'1', N'REGIN DE TARAPAC')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'15', N'REGIN DE ARICA Y PARINACOTA')
INSERT [dbo].[P_Ciudades] ([CiudadCodigo], [CiudadDescripcion]) VALUES (N'0', N'SELECCIONAR')
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (346, N'ALTO HOSPICIO', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (296, N'CAMINA', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (297, N'COLCHANE', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (3, N'HUARA', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (2, N'IQUIQUE', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (4, N'PICA', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (5, N'POZO ALMONTE', 1)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (7, N'ANTOFAGASTA', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (10, N'CALAMA', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (298, N'MARIA ELENA', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (8, N'MEJILLONES', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (300, N'OLLAGE', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (301, N'SAN PEDRO DE ATACAMA', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (299, N'SIERRA GORDA', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (9, N'TALTAL', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (6, N'TOCOPILLA', 2)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (302, N'ALTO DEL CARMEN', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (14, N'CALDERA', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (11, N'CHAARAL', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (13, N'COPIAPO', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (12, N'DIEGO DE ALMAGRO', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (17, N'FREIRINA', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (18, N'HUASCO', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (15, N'TIERRA AMARILLA', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (16, N'VALLENAR', 3)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (22, N'ANDACOLLO', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (31, N'CANELA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (29, N'COMBARBALA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (21, N'COQUIMBO', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (30, N'ILLAPEL', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (20, N'LA HIGUERA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (19, N'LA SERENA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (33, N'LOS VILOS', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (26, N'MONTE PATRIA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (25, N'OVALLE', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (24, N'PAIHUANO', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (27, N'PUNITAQUI', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (28, N'RIO HURTADO', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (32, N'SALAMANCA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (23, N'VICUA', 4)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (44, N'ALGARROBO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (56, N'CABILDO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (67, N'CALLE LARGA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (46, N'CARTAGENA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (40, N'CASABLANCA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (63, N'CATEMU', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (340, N'CONCON', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (45, N'EL QUISCO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (47, N'EL TABO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (51, N'HIJUELAS', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (41, N'ISLA DE PASCUA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (321, N'JUAN FERNANDEZ', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (50, N'LA CALERA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (49, N'LA CRUZ', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (59, N'LA LIGUA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (53, N'LIMACHE', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (65, N'LLAY LLAY', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (66, N'LOS ANDES', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (52, N'NOGALES', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (54, N'OLMUE', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (62, N'PANQUEHUE', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (57, N'PAPUDO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (55, N'PETORCA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (36, N'PUCHUNCAVI', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (61, N'PUTAENDO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (48, N'QUILLOTA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (38, N'QUILPUE', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (35, N'QUINTERO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (68, N'RINCONADA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (42, N'SAN ANTONIO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (69, N'SAN ESTEBAN', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (60, N'SAN FELIPE', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (64, N'SANTA MARIA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (43, N'SANTO DOMINGO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (34, N'VALPARAISO', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (39, N'VILLA ALEMANA', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (37, N'VIA DEL MAR', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (58, N'ZAPALLAR', 5)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (132, N'CHEPICA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (125, N'CHIMBARONGO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (110, N'CODEGUA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (114, N'COINCO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (113, N'COLTAUCO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (112, N'DOIHUE', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (107, N'GRANEROS', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (139, N'LA ESTRELLA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (116, N'LAS CABRAS', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (136, N'LITUECHE', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (129, N'LOLOL', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (106, N'MACHALI', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (122, N'MALLOA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (134, N'MARCHIGUE', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (126, N'NANCAGUA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (138, N'NAVIDAD', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (120, N'OLIVAR', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (130, N'PALMILLA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (133, N'PAREDONES', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (131, N'PERALILLO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (115, N'PEUMO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (118, N'PICHIDEGUA', 6)
GO
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (137, N'PICHILEMU', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (127, N'PLACILLA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (135, N'PUMANQUE', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (123, N'QUINTA DE TILCOCO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (105, N'RANCAGUA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (121, N'RENGO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (119, N'REQUINOA', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (124, N'SAN FERNANDO', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (111, N'SAN FRANCISCO DE MOSTAZAL', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (117, N'SAN VICENTE', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (128, N'SANTA CRUZ', 6)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (166, N'CAUQUENES', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (167, N'CHANCO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (161, N'COLBUN', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (157, N'CONSTITUCION', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (155, N'CUREPTO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (140, N'CURICO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (158, N'EMPEDRADO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (144, N'HUALAE', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (145, N'LICANTEN', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (159, N'LINARES', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (162, N'LONGAVI', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (154, N'MAULE', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (147, N'MOLINA', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (164, N'PARRAL', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (152, N'PELARCO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (320, N'PELLUHUE', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (153, N'PENCAHUE', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (143, N'RAUCO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (165, N'RETIRO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (149, N'RIO CLARO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (141, N'ROMERAL', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (148, N'SAGRADA FAMILIA', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (151, N'SAN CLEMENTE', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (156, N'SAN JAVIER', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (341, N'SAN RAFAEL', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (150, N'TALCA', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (142, N'TENO', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (146, N'VICHUQUEN', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (163, N'VILLA ALEGRE', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (160, N'YERBAS BUENAS', 7)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (303, N'ANTUCO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (198, N'ARAUCO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (180, N'BULNES', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (208, N'CABRERO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (201, N'CAETE', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (344, N'CHIGUAYANTE', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (168, N'CHILLAN', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (342, N'CHILLAN VIEJO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (175, N'COBQUECURA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (186, N'COELEMU', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (170, N'COIHUECO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (188, N'CONCEPCION', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (202, N'CONTULMO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (194, N'CORONEL', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (197, N'CURANILAHUE', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (185, N'EL CARMEN', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (193, N'FLORIDA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (192, N'HUALQUI', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (210, N'LAJA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (199, N'LEBU', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (200, N'LOS ALAMOS', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (204, N'LOS ANGELES', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (195, N'LOTA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (214, N'MULCHEN', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (212, N'NACIMIENTO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (213, N'NEGRETE', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (174, N'NINHUE', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (184, N'PEMUCO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (191, N'PENCO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (169, N'PINTO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (171, N'PORTEZUELO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (215, N'QUILACO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (206, N'QUILLECO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (182, N'QUILLON', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (172, N'QUIRIHUE', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (187, N'RANQUIL', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (176, N'SAN CARLOS', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (178, N'SAN FABIAN', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (177, N'SAN GREGORIO DE IQUEN', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (181, N'SAN IGNACIO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (179, N'SAN NICOLAS', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (343, N'SAN PEDRO DE LA PAZ', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (211, N'SAN ROSENDO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (205, N'SANTA BARBARA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (196, N'SANTA JUANA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (189, N'TALCAHUANO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (203, N'TIRUA', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (190, N'TOME', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (173, N'TREHUACO', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (209, N'TUCAPEL', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (207, N'YUMBEL', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (183, N'YUNGAY', 8)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (216, N'ANGOL', 9)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (235, N'CARAHUE', 9)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (220, N'COLLIPULLI', 9)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (230, N'CUNCO', 9)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (225, N'CURACAUTIN', 9)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (305, N'CURARREHUE', 9)
INSERT [dbo].[P_Comunas] ([CodInterno], [Nombre], [Padre]) VALUES (221, N'ERCILLA', 9)
GO
INSERT [dbo].[P_ConChecklist] ([Con_codi], [Con_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'--SELECCIONE--')
INSERT [dbo].[P_ConChecklist] ([Con_codi], [Con_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'THERMO')
INSERT [dbo].[P_ConChecklist] ([Con_codi], [Con_desc]) VALUES (CAST(2 AS Numeric(18, 0)), N'OTRO')
INSERT [dbo].[P_ConChecklist] ([Con_codi], [Con_desc]) VALUES (CAST(3 AS Numeric(18, 0)), N'CONTENEDOR')
INSERT [dbo].[P_DescripcionCamaras] ([IdCamara], [Camara]) VALUES (N'1         ', N'COMPARTIDA')
INSERT [dbo].[P_DescripcionCamaras] ([IdCamara], [Camara]) VALUES (N'2         ', N'CERRADA')
INSERT [dbo].[P_EstadoCajasDaadas] ([Id], [Estado]) VALUES (1, N'DISPOSICIN DEL CLIENTE')
INSERT [dbo].[P_EstadoCajasDaadas] ([Id], [Estado]) VALUES (2, N'A DESECHO')
INSERT [dbo].[P_EstadoContrato] ([econt_codi], [econt_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'HABILITADO PARA MOVIMIENTOS')
INSERT [dbo].[P_EstadoContrato] ([econt_codi], [econt_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'BLOQUEADO PARA MOVIMIENTOS')
INSERT [dbo].[P_EstadoDocumento] ([ED_CODI], [ED_DESC]) VALUES (CAST(0 AS Numeric(18, 0)), N'ACTIVO')
INSERT [dbo].[P_EstadoDocumento] ([ED_CODI], [ED_DESC]) VALUES (CAST(1 AS Numeric(18, 0)), N'NULO')
INSERT [dbo].[P_EstadoFacturacion] ([tfac_codi], [tfac_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'FACTURACION HABILITADA')
INSERT [dbo].[P_EstadoFacturacion] ([tfac_codi], [tfac_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'FACTURACION DESABILITADA')
INSERT [dbo].[P_EstadoIngreso] ([eing_codi], [eing_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'DESBLOQUEADO')
INSERT [dbo].[P_EstadoIngreso] ([eing_codi], [eing_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'BLOQUEADO')
INSERT [dbo].[P_EstadoPallet] ([IdEstadoPallet], [EstadoPallet]) VALUES (N'4', N'OTROS')
INSERT [dbo].[P_EstadoPallet] ([IdEstadoPallet], [EstadoPallet]) VALUES (N'5', N'BLOQ. S/RESOLUCIN')
INSERT [dbo].[P_EstadoPallet] ([IdEstadoPallet], [EstadoPallet]) VALUES (N'1', N'RETENIDO')
INSERT [dbo].[P_EstadoPallet] ([IdEstadoPallet], [EstadoPallet]) VALUES (N'2', N'DAADO')
INSERT [dbo].[P_EstadoPallet] ([IdEstadoPallet], [EstadoPallet]) VALUES (N'3', N'SIN ETIQUETAR')
INSERT [dbo].[P_EstadoProducto] ([IdEstado], [TipoEstado]) VALUES (1, N'ACTIVO')
INSERT [dbo].[P_EstadoProducto] ([IdEstado], [TipoEstado]) VALUES (2, N'NULO')
INSERT [dbo].[P_Estados] ([EstadoId], [EstadoNombre]) VALUES (1, N'ACTIVO')
INSERT [dbo].[P_Estados] ([EstadoId], [EstadoNombre]) VALUES (2, N'NULO')
INSERT [dbo].[P_Estados] ([EstadoId], [EstadoNombre]) VALUES (3, N'IMPAGO')
INSERT [dbo].[P_EstadoUsuPed] ([estped_glosa], [estped_codi]) VALUES (N'Pallet', 0)
INSERT [dbo].[P_EstadoUsuPed] ([estped_glosa], [estped_codi]) VALUES (N'Pallet/Cajas', 2)
INSERT [dbo].[P_EstadoUsuPed] ([estped_glosa], [estped_codi]) VALUES (N'Pallet/Cajas/Guia', 3)
INSERT [dbo].[P_Filtros] ([IdFiltro], [FiltroDescripcion]) VALUES (N'1', N'<FILTROS>')
INSERT [dbo].[P_Filtros] ([IdFiltro], [FiltroDescripcion]) VALUES (N'2', N'NOMBRE CLIENTE')
INSERT [dbo].[P_Filtros] ([IdFiltro], [FiltroDescripcion]) VALUES (N'3', N'FECHA CREACION')
INSERT [dbo].[P_Incluir] ([Inc_codi], [Inc_Descr]) VALUES (CAST(0 AS Numeric(18, 0)), N'NINGUNO')
INSERT [dbo].[P_Incluir] ([Inc_codi], [Inc_Descr]) VALUES (CAST(1 AS Numeric(18, 0)), N'RECEPCION')
INSERT [dbo].[P_Incluir] ([Inc_codi], [Inc_Descr]) VALUES (CAST(2 AS Numeric(18, 0)), N'DESPACHO')
INSERT [dbo].[P_Incluir] ([Inc_codi], [Inc_Descr]) VALUES (CAST(3 AS Numeric(18, 0)), N'RECEPCION Y DESPACHO')
INSERT [dbo].[P_Incluir] ([Inc_codi], [Inc_Descr]) VALUES (CAST(4 AS Numeric(18, 0)), N'PROCESO ETIQUETADO')
INSERT [dbo].[P_InfCargaDescarga] ([Id], [Tipo]) VALUES (1, N'TONELADAS')
INSERT [dbo].[P_InfCargaDescarga] ([Id], [Tipo]) VALUES (2, N'PALLETS')
INSERT [dbo].[P_InfCargaDescarga] ([Id], [Tipo]) VALUES (3, N'UNIDADES')
INSERT [dbo].[P_InfCPendientesMov] ([id], [TipoMov]) VALUES (N'0', N'DESCARGA')
INSERT [dbo].[P_InfCPendientesMov] ([id], [TipoMov]) VALUES (N'1', N'CARGA')
INSERT [dbo].[P_InfCPendientesMov] ([id], [TipoMov]) VALUES (N'2', N'AMBOS')
INSERT [dbo].[P_InfEstadoPedido] ([Id], [Estado]) VALUES (0, N'TODOS')
INSERT [dbo].[P_InfEstadoPedido] ([Id], [Estado]) VALUES (1, N'PENDIENTES')
INSERT [dbo].[P_InfEstadoPedido] ([Id], [Estado]) VALUES (2, N'EN PREPARACIN')
INSERT [dbo].[P_InfEstadoPedido] ([Id], [Estado]) VALUES (3, N'PREPARADO')
INSERT [dbo].[P_InfMovPallet] ([Id], [Datos]) VALUES (1, N'SUPERVISOR')
INSERT [dbo].[P_InfMovPallet] ([Id], [Datos]) VALUES (2, N'GRUERO')
INSERT [dbo].[P_InfOrdenar] ([id], [Ordenar]) VALUES (1, N'CLIENTES')
INSERT [dbo].[P_InfOrdenar] ([id], [Ordenar]) VALUES (2, N'TUNELES')
INSERT [dbo].[P_InfPalletVencidos] ([Id], [Mostrar]) VALUES (0, N'VENCIDOS')
INSERT [dbo].[P_InfPalletVencidos] ([Id], [Mostrar]) VALUES (1, N'POR VENCER')
INSERT [dbo].[P_InfPalletVencidos] ([Id], [Mostrar]) VALUES (2, N'TODOS')
INSERT [dbo].[P_InfPosicionCamaras] ([Id], [Mostrar]) VALUES (0, N'LIBRES')
INSERT [dbo].[P_InfPosicionCamaras] ([Id], [Mostrar]) VALUES (1, N'OCUPADAS')
INSERT [dbo].[P_InfProductividad] ([Id], [Datos]) VALUES (0, N'SUPERVISOR')
INSERT [dbo].[P_InfProductividad] ([Id], [Datos]) VALUES (1, N'GRUERO')
INSERT [dbo].[P_InfTunel] ([id], [Tunel]) VALUES (1, N'TODOS')
INSERT [dbo].[P_InfTunel] ([id], [Tunel]) VALUES (2, N'TUNEL 01')
INSERT [dbo].[P_InfTunel] ([id], [Tunel]) VALUES (3, N'TUNEL 02')
INSERT [dbo].[P_InfTunel] ([id], [Tunel]) VALUES (4, N'TUNEL 03')
INSERT [dbo].[P_InfTunel] ([id], [Tunel]) VALUES (5, N'TUNEL 04')
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Archivo', 1, 0, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cambio de Usuario', 2, 1, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Salir', 3, 1, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Parmetros', 4, 0, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Maestros', 5, 4, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes', 6, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Familias', 7, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Productos', 8, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envases', 9, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Soporte', 10, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cmaras', 11, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Medidas', 12, 5, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Parmetros', 13, 4, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Choferes', 14, 13, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo Documentos', 15, 13, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Correlativos', 16, 13, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Origen Documentos', 17, 13, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cajas Daadas', 21, 4, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimiento', 23, 0, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcion', 24, 23, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcin de Guias', 25, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin', 27, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin Pendientes', 28, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Habilitacin y Horas Extras', 29, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin Pallet de Tnel', 30, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin  Pallet Homogenizacin', 31, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envio De Correo a Sadema (Tnel)', 32, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Solicitud de Creacin de Cdigo', 33, 24, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Despacho', 34, 23, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tracking Despacho', 35, 34, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Gua de Despacho', 36, 34, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tomar Temperatura Pre-Despacho', 37, 34, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin', 38, 23, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin de Documentos', 39, 38, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Anula Documentos', 40, 38, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Fecha de Vencimiento', 41, 38, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Bloquea Pallet HACCP', 42, 38, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura', 43, 38, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturas WEB', 104, 4, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stocks', 45, 44, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Seguro Cliente', 46, 45, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Acumulado Cliente', 47, 45, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ubicacin Fisica de Soportantes', 48, 45, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Documentos', 49, 44, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Recepcin', 50, 49, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pre Despacho', 51, 49, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Despacho', 52, 49, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tnel', 53, 44, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Tneles', 54, 53, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura Salida Tnel', 55, 53, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Eventos Por Tnel', 56, 53, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pallet Espera Tnel', 57, 53, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad', 58, 44, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Pallets', 59, 58, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad Folio Cliente', 60, 58, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Tnel', 61, 58, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturacin', 62, 44, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Horas Extras', 63, 62, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Diferencias Temperatura', 64, 62, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estadsticas', 65, 44, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Camin en Planta', 66, 65, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Desde la Recepcin', 67, 65, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Pallet en Antecamara', 68, 65, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 1', 69, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 2 Mov. Pallets ', 70, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Carga y Descarga', 71, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Vencido', 72, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Cmara', 73, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Posiciones de Cmaras', 74, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Folio Pallet', 75, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Documentos Emitidos', 76, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Produccin Despacho', 77, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes Pendientes Por Ingresar', 78, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo de Recepcin', 79, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Recepcin Segn Origen', 80, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Numeral Da Por Producto', 81, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Trackeo Cajas', 82, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Pedidos', 83, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimientos en Cmara', 84, 65, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe PCC1', 85, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Reclamos de Clientes', 86, 65, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Inf. Cajas Daadas', 87, 65, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Bloqueados por HACCP', 88, 65, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Informe de Calidad', 103, 4, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estantera ', 90, 89, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Rack', 91, 90, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Piso', 92, 90, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pallet', 93, 89, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta PrePedido', 94, 89, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pedido', 95, 89, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Tnel', 96, 89, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso PNC', 102, 4, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Usuario', 98, 97, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Men', 99, 97, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Perfil', 100, 97, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Clientes', 105, 4, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Utilitarios', 97, 0, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Guas de Recepcin', 106, 39, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Guas de Despacho', 107, 39, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Actualizar Temporales', 108, 39, 0)
GO
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberar Posicin Rack', 109, 39, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cambiar Folio Cliente', 110, 39, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Gua de Recepcin', 111, 40, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Preparacin de Guas', 112, 40, 0)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pedido', 113, 40, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informes', 44, 0, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiquetas', 89, 0, 1)
INSERT [dbo].[P_MenuOPERACION] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Utilitarios', 97, 0, 0)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Archivo', 1, 0, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cambio de Usuario', 2, 1, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Salir', 3, 1, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Parmetros', 4, 0, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Maestros', 5, 4, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes', 6, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Familias', 7, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Productos', 8, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envases', 9, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Soporte', 10, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cmaras', 11, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Medidas', 12, 5, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Parmetros', 13, 4, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Choferes', 14, 13, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo Documentos', 15, 13, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Correlativos', 16, 13, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Origen Documentos', 17, 13, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cajas Daadas', 21, 4, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimiento', 23, 0, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcion', 24, 23, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcin de Guias', 25, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin', 27, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin Pendientes', 28, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Habilitacin y Horas Extras', 29, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin Pallet de Tnel', 30, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin  Pallet Homogenizacin', 31, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envio De Correo a Sadema (Tnel)', 32, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Solicitud de Creacin de Cdigo', 33, 24, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Despacho', 34, 23, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tracking Despacho', 35, 34, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Gua de Despacho', 36, 34, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tomar Temperatura Pre-Despacho', 37, 34, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin', 38, 23, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin de Documentos', 39, 38, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Anula Documentos', 40, 38, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Fecha de Vencimiento', 41, 38, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Bloquea Pallet HACCP', 42, 38, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura', 43, 38, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informes', 44, 0, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stocks', 45, 44, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Seguro Cliente', 46, 45, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Acumulado Cliente', 47, 45, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ubicacin Fisica de Soportantes', 48, 45, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Documentos', 49, 44, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Recepcin', 50, 49, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pre Despacho', 51, 49, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Despacho', 52, 49, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tnel', 53, 44, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Tneles', 54, 53, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura Salida Tnel', 55, 53, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Eventos Por Tnel', 56, 53, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pallet Espera Tnel', 57, 53, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad', 58, 44, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Pallets', 59, 58, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad Folio Cliente', 60, 58, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Tnel', 61, 58, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturacin', 62, 44, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Horas Extras', 63, 62, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Diferencias Temperatura', 64, 62, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estadsticas', 65, 44, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Camin en Planta', 66, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Desde la Recepcin', 67, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Pallet en Antecamara', 68, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 1', 69, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 2 Mov. Pallets ', 70, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Carga y Descarga', 71, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Vencido', 72, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Cmara', 73, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Posiciones de Cmaras', 74, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Folio Pallet', 75, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Documentos Emitidos', 76, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Produccin Despacho', 77, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes Pendientes Por Ingresar', 78, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo de Recepcin', 79, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Recepcin Segn Origen', 80, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Numeral Da Por Producto', 81, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Trackeo Cajas', 82, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Pedidos', 83, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimientos en Cmara', 84, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe PCC1', 85, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Reclamos de Clientes', 86, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Inf. Cajas Daadas', 87, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Bloqueados por HACCP', 88, 65, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiquetas', 89, 0, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estantera ', 90, 89, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Rack', 91, 90, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Piso', 92, 90, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pallet', 93, 89, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta PrePedido', 94, 89, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pedido', 95, 89, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Tnel', 96, 89, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Utilitarios', 97, 0, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Usuario', 98, 97, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Men', 99, 97, 1)
INSERT [dbo].[P_MenuOPERACIONES] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Perfil', 100, 97, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Archivo', 1, 0, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cambio de Usuario', 2, 1, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Salir', 3, 1, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Parmetros', 4, 0, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Maestros', 5, 4, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes', 6, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Familias', 7, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Productos', 8, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envases', 9, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Soporte', 10, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cmaras', 11, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Medidas', 12, 5, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso de Parmetros', 13, 4, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Choferes', 14, 13, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo Documentos', 15, 13, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Correlativos', 16, 13, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Origen Documentos', 17, 13, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Cajas Daadas', 21, 4, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimiento', 23, 0, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcion', 24, 23, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Recepcin de Guias', 25, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin', 27, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ver Guas de Recepcin Pendientes', 28, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Habilitacin y Horas Extras', 29, 24, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin Pallet de Tnel', 30, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Liberacin  Pallet Homogenizacin', 31, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Envio De Correo a Sadema (Tnel)', 32, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Solicitud de Creacin de Cdigo', 33, 24, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Despacho', 34, 23, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tracking Despacho', 35, 34, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Gua de Despacho', 36, 34, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tomar Temperatura Pre-Despacho', 37, 34, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin', 38, 23, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Mantencin de Documentos', 39, 38, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Anula Documentos', 40, 38, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Fecha de Vencimiento', 41, 38, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Bloquea Pallet HACCP', 42, 38, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura', 43, 38, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informes', 44, 0, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stocks', 45, 44, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Seguro Cliente', 46, 45, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Stock Acumulado Cliente', 47, 45, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ubicacin Fisica de Soportantes', 48, 45, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Documentos', 49, 44, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Recepcin', 50, 49, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pre Despacho', 51, 49, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Gua Despacho', 52, 49, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tnel', 53, 44, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Tneles', 54, 53, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Temperatura Salida Tnel', 55, 53, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Eventos Por Tnel', 56, 53, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Pallet Espera Tnel', 57, 53, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad', 58, 44, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Pallets', 59, 58, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad Folio Cliente', 60, 58, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Trazabilidad de Tnel', 61, 58, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturacin', 62, 44, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Horas Extras', 63, 62, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Diferencias Temperatura', 64, 62, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estadsticas', 65, 44, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Camin en Planta', 66, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Desde la Recepcin', 67, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Horas Pallet en Antecamara', 68, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 1', 69, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe de Productividad 2 Mov. Pallets ', 70, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Carga y Descarga', 71, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Vencido', 72, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Cmara', 73, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Posiciones de Cmaras', 74, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Consulta Folio Pallet', 75, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Documentos Emitidos', 76, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Produccin Despacho', 77, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Clientes Pendientes Por Ingresar', 78, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Tipo de Recepcin', 79, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Recepcin Segn Origen', 80, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Numeral Da Por Producto', 81, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Trackeo Cajas', 82, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Pedidos', 83, 65, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Movimientos en Cmara', 84, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe PCC1', 85, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Reclamos de Clientes', 86, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Inf. Cajas Daadas', 87, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Pallet Bloqueados por HACCP', 88, 65, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiquetas', 89, 0, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estantera ', 90, 89, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Rack', 91, 90, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Piso', 92, 90, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pallet', 93, 89, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta PrePedido', 94, 89, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Pedido', 95, 89, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Etiqueta Tnel', 96, 89, 1)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Utilitarios', 97, 0, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Usuario', 98, 97, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Men', 99, 97, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Crear Perfil', 100, 97, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso PNC', 102, 4, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Ingreso Informe de Calidad', 103, 4, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Facturas WEB', 104, 4, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Estado de Clientes', 105, 4, 0)
INSERT [dbo].[P_MenuSUPERVISOR] ([NombreNodo], [IdentificadorNodo], [IdentificadorPadre], [Estado]) VALUES (N'Informe Salida Segn Origen', 106, 65, 1)
GO
INSERT [dbo].[P_MovChecklist] ([mov_codi], [Mov_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'--SELECCIONE--')
INSERT [dbo].[P_MovChecklist] ([mov_codi], [Mov_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'CARGA     ')
INSERT [dbo].[P_MovChecklist] ([mov_codi], [Mov_desc]) VALUES (CAST(2 AS Numeric(18, 0)), N'DESCARGA  ')
INSERT [dbo].[P_MovChecklist] ([mov_codi], [Mov_desc]) VALUES (CAST(3 AS Numeric(18, 0)), N'CARGA Y DESCARGA')
INSERT [dbo].[P_PalletHACCP] ([id], [descripcion]) VALUES (1, N'BLOQUEADO')
INSERT [dbo].[P_PalletHACCP] ([id], [descripcion]) VALUES (0, N'DESBLOQUEADO')
INSERT [dbo].[P_ProcTunel] ([id], [estado]) VALUES (N'0         ', N'NO        ')
INSERT [dbo].[P_ProcTunel] ([id], [estado]) VALUES (N'1         ', N'SI        ')
INSERT [dbo].[P_RadioFrecuencia] ([Id], [RadioNombre]) VALUES (0, N'ADMINISTRADOR')
INSERT [dbo].[P_RadioFrecuencia] ([Id], [RadioNombre]) VALUES (1, N'GRUERO')
INSERT [dbo].[P_RadioFrecuencia] ([Id], [RadioNombre]) VALUES (2, N'SUPERVISOR')
INSERT [dbo].[P_ROLES] ([IdRol], [NombreRol]) VALUES (1, N'OPERADOR DE PRECAMARA')
INSERT [dbo].[P_ROLES] ([IdRol], [NombreRol]) VALUES (2, N'ADMINISTRADOR INFORMATICO')
INSERT [dbo].[P_ROLES] ([IdRol], [NombreRol]) VALUES (3, N'SUPER ADMINISTRADOR')
INSERT [dbo].[P_ROLES] ([IdRol], [NombreRol]) VALUES (4, N'SUPERVISOR DE OPERADOR DE PRECAMARA')
INSERT [dbo].[P_ROLES] ([IdRol], [NombreRol]) VALUES (5, N'SIN ROL')
INSERT [dbo].[P_SeccionVas] ([sec_codi], [sec_descr]) VALUES (CAST(0 AS Numeric(18, 0)), N'RECEPCION')
INSERT [dbo].[P_SeccionVas] ([sec_codi], [sec_descr]) VALUES (CAST(1 AS Numeric(18, 0)), N'DESPACHO')
INSERT [dbo].[P_SeccionVas] ([sec_codi], [sec_descr]) VALUES (CAST(2 AS Numeric(18, 0)), N'ETIQUETADO')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (1, N'SENSOR 1')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (2, N'SENSOR 2')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (3, N'SENSOR 3')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (4, N'SENSOR 4')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (5, N'SENSOR 5')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (6, N'SENSOR 6')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (7, N'SENSOR 7')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (8, N'SENSOR 8')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (9, N'SENSOR 9')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (10, N'SENSOR 10')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (11, N'SENSOR 11')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (12, N'SENSOR 12')
INSERT [dbo].[P_Sensor] ([IdSensor], [Sensor]) VALUES (0, N'SELECCIONAR')
INSERT [dbo].[P_TipoAlmacenamiento] ([id], [almacenamiento]) VALUES (0, N'SELECCIONAR')
INSERT [dbo].[P_TipoAlmacenamiento] ([id], [almacenamiento]) VALUES (1, N'REFRIGERADO')
INSERT [dbo].[P_TipoAlmacenamiento] ([id], [almacenamiento]) VALUES (2, N'CONGELADO')
INSERT [dbo].[P_TipoCamaras] ([IdTipoCamara], [TipoCamara]) VALUES (N'1         ', N'PISO')
INSERT [dbo].[P_TipoCamaras] ([IdTipoCamara], [TipoCamara]) VALUES (N'2         ', N'RACK')
INSERT [dbo].[P_TipoCamaras] ([IdTipoCamara], [TipoCamara]) VALUES (N'3         ', N' SLOT')
INSERT [dbo].[P_TipoCargaDescarga] ([tcar_codi], [tcar_descr]) VALUES (CAST(0 AS Numeric(18, 0)), N'MECANICA')
INSERT [dbo].[P_TipoCargaDescarga] ([tcar_codi], [tcar_descr]) VALUES (CAST(1 AS Numeric(18, 0)), N'MANUAL')
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'0', N'Carnes', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'1', N'Salmones', CAST(1 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'2', N'Frutas', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'3', N'Verduras', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'4', N'Mariscos', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'5', N'Otros', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoClientes] ([tcli_codi], [tcli_desc], [tcli_traqueo]) VALUES (N'6', N'Trackeo', CAST(1 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoDao] ([IdDao], [DescripcionDao]) VALUES (N'0', N'NO')
INSERT [dbo].[P_TipoDao] ([IdDao], [DescripcionDao]) VALUES (N'1', N'SI')
INSERT [dbo].[P_TipoDao] ([IdDao], [DescripcionDao]) VALUES (N'2', N'SELECCIONAR')
INSERT [dbo].[P_TipoDescripcion] ([IdTipoDescripcion], [TipoDescripcion]) VALUES (N'1', N'MECANICA')
INSERT [dbo].[P_TipoDescripcion] ([IdTipoDescripcion], [TipoDescripcion]) VALUES (N'2', N'MANUAL')
INSERT [dbo].[P_TipoDescripcion] ([IdTipoDescripcion], [TipoDescripcion]) VALUES (N'3', N'SELECCIONAR')
INSERT [dbo].[P_TipoEstiba] ([IdEstiba], [DescripcionEstiba]) VALUES (N'1', N'BUENA')
INSERT [dbo].[P_TipoEstiba] ([IdEstiba], [DescripcionEstiba]) VALUES (N'0', N'MALA')
INSERT [dbo].[P_TipoEstiba] ([IdEstiba], [DescripcionEstiba]) VALUES (N'2', N'SELECCIONAR')
INSERT [dbo].[P_TipoHigiene] ([IdHigiene], [DescripcionHigiene]) VALUES (N'1', N'BUENA')
INSERT [dbo].[P_TipoHigiene] ([IdHigiene], [DescripcionHigiene]) VALUES (N'0', N'MALA')
INSERT [dbo].[P_TipoHigiene] ([IdHigiene], [DescripcionHigiene]) VALUES (N'2', N'SELECCIONAR')
INSERT [dbo].[P_TipoLectura] ([tlec_codi], [tlec_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'SIN LECTURA')
INSERT [dbo].[P_TipoLectura] ([tlec_codi], [tlec_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'LECTURA DE ENVASES')
INSERT [dbo].[P_TipoMenu] ([Menu], [TipoPerfil], [Rol]) VALUES (N'OPERACIONES ', N'OPERACIONES', N'SUPERVISOR DE OPERADOR DE PRECAMARA')
INSERT [dbo].[P_TipoMenu] ([Menu], [TipoPerfil], [Rol]) VALUES (N'ADMINISTRACION', N'OPERACIONES', N'ADMINISTRADOR INFORMATICO')
INSERT [dbo].[P_TipoMenu] ([Menu], [TipoPerfil], [Rol]) VALUES (N'OPERACION', N'OPERACIONES', N'SUPERVISOR DE OPERADOR DE PRECAMARA')
INSERT [dbo].[P_TipoMenu] ([Menu], [TipoPerfil], [Rol]) VALUES (N'SUPERVISOR', N'OPERACIONES', N'SUPERVISOR DE OPERADOR DE PRECAMARA')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'AP', N'ANULACION DE PRE - DESPACHO')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'CP', N'CAMBIO DE PALLET')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'EN', N'RECEPCION DE CAJAS')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'PA', N'PEDIDO ANULADO')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'PD', N'PRE-DESPACHADA')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'PW', N'PEDIDO WEB')
INSERT [dbo].[P_TipoMovCajas] ([tmov_sigla], [tmov_desc]) VALUES (N'SA', N'DESPACHADA')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'EN', N'Recepcin')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'PD', N'Pre-Despacho')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'PR', N'Pre-Despacho por Radio Frecuencia')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'RM', N'Posicionamiento Manual')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'RR', N'Posicionamiento por Radio Frecuencia')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'SA', N'Despacho')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'WP', N'Pedido Web')
INSERT [dbo].[P_TipoMovTraza] ([tmov_sigla], [tmov_desc]) VALUES (N'ET', N'Etiquetado')
INSERT [dbo].[P_TipoMovVas] ([tmov_codi], [tmov_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'ENTRADA')
INSERT [dbo].[P_TipoMovVas] ([tmov_codi], [tmov_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'SALIDA')
INSERT [dbo].[P_TipoNumerales] ([tnum_codi], [tnum_desc], [tnum_act]) VALUES (CAST(1 AS Numeric(18, 0)), N'NORMAL', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoNumerales] ([tnum_codi], [tnum_desc], [tnum_act]) VALUES (CAST(2 AS Numeric(18, 0)), N'ESCALA DIARIA', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoNumerales] ([tnum_codi], [tnum_desc], [tnum_act]) VALUES (CAST(3 AS Numeric(18, 0)), N'ESCALA POR PROMEDIO', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoNumerales] ([tnum_codi], [tnum_desc], [tnum_act]) VALUES (CAST(4 AS Numeric(18, 0)), N'CAMARA CERRADA', CAST(1 AS Numeric(18, 0)))
INSERT [dbo].[P_TipoOlores] ([IdOlor], [DescripcionOlor]) VALUES (N'0', N'NO')
INSERT [dbo].[P_TipoOlores] ([IdOlor], [DescripcionOlor]) VALUES (N'1', N'SI')
INSERT [dbo].[P_TipoOlores] ([IdOlor], [DescripcionOlor]) VALUES (N'2', N'SELECCIONAR')
INSERT [dbo].[P_TipoPerfil] ([Id], [TipoPerfil]) VALUES (1, N'OPERACIONES')
INSERT [dbo].[P_TipoRecepcion] ([IdRecepcion], [DescripcionRecepcion]) VALUES (N'1', N'NACIONAL')
INSERT [dbo].[P_TipoRecepcion] ([IdRecepcion], [DescripcionRecepcion]) VALUES (N'2', N'IMPORTACION')
INSERT [dbo].[P_TipoRecepcion] ([IdRecepcion], [DescripcionRecepcion]) VALUES (N'3', N'EXPORTACION')
INSERT [dbo].[P_TipoRecepcion] ([IdRecepcion], [DescripcionRecepcion]) VALUES (N'4', N'SELECCIONAR')
INSERT [dbo].[P_TipoSeguros] ([tseg_codi], [tseg_desc]) VALUES (CAST(0 AS Numeric(18, 0)), N'SEGURO NORMAL')
INSERT [dbo].[P_TipoSeguros] ([tseg_codi], [tseg_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'SEGURO CON ESCALA')
INSERT [dbo].[P_TipoSeguros] ([tseg_codi], [tseg_desc]) VALUES (CAST(2 AS Numeric(18, 0)), N'SEGURO EXCEDENTE')
INSERT [dbo].[P_TipoTunel] ([IdTunel], [Tunel]) VALUES (1, N'SIN TUNEL')
INSERT [dbo].[P_TipoTunel] ([IdTunel], [Tunel]) VALUES (2, N'A TUNEL')
INSERT [dbo].[P_Tunel] ([IdTunel], [Tunel]) VALUES (1, N'NO')
INSERT [dbo].[P_Tunel] ([IdTunel], [Tunel]) VALUES (2, N'T1')
INSERT [dbo].[P_Tunel] ([IdTunel], [Tunel]) VALUES (3, N'T2')
INSERT [dbo].[P_Tunel] ([IdTunel], [Tunel]) VALUES (4, N'T3')
INSERT [dbo].[P_Tunel] ([IdTunel], [Tunel]) VALUES (5, N'T4')
INSERT [dbo].[P_turnos] ([tur_codi], [tur_desc]) VALUES (CAST(1 AS Numeric(18, 0)), N'DIA')
INSERT [dbo].[P_turnos] ([tur_codi], [tur_desc]) VALUES (CAST(2 AS Numeric(18, 0)), N'NOCHE')
INSERT [dbo].[P_Vigencia] ([IdVigencia], [Nombre]) VALUES (1, N'ACTIVA')
INSERT [dbo].[P_Vigencia] ([IdVigencia], [Nombre]) VALUES (2, N'NULA')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'001', N'RECEPCIONES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'002', N'PRE-DESPACHOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'003', N'DESPACHOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'004', N'MANTENEDOR CLIENTES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'005', N'MANTENEDOR ENVASES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'006', N'MANTENEDOR CAMARAS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'007', N'MANTENEDOR CHOFERES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'008', N'MANTENEDOR SOPORTANTES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'009', N'MANTENEDOR FAMILIAS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'010', N'MANTENEDOR MEDIDAS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'011', N'MANTENEDOR PRODUCTOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'012', N'MANTENEDOR ORIGENES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'013', N'POSICIONAMIENTO')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'014', N'MANTENEDOR DE USUARIOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'015', N'MANTENEDOR DE CONTRATOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'016', N'MANTENEDOR DE SERVICIOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'017', N'MODULO PORTERIA')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'018', N'INFORMES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'020', N'PROCESO LIBERACION SOPORTANTES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'021', N'PROCESO DE ETIQUETADO')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'022', N'PREPARACION DE PEDIDOS')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'023', N'MODULO DE FACTURACION')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'024', N'ESTADO CONTENEDORES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'025', N'PROCESO RCP')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'026', N'PRIVILEGIOS TERMINALES MOVILES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'027', N'PROCESO DE BLOQ Y DESBLOQ DE SOPORTANTES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'028', N'MANTENEDOR DE COTIZACIONES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'029', N'CONTROLES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'030', N'ENVO DE E-MAIL')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'031', N'MANTENEDOR POSICIONES')
INSERT [dbo].[PrivilegiosSeccion] ([Priv_Id], [Priv_Nombre]) VALUES (N'032', N'PROCESOS')
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'001', N'CREAR RECEPCION', N'001', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'002', N'ANULAR GUIA RECEPCION', N'001', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'003', N'MODIFICAR GUIA RECEPCION', N'001', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'004', N'CREAR PRE-DESPACHO', N'002', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'005', N'ANULAR GUIA PRE-DESPACHO', N'002', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'006', N'CREAR DESPACHO', N'003', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'007', N'MODIFICAR DESPACHO', N'003', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'008', N'AGREGAR CLIENTES ', N'004', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'009', N'MODIFICAR CLIENTES', N'004', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'010', N'ELIMINAR CLIENTES', N'004', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'011', N'AGREGAR ENVASES', N'005', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'012', N'MODIFICAR ENVASES', N'005', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'013', N'ELIMINAR ENVASES', N'005', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'014', N'AGREGAR CAMARAS', N'006', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'015', N'MODIFICAR CAMARAS', N'006', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'016', N'ELIMINAR CAMARAS', N'006', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'017', N'AGREGAR CHOFERES', N'007', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'018', N'MODIFICAR CHOFERES', N'007', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'019', N'ELIMINAR CHOFERES', N'007', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'020', N'AGREGAR DE SOPORTANTES', N'008', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'021', N'MODIFICAR SOPORTANTES', N'008', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'022', N'ELIMINAR SOPORTANTES', N'008', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'023', N'AGREGAR FAMILIAS', N'009', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'024', N'MODIFICAR FAMILIAS', N'009', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'025', N'ELIMINAR FAMILIAS', N'009', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'026', N'AGREGAR MEDIDAS', N'010', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'027', N'MODIFICAR MEDIDAS', N'010', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'028', N'ELIMINAR MEDIDAS', N'010', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'029', N'AGREGAR PRODUCTOS', N'011', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'030', N'MODIFICAR PRODUCTOS', N'011', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'031', N'ELIMINAR PRODUCTOS', N'011', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'032', N'BLOQUEAR PRODUCTO A RECEPCION', N'011', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'033', N'AGREGAR ORIGENES ', N'012', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'034', N'MODIFICAR ORIGENES', N'012', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'035', N'ELIMINAR ORIGENES', N'012', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'036', N'AGREGAR USUARIOS', N'014', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'037', N'POSICIONAMIENTO MANUAL', N'013', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'038', N'CREAR CONTRATO', N'015', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'039', N'ELIMINAR CONTRATO', N'015', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'040', N'MODIFICAR TARIFAS', N'015', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'041', N'MODIFICAR ENCABEZADO', N'015', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'042', N'INGRESO SE SERVICIOS', N'016', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'043', N'REGISTRO DE CAMIONES', N'017', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'044', N'MOVIMIENTO DE CAMIONES', N'017', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'045', N'ESTADISTICAS (TIEMPOS)', N'017', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'046', N'MODIFICAR CHECKLIST', N'017', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'047', N'INFORMES DE STOCK', N'018', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'048', N'INFORME DE TRAZABILIDAD', N'018', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'049', N'INFORME DE IMPRESION DE ETIQUETAS RACK', N'018', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'051', N'SOLO VER RECEPCIONES', N'001', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'052', N'SOLO VER PRE- DESPACHOS', N'002', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'053', N'SOLO VER DESPACHOS', N'003', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'054', N'PROCESO IMPORTACIONES - DESBLOQUEAR', N'020', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'055', N'PROCESO IMPORTACIONES - MODIFICAR', N'020', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'056', N'AGREGAR ETIQUETADOS', N'021', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'057', N'MODIFICAR ETIQUETADOS', N'021', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'058', N'MODIFICAR TEMPERATURAS DE RECEPCION', N'001', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'059', N'MODIFICAR RECEPCION DURANTE EL DA', N'001', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'060', N'MODIFICAR EL DESPACHO DURANTE EL DIA', N'003', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'061', N'HABILITAR 24 HRS PARA MODIFICAR UNA RECEPCION', N'001', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'062', N'NO COBRO DE MOVIMIENTOS', N'012', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'063', N'MODIFICAR DESPACHOS HASTA LAS 12 HRS DIA SGTE.', N'003', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'064', N'DESBLOQUEAR SOPORTANTES PARA EL TRAQUEO', N'001', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'065', N'INGRESO A MODULO DE PEDIDOS', N'022', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'066', N'MODIFICACION DE PALLETS DE PEDIDO', N'022', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'067', N'ELIMINACION DE PEDIDOS WEB', N'022', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'068', N'INGRESO DE COBROS FRIGORIFICO', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'069', N'INGRESO DE COBROS ADMINISTRATIVOS', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'070', N'MODIF. DE COBROS  HASTA 3 DIAS', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'071', N'MODIF. DE COBROS  FULL', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'072', N'VER ESTADO DE CONTENEDORES', N'024', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'073', N'MODIFICAR ESTADO DE CONTENEDORES', N'024', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'074', N'INGRESO RCP', N'025', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'075', N'MODIFICACION RCP', N'025', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'077', N'ANULAR DOCUMENTO VAS', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'078', N'POSICIONAR', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'079', N'TRAZABILIDAD', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'080', N'ETIQUETADO', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'081', N'PRE - DESPACHO', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'082', N'PREPARACION DE PEDIDOS', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'083', N'POR POSICIONAR', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'084', N'TRAKEO DE ENVASES', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'085', N'INVENTARIO DE MERCADERIA', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'086', N'SELECCION DE CAJAS', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'087', N'REVISION REDE A FRIGORIFICO', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'088', N'REVISION FRIGORIFICO A REDE ', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'089', N'MANTENEDOR USUARIOS OPERACIONES', N'014', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'090', N'CATEGORIAS', N'014', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'091', N'SUB CATEGORIAS', N'014', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'092', N'MANTENEDOR DE MONEDAS', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'093', N'FACTURACION DE CLIENTES', N'023', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'094', N'BLOQUEO Y DESBLOQUEO DE SOPORTANTES', N'027', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'095', N'CAMBIO DE CAJAS', N'022', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'096', N'INGRESO DE COTIZACIONES', N'028', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'097', N'ELIMINAR INGRESO PORTERIA', N'017', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'098', N'INGRESO A TUNEL', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'099', N'I/S ANDENES', N'026', 1)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'100', N'CONTROL MOVIMIENTOS/CAM
', N'029', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'101', N'SOPORTANTES PARA INGRESO TUNEL', N'029', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'102', N'SERVICIOS RECEPCION', N'001', 0)
GO
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'103', N'AUDITORA
', N'026', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'104', N'PEDIDOS POR USUARIO', N'029', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'105', N'USO MANTENEDOR EMAIL
', N'030', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'106', N'INFORME TUNELES TONELADAS
', N'029', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'107', N'USO MANTENEDOR POSICIONES', N'031', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'108', N'JIBIA
', N'032', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'109', N'INFORME PALLETS MAL POSICIONADOS
', N'029', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'110', N'RESERVAR
', N'029', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'111', N'COLUMNA POS
', N'026', 0)
INSERT [dbo].[PrivilegiosSubSeccion] ([Spriv_Id], [Spriv_nombre], [Spriv_PrivId], [spriv_habil]) VALUES (N'112', N'MANTENEDOR DE CAMARAS PLANO 
', N'006', 0)
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'0', N'VIGENTE', N'0', CAST(1 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'1', N'SELECCIONADO', N'0', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'2', N'PEDIDO', N'1', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'3', N'BLOQUEADO CLIENTE', N'1', CAST(1 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'4', N'HACCP', N'1', CAST(1 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'5', N'BLOQ. S/RESOLUCIN', N'1', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'6', N'DESPACHADO', N'1', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[RACKDETA_ESTADO] ([CODIGO], [DESCRIPCION], [BLOQUEAR], [VISIBLE]) VALUES (N'7', N'EN PRE-DESPACHO', N'1', CAST(0 AS Numeric(18, 0)))
INSERT [dbo].[ROLES] ([CODIGO_ROL], [DESCRIPCION_ROL]) VALUES (1, N'OPERADOR DE PRECAMARA')
INSERT [dbo].[ROLES] ([CODIGO_ROL], [DESCRIPCION_ROL]) VALUES (2, N'ADMINISTRADOR INFORMATICO')
INSERT [dbo].[ROLES] ([CODIGO_ROL], [DESCRIPCION_ROL]) VALUES (3, N'SUPER ADMINISTRADOR')
INSERT [dbo].[ROLES] ([CODIGO_ROL], [DESCRIPCION_ROL]) VALUES (4, N'SUPERVISOR DE OPERADOR DE PRECAMARA')

INSERT [dbo].[Mae_Bodega] ([Cod_Bodega], [Des_Bodega], [Tipo], [Dir_Bodega], [Rut_Bodega], [Razon_Social], [contacto]) VALUES (N'1', N'BODEGA 1', N'FRIGORIFICO', N'LONG. SUR 95.5', CAST(774486305 AS Numeric(18, 0)), N'PRECISA FROZEN STORAGE & SERVICES LTDA', NULL)
INSERT [dbo].[Mae_Bodega] ([Cod_Bodega], [Des_Bodega], [Tipo], [Dir_Bodega], [Rut_Bodega], [Razon_Social], [contacto]) VALUES (N'0', N'ADMIN', N'FRIGORIFICO', N' ', CAST(111111111 AS Numeric(18, 0)), NULL, NULL)


